"use strict";(self.webpackChunkadmin2=self.webpackChunkadmin2||[]).push([[138],{138:(me,O,c)=>{c.r(O),c.d(O,{ImportExportModule:()=>_e});var _=c(9808),G=c(2461),z=c(3541),N=c(4332),M=c(2732),b=c(440),x=c(5330),J=c(511),m=c(520),T=c(262),q=c(608),t=c(7587);let Z=(()=>{class n extends q.D{constructor(e){super(e),this.setRequestUrl("import")}getSheetProperties(e){const o=this.getRequestUrl()+`/${e.id}/properties`;return this.http.post(o,e,{headers:this.headers}).pipe((0,T.K)(this.handleError()))}getFieldsOptions(e,o){const i=this.getRequestUrl()+`/${e}/fields_options`;let r=this.createHttpParams(o);return this.http.get(i,{params:r,headers:this.headers}).pipe((0,T.K)(this.handleError()))}splitFileAction(e){const o=this.getRequestUrl()+`/${e}/split_file`;return this.http.post(o,{},{headers:this.headers}).pipe((0,T.K)(this.handleError()))}testData(e){const o=this.getRequestUrl()+`/${e.id}/do_import_test`;return this.http.post(o,e,{headers:this.headers}).pipe((0,T.K)(this.handleError()))}importData(e){const o=this.getRequestUrl()+`/${e.id}/do_import`;return this.http.post(o,e,{headers:this.headers}).pipe((0,T.K)(this.handleError()))}importDataProgress(e){const o=this.getRequestUrl()+`/${e.id}/do_import`;return this.http.request(new m.aW("POST",o,e,{reportProgress:!0,responseType:"text",headers:this.headers}))}getPercent(e){const o=this.getRequestUrl()+`/${e.id}/percent`;return this.http.get(o,{headers:this.headers}).pipe((0,T.K)(this.handleError()))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var s=c(3075),X=c(7489);class E{constructor(l,e,o,i,r,p,a,d,g,h){this.id=l,this.title=e,this.fileData=o,this.type=i,this.fileSize=r,this.rowsQuantity=p,this.sheetsQuantity=a,this.sheetsNames=d,this.options=g,this.fieldsOptions=h,void 0===this.options&&E.setOptionsDefaults(this)}static setOptionsDefaults(l){l.options||(l.options={}),l.options=Object.assign({parentId:0,rowNumberHeaders:1,rowNumberFirst:2,rowNumberLast:3,stepsNumber:1,step:1,categoriesSeparator:"",sheetName:"",contentType:"",articulFieldName:"",aliasAdditionalFieldName:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"',skipFound:!1,filesDownload:!1},l.options)}}var W=c(6008),F=c(253),Q=c(5759),R=c(1034),v=c(889),U=c(1480),f=c(2925),C=c(9783),w=c(1424),K=c(8958),D=c(4036),k=c(524),tt=c(242),y=c(845),I=c(5787),S=c(4119),P=c(3724),Y=c(6198),B=c(8185);function et(n,l){1&n&&(t.ynx(0),t.TgZ(1,"div",31),t._UZ(2,"div",23),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",2)(6,"div",3)(7,"label",32)(8,"span",13),t.ALo(9,"translate"),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t._UZ(12,"input",33),t.qZA(),t.TgZ(13,"div",3)(14,"label",34)(15,"span",13),t.ALo(16,"translate"),t._uU(17),t.ALo(18,"translate"),t.qZA()(),t._UZ(19,"input",35),t.qZA()()(),t.TgZ(20,"div",3)(21,"label",36),t._uU(22),t.ALo(23,"translate"),t.qZA(),t._UZ(24,"input",37),t.qZA()(),t.BQk()),2&n&&(t.xp6(8),t.Q6J("title",t.lcZ(9,5,"CSV_SEPARATOR")),t.xp6(2),t.Oqu(t.lcZ(11,7,"CSV_SEPARATOR")),t.xp6(5),t.Q6J("title",t.lcZ(16,9,"CSV_ENCLOSURE")),t.xp6(2),t.Oqu(t.lcZ(18,11,"CSV_ENCLOSURE")),t.xp6(5),t.Oqu(t.lcZ(23,13,"CSV_ENCODING")))}function nt(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-dropdown",51),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).model.options.sheetName=i})("onChange",function(){return t.CHM(e),t.oxw(2).getSheetProperties()}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("options",e.model.sheetsNames)("ngModel",e.model.options.sheetName)}}function ot(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-dropdown",52),t.NdJ("onChange",function(i){return t.CHM(e),t.oxw(2).getContentType(i.value)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("options",e.contentTypes)("showClear",!0)}}function it(n,l){if(1&n&&(t.ynx(0),t._UZ(1,"p-dropdown",53),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("options",e.contentType.fields)("showClear",!0)}}function rt(n,l){if(1&n&&(t.ynx(0),t._UZ(1,"p-dropdown",54),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("options",e.contentType.fields)("showClear",!0)}}function lt(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div")(2,"div",31),t._UZ(3,"div",23),t.qZA(),t.TgZ(4,"div",38)(5,"div",3)(6,"label",39),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.YNc(9,nt,2,2,"ng-container",40),t.qZA(),t.TgZ(10,"div",3)(11,"label",41),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",42),t._UZ(15,"app-select-parent-dropdown",43),t.qZA()()(),t.TgZ(16,"div",38)(17,"div",3)(18,"label",44),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.YNc(21,ot,2,2,"ng-container",40),t.qZA(),t.TgZ(22,"div",3)(23,"label",45),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.YNc(26,it,2,2,"ng-container",40),t.qZA()(),t.TgZ(27,"div",38)(28,"div",3)(29,"label",46)(30,"span",13),t.ALo(31,"translate"),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t.YNc(34,rt,2,2,"ng-container",40),t.qZA(),t.TgZ(35,"div",3)(36,"div",6),t._UZ(37,"p-inputSwitch",47),t.TgZ(38,"label",48),t._uU(39),t.ALo(40,"translate"),t.qZA()(),t.TgZ(41,"div",6),t._UZ(42,"p-inputSwitch",49),t.TgZ(43,"label",50),t._uU(44),t.ALo(45,"translate"),t.qZA()()()()(),t.BQk()),2&n){const e=t.oxw(),o=t.MAs(65);t.xp6(7),t.Oqu(t.lcZ(8,16,"SHEET")),t.xp6(2),t.Q6J("ngIf",e.model.sheetsNames.length>0)("ngIfElse",o),t.xp6(3),t.Oqu(t.lcZ(13,18,"PARENT_FOLDER")),t.xp6(7),t.hij(" ",t.lcZ(20,20,"CONTENT_TYPE")," "),t.xp6(2),t.Q6J("ngIf",e.contentTypes.length>0)("ngIfElse",o),t.xp6(3),t.Oqu(t.lcZ(25,22,"SEARCH_FIELD")),t.xp6(2),t.Q6J("ngIf",e.contentType)("ngIfElse",o),t.xp6(4),t.Q6J("title",t.lcZ(31,24,"ALIAS_ADDITIONAL_FIELD")),t.xp6(2),t.Oqu(t.lcZ(33,26,"ALIAS_ADDITIONAL_FIELD")),t.xp6(2),t.Q6J("ngIf",e.contentType)("ngIfElse",o),t.xp6(5),t.hij(" ",t.lcZ(40,28,"FILES_DOWNLOAD")," "),t.xp6(5),t.hij(" ",t.lcZ(45,30,"SKIP_FOUND")," ")}}function st(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",66),t.NdJ("click",function(i){return t.CHM(e),t.oxw(2).getTestData(i)}),t.ALo(1,"translate"),t.qZA()}2&n&&t.Q6J("label",t.lcZ(1,1,"TEST"))}function at(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",66),t.NdJ("click",function(i){return t.CHM(e),t.oxw(2).clearTestData(i)}),t.ALo(1,"translate"),t.qZA()}2&n&&t.Q6J("label",t.lcZ(1,1,"CANCEL"))}const pt=function(){return{standalone:!0}};function ct(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",67)(1,"div",68)(2,"label",69),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p-dropdown",70),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).model.options.step=i}),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(3),t.hij(" ",t.lcZ(4,4,"STEP")," "),t.xp6(2),t.Q6J("options",e.steps)("ngModel",e.model.options.step)("ngModelOptions",t.DdM(6,pt))}}function dt(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",78)(2,"input",79),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().$implicit.targetName=i}),t.ALo(3,"translate"),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,2,"SYSTEM_NAME"))("ngModel",e.targetName)}}function _t(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-dropdown",74),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).$implicit.targetName=i}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2).$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("options",o.contentType.fields)("ngModel",e.targetName)}}function mt(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div",78),t.YNc(2,_t,2,2,"ng-container",40),t.qZA(),t.BQk()),2&n){const e=t.oxw(3),o=t.MAs(65);t.xp6(2),t.Q6J("ngIf",e.contentType)("ngIfElse",o)}}function ut(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",78)(2,"input",79),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().$implicit.separator=i}),t.ALo(3,"translate"),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,2,"SEPARATOR"))("ngModel",e.separator)}}function gt(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",86)(2,"input",79),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().$implicit.targetTitle=i}),t.ALo(3,"translate"),t.qZA()(),t.TgZ(4,"div",87)(5,"input",79),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().$implicit.targetName=i}),t.ALo(6,"translate"),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,4,"FIELD_NAME"))("ngModel",e.targetTitle),t.xp6(3),t.Q6J("pTooltip",t.lcZ(6,6,"SYSTEM_NAME"))("ngModel",e.targetName)}}function ft(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",86)(1,"input",79),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).$implicit.targetTitle=i}),t.ALo(2,"translate"),t.qZA()()}if(2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("pTooltip",t.lcZ(2,2,"FIELD_NAME"))("ngModel",e.targetTitle)}}function ht(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-dropdown",74),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).$implicit.targetName=i}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2).$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("options",o.contentType.fields)("ngModel",e.targetName)}}const xt=function(n,l){return{"col-4":n,"col-6":l}};function Ct(n,l){if(1&n&&(t.ynx(0),t.YNc(1,ft,3,4,"div",88),t.TgZ(2,"div",89),t.YNc(3,ht,2,2,"ng-container",40),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit,o=t.oxw(4),i=t.MAs(65);t.xp6(1),t.Q6J("ngIf",o.getIsParametersField(e.targetName)),t.xp6(1),t.Q6J("ngClass",t.WLB(4,xt,o.getIsParametersField(e.targetName),!o.getIsParametersField(e.targetName))),t.xp6(1),t.Q6J("ngIf",o.contentType)("ngIfElse",i)}}function Tt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",85)(1,"div",73)(2,"p-dropdown",74),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.targetAction=i})("ngModelChange",function(i){const p=t.CHM(e).$implicit,a=t.oxw(2).$implicit;return t.oxw(2).onChangeFieldAction(p,i,a)}),t.qZA()(),t.ynx(3,75),t.YNc(4,gt,7,8,"ng-container",76),t.YNc(5,Ct,4,7,"ng-container",76),t.BQk(),t.qZA()}if(2&n){const e=l.$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("ngClass",o.getFieldsColumnClass(e,"field_sub")),t.xp6(1),t.Q6J("options",o.rowSplitActions)("ngModel",e.targetAction),t.xp6(1),t.Q6J("ngSwitch",e.targetAction),t.xp6(1),t.Q6J("ngSwitchCase","new"),t.xp6(1),t.Q6J("ngSwitchCase","field")}}function bt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",80)(1,"div",2)(2,"div",81),t.YNc(3,Tt,6,6,"div",82),t.TgZ(4,"div",83)(5,"button",84),t.NdJ("click",function(i){t.CHM(e);const r=t.oxw().$implicit;return t.oxw(2).fieldAddOptions(r,i)}),t.ALo(6,"translate"),t.qZA()()()()()}if(2&n){const e=t.oxw().$implicit;t.xp6(3),t.Q6J("ngForOf",e.options),t.xp6(2),t.Q6J("label",t.lcZ(6,2,"ADD"))}}function Zt(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",2)(2,"div",71),t._uU(3),t.qZA(),t.TgZ(4,"div",72)(5,"div",2)(6,"div",73)(7,"p-dropdown",74),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.targetAction=i})("ngModelChange",function(i){const p=t.CHM(e).$implicit;return t.oxw(2).onChangeFieldAction(p,"field",i)}),t.qZA()(),t.ynx(8,75),t.YNc(9,dt,4,4,"ng-container",76),t.YNc(10,mt,3,2,"ng-container",76),t.YNc(11,ut,4,4,"ng-container",76),t.BQk(),t.qZA()()(),t.YNc(12,bt,7,4,"div",77),t.BQk()}if(2&n){const e=l.$implicit,o=t.oxw(2);t.xp6(3),t.hij(" ",e.sourceTitle," "),t.xp6(3),t.Q6J("ngClass",o.getFieldsColumnClass(e,"field")),t.xp6(1),t.Q6J("options",o.rowActions)("ngModel",e.targetAction),t.xp6(1),t.Q6J("ngSwitch",e.targetAction),t.xp6(1),t.Q6J("ngSwitchCase","new"),t.xp6(1),t.Q6J("ngSwitchCase","field"),t.xp6(1),t.Q6J("ngSwitchCase","split"),t.xp6(1),t.Q6J("ngIf","split"==e.targetAction)}}function At(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA()()),2&n){const e=l.$implicit;t.xp6(2),t.hij(" ",e," ")}}function vt(n,l){if(1&n&&(t.TgZ(0,"table",95)(1,"thead",101)(2,"tr")(3,"th"),t._uU(4),t.ALo(5,"translate"),t.qZA()()(),t.TgZ(6,"tbody",97),t.YNc(7,At,3,1,"tr",64),t.qZA()()),2&n){const e=t.oxw(3);t.xp6(4),t.Oqu(t.lcZ(5,2,"CATEGORIES")),t.xp6(3),t.Q6J("ngForOf",e.testData.categories)}}function wt(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"json"),t.qZA()()),2&n){const e=l.$implicit;t.xp6(2),t.hij(" ",e.key," "),t.xp6(2),t.hij(" ",t.lcZ(5,2,e.value)," ")}}function yt(n,l){if(1&n&&(t.TgZ(0,"div",90)(1,"div",2)(2,"div",91)(3,"div",92),t.YNc(4,vt,8,4,"table",93),t.qZA(),t.TgZ(5,"div",94)(6,"table",95)(7,"colgroup"),t._UZ(8,"col",96),t.qZA(),t.TgZ(9,"tbody",97)(10,"tr")(11,"td"),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA()(),t.TgZ(16,"tr")(17,"td"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA()(),t.TgZ(22,"tr")(23,"td"),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"td"),t._uU(27),t.ALo(28,"translate"),t.qZA()()()()()(),t.TgZ(29,"div",98)(30,"div",94)(31,"table",95)(32,"colgroup"),t._UZ(33,"col",99)(34,"col",100),t.qZA(),t.TgZ(35,"thead",101)(36,"tr")(37,"th",102),t._uU(38),t.ALo(39,"translate"),t.qZA()()(),t.TgZ(40,"tbody",97),t.YNc(41,wt,6,4,"tr",64),t.ALo(42,"keyvalue"),t.qZA()()()()()()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",e.testData.categories.length),t.xp6(8),t.hij(" ",t.lcZ(13,10,"ROW_NUMBER")," "),t.xp6(3),t.hij(" ",e.testData.row_number_first," "),t.xp6(3),t.hij(" ",t.lcZ(19,12,"MEMORY_USED")," "),t.xp6(3),t.hij(" ",e.testData.memory_peak_usage," "),t.xp6(3),t.hij(" ",t.lcZ(25,14,"TIME_EXECUTION")," "),t.xp6(3),t.AsE(" ",e.testData.time_execution," ",t.lcZ(28,16,"TIME_EXECUTION_SEC")," "),t.xp6(11),t.Oqu(t.lcZ(39,18,"PRODUCT_DATA")),t.xp6(3),t.Q6J("ngForOf",t.lcZ(42,20,e.testData.data))}}function It(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",55)(2,"div",56)(3,"div",57)(4,"div",58)(5,"button",59),t.NdJ("click",function(i){return t.CHM(e),t.oxw().updateData(i)}),t.ALo(6,"translate"),t.qZA(),t.YNc(7,st,2,3,"button",60),t.YNc(8,at,2,3,"button",60),t.qZA(),t.TgZ(9,"div",58),t.YNc(10,ct,6,7,"div",61),t.TgZ(11,"button",62),t.NdJ("click",function(i){return t.CHM(e),t.oxw().startImport(i)}),t._uU(12),t.ALo(13,"translate"),t.qZA()()()(),t.TgZ(14,"div",63),t.YNc(15,Zt,13,9,"ng-container",64),t.qZA(),t.YNc(16,yt,43,22,"div",65),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("pTooltip",t.lcZ(6,7,"REFRESH")),t.xp6(2),t.Q6J("ngIf",!e.testData),t.xp6(1),t.Q6J("ngIf",e.testData),t.xp6(2),t.Q6J("ngIf",e.model.options.stepsNumber>1),t.xp6(2),t.hij(" ",t.lcZ(13,9,"START_IMPORT")," "),t.xp6(3),t.Q6J("ngForOf",e.model.fieldsOptions),t.xp6(1),t.Q6J("ngIf",e.testData)}}function Nt(n,l){if(1&n&&t._UZ(0,"p-message",103),2&n){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function Mt(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div",105),t._UZ(2,"p-progressBar",106),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("value",e.percent)}}function Et(n,l){if(1&n&&(t.TgZ(0,"div",104),t._UZ(1,"p-progressSpinner"),t.YNc(2,Mt,3,1,"ng-container",21),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.showProgressBar)}}function St(n,l){1&n&&(t.TgZ(0,"div",107),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"EMPTY"),". "))}let Lt=(()=>{class n extends Q.P{constructor(e,o,i,r,p,a,d,g,h){super(e,o,i,r),this.ref=e,this.config=o,this.systemNameService=i,this.dataService=r,this.contentTypesService=p,this.settingsService=a,this.appSettings=d,this.translateService=g,this.messageService=h,this.loadingConfiguration=!1,this.isInitialised=!1,this.sheetHeaders=[],this.contentTypes=[],this.percent=0,this.showProgressBar=!1,this.steps=[1],this.files={},this.model=new E(0,""),this.form=new s.cw({title:new s.NI("",[s.kI.required]),fileData:new s.NI(null,[]),options__rowNumberHeaders:new s.NI(1,[]),options__rowNumberFirst:new s.NI(2,[]),options__rowNumberLast:new s.NI(3,[]),options__categoriesSeparator:new s.NI("",[]),options__stepsNumber:new s.NI(1,[]),options__csvSeparator:new s.NI("",[]),options__csvEncoding:new s.NI("",[]),options__csvEnclosure:new s.NI("",[]),options__sheetName:new s.NI("",[]),options__parentId:new s.NI("",[]),options__contentType:new s.NI("",[]),options__articulFieldName:new s.NI("",[]),options__aliasAdditionalFieldName:new s.NI("",[]),options__filesDownload:new s.NI("",[]),options__skipFound:new s.NI("",[])}),this.rowActions=[],this.rowSplitActions=[]}ngOnInit(){this.rowActions=[{name:"",title:this.getLangString("NO_IMPORT")},{name:"category",title:this.getLangString("CATEGORY")},{name:"field",title:this.getLangString("SELECT_FIELD")},{name:"new",title:this.getLangString("CREATE_FIELD")},{name:"translations",title:this.getLangString("TRANSLATIONS")},{name:"split",title:this.getLangString("SPLIT")}],this.rowSplitActions=[{name:"",title:this.getLangString("NO_IMPORT")},{name:"field",title:this.getLangString("SELECT_FIELD")},{name:"new",title:this.getLangString("CREATE_FIELD")},{name:"delete",title:this.getLangString("DELETE")}],super.ngOnInit(),this.getContentTypes()}onGetData(e){super.onGetData(e),setTimeout(()=>{this.isInitialised=!0},1),this.model.options.contentType&&this.getContentType(this.model.options.contentType),(!this.model.fieldsOptions||0===this.model.fieldsOptions.length)&&this.getSheetProperties(),this.updateStepsArr()}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}getFileName(e){return"string"==typeof e?e:W.q.getFileName(e)}onOptionChanged(){!this.isInitialised||(clearTimeout(this.timerConfiguration),this.timerConfiguration=setTimeout(this.getSheetProperties.bind(this),700))}getContentTypes(){this.contentTypesService.getListPage().subscribe({next:e=>{this.contentTypes=e.items,this.contentTypes.unshift(new F.z(0,"",""))},error:e=>{this.errorMessage=e}})}getContentType(e){e?(this.loadingConfiguration=!0,this.contentTypesService.getItemByName(e).subscribe({next:o=>{this.contentType=o,this.contentType.fields.unshift(new R._(0,"","")),this.loadingConfiguration=!1},error:o=>{o.error&&(this.errorMessage=o.error),this.contentType=null,this.loadingConfiguration=!1}})):this.contentType=null}onChangeFieldAction(e,o,i){if(e.targetName="",e.targetTitle="",e.separator="",e.options=[],"delete"===o&&i){const r=i.options.findIndex(p=>"delete"===p.targetAction);r>-1&&i.options.splice(r,1)}}getSheetProperties(e){e&&e.preventDefault(),this.form.controls.options__sheetName.value?(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.getSheetProperties(this.getFormData()).subscribe({next:i=>{this.model.fieldsOptions=i.fieldsOptions,this.model.options.rowNumberLast=i.rowsQuantity,this.form.controls.options__rowNumberLast.setValue(i.rowsQuantity),this.loadingConfiguration=!1},error:i=>{this.loadingConfiguration=!1}})):this.sheetHeaders=[]}getTestData(e){if(e&&e.preventDefault(),this.loading||this.loadingConfiguration)return;this.errorMessage="",this.loadingConfiguration=!0;const o=this.getFormData();this.dataService.testData(o).subscribe({next:i=>{i?this.testData=i:this.errorMessage=this.getLangString("ERROR"),this.loadingConfiguration=!1},error:i=>{this.errorMessage=i.error||this.getLangString("ERROR"),this.loadingConfiguration=!1}})}updateData(e){e&&e.preventDefault(),this.testData?this.getTestData():this.getSheetProperties()}fieldAddOptions(e,o){o&&o.preventDefault(),e.options.push({targetAction:""})}getIsFieldsCount(e,o){switch(o){case 1:return!e.targetAction||["category"].indexOf(e.targetAction)>-1;case 2:return["field","split"].indexOf(e.targetAction)>-1;case 3:return["new"].indexOf(e.targetAction)>-1}return!0}getIsParametersField(e){return!!this.contentType&&this.contentType.fields.filter(p=>"parameters"===p.inputType).map(p=>p.name).indexOf(e)>-1}getFieldsColumnClass(e,o){let i=[["split","field","new"],[]],r=["col-6 pe-2","col-4 pe-2"];const p=this.getIsParametersField(e.targetName);"field_sub"===o&&(i=[["split"],["new"]],p?i[1].push("field"):i[0].push("field"),r=["col-6 pe-2","col-4 pe-2"]);let a="col-12";return i.forEach((d,g)=>{d.indexOf(e.targetAction)>-1&&(a=r[g])}),a}onStepNumberChange(){this.updateStepsArr()}onImportCompleted(){this.showProgressBar=!1,this.loading=!1,this.closeReason="updated",this.messageService.add({key:"message",severity:"success",summary:this.getLangString("MESSAGE"),detail:this.getLangString("IMPORT_COMPLETED")})}updateStepsArr(){this.steps=(0,X.range)(1,Math.max(1,parseInt(String(this.model.options.stepsNumber),10)+1)),this.model.options.step=1}startImport(e){if(e&&e.preventDefault(),this.loading||this.loadingConfiguration)return;this.errorMessage="",this.testData=null,this.loading=!0,this.percent=0;const o=this.getFormData();let i=0,r="",p={};this.dataService.importDataProgress(o).subscribe({next:a=>{if(a instanceof m.Zn)this.updatePercent(100);else if(a instanceof m.ZM)200!==a.status&&400!==a.status&&this.onImportCompleted();else if(a.type===m.dt.DownloadProgress){r=a.partialText.substr(i).trim();const d=r.split("\n");r=d[d.length-1],i=a.partialText.length,"{"===r.substr(0,1)&&"}"===r.substr(r.length-1,1)&&(p=JSON.parse(r),this.updatePercent((p.currentIndex-p.rowNumberFirst)/(p.rowNumberLast-p.rowNumberFirst)*100))}},error:a=>{a.error&&a.error.indexOf("{")>-1&&(a.error=JSON.parse(a.error),a.error=a.error.error||this.getLangString("ERROR")),this.errorMessage=a.error||this.getLangString("ERROR"),this.showProgressBar=!1,this.loading=!1}})}updatePercent(e){this.percent=Math.min(100,Math.floor(e)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout(this.onImportCompleted.bind(this),1e3)}clearTestData(e){e&&e.preventDefault(),this.testData=null}getFormData(){const e=super.getFormData();return e.fieldsOptions=this.model.fieldsOptions||[],e.step=this.model.options.step||1,e}onFilesSaved(e){e&&e.id&&(this.model=e,this.model.options.rowNumberLast&&this.form.controls.options__rowNumberLast.setValue(this.model.options.rowNumberLast),this.model.sheetsNames&&this.model.sheetsNames.length>0&&(this.model.options.sheetName=this.model.sheetsNames[0],this.form.controls.options__sheetName.setValue(this.model.options.sheetName)),this.getSheetProperties())}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.E7),t.Y36(x.S),t.Y36(M.U),t.Y36(Z),t.Y36(v.s),t.Y36(N.g),t.Y36(U.d),t.Y36(f.sK),t.Y36(C.ez))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-modal-import"]],features:[t._Bn([Z]),t.qOj],decls:66,vars:44,consts:[[3,"formGroup"],["formEl",""],[1,"grid"],[1,"col-12","md:col-6"],["for","fieldTitle",1,"block","mb-2"],["type","text","pInputText","","id","fieldTitle","formControlName","title",1,"w-full"],[1,"mb-2"],["formControlName","fileData",3,"allowedExtensions","fieldName","largeFieldMode","files","filesChange"],[1,"mb-2","form-group-message"],["for","fieldRowNumberHeaders",1,"block","mb-2"],["type","number","pInputText","","id","fieldRowNumberHeaders","step","1","min","1","name","rowNumberHeaders","formControlName","options__rowNumberHeaders",1,"w-full"],[1,"col-12","lg:col-6"],["for","fieldRowNumberFirst",1,"block","mb-2"],[1,"text-overflow",3,"title"],["type","number","pInputText","","id","fieldRowNumberFirst","step","1","min","1","name","rowNumberFirst","formControlName","options__rowNumberFirst",1,"w-full"],["for","fieldRowNumberLast",1,"block","mb-2"],["type","number","pInputText","","id","fieldRowNumberLast","step","1","min","1","name","rowNumberLast","formControlName","options__rowNumberLast",1,"w-full"],["for","fieldCategoriesSeparator",1,"block","mb-2"],["type","text","pInputText","","id","fieldCategoriesSeparator","name","categoriesSeparator","formControlName","options__categoriesSeparator",1,"w-full"],["for","fieldStepsNumber",1,"block","mb-2"],["type","number","pInputText","","id","fieldStepsNumber","step","1","min","1","max","100","formControlName","options__stepsNumber",1,"w-full",3,"ngModel","ngModelChange"],[4,"ngIf"],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left"],[1,"p-divider-content"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],[1,"col-12","md:col-3"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-warning","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],["emptyTemplate",""],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left","mt-1"],["for","fieldCSVSeparator",1,"block","mb-2","text-overflow"],["type","text","pInputText","","id","fieldCSVSeparator","name","csvSeparator","formControlName","options__csvSeparator",1,"w-full"],["for","fieldCSVEnclosure",1,"block","mb-2","text-overflow"],["type","text","pInputText","","id","fieldCSVEnclosure","name","csvEnclosure","formControlName","options__csvEnclosure",1,"w-full"],["for","fieldCSVEncoding",1,"block","mb-2"],["type","text","pInputText","","id","fieldCSVEncoding","name","csvEncoding","formControlName","options__csvEncoding",1,"w-full"],[1,"grid","mb-2"],["for","fieldSheetsNames",1,"block","mb-2"],[4,"ngIf","ngIfElse"],[1,"block","mb-2"],[1,"w-full-parent"],["formControlName","options__parentId"],["for","fieldContentType",1,"block","mb-2"],["for","fieldArticulFieldName",1,"block","mb-2"],["for","fieldAliasAdditionalFieldName",1,"block","mb-2","text-overflow"],["inputId","fieldFilesDownload","styleClass","mr-2 vertical-align-middle","formControlName","options__filesDownload"],["for","fieldFilesDownload",1,"vertical-align-middle"],["inputId","fieldSkipFound","styleClass","mr-2 vertical-align-middle","formControlName","options__skipFound"],["for","fieldSkipFound",1,"vertical-align-middle"],["styleClass","w-full","inputId","fieldSheetsNames","formControlName","options__sheetName",3,"options","ngModel","ngModelChange","onChange"],["styleClass","w-full","inputId","fieldContentType","optionLabel","title","optionValue","name","formControlName","options__contentType",3,"options","showClear","onChange"],["styleClass","w-full","inputId","fieldArticulFieldName","optionLabel","title","optionValue","name","formControlName","options__articulFieldName",3,"options","showClear"],["styleClass","w-full","inputId","fieldAliasAdditionalFieldName","optionLabel","title","optionValue","name","formControlName","options__aliasAdditionalFieldName",3,"options","showClear"],[1,"border-round","border-1","surface-200","border-400","p-3"],[1,"border-bottom-1","border-400","mb-3"],[1,"flex","justify-content-between","flex-wrap"],[1,"flex","align-items-center","justify-content-center","mb-3"],["type","button","pButton","","pRipple","","icon","pi pi-sync","tooltipPosition","bottom",1,"p-button-sm",3,"pTooltip","click"],["type","button","pButton","","pRipple","","class","p-button-secondary p-button-sm ml-2",3,"label","click",4,"ngIf"],["class","d-inline-block pr-2","style","width: 150px;",4,"ngIf"],["type","button","pButton","","pRipple","",3,"click"],[1,"max-height400"],[4,"ngFor","ngForOf"],["class","mt-3 pt-3 border-top-1 border-400",4,"ngIf"],["type","button","pButton","","pRipple","",1,"p-button-secondary","p-button-sm","ml-2",3,"label","click"],[1,"d-inline-block","pr-2",2,"width","150px"],[1,"p-inputgroup"],["for","fieldStep",1,"p-inputgroup-addon"],["styleClass","border-noround-left w-full","inputId","fieldStep",3,"options","ngModel","ngModelOptions","ngModelChange"],[1,"col-12","md:col-4"],[1,"col-12","md:col-8"],[3,"ngClass"],["styleClass","w-full","optionLabel","title","optionValue","name","appendTo","body",3,"options","ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","border-bottom-1 border-400 pb-2 mb-3",4,"ngIf"],[1,"col-6","ps-2"],["type","text","pInputText","","tooltipPosition","bottom",1,"w-full",3,"pTooltip","ngModel","ngModelChange"],[1,"border-bottom-1","border-400","pb-2","mb-3"],[1,"col-12"],["class","grid mb-3",4,"ngFor","ngForOf"],[1,"text-center"],["type","button","pButton","","pRipple","","icon","pi pi-plus",1,"p-button-secondary","p-button-sm",3,"label","click"],[1,"grid","mb-3"],[1,"col-4","px-1"],[1,"col-4","ps-2"],["class","col-4 px-1",4,"ngIf"],[1,"ps-2",3,"ngClass"],[1,"mt-3","pt-3","border-top-1","border-400"],[1,"lg:col-5"],[1,"p-component","p-datatable","p-datatable-sm","p-datatable-responsive-stack","mb-3"],["class","p-datatable-table w-full",4,"ngIf"],[1,"p-component","p-datatable","p-datatable-sm","p-datatable-responsive-stack"],[1,"p-datatable-table","w-full"],["width","50%","span","2"],[1,"p-datatable-tbody"],[1,"lg:col-7"],["width","40%"],["width","60%"],[1,"p-datatable-thead"],["colspan","2"],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"loading-overlay"],[1,"app-progress"],[3,"value"],[1,"border-round","border-1","surface-200","border-400","py-2","px-3"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"div",3)(5,"label",4),t._uU(6),t.ALo(7,"translate"),t.qZA(),t._UZ(8,"input",5),t.qZA(),t.TgZ(9,"div",3)(10,"div",6)(11,"app-file-widget",7),t.NdJ("filesChange",function(r){return o.files=r}),t.qZA()()()(),t.TgZ(12,"div",2)(13,"div",3)(14,"div",8)(15,"label",9),t._uU(16),t.ALo(17,"translate"),t.qZA(),t._UZ(18,"input",10),t.qZA()(),t.TgZ(19,"div",3)(20,"div",2)(21,"div",11)(22,"label",12)(23,"span",13),t.ALo(24,"translate"),t._uU(25),t.ALo(26,"translate"),t.qZA()(),t._UZ(27,"input",14),t.qZA(),t.TgZ(28,"div",11)(29,"label",15)(30,"span",13),t.ALo(31,"translate"),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t._UZ(34,"input",16),t.qZA()()()(),t.TgZ(35,"div",2)(36,"div",3)(37,"label",17),t._uU(38),t.ALo(39,"translate"),t.qZA(),t._UZ(40,"input",18),t.qZA(),t.TgZ(41,"div",3)(42,"div",6)(43,"label",19),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"input",20),t.NdJ("ngModelChange",function(r){return o.model.options.stepsNumber=r})("ngModelChange",function(){return o.onStepNumberChange()}),t.qZA()()()(),t.YNc(47,et,25,15,"ng-container",21),t.YNc(48,lt,46,32,"ng-container",21),t.qZA(),t.YNc(49,It,17,11,"ng-container",21),t.TgZ(50,"div",22),t._UZ(51,"div",23),t.qZA(),t.YNc(52,Nt,1,1,"p-message",24),t.TgZ(53,"div",2)(54,"div",3)(55,"button",25),t.NdJ("click",function(r){return o.saveData(!0,r)}),t.ALo(56,"translate"),t.qZA()(),t.TgZ(57,"div",26)(58,"button",27),t.NdJ("click",function(r){return o.saveData(!1,r)}),t.ALo(59,"translate"),t.qZA()(),t.TgZ(60,"div",26)(61,"button",28),t.NdJ("click",function(r){return o.closeModal(r)}),t.ALo(62,"translate"),t.qZA()()()(),t.YNc(63,Et,3,1,"div",29),t.YNc(64,St,3,3,"ng-template",null,30,t.W1O)),2&e&&(t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(5),t.hij(" ",t.lcZ(7,22,"TITLE")," "),t.xp6(5),t.Q6J("allowedExtensions",".xls,.xlsx,.csv")("fieldName","fileData")("largeFieldMode",!1)("files",o.files),t.xp6(5),t.Oqu(t.lcZ(17,24,"ROW_NUMBER_HEADERS")),t.xp6(7),t.Q6J("title",t.lcZ(24,26,"ROW_NUMBER_FIRST")),t.xp6(2),t.Oqu(t.lcZ(26,28,"ROW_NUMBER_FIRST")),t.xp6(5),t.Q6J("title",t.lcZ(31,30,"ROW_NUMBER_LAST")),t.xp6(2),t.Oqu(t.lcZ(33,32,"ROW_NUMBER_LAST")),t.xp6(6),t.Oqu(t.lcZ(39,34,"SEPARATOR_CATEGORIES")),t.xp6(6),t.Oqu(t.lcZ(45,36,"STEPS_NUMBER")),t.xp6(2),t.Q6J("ngModel",o.model.options.stepsNumber),t.xp6(1),t.Q6J("ngIf","csv"==o.model.type),t.xp6(1),t.Q6J("ngIf",o.model.id),t.xp6(1),t.Q6J("ngIf",o.model.id&&o.model.options.sheetName),t.xp6(3),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(56,38,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("label",t.lcZ(59,40,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(62,42,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading||o.loadingConfiguration))},directives:[s._Y,s.JL,s.sg,s.Fj,w.o,s.JJ,s.u,K.E,s.qQ,s.wV,s.Fd,_.O5,D.Lt,k.F,tt.Ql,y.Hq,I.H,S.u,s.On,_.sg,_.mk,_.RF,_.n9,P.q,Y.G,B.k],pipes:[f.X$,_.Nd,_.Ts],encapsulation:2}),n})();var H=c(6421),u=c(5050),$=c(6572),j=c(1874),V=c(330);function Ot(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10),t._UZ(2,"i",11),t.TgZ(3,"input",12),t.NdJ("input",function(){return t.CHM(e),t.oxw().onInputSearch()})("ngModelChange",function(i){return t.CHM(e),t.oxw().queryOptions.search_word=i}),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",13)(6,"button",14),t.NdJ("click",function(i){return t.CHM(e),t.oxw(),t.MAs(6).toggle(i)}),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",15),t.NdJ("click",function(i){return t.CHM(e),t.oxw().openModal(null,i)}),t.ALo(9,"translate"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(3),t.MGl("placeholder","",t.lcZ(4,4,"SEARCH"),"..."),t.Q6J("ngModel",e.queryOptions.search_word),t.xp6(3),t.Q6J("label",t.lcZ(7,6,"ACTIONS")),t.xp6(2),t.Q6J("label",t.lcZ(9,8,"ADD"))}}function Jt(n,l){if(1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"p-sortIcon",18),t.qZA()),2&n){const e=l.$implicit;t.Q6J("pSortableColumn",e.field),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.header)," "),t.xp6(2),t.Q6J("field",e.field)}}function qt(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"th"),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.YNc(3,Jt,4,5,"th",16),t.qZA()),2&n){const e=l.$implicit;t.xp6(3),t.Q6J("ngForOf",e)}}function Ft(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",24)(2,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().openModal(i)}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().deleteItem(i)}),t.ALo(5,"translate"),t.qZA()(),t.BQk()}2&n&&(t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,2,"EDIT")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(5,4,"DELETE")))}function Qt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"td")(1,"app-render-output",22),t.NdJ("changeRequest",function(i){return t.CHM(e),t.oxw(2).onOptionUpdate(i)}),t.qZA(),t.YNc(2,Ft,6,6,"ng-container",23),t.qZA()}if(2&n){const e=l.$implicit,o=l.index,i=t.oxw(),r=i.$implicit,p=i.columns;t.xp6(1),t.Q6J("value",r[e.field])("key",e.field)("outputType",e.outputType)("options",e.outputProperties)("object",r),t.xp6(1),t.Q6J("ngIf",p.length==o+1)}}function Rt(n,l){if(1&n&&(t.TgZ(0,"tr",19)(1,"td"),t._UZ(2,"p-tableCheckbox",20),t.qZA(),t.YNc(3,Qt,3,6,"td",21),t.qZA()),2&n){const e=l.$implicit,o=l.columns;t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("value",e),t.xp6(1),t.Q6J("ngForOf",o)}}function Ut(n,l){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NOTHING_FOUND"),". "))}function Dt(n,l){1&n&&(t._uU(0),t.ALo(1,"translate")),2&n&&t.hij(" ",t.lcZ(1,1,"EMPTY"),". ")}function kt(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"td",27),t.YNc(2,Ut,3,3,"ng-container",28),t.YNc(3,Dt,2,3,"ng-template",null,29,t.W1O),t.qZA()()),2&n){const e=l.$implicit,o=t.MAs(4),i=t.oxw();t.xp6(1),t.Q6J("colSpan",e.length+1),t.xp6(1),t.Q6J("ngIf",i.queryOptions.search_word)("ngIfElse",o)}}let Pt=(()=>{class n extends H.p{constructor(e,o,i,r,p,a){super(e,o,i,r,p,a),this.dialogService=e,this.contentTypesService=o,this.dataService=i,this.translateService=r,this.messageService=p,this.confirmationService=a,this.queryOptions=new J.J(1,12,"id","desc"),this.items=[],this.cols=[{field:"id",header:"ID",outputType:"text-center",outputProperties:{}},{field:"title",header:"TITLE",outputType:"text",outputProperties:{}},{field:"fileSize",header:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{field:"type",header:"FILE_TYPE",outputType:"text",outputProperties:{}},{field:"sheetsQuantity",header:"SHEETS_QUANTITY",outputType:"text",outputProperties:{}},{field:"rowsQuantity",header:"ROWS_QUANTITY",outputType:"text",outputProperties:{}}]}getModalComponent(){return Lt}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.xA),t.Y36(v.s),t.Y36(Z),t.Y36(f.sK),t.Y36(C.ez),t.Y36(C.YP))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-import"]],features:[t._Bn([x.xA,Z]),t.qOj],decls:9,vars:16,consts:[["styleClass","p-datatable-striped","dataKey","id",3,"selection","contextMenuSelection","contextMenu","sortField","sortOrder","lazy","paginator","showJumpToPageDropdown","value","columns","rows","totalRecords","loading","selectionChange","contextMenuSelectionChange","onLazyLoad"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["styleClass","p-menu-nowrap",3,"popup","model"],["menu",""],[3,"model"],["contextMenu",""],[1,"flex","md:justify-content-between","flex-wrap"],[1,"p-input-icon-left","w-full","md:w-auto","mb-2","md:mb-0"],[1,"pi","pi-search"],["pInputText","","type","text",1,"lg:w-auto","w-full",3,"ngModel","placeholder","input","ngModelChange"],[1,"w-full","md:w-auto"],["type","button","pButton","","pRipple","","icon","pi pi-chevron-down","iconPos","left",1,"ml-0","md:ml-2","w-full","md:w-auto","mb-2","md:mb-0",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-plus","iconPos","left",1,"p-button-success","ml-0","md:ml-2","w-full","md:w-auto",3,"label","click"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[1,"show-on-hover-parent",3,"pContextMenuRow"],[3,"value"],[4,"ngFor","ngForOf"],[3,"value","key","outputType","options","object","changeRequest"],[4,"ngIf"],[1,"absolute","show-on-hover","pos-top10","pos-right10"],["pButton","","pRipple","","icon","pi pi-pencil","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","left",1,"p-button","p-button-sm","p-button-rounded","p-button-danger","ml-2",3,"pTooltip","click"],[3,"colSpan"],[4,"ngIf","ngIfElse"],["emptyMessage",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"p-table",0),t.NdJ("selectionChange",function(r){return o.itemsSelected=r})("contextMenuSelectionChange",function(r){return o.itemSelected=r})("onLazyLoad",function(r){return o.getData(r)}),t.YNc(1,Ot,10,10,"ng-template",1),t.YNc(2,qt,4,1,"ng-template",2),t.YNc(3,Rt,4,3,"ng-template",3),t.YNc(4,kt,5,3,"ng-template",4),t.qZA(),t._UZ(5,"p-menu",5,6)(7,"p-contextMenu",7,8)),2&e){const i=t.MAs(8);t.Q6J("selection",o.itemsSelected)("contextMenuSelection",o.itemSelected)("contextMenu",i)("sortField",o.queryOptions.sort_by)("sortOrder","asc"==o.queryOptions.sort_dir?1:-1)("lazy",!0)("paginator",!0)("showJumpToPageDropdown",!0)("value",o.items)("columns",o.cols)("rows",o.queryOptions.limit)("totalRecords",o.itemsTotal)("loading",o.loading),t.xp6(5),t.Q6J("popup",!0)("model",o.menuItems),t.xp6(2),t.Q6J("model",o.contextMenuItems)}},directives:[u.iA,C.jx,s.Fj,w.o,s.JJ,s.On,y.Hq,I.H,u.Mo,_.sg,u.lQ,u.fz,u.zi,u.UA,$.g,_.O5,S.u,j.v2,V.xV],pipes:[f.X$],encapsulation:2}),n})();class L{constructor(l,e,o,i,r,p,a){this.id=l,this.title=e,this.fileData=o,this.type=i,this.fileSize=r,this.options=p,this.fieldsOptions=a,void 0===this.options&&L.setOptiontDefaults(this),void 0===this.fieldsOptions&&(this.fieldsOptions=[])}static setOptiontDefaults(l){l.options||(l.options={}),l.options=Object.assign({parentId:0,contentType:"",categoryType:"column",categoriesSeparator:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"'},l.options)}}let A=(()=>{class n extends q.D{constructor(e){super(e),this.setRequestUrl("export")}exportDataProgress(e){const o=this.getRequestUrl()+`/${e.id}/do_export`;return this.http.request(new m.aW("POST",o,e,{reportProgress:!0,responseType:"text",headers:this.headers}))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const Yt=["optionParentEl"];function Bt(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-dropdown",29),t.NdJ("onChange",function(i){return t.CHM(e),t.oxw().getContentType(i.value)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("options",e.contentTypes)("showClear",!0)}}function Ht(n,l){1&n&&(t.ynx(0),t.TgZ(1,"div",2)(2,"div",30)(3,"div",15)(4,"label",31),t._uU(5),t.ALo(6,"translate"),t.qZA(),t._UZ(7,"input",32),t.qZA()(),t.TgZ(8,"div",30)(9,"div",15)(10,"label",33),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"input",34),t.qZA()()(),t.TgZ(14,"div",2)(15,"div",30)(16,"div",15)(17,"label",35),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._UZ(20,"input",36),t.qZA()()(),t.BQk()),2&n&&(t.xp6(5),t.Oqu(t.lcZ(6,3,"CSV_SEPARATOR")),t.xp6(6),t.Oqu(t.lcZ(12,5,"CSV_ENCODING")),t.xp6(7),t.Oqu(t.lcZ(19,7,"CSV_ENCLOSURE")))}function $t(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div",39),t._UZ(2,"a",45),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.hYB("href","",e.baseUrl,"/admin/files/download/",e.model.fileData.fileId,"",t.LSH),t.Q6J("label",t.lcZ(3,3,"DOWNLOAD"))}}function jt(n,l){if(1&n&&t._UZ(0,"p-dropdown",54),2&n){const e=t.oxw(3);t.Q6J("options",e.contentType.fields)}}function Vt(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",46)(2,"div",2)(3,"div",47),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",48)(7,"div",2)(8,"div",49,50)(10,"p-dropdown",51),t.NdJ("onChange",function(){const i=t.CHM(e),r=i.$implicit,p=i.index,a=t.MAs(9);return t.oxw(2).onChangeFieldAction(r,p,a)}),t.qZA()(),t.TgZ(11,"div",52),t.YNc(12,jt,1,1,"p-dropdown",53),t.qZA()()()()(),t.BQk()}if(2&n){const e=l.index,o=t.oxw(2),i=t.MAs(58);t.xp6(1),t.Q6J("formGroupName",e+""),t.xp6(3),t.AsE(" ",t.lcZ(5,6,"COLUMN")," #",e+1," "),t.xp6(6),t.Q6J("options",o.rowActions),t.xp6(2),t.Q6J("ngIf",o.contentType)("ngIfElse",i)}}function Gt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",37)(1,"div")(2,"div",38)(3,"div",2)(4,"div",39)(5,"button",40),t.NdJ("click",function(i){return t.CHM(e),t.oxw().startExport(i)}),t.ALo(6,"translate"),t.qZA()(),t.YNc(7,$t,4,5,"ng-container",20),t.qZA()(),t.TgZ(8,"div",41),t.YNc(9,Vt,13,8,"ng-container",42),t.TgZ(10,"div",43)(11,"button",44),t.NdJ("click",function(){return t.CHM(e),t.oxw().arrayFieldAdd("fieldsOptions")}),t.ALo(12,"translate"),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("label",t.lcZ(6,5,"EXPORT"))("disabled",0==e.arrayFields.fieldsOptions.controls.length),t.xp6(2),t.Q6J("ngIf",e.model.fileData),t.xp6(2),t.Q6J("ngForOf",e.arrayFields.fieldsOptions.controls),t.xp6(2),t.Q6J("label",t.lcZ(12,7,"ADD"))}}function zt(n,l){if(1&n&&t._UZ(0,"p-message",55),2&n){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function Xt(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"div",57),t._UZ(2,"p-progressBar",58),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("value",e.percent)}}function Wt(n,l){if(1&n&&(t.TgZ(0,"div",56),t._UZ(1,"p-progressSpinner"),t.YNc(2,Xt,3,1,"ng-container",20),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.showProgressBar)}}function Kt(n,l){1&n&&(t.TgZ(0,"div",59),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"EMPTY"),". "))}let te=(()=>{class n extends Q.P{constructor(e,o,i,r,p,a,d,g,h){super(e,o,i,r),this.ref=e,this.config=o,this.systemNameService=i,this.dataService=r,this.settingsService=p,this.appSettings=a,this.contentTypesService=d,this.translateService=g,this.messageService=h,this.model=new L(0,""),this.loadingConfiguration=!1,this.isInitialised=!1,this.sheetHeaders=[],this.contentTypes=[],this.percent=0,this.showProgressBar=!1,this.baseUrl="",this.form=new s.cw({title:new s.NI("",[s.kI.required]),type:new s.NI("",[s.kI.required]),options__parentId:new s.NI(0,[]),options__contentType:new s.NI("",[s.kI.required]),options__categoryType:new s.NI("",[]),options__categoriesSeparator:new s.NI("",[]),options__csvSeparator:new s.NI("",[]),options__csvEncoding:new s.NI("",[]),options__csvEnclosure:new s.NI("",[]),fieldsOptions:new s.Oe([])}),this.arrayFieldsData={fieldsOptions:{targetAction:{validators:[s.kI.required]},targetName:{validators:[]}}},this.filesFormats=[{name:"xls",title:"XLS"},{name:"xlsx",title:"XLSX"},{name:"csv",title:"CSV"}],this.categoryExportType=[],this.rowActions=[]}ngOnInit(){this.categoryExportType=[{name:"column",title:this.getLangString("COLUMNS")},{name:"row",title:this.getLangString("ROWS")}],this.rowActions=[{name:"category",title:this.getLangString("CATEGORY")},{name:"categories_splitted",title:this.getLangString("CATEGORIES_WITH_SEPARATOR")},{name:"field",title:this.getLangString("SELECT_FIELD")},{name:"translations",title:this.getLangString("TRANSLATIONS")},{name:"delete",title:this.getLangString("DELETE")}],this.baseUrl=this.appSettings.settings.webApiUrl,this.createArrayFieldsProperty("fieldsOptions"),super.ngOnInit(),this.getContentTypes()}onGetData(e){super.onGetData(e),setTimeout(()=>{const o=this.optionParentEl.toArray();this.form.controls.fieldsOptions.controls.forEach((r,p)=>{this.onChangeFieldAction(r,p,o[p].nativeElement)})},0),this.model.options.contentType&&this.getContentType(this.model.options.contentType)}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}getContentTypes(){this.contentTypesService.getListPage().subscribe({next:e=>{this.contentTypes=e.items,this.contentTypes.unshift(new F.z(0,"",""))},error:e=>{this.errorMessage=e}})}getContentType(e){e?(this.loading=!0,this.contentTypesService.getItemByName(e).subscribe({next:o=>{this.contentType=o,this.contentType.fields.unshift(new R._(0,"","")),this.loading=!1},error:o=>{o.error&&(this.errorMessage=o.error),this.contentType=null,this.loading=!1}})):this.contentType=null}onChangeFieldAction(e,o,i){const p=e.controls.targetAction.value;if("delete"===p)return void this.arrayFieldDelete("fieldsOptions",o);const a=i.nextElementSibling;"field"===(i.className="col-12",a.classList.add("hidden"),p)&&(i.className="col-12 lg:col-6",a.classList.remove("hidden"))}getTargetTitle(e,o){if(this.model.fieldsOptions=[],"field"===e){if(this.contentType){const i=this.contentType.fields.findIndex(r=>r.name===o);if(i>-1)return this.contentType.fields[i].title}}else{const i=this.rowActions.findIndex(r=>r.name===e);if(i>-1)return this.rowActions[i].title}return""}arrayFieldAdd(e,o,i){super.arrayFieldAdd(e,o,i);const r=this.arrayFields[e].controls;r[r.length-1].controls.targetAction.value||r[r.length-1].controls.targetAction.setValue(this.rowActions[0].name),!r[r.length-1].controls.targetName&&this.contentType&&r[r.length-1].controls.targetName.setValue(this.contentType.fields[0].name)}onChangeFieldName(e,o){"_id"===o&&(e.targetTitle="ID")}startExport(e){if(e&&e.preventDefault(),this.loading)return;this.errorMessage="",this.percent=0,this.loading=!0,this.model.fileData=null;const o=this.getFormData();let i=0,r="",p={};this.dataService.exportDataProgress(o).subscribe({next:a=>{if(a instanceof m.Zn)this.updatePercent(100);else if(!(a instanceof m.ZM)&&a.type===m.dt.DownloadProgress){r=a.partialText.substr(i).trim();const d=r.split("\n");r=d[d.length-1],i=a.partialText.length,"{"===r.substr(0,1)&&"}"===r.substr(r.length-1,1)&&(p=JSON.parse(r),this.updatePercent((p.currentIndex-p.rowNumberFirst)/(p.rowNumberLast-p.rowNumberFirst)*100))}},error:a=>{a.error&&a.error.indexOf("{")>-1&&(a.error=JSON.parse(a.error),a.error=a.error.error||this.getLangString("ERROR")),a.error&&(this.errorMessage=a.error),this.loading=!1,this.showProgressBar=!1}})}updatePercent(e){this.percent=Math.min(100,Math.floor(e)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&(clearTimeout(this.timer),this.timer=setTimeout(this.onExportCompleted.bind(this),1e3))}onExportCompleted(){clearTimeout(this.timer),this.showProgressBar=!1,this.loading=!1,this.closeReason="updated",this.model.id&&this.getData(this.model.id),this.messageService.add({key:"message",severity:"success",summary:this.getLangString("MESSAGE"),detail:this.getLangString("EXPORT_COMPLETED")})}getFormData(){const e=super.getFormData();return e.fieldsOptions&&e.fieldsOptions.forEach(o=>{o.targetTitle=this.getTargetTitle(o.targetAction,o.targetName)}),e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.E7),t.Y36(x.S),t.Y36(M.U),t.Y36(A),t.Y36(N.g),t.Y36(U.d),t.Y36(v.s),t.Y36(f.sK),t.Y36(C.ez))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-modal-export"]],viewQuery:function(e,o){if(1&e&&t.Gf(Yt,5),2&e){let i;t.iGM(i=t.CRH())&&(o.optionParentEl=i)}},features:[t._Bn([A]),t.qOj],decls:59,vars:37,consts:[[3,"formGroup"],["formEl",""],[1,"grid"],[1,"col-12","md:col-6"],["for","fieldTitle",1,"block","mb-2"],["type","text","pInputText","","id","fieldTitle","formControlName","title",1,"w-full","mb-2"],["for","fieldParent",1,"block","mb-2"],[1,"w-full-parent"],["formControlName","options__parentId"],["for","fieldFormat",1,"block","mb-2"],["inputId","fieldFormat","styleClass","w-full mb-2","formControlName","type","optionLabel","title","optionValue","name",3,"options","ngModel","ngModelChange"],["for","fieldContentType",1,"block","mb-2"],[4,"ngIf","ngIfElse"],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left"],[1,"p-divider-content"],[1,"mb-2"],["for","fieldCategoryType",1,"block","mb-2"],["formControlName","options__categoryType","styleClass","w-full","inputId","fieldCategoryType","optionLabel","title","optionValue","name",3,"options"],["for","fieldCategoriesSeparator",1,"block","mb-2"],["type","text","pInputText","","id","fieldCategoriesSeparator","formControlName","options__categoriesSeparator",1,"w-full","mb-2"],[4,"ngIf"],["class","border-round border-1 surface-200 border-400 p-3",4,"ngIf"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],[1,"col-12","md:col-3"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-warning","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],["emptyTemplate",""],["styleClass","w-full","inputId","fieldContentType","optionLabel","title","optionValue","name","formControlName","options__contentType",3,"options","showClear","onChange"],[1,"col-12","lg:col-6"],["for","fieldCSVSeparator",1,"block","mb-2"],["type","text","pInputText","","id","fieldCSVSeparator","formControlName","options__csvSeparator",1,"w-full","mb-2"],["for","fieldCSVEncoding",1,"block","mb-2"],["type","text","pInputText","","id","fieldCSVEncoding","formControlName","options__csvEncoding",1,"w-full","mb-2"],["for","fieldCSVEnclosure",1,"block","mb-2"],["type","text","pInputText","","id","fieldCSVEnclosure","formControlName","options__csvEnclosure",1,"w-full","mb-2"],[1,"border-round","border-1","surface-200","border-400","p-3"],[1,"border-bottom-1","border-400","pb-2","mb-3"],[1,"col-12","lg:col-4"],["type","button","pButton","","pRipple","",1,"p-button-raised","w-full",3,"label","disabled","click"],["formArrayName","fieldsOptions",1,"max-height400"],[4,"ngFor","ngForOf"],[1,"text-center"],["type","button","pButton","","pRipple","","icon","pi pi-plus",1,"p-button-secondary","p-button-sm",3,"label","click"],["pButton","","pRipple","","icon","pi pi-download","target","_blank",1,"p-button-raised","p-button-success","w-full",3,"href","label"],[3,"formGroupName"],[1,"col-12","md:col-4"],[1,"col-12","md:col-8"],[1,"col-12"],["optionParentEl",""],["styleClass","w-full","inputId","fieldCategoryType","optionLabel","title","optionValue","name","appendTo","body","formControlName","targetAction",3,"options","onChange"],[1,"col-12","lg:col-6","hidden"],["styleClass","w-full","optionLabel","title","optionValue","name","appendTo","body","formControlName","targetName",3,"options",4,"ngIf","ngIfElse"],["styleClass","w-full","optionLabel","title","optionValue","name","appendTo","body","formControlName","targetName",3,"options"],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"loading-overlay"],[1,"app-progress"],[3,"value"],[1,"border-round","border-1","surface-200","border-400","py-2","px-3"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"div",3)(5,"label",4),t._uU(6),t.ALo(7,"translate"),t.qZA(),t._UZ(8,"input",5),t.qZA(),t.TgZ(9,"div",3)(10,"label",6),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"div",7),t._UZ(14,"app-select-parent-dropdown",8),t.qZA()()(),t.TgZ(15,"div",2)(16,"div",3)(17,"label",9),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"p-dropdown",10),t.NdJ("ngModelChange",function(r){return o.model.type=r}),t.qZA()(),t.TgZ(21,"div",3)(22,"label",11),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.YNc(25,Bt,2,2,"ng-container",12),t.qZA()(),t.TgZ(26,"div",13),t._UZ(27,"div",14),t.qZA(),t.TgZ(28,"div",2)(29,"div",3)(30,"div",15)(31,"label",16),t._uU(32),t.ALo(33,"translate"),t.qZA(),t._UZ(34,"p-dropdown",17),t.qZA()(),t.TgZ(35,"div",3)(36,"div",15)(37,"label",18),t._uU(38),t.ALo(39,"translate"),t.qZA(),t._UZ(40,"input",19),t.qZA()()(),t.YNc(41,Ht,21,9,"ng-container",20),t.YNc(42,Gt,13,9,"div",21),t.qZA(),t.TgZ(43,"div",13),t._UZ(44,"div",14),t.qZA(),t.YNc(45,zt,1,1,"p-message",22),t.TgZ(46,"div",2)(47,"div",3)(48,"button",23),t.NdJ("click",function(r){return o.saveData(!0,r)}),t.ALo(49,"translate"),t.qZA()(),t.TgZ(50,"div",24)(51,"button",25),t.NdJ("click",function(r){return o.saveData(!1,r)}),t.ALo(52,"translate"),t.qZA()(),t.TgZ(53,"div",24)(54,"button",26),t.NdJ("click",function(r){return o.closeModal(r)}),t.ALo(55,"translate"),t.qZA()()()(),t.YNc(56,Wt,3,1,"div",27),t.YNc(57,Kt,3,3,"ng-template",null,28,t.W1O)),2&e){const i=t.MAs(58);t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(5),t.hij(" ",t.lcZ(7,19,"TITLE")," "),t.xp6(5),t.hij(" ",t.lcZ(12,21,"PARENT_FOLDER")," "),t.xp6(7),t.hij(" ",t.lcZ(19,23,"FORMAT")," "),t.xp6(2),t.Q6J("options",o.filesFormats)("ngModel",o.model.type),t.xp6(3),t.hij(" ",t.lcZ(24,25,"CONTENT_TYPE")," "),t.xp6(2),t.Q6J("ngIf",o.contentTypes.length>0)("ngIfElse",i),t.xp6(7),t.hij(" ",t.lcZ(33,27,"SAVE_CATEGORIES_TYPE")," "),t.xp6(2),t.Q6J("options",o.categoryExportType),t.xp6(4),t.hij(" ",t.lcZ(39,29,"SEPARATOR_CATEGORIES")," "),t.xp6(3),t.Q6J("ngIf","csv"==o.model.type),t.xp6(1),t.Q6J("ngIf",o.model.id),t.xp6(3),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(49,31,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("label",t.lcZ(52,33,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(55,35,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading)}},directives:[s._Y,s.JL,s.sg,s.Fj,w.o,s.JJ,s.u,k.F,D.Lt,_.O5,y.Hq,I.H,s.CE,_.sg,s.x0,P.q,Y.G,B.k],pipes:[f.X$],encapsulation:2}),n})();function ee(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10),t._UZ(2,"i",11),t.TgZ(3,"input",12),t.NdJ("input",function(){return t.CHM(e),t.oxw().onInputSearch()})("ngModelChange",function(i){return t.CHM(e),t.oxw().queryOptions.search_word=i}),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",13)(6,"button",14),t.NdJ("click",function(i){return t.CHM(e),t.oxw(),t.MAs(6).toggle(i)}),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",15),t.NdJ("click",function(i){return t.CHM(e),t.oxw().openModal(null,i)}),t.ALo(9,"translate"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(3),t.MGl("placeholder","",t.lcZ(4,4,"SEARCH"),"..."),t.Q6J("ngModel",e.queryOptions.search_word),t.xp6(3),t.Q6J("label",t.lcZ(7,6,"ACTIONS")),t.xp6(2),t.Q6J("label",t.lcZ(9,8,"ADD"))}}function ne(n,l){if(1&n&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"p-sortIcon",18),t.qZA()),2&n){const e=l.$implicit;t.Q6J("pSortableColumn",e.field),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.header)," "),t.xp6(2),t.Q6J("field",e.field)}}function oe(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"th"),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.YNc(3,ne,4,5,"th",16),t.qZA()),2&n){const e=l.$implicit;t.xp6(3),t.Q6J("ngForOf",e)}}function ie(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",24)(2,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().openModal(i)}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().deleteItem(i)}),t.ALo(5,"translate"),t.qZA()(),t.BQk()}2&n&&(t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,2,"EDIT")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(5,4,"DELETE")))}function re(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"td")(1,"app-render-output",22),t.NdJ("changeRequest",function(i){return t.CHM(e),t.oxw(2).onOptionUpdate(i)}),t.qZA(),t.YNc(2,ie,6,6,"ng-container",23),t.qZA()}if(2&n){const e=l.$implicit,o=l.index,i=t.oxw(),r=i.$implicit,p=i.columns;t.xp6(1),t.Q6J("value",r[e.field])("key",e.field)("outputType",e.outputType)("options",e.outputProperties)("object",r),t.xp6(1),t.Q6J("ngIf",p.length==o+1)}}function le(n,l){if(1&n&&(t.TgZ(0,"tr",19)(1,"td"),t._UZ(2,"p-tableCheckbox",20),t.qZA(),t.YNc(3,re,3,6,"td",21),t.qZA()),2&n){const e=l.$implicit,o=l.columns;t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("value",e),t.xp6(1),t.Q6J("ngForOf",o)}}function se(n,l){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NOTHING_FOUND"),". "))}function ae(n,l){1&n&&(t._uU(0),t.ALo(1,"translate")),2&n&&t.hij(" ",t.lcZ(1,1,"EMPTY"),". ")}function pe(n,l){if(1&n&&(t.TgZ(0,"tr")(1,"td",27),t.YNc(2,se,3,3,"ng-container",28),t.YNc(3,ae,2,3,"ng-template",null,29,t.W1O),t.qZA()()),2&n){const e=l.$implicit,o=t.MAs(4),i=t.oxw();t.xp6(1),t.Q6J("colSpan",e.length+1),t.xp6(1),t.Q6J("ngIf",i.queryOptions.search_word)("ngIfElse",o)}}const ce=[{path:"",component:(()=>{class n{constructor(){}navBarToggle(){window.document.querySelector(".layout-sidebar").classList.toggle("active"),window.document.querySelector(".layout-mask").classList.toggle("layout-mask-active")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-import-export"]],decls:20,vars:9,consts:[[1,"layout-topbar","justify-content-between"],["type","button",1,"menu-button",3,"click"],[1,"pi","pi-bars"],[1,"layout-topbar-header","text-3xl","text-600"],[1,"fi","fi-br-upload","vertical-align-middle","mr-3"],[1,"vertical-align-middle"],[1,"topbar-menu"],["routerLinkActive","active"],["routerLink","/import-export/import"],["routerLink","/import-export/export"],[1,"layout-content"],[1,"content-section","min-height400","bg-white"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"button",1),t.NdJ("click",function(){return o.navBarToggle()}),t._UZ(2,"i",2),t.qZA(),t.TgZ(3,"span",3),t._UZ(4,"i",4),t.TgZ(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"ul",6)(9,"li",7)(10,"a",8),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"li",7)(14,"a",9),t._uU(15),t.ALo(16,"translate"),t.qZA()()()(),t.TgZ(17,"div",10)(18,"div",11),t._UZ(19,"router-outlet"),t.qZA()()),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,3,"IMPORT_EXPORT")),t.xp6(5),t.Oqu(t.lcZ(12,5,"IMPORT")),t.xp6(4),t.Oqu(t.lcZ(16,7,"EXPORT")))},directives:[b.Od,b.yS,b.lC],pipes:[f.X$],styles:[""]}),n})(),children:[{path:"",redirectTo:"import"},{path:"import",component:Pt},{path:"export",component:(()=>{class n extends H.p{constructor(e,o,i,r,p,a){super(e,o,i,r,p,a),this.dialogService=e,this.contentTypesService=o,this.dataService=i,this.translateService=r,this.messageService=p,this.confirmationService=a,this.queryOptions=new J.J(1,12,"id","desc"),this.items=[],this.cols=[{field:"id",header:"ID",outputType:"text-center",outputProperties:{}},{field:"title",header:"TITLE",outputType:"text",outputProperties:{}},{field:"fileSize",header:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{field:"type",header:"FILE_TYPE",outputType:"text",outputProperties:{}}]}getModalComponent(){return te}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.xA),t.Y36(v.s),t.Y36(A),t.Y36(f.sK),t.Y36(C.ez),t.Y36(C.YP))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-export"]],features:[t._Bn([x.xA,A]),t.qOj],decls:9,vars:16,consts:[["styleClass","p-datatable-striped","dataKey","id",3,"selection","contextMenuSelection","contextMenu","sortField","sortOrder","lazy","paginator","showJumpToPageDropdown","value","columns","rows","totalRecords","loading","selectionChange","contextMenuSelectionChange","onLazyLoad"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["styleClass","p-menu-nowrap",3,"popup","model"],["menu",""],[3,"model"],["contextMenu",""],[1,"flex","md:justify-content-between","flex-wrap"],[1,"p-input-icon-left","w-full","md:w-auto","mb-2","md:mb-0"],[1,"pi","pi-search"],["pInputText","","type","text",1,"lg:w-auto","w-full",3,"ngModel","placeholder","input","ngModelChange"],[1,"w-full","md:w-auto"],["type","button","pButton","","pRipple","","icon","pi pi-chevron-down","iconPos","left",1,"ml-0","md:ml-2","w-full","md:w-auto","mb-2","md:mb-0",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-plus","iconPos","left",1,"p-button-success","ml-0","md:ml-2","w-full","md:w-auto",3,"label","click"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[1,"show-on-hover-parent",3,"pContextMenuRow"],[3,"value"],[4,"ngFor","ngForOf"],[3,"value","key","outputType","options","object","changeRequest"],[4,"ngIf"],[1,"absolute","show-on-hover","pos-top10","pos-right10"],["pButton","","pRipple","","icon","pi pi-pencil","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","left",1,"p-button","p-button-sm","p-button-rounded","p-button-danger","ml-2",3,"pTooltip","click"],[3,"colSpan"],[4,"ngIf","ngIfElse"],["emptyMessage",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"p-table",0),t.NdJ("selectionChange",function(r){return o.itemsSelected=r})("contextMenuSelectionChange",function(r){return o.itemSelected=r})("onLazyLoad",function(r){return o.getData(r)}),t.YNc(1,ee,10,10,"ng-template",1),t.YNc(2,oe,4,1,"ng-template",2),t.YNc(3,le,4,3,"ng-template",3),t.YNc(4,pe,5,3,"ng-template",4),t.qZA(),t._UZ(5,"p-menu",5,6)(7,"p-contextMenu",7,8)),2&e){const i=t.MAs(8);t.Q6J("selection",o.itemsSelected)("contextMenuSelection",o.itemSelected)("contextMenu",i)("sortField",o.queryOptions.sort_by)("sortOrder","asc"==o.queryOptions.sort_dir?1:-1)("lazy",!0)("paginator",!0)("showJumpToPageDropdown",!0)("value",o.items)("columns",o.cols)("rows",o.queryOptions.limit)("totalRecords",o.itemsTotal)("loading",o.loading),t.xp6(5),t.Q6J("popup",!0)("model",o.menuItems),t.xp6(2),t.Q6J("model",o.contextMenuItems)}},directives:[u.iA,C.jx,s.Fj,w.o,s.JJ,s.On,y.Hq,I.H,u.Mo,_.sg,u.lQ,u.fz,u.zi,u.UA,$.g,_.O5,S.u,j.v2,V.xV],pipes:[f.X$],encapsulation:2}),n})()}]}];let de=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[b.Bz.forChild(ce)],b.Bz]}),n})(),_e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[N.g,M.U,Z,A,z.G],imports:[[_.ez,G.m,de]]}),n})()}}]);