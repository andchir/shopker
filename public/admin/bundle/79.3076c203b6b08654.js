"use strict";(self.webpackChunkadmin2=self.webpackChunkadmin2||[]).push([[79],{1079:(Be,$,c)=>{c.r($),c.d($,{CatalogModule:()=>Qe});var _=c(9808),lt=c(2461),b=c(440),t=c(7587),g=c(2925);let rt=(()=>{class i{navBarToggle(){window.document.querySelector(".layout-sidebar").classList.toggle("active"),window.document.querySelector(".layout-mask").classList.toggle("layout-mask-active")}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-catalog"]],features:[t._Bn([])],decls:24,vars:12,consts:[[1,"layout-topbar","justify-content-between"],["type","button",1,"menu-button",3,"click"],[1,"pi","pi-bars"],[1,"layout-topbar-header","text-3xl","text-600"],[1,"fi","fi-br-cube","vertical-align-middle","mr-3"],[1,"vertical-align-middle"],[1,"topbar-menu"],["routerLinkActive","active"],["routerLink","category"],["routerLink","content_types"],["routerLink","field_types"],[1,"layout-content"],[1,"content-section","min-height400","bg-white"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"button",1),t.NdJ("click",function(){return o.navBarToggle()}),t._UZ(2,"i",2),t.qZA(),t.TgZ(3,"span",3),t._UZ(4,"i",4),t.TgZ(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"ul",6)(9,"li",7)(10,"a",8),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"li",7)(14,"a",9),t._uU(15),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"li",7)(18,"a",10),t._uU(19),t.ALo(20,"translate"),t.qZA()()()(),t.TgZ(21,"div",11)(22,"div",12),t._UZ(23,"router-outlet"),t.qZA()()),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,4,"CATALOG")),t.xp6(5),t.Oqu(t.lcZ(12,6,"CATALOG")),t.xp6(4),t.Oqu(t.lcZ(16,8,"CONTENT_TYPES")),t.xp6(4),t.Oqu(t.lcZ(20,10,"FIELD_TYPES")))},directives:[b.Od,b.yS,b.lC],pipes:[g.X$],encapsulation:2}),i})();var A=c(2722),st=c(5698),m=c(5330),Q=c(6421),D=c(608),I=c(520);let R=(()=>{class i extends D.D{constructor(e){super(e),this.setRequestUrl("/admin/products")}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(I.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var O=c(511),s=c(3075),pt=c(2076),at=c(4004),ct=c(4482),V=c(5403),dt=c(5032),w=c(5759),Y=c(253);let E=(()=>{class i extends D.D{constructor(e){super(e),this.setRequestUrl("/admin/files")}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(I.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var v=c(1034),z=c(8283),N=c(2732),T=c(889),B=c(3541),X=c(1480),K=c(7102),j=c(524),S=c(242),L=c(3724),C=c(845),y=c(5787),F=c(6198);const mt=function(){return{standalone:!0}};function gt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",17)(1,"p-selectButton",24),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).onLocaleSwitch(n)}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("options",e.localeListFull)("ngModel",e.localeCurrent)("ngModelOptions",t.DdM(3,mt))}}function _t(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",13)(2,"div",7),t.YNc(3,gt,2,4,"div",14),t.TgZ(4,"div",15),t._UZ(5,"app-select-parent-dropdown",16),t.qZA()(),t.TgZ(6,"div",7)(7,"div",17),t._UZ(8,"p-inputSwitch",18),t.TgZ(9,"label",19),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"div"),t._UZ(13,"p-inputSwitch",20),t.TgZ(14,"label",21),t._uU(15),t.ALo(16,"translate"),t.qZA()()()(),t.TgZ(17,"div",22)(18,"app-render-input",23),t.NdJ("onFieldAdd",function(n){return t.CHM(e),t.oxw().fieldAdd(n)})("onParametersAdd",function(n){return t.CHM(e),t.oxw().arrayFieldAdd(n)})("onParametersUpdate",function(n){return t.CHM(e),t.oxw().onParametersUpdate(n)})("onParametersDelete",function(n){return t.CHM(e),t.oxw().onParametersDelete(n)}),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.localeListFull.length>1),t.xp6(7),t.hij(" ",t.lcZ(11,12,"ACTIVE")," "),t.xp6(5),t.hij(" ",t.lcZ(16,14,"CLEAR_FILE_CACHE")," "),t.xp6(3),t.Q6J("fields",e.currentContentType.fields)("groups",e.currentContentType.groups)("arrayFields",e.arrayFields)("model",e.model)("form",e.form)("files",e.files)("localeFieldsAllowed",e.localeFieldsAllowed)("localeCurrent",e.localeCurrent)("isLocalizationActive",e.localeCurrent!==e.localeDefault)}}function ft(i,r){if(1&i&&t._UZ(0,"p-message",25),2&i){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function ht(i,r){1&i&&(t.TgZ(0,"div",26),t._UZ(1,"p-progressSpinner"),t.qZA())}let Tt=(()=>{class i extends w.P{constructor(e,o,n,l,p,a,d,h){super(e,o,n,l),this.ref=e,this.config=o,this.systemNameService=n,this.dataService=l,this.contentTypesService=p,this.categoriesService=a,this.filesService=d,this.appSettings=h,this.dataLoaded=!1,this.categoriesTree=[],this.categories=[],this.contentTypes=[],this.currentContentType=new Y.z(0,"","","","",[],[],!0),this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.form=new s.cw({id:new s.NI(0,[]),parentId:new s.NI(0,[]),isActive:new s.NI(!0,[]),clearCache:new s.NI(!0,[])})}ngOnInit(){this.model={id:this.config.data.id||0,parentId:this.config.data.parentId||0},this.createLanguageSettings(this.appSettings.settings),this.dataService.setRequestUrl(`/admin/products/${this.model.parentId}`),this.form.controls.parentId.setValue(this.model.parentId),this.getContentType().then(e=>{this.config.data.id?this.getData(this.config.data.id):(this.updateForm(),this.buildControls(),setTimeout(()=>{this.updateControls(),this.form.controls.isActive&&this.form.controls.isActive.setValue(!0)},0),this.dataLoaded=!0),this.currentContentType.fields.forEach(o=>{["text","textarea","rich_text"].indexOf(o.inputType)>-1&&this.localeFieldsAllowed.push(o.name)}),this.currentContentType.groups=[],(0,pt.D)(this.currentContentType.fields).pipe((0,at.U)(o=>o.group),function ut(i,r){return(0,ct.e)((e,o)=>{const n=new Set;e.subscribe(new V.Q(o,l=>{const p=i?i(l):l;n.has(p)||(n.add(p),o.next(l))})),null==r||r.subscribe(new V.Q(o,()=>n.clear(),dt.Z))})}()).subscribe(o=>{this.currentContentType.groups.push(o)})},e=>{this.dataLoaded=!0,this.errorMessage=e.error||"Error.",this.dataLoaded=!0})}onGetData(e){this.model=e,this.dataLoaded=!0,this.getCategories(),this.updateForm(),this.buildControls(),setTimeout(()=>{this.updateControls()},0)}buildControls(){this.currentContentType.fields.forEach(e=>{if(!this.form.controls[e.name])if(["parameters"].indexOf(e.inputType)>-1){z.l.getParametersOptions(e),this.arrayFieldsData[e.name]={},e.inputProperties.keys.forEach(n=>{this.arrayFieldsData[e.name][n]={validators:[]}}),this.createArrayFieldsProperty(e.name);const o=new s.Oe([]);this.form.addControl(e.name,o)}else{const o=this.getValidators(e),n=new s.NI(this.model[e.name]||"",o);this.form.addControl(e.name,n)}})}updateForm(e){e||(e=JSON.parse(JSON.stringify(this.model)));const o=this.currentContentType.fields.map(n=>n.name);o.push("id","parentId","previousParentId","isActive","clearCache","translations"),e.clearCache=!0,Object.keys(this.model).forEach(n=>{if(n.indexOf("__")>-1){const l=v._.getFieldBaseName(n);if(l===n)return;const p=v._.getFieldIndexData(this.currentContentType.fields,l);if(-1===p.index)return;const a=JSON.parse(JSON.stringify(this.currentContentType.fields[p.index]));a.name=n,this.currentContentType.fields.splice(p.index+p.additFieldsCount+1,0,a),o.push(n)}});for(const n in this.form.controls)this.form.controls.hasOwnProperty(n)&&-1===o.indexOf(n)&&this.form.removeControl(n)}getCategories(){this.categoriesService.getListPage().subscribe({next:e=>{this.categories=e.items},error:e=>{this.errorMessage=e.error||"Error."}})}getContentType(){return this.loading=!0,new Promise((e,o)=>{this.contentTypesService.getItemByCategory(this.model.parentId).subscribe({next:n=>{Object.assign(this.currentContentType,n),this.errorMessage="",this.loading=!1,e(n)},error:n=>{this.errorMessage=n.error||"Error.",this.loading=!1,o(n)}})})}getValidators(e){const o=[];return e.required&&o.push(s.kI.required),o}onParametersDelete(e){this.arrayFieldDelete(e[0],e[1])}onParametersUpdate(e){this.arrayFieldUpdate(e[0],e[1])}getFormData(){const e=super.getFormData();return this.model&&this.model.parentId&&void 0===e.parentId&&(e.parentId=this.model.parentId),e.fieldsSort=this.getFieldsSortData(),e}fieldAdd(e){const o=v._.getFieldIndexData(this.currentContentType.fields,e.name);if(-1===o.index)return;const n=v._.getFieldBaseName(e.name),l=JSON.parse(JSON.stringify(e));l.name=`${n}__${o.additFieldsCount+1}`,this.currentContentType.fields.splice(o.index+1,0,l),this.buildControls()}filesUploadRequest(e,o){return e.append("itemId",String(o)),e.append("ownerType",this.currentContentType.name),e.append("categoryId",String(this.model.parentId)),e.append("fieldsSort",this.getFieldsSortData().join(",")),this.filesService.postFormData(e)}getFieldsSortData(){return this.currentContentType.fields.filter(o=>"file"===o.inputType).map(o=>o.name)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.E7),t.Y36(m.S),t.Y36(N.U),t.Y36(R),t.Y36(T.s),t.Y36(B.G),t.Y36(E),t.Y36(X.d))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-product"]],features:[t._Bn([E]),t.qOj],decls:18,vars:13,consts:[[3,"formGroup"],["formEl",""],[4,"ngIf"],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left"],[1,"p-divider-content"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],[1,"grid","mt-2"],[1,"col-12","md:col-6"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],[1,"col-12","md:col-3"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-warning","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],[1,"grid","mb-3"],["class","mb-3",4,"ngIf"],[1,"w-full-parent"],["formControlName","parentId"],[1,"mb-3"],["inputId","fieldActive","styleClass","mr-2 vertical-align-middle","formControlName","isActive"],["for","fieldActive",1,"vertical-align-middle"],["inputId","fieldClearCache","styleClass","mr-2 vertical-align-middle","formControlName","clearCache"],["for","fieldClearCache",1,"vertical-align-middle"],[1,"min-height400"],[3,"fields","groups","arrayFields","model","form","files","localeFieldsAllowed","localeCurrent","isLocalizationActive","onFieldAdd","onParametersAdd","onParametersUpdate","onParametersDelete"],["optionLabel","title","optionValue","name","styleClass","buttons-sm",3,"options","ngModel","ngModelOptions","ngModelChange"],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"loading-overlay"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"form",0,1),t.YNc(3,_t,19,16,"ng-container",2),t.TgZ(4,"div",3),t._UZ(5,"div",4),t.qZA(),t.YNc(6,ft,1,1,"p-message",5),t.TgZ(7,"div",6)(8,"div",7)(9,"button",8),t.NdJ("click",function(l){return o.saveData(!0,l)}),t.ALo(10,"translate"),t.qZA()(),t.TgZ(11,"div",9)(12,"button",10),t.NdJ("click",function(l){return o.saveData(!1,l)}),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",9)(15,"button",11),t.NdJ("click",function(l){return o.closeModal(l)}),t.ALo(16,"translate"),t.qZA()()()()(),t.YNc(17,ht,2,0,"div",12)),2&e&&(t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(2),t.Q6J("ngIf",o.dataLoaded),t.xp6(3),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(10,7,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("label",t.lcZ(13,9,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(16,11,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading))},directives:[s._Y,s.JL,s.sg,_.O5,K.UN,s.JJ,s.On,j.F,s.u,S.Ql,z.l,L.q,C.Hq,y.H,F.G],pipes:[g.X$],encapsulation:2}),i})();class M{constructor(r,e,o,n,l,p,a,d,h,G,De,Re,Ye){this.id=r,this.isFolder=e,this.parentId=o,this.name=n,this.title=l,this.description=p,this.contentTypeName=a,this.isActive=d,this.clearCache=h,this.menuIndex=G,this.translations=De,this.image=Re,this.contentType=Ye,void 0===this.clearCache&&(this.clearCache=!1),void 0===this.translations&&(this.translations={})}static createTree(r,e=null,o=!0){if(0===r.length)return null;if(!e){const l=r.findIndex(p=>"root"===p.name);e=l>-1?M.toTreeNode(r[l],o):{id:0,key:0,parentId:0,label:"",expanded:!0,children:[]}}e.children=[];const n=r.filter(l=>0!==l.id&&l.parentId===e.id);return n.length>0&&(n.forEach(l=>{e.children.push(M.toTreeNode(l,o))}),e.children.forEach(l=>{M.createTree(r,l,o)})),0===e.children.length&&(e.children=null),e}static getCurrentNode(r,e){if(!e)return null;if(e.id===r)return e;if(e.children){let o=null;for(let n=0;null==o&&n<e.children.length;n++)o=M.getCurrentNode(r,e.children[n]);return o}return null}static toTreeNode(r,e=!0){return{id:r.id,key:r.id,label:r.title,parentId:r.parentId||0,expanded:e}}}var Z=c(1424),x=c(4119),q=c(3407),k=c(4036),Ct=c(8958);const yt=function(){return{standalone:!0}};function bt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",6)(1,"p-selectButton",38),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().onLocaleSwitch(n)}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("options",e.localeListFull)("ngModel",e.localeCurrent)("ngModelOptions",t.DdM(3,yt))}}function Zt(i,r){if(1&i&&(t.TgZ(0,"div",39),t._UZ(1,"app-select-parent-dropdown",40),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("filterId",e.filterParentId)}}function xt(i,r){if(1&i&&(t.TgZ(0,"span",41),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("[",e.localeCurrent,"]")}}function At(i,r){if(1&i&&(t.TgZ(0,"span",42),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("[",e.localeCurrent,"]")}}function vt(i,r){if(1&i&&t._UZ(0,"p-dropdown",43),2&i){const e=t.oxw();t.Q6J("options",e.contentTypes)}}function Mt(i,r){if(1&i&&t._UZ(0,"p-message",44),2&i){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function It(i,r){1&i&&(t.TgZ(0,"div",45),t._UZ(1,"p-progressSpinner"),t.qZA())}const W=function(i){return{"text-green-500":i}};let wt=(()=>{class i extends w.P{constructor(e,o,n,l,p,a,d){super(e,o,n,l),this.ref=e,this.config=o,this.systemNameService=n,this.dataService=l,this.contentTypesService=p,this.filesService=a,this.appSettings=d,this.model=new M(null,!1,0,"","","","",!0),this.form=new s.cw({id:new s.NI("",[]),title:new s.NI("",[s.kI.required]),name:new s.NI("",[s.kI.required]),description:new s.NI("",[]),parentId:new s.NI("",[]),image:new s.NI("",[]),contentTypeName:new s.NI("",[]),menuIndex:new s.NI("",[]),isActive:new s.NI("",[]),clearCache:new s.NI("",[])}),this.contentTypes=[],this.isRoot=!1,this.isItemCopy=!1,this.filterParentId=null,this.localeFieldsAllowed=["title","description"]}ngOnInit(){this.createLanguageSettings(this.appSettings.settings),this.getContentTypes(),void 0!==this.config.data.isItemCopy&&(this.isItemCopy=this.config.data.isItemCopy),void 0!==this.config.data.parentId&&(this.parentId=this.config.data.parentId),null!=this.config.data.id?(this.config.data.id||(this.isRoot=!0),this.getData(this.config.data.id)):(this.updateControls(),this.parentId&&this.form.controls.parentId.setValue(this.parentId)),this.form.valueChanges.pipe((0,A.R)(this.destroyed$)).subscribe(()=>this.onValueChanged("form"))}onGetData(e){this.model=e,this.isRoot&&(this.model.id=0,this.model.name="root"),this.filterParentId=this.model.id,this.updateControls(),setTimeout(()=>{this.isItemCopy&&(this.model.id=0)},1)}closeModal(e){e&&e.preventDefault(),this.ref.close("updated"===this.closeReason?this.model:this.closeReason)}getContentTypes(){this.contentTypesService.getListPage().subscribe({next:e=>{this.contentTypes=e.items,this.contentTypes.length>0&&!this.form.controls.contentTypeName.value&&this.form.controls.contentTypeName.setValue(this.contentTypes[0].name)},error:e=>{this.errorMessage=e}})}filesUploadRequest(e,o){return this.filesService.postFormData(e)}saveFiles(e,o="",n=!1){super.saveFiles(e,"category",n)}saveRequest(){return this.model&&(this.model.id||this.isRoot)?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.E7),t.Y36(m.S),t.Y36(N.U),t.Y36(B.G),t.Y36(T.s),t.Y36(E),t.Y36(X.d))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-category"]],features:[t._Bn([E]),t.qOj],decls:73,vars:54,consts:[[3,"formGroup"],["formEl",""],[1,"grid"],[1,"col-12","md:col-6"],["class","mb-3",4,"ngIf"],["class","w-full-parent",4,"ngIf"],[1,"mb-3"],["inputId","fieldActive","styleClass","mr-2 vertical-align-middle","formControlName","isActive"],["for","fieldActive",1,"vertical-align-middle"],["inputId","fieldClearCache","styleClass","mr-2 vertical-align-middle","formControlName","clearCache"],["for","fieldClearCache",1,"vertical-align-middle"],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left"],[1,"p-divider-content"],["for","fieldTitle",1,"block","mb-2",3,"ngClass"],["class","font-bold text-green-500",4,"ngIf"],["type","text","id","fieldTitle","pInputText","","formControlName","title",1,"w-full"],["for","fieldSystemName",1,"block","mb-2"],[1,"p-inputgroup"],["type","text","id","fieldSystemName","pInputText","","formControlName","name",1,"w-full",3,"readOnly"],["type","button","pButton","","pRipple","","icon","pi pi-refresh","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","disabled","click"],["for","fieldDescription",1,"block","mb-2",3,"ngClass"],["class","font-bold",4,"ngIf"],["id","fieldDescription","rows","6","pInputTextarea","","formControlName","description",1,"w-full","mb-2"],[1,"col-12","md:col-6","mb-2"],["for","fieldContentType",1,"block","mb-2"],["formControlName","contentTypeName","styleClass","w-full","inputId","fieldContentType","optionLabel","title","optionValue","name","name","contentTypeName",3,"options",4,"ngIf"],[1,"mb-2"],["for","fieldMenuIndex",1,"block","mb-2"],["type","number","id","fieldMenuIndex","pInputText","","formControlName","menuIndex",1,"w-full"],["for","fieldImage",1,"block","mb-2"],["formControlName","image",3,"allowedExtensions","files","filesChange"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],[1,"grid","mt-2"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],[1,"col-12","md:col-3"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-warning","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],["optionLabel","title","optionValue","name","styleClass","buttons-sm",3,"options","ngModel","ngModelOptions","ngModelChange"],[1,"w-full-parent"],["inputId","fieldParent","formControlName","parentId",3,"filterId"],[1,"font-bold","text-green-500"],[1,"font-bold"],["formControlName","contentTypeName","styleClass","w-full","inputId","fieldContentType","optionLabel","title","optionValue","name","name","contentTypeName",3,"options"],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"loading-overlay"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"div",3),t.YNc(5,bt,2,4,"div",4),t.YNc(6,Zt,2,1,"div",5),t.qZA(),t.TgZ(7,"div",3)(8,"div",6),t._UZ(9,"p-inputSwitch",7),t.TgZ(10,"label",8),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"div"),t._UZ(14,"p-inputSwitch",9),t.TgZ(15,"label",10),t._uU(16),t.ALo(17,"translate"),t.qZA()()()(),t.TgZ(18,"div",11),t._UZ(19,"div",12),t.qZA(),t.TgZ(20,"div",2)(21,"div",3)(22,"div",6)(23,"label",13),t._uU(24),t.ALo(25,"translate"),t.YNc(26,xt,2,1,"span",14),t.qZA(),t._UZ(27,"input",15),t.qZA(),t.TgZ(28,"div")(29,"label",16),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"div",17),t._UZ(33,"input",18),t.TgZ(34,"button",19),t.NdJ("click",function(l){return o.generateName(o.model,l)}),t.ALo(35,"translate"),t.qZA()()()(),t.TgZ(36,"div",3)(37,"label",20),t._uU(38),t.ALo(39,"translate"),t.YNc(40,At,2,1,"span",21),t.qZA(),t._UZ(41,"textarea",22),t.qZA()(),t.TgZ(42,"div",2)(43,"div",23)(44,"div",6)(45,"label",24),t._uU(46),t.ALo(47,"translate"),t.qZA(),t.YNc(48,vt,1,1,"p-dropdown",25),t.qZA(),t.TgZ(49,"div",26)(50,"label",27),t._uU(51),t.ALo(52,"translate"),t.qZA(),t._UZ(53,"input",28),t.qZA()(),t.TgZ(54,"div",23)(55,"label",29),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"app-file-widget",30),t.NdJ("filesChange",function(l){return o.files=l}),t.qZA()()(),t.TgZ(59,"div",11),t._UZ(60,"div",12),t.qZA(),t.YNc(61,Mt,1,1,"p-message",31),t.TgZ(62,"div",32)(63,"div",3)(64,"button",33),t.NdJ("click",function(l){return o.saveData(!0,l)}),t.ALo(65,"translate"),t.qZA()(),t.TgZ(66,"div",34)(67,"button",35),t.NdJ("click",function(l){return o.saveData(!1,l)}),t.ALo(68,"translate"),t.qZA()(),t.TgZ(69,"div",34)(70,"button",36),t.NdJ("click",function(l){return o.closeModal(l)}),t.ALo(71,"translate"),t.qZA()()()()(),t.YNc(72,It,2,0,"div",37)),2&e&&(t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(4),t.Q6J("ngIf",o.localeListFull.length>1),t.xp6(1),t.Q6J("ngIf",!o.isRoot),t.xp6(5),t.hij(" ",t.lcZ(12,26,"ACTIVE")," "),t.xp6(5),t.hij(" ",t.lcZ(17,28,"CLEAR_FILE_CACHE")," "),t.xp6(7),t.Q6J("ngClass",t.VKq(50,W,o.localeCurrent!=o.localeDefault)),t.xp6(1),t.hij(" ",t.lcZ(25,30,"TITLE")," "),t.xp6(2),t.Q6J("ngIf",o.localeCurrent!=o.localeDefault),t.xp6(4),t.hij(" ",t.lcZ(31,32,"SYSTEM_NAME")," "),t.xp6(3),t.Q6J("readOnly",o.isRoot),t.xp6(1),t.Q6J("pTooltip",t.lcZ(35,34,"GENERATE"))("disabled",o.isRoot),t.xp6(3),t.Q6J("ngClass",t.VKq(52,W,o.localeCurrent!=o.localeDefault)),t.xp6(1),t.hij(" ",t.lcZ(39,36,"DESCRIPTION")," "),t.xp6(2),t.Q6J("ngIf",o.localeCurrent!=o.localeDefault),t.xp6(6),t.hij(" ",t.lcZ(47,38,"CONTENT_TYPE")," "),t.xp6(2),t.Q6J("ngIf",o.contentTypes.length>0),t.xp6(3),t.hij(" ",t.lcZ(52,40,"MENU_INDEX")," "),t.xp6(5),t.hij(" ",t.lcZ(57,42,"IMAGE")," "),t.xp6(2),t.Q6J("allowedExtensions","image/*")("files",o.files),t.xp6(3),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(65,44,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("label",t.lcZ(68,46,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(71,48,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading))},directives:[s._Y,s.JL,s.sg,_.O5,K.UN,s.JJ,s.On,j.F,s.u,S.Ql,_.mk,s.Fj,Z.o,C.Hq,y.H,x.u,q.g,k.Lt,s.wV,Ct.E,L.q,F.G],pipes:[g.X$],encapsulation:2}),i})();var f=c(9783),u=c(5050),U=c(6572),H=c(1874),P=c(330);const Nt=["selectParentInput"];function St(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"app-select-parent-dropdown",13,14),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().categoryId=n})("ngModelChange",function(){return t.CHM(e),t.oxw().onCategoryUpdated()})("onAction",function(n){return t.CHM(e),t.oxw().onMenuAction(n)}),t.qZA()()(),t.TgZ(6,"div",15)(7,"div",16),t._UZ(8,"i",17),t.TgZ(9,"input",18),t.NdJ("input",function(){return t.CHM(e),t.oxw().onInputSearch()})("ngModelChange",function(n){return t.CHM(e),t.oxw().queryOptions.search_word=n}),t.ALo(10,"translate"),t.qZA()()()(),t.TgZ(11,"div",10)(12,"button",19),t.NdJ("click",function(n){return t.CHM(e),t.oxw(),t.MAs(6).toggle(n)}),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"button",20),t.NdJ("click",function(n){return t.CHM(e),t.oxw().openModal(null,n)}),t.ALo(15,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("showHeaderButtons",!0)("ngModel",e.categoryId),t.xp6(5),t.MGl("placeholder","",t.lcZ(10,6,"SEARCH"),"..."),t.Q6J("ngModel",e.queryOptions.search_word),t.xp6(3),t.Q6J("label",t.lcZ(13,8,"ACTIONS")),t.xp6(2),t.Q6J("label",t.lcZ(15,10,"ADD"))}}function Lt(i,r){if(1&i&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"p-sortIcon",23),t.qZA()),2&i){const e=r.$implicit;t.Q6J("pSortableColumn",e.field),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.header)," "),t.xp6(2),t.Q6J("field",e.field)}}function Ft(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"th"),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.YNc(3,Lt,4,5,"th",21),t.qZA()),2&i){const e=r.$implicit;t.xp6(3),t.Q6J("ngForOf",e)}}function Jt(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",29)(2,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw().openModal(n)}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",31),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw().deleteItem(n)}),t.ALo(5,"translate"),t.qZA()(),t.BQk()}2&i&&(t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,2,"EDIT")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(5,4,"DELETE")))}function Ot(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td")(1,"app-render-output",27),t.NdJ("changeRequest",function(n){return t.CHM(e),t.oxw(2).onOptionUpdate(n)}),t.qZA(),t.YNc(2,Jt,6,6,"ng-container",28),t.qZA()}if(2&i){const e=r.$implicit,o=r.index,n=t.oxw(),l=n.$implicit,p=n.columns;t.xp6(1),t.Q6J("value",l[e.field])("key",e.field)("outputType",e.outputType)("options",e.outputProperties)("object",l),t.xp6(1),t.Q6J("ngIf",p.length==o+1)}}function Et(i,r){if(1&i&&(t.TgZ(0,"tr",24)(1,"td"),t._UZ(2,"p-tableCheckbox",25),t.qZA(),t.YNc(3,Ot,3,6,"td",26),t.qZA()),2&i){const e=r.$implicit,o=r.columns;t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("value",e),t.xp6(1),t.Q6J("ngForOf",o)}}function qt(i,r){1&i&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NOTHING_FOUND"),". "))}function kt(i,r){1&i&&(t._uU(0),t.ALo(1,"translate")),2&i&&t.hij(" ",t.lcZ(1,1,"EMPTY"),". ")}function Ut(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td",32),t.YNc(2,qt,3,3,"ng-container",33),t.YNc(3,kt,2,3,"ng-template",null,34,t.W1O),t.qZA()()),2&i){const e=r.$implicit,o=t.MAs(4),n=t.oxw();t.xp6(1),t.Q6J("colSpan",e.length+1),t.xp6(1),t.Q6J("ngIf",n.queryOptions.search_word)("ngIfElse",o)}}let Pt=(()=>{class i extends Q.p{constructor(e,o,n,l,p,a,d,h,G){super(e,o,n,l,p,a),this.dialogService=e,this.contentTypesService=o,this.dataService=n,this.translateService=l,this.messageService=p,this.confirmationService=a,this.categoriesService=d,this.router=h,this.route=G,this.queryOptions=new O.J(1,12,"id","desc"),this.items=[],this.cols=[],this.categoriesTree=[],this.loadingCategories=!1}ngOnInit(){super.ngOnInit(),this.menuItems.push({label:this.getLangString("DISABLE_ENABLE"),icon:"pi pi-times-circle",command:()=>{this.blockSelected()}}),this.route.paramMap.pipe((0,A.R)(this.destroyed$)).subscribe({next:e=>{this.categoryId=e.get("categoryId")?parseInt(e.get("categoryId"),10):0,this.openCategory()},error:e=>{console.log(e)}}),this.getCategoriesTree()}getContentType(){return this.contentTypesService.getItemByName(this.currentCategory.contentTypeName)}openCategory(){this.loading=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.categoriesService.getItem(this.categoryId).subscribe({next:e=>{this.currentCategory=e,this.currentContentType=e.contentType,this.updateTableConfig(),setTimeout(this.getData.bind(this),1)},error:()=>{this.loading=!1,this.router.navigate(["/catalog","category"])}})}getData(e){this.currentContentType?super.getData(e):this.loading=!1}getModalComponent(){return Tt}getItemData(e){return{id:e?e.id:0,parentId:this.categoryId}}openModal(e,o){super.openModal(e,o,"modal-margin-left")}updateTableConfig(){!this.currentContentType||(this.cols=[],this.currentContentType.fields.forEach(e=>{e.showInTable&&this.cols.push({field:e.name,header:e.title,outputType:e.outputType,outputProperties:e.outputProperties})}),this.cols.unshift({field:"id",header:"ID",outputType:"text-center",outputProperties:{}}),this.cols.push({field:"isActive",header:"STATUS",outputType:"boolean",outputProperties:{}}))}getCategoriesTree(){this.loadingCategories=!0,this.categoriesService.getTree().subscribe({next:e=>{this.categoriesTree=e,this.loadingCategories=!1},error:()=>{this.loadingCategories=!1}})}onCategoryUpdated(e){e&&(this.categoryId=e),this.router.navigate(this.categoryId?["/catalog","category",this.categoryId]:["/catalog","category"])}openCategoryModal(e,o,n=!1){const l={id:e,parentId:o,isItemCopy:n};this.dialogService.open(wt,{header:void 0!==e?e?this.getLangString("CATEGORY")+` #${e}`:this.getLangString("ROOT_FOLDER"):this.getLangString("ADD_NEW_CATEGORY"),width:"800px",data:l}).onClose.pipe((0,st.q)(1)).subscribe({next:a=>{"canceled"!==a&&(this.selectParentInput&&this.selectParentInput.getCategoriesTree(),(!e||n)&&a&&a.id&&this.onCategoryUpdated(a.id))}}),setTimeout(()=>{window.document.querySelector(".p-component-overlay")&&window.document.querySelector(".p-component-overlay").classList.add("modal-margin-left")},1)}onMenuAction(e){const n=e[1],l=e[2]||0;switch(e[0]){case"new":this.openCategoryModal(null,n);break;case"edit":this.openCategoryModal(n);break;case"clone":this.openCategoryModal(n,null,!0);break;case"delete":this.confirmationService.confirm({message:this.getLangString("YOU_SURE_YOU_WANT_DELETE"),accept:()=>{this.deleteCategoryItem(n,l)}});break;case"root":this.categoryId=0}}deleteCategoryItem(e,o){!e||(this.loading=!0,this.categoriesService.deleteItem(e).subscribe({next:()=>{this.categoryId=o||0,this.selectParentInput&&this.selectParentInput.getCategoriesTree(),this.onCategoryUpdated()},error:n=>{n.error&&this.messageService.add({key:"message",severity:"error",detail:n.error}),this.loading=!1}}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.xA),t.Y36(T.s),t.Y36(R),t.Y36(g.sK),t.Y36(f.ez),t.Y36(f.YP),t.Y36(B.G),t.Y36(b.F0),t.Y36(b.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-catalog-category"]],viewQuery:function(e,o){if(1&e&&t.Gf(Nt,5),2&e){let n;t.iGM(n=t.CRH())&&(o.selectParentInput=n.first)}},features:[t._Bn([m.xA,R]),t.qOj],decls:9,vars:16,consts:[["styleClass","p-datatable-striped","dataKey","id",3,"selection","contextMenuSelection","contextMenu","sortField","sortOrder","lazy","paginator","showJumpToPageDropdown","value","columns","rows","totalRecords","loading","selectionChange","contextMenuSelectionChange","onLazyLoad"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["styleClass","p-menu-nowrap",3,"popup","model"],["menu",""],[3,"model"],["contextMenu",""],[1,"flex","lg:justify-content-between","flex-wrap"],[1,"w-full","lg:w-auto"],[1,"block","lg:inline-block","vertical-align-top","mr-0","lg:mr-2","w-full","lg:w-auto","mb-2","lg:mb-0"],[1,"w-full-parent-lg"],["inputId","fieldSelectCategory",3,"showHeaderButtons","ngModel","ngModelChange","onAction"],["selectParentInput",""],[1,"inline-block","vertical-align-top","w-full","lg:w-auto"],[1,"p-input-icon-left","w-full","lg:w-auto","mb-2","lg:mb-0"],[1,"pi","pi-search"],["pInputText","","type","text",1,"lg:w-auto","w-full",3,"ngModel","placeholder","input","ngModelChange"],["type","button","pButton","","pRipple","","icon","pi pi-chevron-down","iconPos","left",1,"ml-0","lg:ml-2","w-full","lg:w-auto","mb-2","lg:mb-0",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-plus","iconPos","left",1,"p-button-success","ml-0","lg:ml-2","w-full","lg:w-auto",3,"label","click"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[1,"show-on-hover-parent",3,"pContextMenuRow"],[3,"value"],[4,"ngFor","ngForOf"],[3,"value","key","outputType","options","object","changeRequest"],[4,"ngIf"],[1,"absolute","show-on-hover","pos-top10","pos-right10"],["pButton","","pRipple","","icon","pi pi-pencil","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","left",1,"p-button","p-button-sm","p-button-rounded","p-button-danger","ml-2",3,"pTooltip","click"],[3,"colSpan"],[4,"ngIf","ngIfElse"],["emptyMessage",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"p-table",0),t.NdJ("selectionChange",function(l){return o.itemsSelected=l})("contextMenuSelectionChange",function(l){return o.itemSelected=l})("onLazyLoad",function(l){return o.getData(l)}),t.YNc(1,St,16,12,"ng-template",1),t.YNc(2,Ft,4,1,"ng-template",2),t.YNc(3,Et,4,3,"ng-template",3),t.YNc(4,Ut,5,3,"ng-template",4),t.qZA(),t._UZ(5,"p-menu",5,6)(7,"p-contextMenu",7,8)),2&e){const n=t.MAs(8);t.Q6J("selection",o.itemsSelected)("contextMenuSelection",o.itemSelected)("contextMenu",n)("sortField",o.queryOptions.sort_by)("sortOrder","asc"==o.queryOptions.sort_dir?1:-1)("lazy",!0)("paginator",!0)("showJumpToPageDropdown",!0)("value",o.items)("columns",o.cols)("rows",o.queryOptions.limit)("totalRecords",o.itemsTotal)("loading",o.loading),t.xp6(5),t.Q6J("popup",!0)("model",o.menuItems),t.xp6(2),t.Q6J("model",o.contextMenuItems)}},directives:[u.iA,f.jx,j.F,s.JJ,s.On,s.Fj,Z.o,C.Hq,y.H,u.Mo,_.sg,u.lQ,u.fz,u.zi,u.UA,U.g,_.O5,x.u,H.v2,P.xV],pipes:[g.X$],encapsulation:2}),i})();var Qt=c(9646),tt=c(262);let et=(()=>{class i{constructor(e){this.http=e,this.headers=new I.WM({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="/admin/collections"}setRequestUrl(e){this.requestUrl=e}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe((0,tt.K)(this.handleError()))}deleteItemByName(e){const o=`${this.getRequestUrl()}/${e}`;return this.http.delete(o,{headers:this.headers}).pipe((0,tt.K)(this.handleError()))}handleError(e="operation",o){return n=>{if(n.error)throw n.error;return(0,Qt.of)(o)}}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(I.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),J=(()=>{class i extends D.D{constructor(e){super(e),this.setRequestUrl("/admin/field_types")}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(I.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var ot=c(8061);const Dt=["formEl"],Rt=["panelAddGroup"],nt=function(){return{standalone:!0}};function Yt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",53)(1,"div",54)(2,"label",55),t._uU(3),t.qZA()(),t.TgZ(4,"div",56)(5,"input",57),t.NdJ("ngModelChange",function(n){const p=t.CHM(e).$implicit;return t.oxw(2).fieldModel.inputProperties[p.name]=n}),t.qZA()()()}if(2&i){const e=r.$implicit,o=t.oxw(2);t.xp6(2),t.MGl("for","parameterInputField",e.name,""),t.xp6(1),t.hij(" ",e.title," "),t.xp6(2),t.MGl("id","parameterInputField",e.name,""),t.Q6J("ngModel",o.fieldModel.inputProperties[e.name])("ngModelOptions",t.DdM(5,nt))}}function Bt(i,r){if(1&i&&(t.ynx(0),t.YNc(1,Yt,6,6,"div",52),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.fieldTypeProperties.input)}}function jt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",53)(1,"div",54)(2,"label",55),t._uU(3),t.qZA()(),t.TgZ(4,"div",56)(5,"input",57),t.NdJ("ngModelChange",function(n){const p=t.CHM(e).$implicit;return t.oxw(2).fieldModel.outputProperties[p.name]=n}),t.qZA()()()}if(2&i){const e=r.$implicit,o=t.oxw(2);t.xp6(2),t.MGl("for","parameterOutputField",e.name,""),t.xp6(1),t.hij(" ",e.title," "),t.xp6(2),t.MGl("id","parameterOutputField",e.name,""),t.Q6J("ngModel",o.fieldModel.outputProperties[e.name])("ngModelOptions",t.DdM(5,nt))}}function Ht(i,r){if(1&i&&(t.ynx(0),t.YNc(1,jt,6,6,"div",52),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.fieldTypeProperties.output)}}function Gt(i,r){if(1&i&&t._UZ(0,"p-message",58),2&i){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function $t(i,r){1&i&&(t.TgZ(0,"div",59),t._UZ(1,"p-progressSpinner"),t.qZA())}function Vt(i,r){1&i&&(t.TgZ(0,"div",60),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"THERE_NO_PARAMETERS")," "))}let zt=(()=>{class i extends w.P{constructor(e,o,n,l,p,a){super(e,o,n,l),this.ref=e,this.config=o,this.systemNameService=n,this.dataService=l,this.fieldTypesService=p,this.translateService=a,this.errorMessage="",this.model=new Y.z(0,"","","","",[],[],!0),this.fieldModel=new v._(0,"","","","",{},"",{},""),this.form=new s.cw({id:new s.NI("",[]),title:new s.NI("",[s.kI.required]),name:new s.NI("",[s.kI.required,s.kI.pattern("[A-Za-z0-9_-]+")]),description:new s.NI("",[]),inputType:new s.NI(null,[s.kI.required]),outputType:new s.NI(null,[s.kI.required]),group:new s.NI("",[s.kI.required]),required:new s.NI(!1,[]),showInTable:new s.NI(!1,[]),showOnPage:new s.NI(!1,[]),showInList:new s.NI(!1,[]),isFilter:new s.NI(!1,[])}),this.fieldTypeProperties={input:[],output:[]}}ngOnInit(){this.fieldModel=this.config.data.field||new v._(0,"","","","text",{},"text",{},""),this.contentType=this.config.data.contentType,this.groups=this.contentType.groups.slice(),this.fieldIndex=this.config.data.index,this.fieldModel.group||(this.fieldModel.group=this.groups[0]),this.getFieldTypes()}getFieldTypes(){const e=new O.J(1,0,"title","asc","title");this.fieldTypesService.getListPage(e).pipe((0,A.R)(this.destroyed$)).subscribe({next:o=>{this.fieldTypes=o.items,setTimeout(()=>{this.updateControls(),this.selectFieldTypeProperties("input"),this.selectFieldTypeProperties("output")},1)},error:o=>{this.errorMessage=o}})}openBlock(e,o,n){n&&n.preventDefault(),-1!==e.className.indexOf("hidden")?(e.classList.remove("hidden"),o&&o.focus(),this.errorMessage=""):e.classList.add("hidden")}closeBlock(e,o){o&&o.preventDefault(),e.classList.add("hidden")}deleteGroup(e){e&&e.preventDefault();const o=this.form.controls.group.value,n=this.contentType.fields.findIndex(p=>p.group===o);if(this.errorMessage="",n>-1)return void(this.errorMessage=this.getLangString("YOU_CANT_DELETE_NOTEMPTY_GROUP"));const l=this.groups.indexOf(o);l>-1&&(this.groups.splice(l,1),this.form.controls.group.setValue(this.groups[0]||null))}addGroup(e,o){if(o&&o.preventDefault(),this.errorMessage="",!e.value)return void e.focus();const n=e.value;this.groups.indexOf(n)>-1?this.errorMessage=this.getLangString("GROUP_ALREADY_EXISTS"):(this.groups.push(n),this.form.controls.group.setValue(n),e.value="",this.panelAddGroup.nativeElement.classList.add("hidden"))}updateControls(){if(!this.fieldModel)return;const e=this.form.controls;Object.keys(e).forEach(o=>{void 0!==this.fieldModel[o]&&(Array.isArray(this.fieldModel[o])&&this.arrayFields[o]?this.fieldModel[o].forEach((n,l)=>{this.arrayFieldAdd(o,n)}):e[o].setValue(this.fieldModel[o]))})}saveData(e=!1,o){if(o&&o.preventDefault(),this.errorMessage="",!this.form.valid)return this.formGroupMarkTouched(this.form),void this.focusFormError();const n=Object.assign({},this.form.value);n.inputProperties=Object.assign({},this.fieldModel.inputProperties),n.outputProperties=Object.assign({},this.fieldModel.outputProperties);const l=this.contentType.fields.findIndex(p=>p.name===n.name);l>-1&&this.fieldIndex!==l?this.errorMessage=this.getLangString("FIELD_ALREADY_EXISTS"):this.ref.close(n)}selectFieldTypeProperties(e,o){o?this.form.controls[`${e}Type`].setValue(o):o=this.form.controls[`${e}Type`].value;const n=this.fieldTypes.findIndex(d=>d.name===o);if(-1===n)return void(this.fieldTypeProperties[e]=[]);const l=this.fieldTypes[n],p=`${e}Properties`;this.fieldTypeProperties[e].splice(0),l[e+"Properties"].forEach((d,h)=>{this.fieldTypeProperties[e].push(d)});const a=l[`${e}Properties`].map(d=>d.name);for(const d in this.fieldModel[p])this.fieldModel[p].hasOwnProperty(d)&&-1===a.indexOf(d)&&delete this.fieldModel[p][d];for(const d in this.fieldTypeProperties[e])if(this.fieldTypeProperties[e].hasOwnProperty(d)){const h=this.fieldTypeProperties[e][d].name;void 0===this.fieldModel[p][h]&&(this.fieldModel[p][h]=this.fieldTypeProperties[e][d].default_value)}}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.E7),t.Y36(m.S),t.Y36(N.U),t.Y36(T.s),t.Y36(J),t.Y36(g.sK))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-content-type-field"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Dt,5),t.Gf(Rt,7)),2&e){let n;t.iGM(n=t.CRH())&&(o.formEl=n.first),t.iGM(n=t.CRH())&&(o.panelAddGroup=n.first)}},features:[t._Bn([J]),t.qOj],decls:110,vars:79,consts:[[3,"formGroup"],["formEl",""],[1,"grid"],[1,"col-12","md:col-6"],[1,"mb-2"],["for","contentTypeFieldTitle",1,"block","mb-2"],["type","text","id","contentTypeFieldTitle","pInputText","","formControlName","title",1,"w-full"],["for","contentTypeFieldName",1,"block","mb-2"],[1,"p-inputgroup"],["type","text","id","contentTypeFieldName","pInputText","","formControlName","name",1,"w-full"],["type","button","pButton","","pRipple","","icon","pi pi-refresh","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],["for","contentTypeFieldDescription",1,"block","mb-2"],["id","contentTypeFieldDescription","rows","5","pInputTextarea","","formControlName","description",1,"w-full","mb-2"],["for","contentTypeFieldInputType",1,"block","mb-2"],[1,"p-inputgroup","mb-2"],["inputId","contentTypeFieldInputType","styleClass","w-full border-noround-right","formControlName","inputType","optionLabel","title","optionValue","name",3,"options","onChange"],["type","button","pButton","","pRipple","","icon","pi pi-cog","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],[1,"pt-2","hidden"],["inputTypeOptionsBlock",""],["styleClass","p-panel-sm",3,"header"],[4,"ngIf","ngIfElse"],["for","contentTypeFieldOutputType",1,"block","mb-2"],["inputId","contentTypeFieldOutputType","styleClass","w-full border-noround-right","formControlName","outputType","optionLabel","title","optionValue","name",3,"options","onChange"],["outputTypeOptionsBlock",""],["for","contentTypeFieldGroup",1,"block","mb-2"],["type","button","pButton","","pRipple","","icon","pi pi-plus","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],["styleClass","w-full border-noround","inputId","contentTypeFieldGroup","formControlName","group",3,"options"],["type","button","pButton","","pRipple","","icon","pi pi-times","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],[1,"pt-3","hidden"],["panelAddGroup",""],["type","text","id","contentTypeFieldNewGroup","pInputText","",1,"w-full","mb-3"],["newGroupField",""],[1,"text-right"],["type","button","pButton","","pRipple","",1,"p-button-secondary","p-button-sm","ml-2",3,"label","click"],[1,"col-12","md:col-6","pt-3"],[1,"mb-3"],["inputId","contentTypeFieldRequired","styleClass","mr-2 vertical-align-middle","formControlName","required"],["for","contentTypeFieldRequired",1,"vertical-align-middle"],["inputId","contentTypeFieldShowInTable","styleClass","mr-2 vertical-align-middle","formControlName","showInTable"],["for","contentTypeFieldShowInTable",1,"vertical-align-middle"],["inputId","contentTypeFieldShowOnPage","styleClass","mr-2 vertical-align-middle","formControlName","showOnPage"],["for","contentTypeFieldShowOnPage",1,"vertical-align-middle"],["inputId","contentTypeFieldShowInList","styleClass","mr-2 vertical-align-middle","formControlName","showInList"],["for","contentTypeFieldShowInList",1,"vertical-align-middle"],["inputId","contentTypeFieldIsFilter","styleClass","mr-2 vertical-align-middle","formControlName","isFilter"],["for","contentTypeFieldIsFilter",1,"vertical-align-middle"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],[1,"grid","mt-2"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],["propertiesEmptyMessage",""],["class","grid mb-2",4,"ngFor","ngForOf"],[1,"grid","mb-2"],[1,"col-5"],[1,"text-sm",3,"for"],[1,"col-7"],["type","text","pInputText","",1,"p-inputtext-sm","w-full",3,"id","ngModel","ngModelOptions","ngModelChange"],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"loading-overlay"],[1,"surface-200","border-round","p-3"]],template:function(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",6),t.qZA(),t.TgZ(10,"div")(11,"label",7),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",8),t._UZ(15,"input",9),t.TgZ(16,"button",10),t.NdJ("click",function(p){return o.generateName(o.model,p)}),t.ALo(17,"translate"),t.qZA()()()(),t.TgZ(18,"div",3)(19,"div")(20,"label",11),t._uU(21),t.ALo(22,"translate"),t.qZA(),t._UZ(23,"textarea",12),t.qZA()()(),t.TgZ(24,"div",2)(25,"div",3)(26,"label",13),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"div",14)(30,"p-dropdown",15),t.NdJ("onChange",function(){return o.selectFieldTypeProperties("input")}),t.qZA(),t.TgZ(31,"button",16),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(34);return o.openBlock(a,null,p)}),t.ALo(32,"translate"),t.qZA()(),t.TgZ(33,"div",17,18)(35,"p-panel",19),t.ALo(36,"translate"),t.YNc(37,Bt,2,1,"ng-container",20),t.qZA()()(),t.TgZ(38,"div",3)(39,"label",21),t._uU(40),t.ALo(41,"translate"),t.qZA(),t.TgZ(42,"div",14)(43,"p-dropdown",22),t.NdJ("onChange",function(){return o.selectFieldTypeProperties("output")}),t.qZA(),t.TgZ(44,"button",16),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(47);return o.openBlock(a,null,p)}),t.ALo(45,"translate"),t.qZA()(),t.TgZ(46,"div",17,23)(48,"p-panel",19),t.ALo(49,"translate"),t.YNc(50,Ht,2,1,"ng-container",20),t.qZA()()()(),t.TgZ(51,"div",2)(52,"div",3)(53,"label",24),t._uU(54),t.ALo(55,"translate"),t.qZA(),t.TgZ(56,"div",8)(57,"button",25),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(63),d=t.MAs(67);return o.openBlock(a,d,p)}),t.ALo(58,"translate"),t.qZA(),t._UZ(59,"p-dropdown",26),t.TgZ(60,"button",27),t.NdJ("click",function(){return o.deleteGroup()}),t.ALo(61,"translate"),t.qZA()(),t.TgZ(62,"div",28,29)(64,"p-panel",19),t.ALo(65,"translate"),t._UZ(66,"input",30,31),t.TgZ(68,"div",32)(69,"button",33),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(67);return o.addGroup(a,p)}),t.ALo(70,"translate"),t.qZA(),t.TgZ(71,"button",33),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(63);return o.closeBlock(a,p)}),t.ALo(72,"translate"),t.qZA()()()()(),t.TgZ(73,"div",34)(74,"div",35),t._UZ(75,"p-inputSwitch",36),t.TgZ(76,"label",37),t._uU(77),t.ALo(78,"translate"),t.qZA()(),t.TgZ(79,"div",35),t._UZ(80,"p-inputSwitch",38),t.TgZ(81,"label",39),t._uU(82),t.ALo(83,"translate"),t.qZA()(),t.TgZ(84,"div",35),t._UZ(85,"p-inputSwitch",40),t.TgZ(86,"label",41),t._uU(87),t.ALo(88,"translate"),t.qZA()(),t.TgZ(89,"div",35),t._UZ(90,"p-inputSwitch",42),t.TgZ(91,"label",43),t._uU(92),t.ALo(93,"translate"),t.qZA()(),t.TgZ(94,"div",35),t._UZ(95,"p-inputSwitch",44),t.TgZ(96,"label",45),t._uU(97),t.ALo(98,"translate"),t.qZA()()()(),t.YNc(99,Gt,1,1,"p-message",46),t.TgZ(100,"div",47)(101,"div",3)(102,"button",48),t.NdJ("click",function(p){return o.saveData(!0,p)}),t.ALo(103,"translate"),t.qZA()(),t.TgZ(104,"div",3)(105,"button",49),t.NdJ("click",function(p){return o.closeModal(p)}),t.ALo(106,"translate"),t.qZA()()()()(),t.YNc(107,$t,2,0,"div",50),t.YNc(108,Vt,3,3,"ng-template",null,51,t.W1O)}if(2&e){const n=t.MAs(109);t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(6),t.hij(" ",t.lcZ(8,33,"TITLE")," "),t.xp6(5),t.hij(" ",t.lcZ(13,35,"SYSTEM_NAME")," "),t.xp6(4),t.Q6J("pTooltip",t.lcZ(17,37,"GENERATE")),t.xp6(5),t.hij(" ",t.lcZ(22,39,"DESCRIPTION")," "),t.xp6(6),t.hij(" ",t.lcZ(28,41,"INPUT_TYPE")," "),t.xp6(3),t.Q6J("options",o.fieldTypes),t.xp6(1),t.Q6J("pTooltip",t.lcZ(32,43,"OPTIONS")),t.xp6(4),t.Q6J("header",t.lcZ(36,45,"OPTIONS")),t.xp6(2),t.Q6J("ngIf",o.fieldTypeProperties.input.length>0)("ngIfElse",n),t.xp6(3),t.hij(" ",t.lcZ(41,47,"OUTPUT_TYPE")," "),t.xp6(3),t.Q6J("options",o.fieldTypes),t.xp6(1),t.Q6J("pTooltip",t.lcZ(45,49,"OPTIONS")),t.xp6(4),t.Q6J("header",t.lcZ(49,51,"OPTIONS")),t.xp6(2),t.Q6J("ngIf",o.fieldTypeProperties.output.length>0)("ngIfElse",n),t.xp6(4),t.hij(" ",t.lcZ(55,53,"GROUP")," "),t.xp6(3),t.Q6J("pTooltip",t.lcZ(58,55,"ADD_GROUP")),t.xp6(2),t.Q6J("options",o.groups),t.xp6(1),t.Q6J("pTooltip",t.lcZ(61,57,"DELETE")),t.xp6(4),t.Q6J("header",t.lcZ(65,59,"ADD_GROUP")),t.xp6(5),t.Q6J("label",t.lcZ(70,61,"ADD")),t.xp6(2),t.Q6J("label",t.lcZ(72,63,"CANCEL")),t.xp6(6),t.hij(" ",t.lcZ(78,65,"REQUIRED")," "),t.xp6(5),t.hij(" ",t.lcZ(83,67,"SHOW_IN_TABLE")," "),t.xp6(5),t.hij(" ",t.lcZ(88,69,"SHOW_ON_PAGE")," "),t.xp6(5),t.hij(" ",t.lcZ(93,71,"SHOW_IN_LIST")," "),t.xp6(5),t.hij(" ",t.lcZ(98,73,"SHOW_IN_FILTER")," "),t.xp6(2),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(103,75,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(106,77,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading)}},directives:[s._Y,s.JL,s.sg,s.Fj,Z.o,s.JJ,s.u,C.Hq,y.H,x.u,q.g,k.Lt,ot.s,_.O5,_.sg,s.On,S.Ql,L.q,F.G],pipes:[g.X$],encapsulation:2}),i})();var Xt=c(4553),Kt=c(9430);let Wt=(()=>{class i{constructor(e,o,n){this.ref=e,this.config=o,this.translateService=n,this.closeReason="canceled",this.fields=[],this.sortData=[],this.sortOptions=[{name:"",title:"SORT_FIELDS"},{name:"listOrder-showInList",title:"SORT_FIELDS_LIST"},{name:"pageOrder-showOnPage",title:"SORT_FIELDS_PAGE"},{name:"filterOrder-isFilter",title:"SORT_FILTERS"}],this.sortType="",this.sortingFieldName="",this.errorMessage=""}ngOnInit(){this.sortOptions.forEach(e=>{e.title=this.getLangString(e.title)}),this.config.data.fields&&(this.fields=this.config.data.fields),this.sortingInit()}saveData(e){e&&e.preventDefault(),this.sortingApply(),this.ref.close({reason:"submit",data:this.fields})}closeModal(e){e&&e.preventDefault(),this.ref.close(this.closeReason)}dismissModal(e){this.ref.close(null)}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}sortingInit(){this.sortingApply();const e=this.sortType.split("-");this.sortingFieldName=e[0];const o=e[1]?this.fields.filter(n=>n[e[1]]):this.fields;o.sort(function(n,l){return n[e[0]]-l[e[0]]}),0!==o.length?(this.sortData=o.map(n=>({name:n.name,title:n.title})),this.sortData=o.map(n=>({name:n.name,title:n.title}))):this.errorMessage=this.getLangString("SORT_FIELDS_EMPTY")}sortingApply(){if(this.sortingFieldName)this.sortData.forEach((e,o)=>{const n=this.fields.findIndex(l=>l.name===e.name);n>-1&&(this.fields[n][this.sortingFieldName]=o)});else{const e=this.sortData.map(o=>o.name);this.fields.sort(function(o,n){return e.indexOf(o.name)-e.indexOf(n.name)})}}sortingReset(){this.sortData.splice(0,this.sortData.length),this.sortingFieldName=""}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.E7),t.Y36(m.S),t.Y36(g.sK))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-content-type-fields-sorting"]],features:[t._Bn([Xt.pQ])],decls:12,vars:9,consts:[[1,"mb-3"],["optionValue","name","optionLabel","title",3,"options","ngModel","ngModelChange"],[1,"min-height300","mb-3"],[3,"items","itemsChange"],[1,"grid","mt-2"],[1,"col-12","md:col-6"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"p-dropdown",1),t.NdJ("ngModelChange",function(l){return o.sortType=l})("ngModelChange",function(){return o.sortingInit()}),t.qZA()(),t.TgZ(3,"div",2)(4,"app-sorting-dnd",3),t.NdJ("itemsChange",function(l){return o.sortData=l}),t.qZA()(),t.TgZ(5,"div",4)(6,"div",5)(7,"button",6),t.NdJ("click",function(l){return o.saveData(l)}),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"div",5)(10,"button",7),t.NdJ("click",function(l){return o.closeModal(l)}),t.ALo(11,"translate"),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("options",o.sortOptions)("ngModel",o.sortType),t.xp6(2),t.Q6J("items",o.sortData),t.xp6(3),t.Q6J("label",t.lcZ(8,5,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(11,7,"CLOSE")))},directives:[k.Lt,s.JJ,s.On,Kt.i,C.Hq,y.H],pipes:[g.X$],encapsulation:2}),i})();var te=c(761);const ee=["formEl"],oe=["panelAddCollection"];function ne(i,r){if(1&i&&t._UZ(0,"p-message",49),2&i){const e=t.oxw();t.Q6J("text",e.errorMessageTop)}}function ie(i,r){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"th"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th"),t._uU(14),t.ALo(15,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,5,"TITLE")),t.xp6(3),t.Oqu(t.lcZ(6,7,"INPUT_TYPE")),t.xp6(3),t.Oqu(t.lcZ(9,9,"GROUP")),t.xp6(3),t.Oqu(t.lcZ(12,11,"REQUIRED")),t.xp6(3),t.Oqu(t.lcZ(15,13,"SHOW_IN_TABLE")))}function le(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr",50)(1,"td"),t._uU(2),t.TgZ(3,"span",51),t._uU(4),t.qZA()(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"app-render-output",52),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"app-render-output",52),t.TgZ(13,"div",53)(14,"button",54),t.NdJ("click",function(n){const p=t.CHM(e).$implicit;return t.oxw().editField(p,n)}),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"button",55),t.NdJ("click",function(n){const p=t.CHM(e).$implicit;return t.oxw().copyField(p,n)}),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"button",56),t.NdJ("click",function(n){const p=t.CHM(e).$implicit;return t.oxw().deleteField(p,n)}),t.ALo(19,"translate"),t.qZA()()()()}if(2&i){const e=r.$implicit;t.Q6J("pEditableRow",e)("pContextMenuRow",e),t.xp6(2),t.hij("",e.title," "),t.xp6(2),t.hij("(",e.name,")"),t.xp6(2),t.Oqu(e.inputType),t.xp6(2),t.Oqu(e.group),t.xp6(2),t.Q6J("value",e.required),t.xp6(2),t.Q6J("value",e.showInTable),t.xp6(2),t.Q6J("pTooltip",t.lcZ(15,11,"EDIT")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(17,13,"CLONE")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(19,15,"DELETE"))}}function re(i,r){if(1&i&&t._UZ(0,"p-message",49),2&i){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function se(i,r){1&i&&(t.TgZ(0,"div",57),t._UZ(1,"p-progressSpinner"),t.qZA())}let pe=(()=>{class i extends w.P{constructor(e,o,n,l,p,a,d,h){super(e,o,n,l),this.ref=e,this.config=o,this.systemNameService=n,this.dataService=l,this.dialogService=p,this.translateService=a,this.collectionsService=d,this.confirmationService=h,this.model=new Y.z(0,"","","","",[],[],!0),this.form=new s.cw({id:new s.NI("",[]),title:new s.NI("",[s.kI.required]),name:new s.NI("",[s.kI.required,s.kI.pattern("[A-Za-z0-9_-]+")]),description:new s.NI("",[]),collection:new s.NI("",[s.kI.required]),isActive:new s.NI("",[]),isCreateByUsersAllowed:new s.NI("",[])}),this.collections=["products"],this.errorMessageTop=""}ngOnInit(){super.ngOnInit(),this.config.data.id||this.getCollectionsList(),this.contextMenuItems=[{label:this.getLangString("EDIT"),icon:"pi pi-fw pi-pencil",command:()=>this.editField(this.itemSelected)},{label:this.getLangString("CLONE"),icon:"pi pi-fw pi-clone",command:()=>this.copyField(this.itemSelected)},{label:this.getLangString("DELETE"),icon:"pi pi-fw pi-trash",command:()=>this.deleteField(this.itemSelected)}]}onGetData(e,o=!1){this.model=e,o&&(this.model.id=0),this.getCollectionsList(),this.updateControls()}getCollectionsList(){this.collectionsService.getList().subscribe(e=>{e.length>0&&(this.collections=e,this.model.collection||(this.model.collection=this.collections[0]),-1===this.collections.indexOf(this.model.collection)&&this.collections.unshift(this.model.collection)),setTimeout(()=>{this.form.controls.collection.setValue(this.model.collection)},1)})}addCollection(e,o){if(o&&o.preventDefault(),this.errorMessageTop="",!e.value)return void e.focus();const n=e.value;this.collections.indexOf(n)>-1?this.errorMessageTop=this.getLangString("COLLECTION_EXISTS"):(this.collections.push(n),this.form.controls.collection.setValue(n),e.value="",this.panelAddCollection.nativeElement.classList.add("hidden"))}openBlock(e,o,n){n&&n.preventDefault(),-1!==e.className.indexOf("hidden")?(e.classList.remove("hidden"),o&&o.focus(),this.errorMessageTop="",this.errorMessage=""):e.classList.add("hidden")}closeBlock(e,o){o&&o.preventDefault(),e.classList.add("hidden")}deleteCollection(){this.errorMessageTop="",this.confirmationService.confirm({message:this.getLangString("YOU_SURE_YOU_WANT_DELETE"),accept:()=>{const e=this.form.controls.collection.value;this.loading=!0,this.collectionsService.deleteItemByName(e).subscribe({next:()=>{const o=this.collections.indexOf(e);o>-1&&(this.collections.splice(o,1),this.form.controls.collection.setValue(this.collections[0]||"")),this.errorMessageTop="",this.loading=!1},error:o=>{this.errorMessageTop=o.error||"Error.",this.loading=!1}})}})}deleteField(e,o){o&&o.preventDefault();const n=this.model.fields.findIndex(l=>l.name===e.name);-1!==n?this.model.fields.splice(n,1):this.errorMessage=this.getLangString("FIELD_NOR_FOUND")}modalContentTypeField(e,o=-1){this.dialogService.open(zt,{header:this.getLangString("EDIT_FIELD"),width:"800px",data:Object.assign({},e,{index:o})}).onClose.pipe((0,A.R)(this.destroyed$)).subscribe({next:l=>{l&&l.name&&(o>-1?Object.assign(this.model.fields[o],l):this.model.fields.push(Object.assign({},l)),this.updateGroupsList())}})}editField(e,o){o&&o.preventDefault();const n=this.model.fields.findIndex(p=>p.name===e.name),l={field:Object.assign({},e),contentType:this.model};l.field.inputProperties&&(l.field.inputProperties=Object.assign({},e.inputProperties)),l.field.outputProperties&&(l.field.outputProperties=Object.assign({},e.outputProperties)),this.modalContentTypeField(l,n)}addField(e){e&&e.preventDefault(),this.modalContentTypeField({field:null,contentType:this.model})}copyField(e,o){o&&o.preventDefault();const n={field:JSON.parse(JSON.stringify(e)),contentType:this.model};this.modalContentTypeField(n)}updateGroupsList(){const e=[];this.model.fields.forEach(o=>{-1===e.indexOf(o.group)&&e.push(o.group)}),this.model.groups=e}fieldsExport(e){e&&e.preventDefault(),this.errorMessage="";const n={textValue:JSON.stringify(this.model.fields,null,"\t")};this.dialogService.open(te.p,{header:this.getLangString("IMPORT_EXPORT")+" JSON",width:"800px",data:n}).onClose.pipe((0,A.R)(this.destroyed$)).subscribe({next:p=>{if(p&&p.data)try{const a=JSON.parse(p.data);this.model.fields.splice(0,this.model.fields.length),this.model.fields.push(...a)}catch(a){this.errorMessage=this.getLangString("JSON_SYNTAX_ERROR")}}})}sortingStart(e){e&&e.preventDefault(),this.errorMessage="";const n={fields:JSON.parse(JSON.stringify(this.model.fields))};this.dialogService.open(Wt,{header:this.getLangString("SORT"),width:"800px",data:n}).onClose.pipe((0,A.R)(this.destroyed$)).subscribe({next:p=>{p&&p.data&&(this.model.fields.splice(0,this.model.fields.length),this.model.fields.push(...p.data))}})}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}getFormData(){const e=super.getFormData();return e.id=this.model.id||0,e.fields=this.model.fields,e.groups=this.model.groups,e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.E7),t.Y36(m.S),t.Y36(N.U),t.Y36(T.s),t.Y36(m.xA),t.Y36(g.sK),t.Y36(et),t.Y36(f.YP))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-content-type"]],viewQuery:function(e,o){if(1&e&&(t.Gf(ee,5),t.Gf(oe,7)),2&e){let n;t.iGM(n=t.CRH())&&(o.formEl=n.first),t.iGM(n=t.CRH())&&(o.panelAddCollection=n.first)}},features:[t._Bn([et]),t.qOj],decls:85,vars:64,consts:[[3,"formGroup"],["formEl",""],[1,"grid"],[1,"col-12","md:col-6"],[1,"mb-2"],["for","fieldTitle",1,"block","mb-2"],["type","text","id","fieldTitle","pInputText","","formControlName","title",1,"w-full"],["for","fieldSystemName",1,"block","mb-2"],[1,"p-inputgroup"],["type","text","id","fieldSystemName","pInputText","","formControlName","name",1,"w-full"],["type","button","pButton","","pRipple","","icon","pi pi-refresh","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],["for","fieldDescription",1,"block","mb-2"],["id","fieldDescription","rows","5","pInputTextarea","","formControlName","description",1,"w-full","mb-2"],[1,"col-12","md:col-6","mb-3"],["for","fieldCollection",1,"block","mb-2"],["type","button","pButton","","pRipple","","icon","pi pi-plus","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],["styleClass","w-full border-noround","inputId","fieldCollection","formControlName","collection",3,"options"],["type","button","pButton","","pRipple","","icon","pi pi-times","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],[1,"pt-3","hidden"],["panelAddCollection",""],["styleClass","p-panel-sm",3,"header"],["type","text","id","fieldNewCollection","pInputText","",1,"w-full","mb-3"],["newCollectionField",""],[1,"text-right"],["type","button","pButton","","pRipple","",1,"p-button-secondary","p-button-sm","ml-2",3,"label","click"],[1,"grid","mb-3"],["inputId","fieldActive","styleClass","mr-2 vertical-align-middle","formControlName","isActive"],["for","fieldActive",1,"vertical-align-middle"],["inputId","fieldCreateByUsersAllowed","styleClass","mr-2 vertical-align-middle","formControlName","isCreateByUsersAllowed"],["for","fieldCreateByUsersAllowed",1,"vertical-align-middle"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left"],[1,"p-divider-content"],[1,"text-center","pb-3"],["type","button","pButton","","pRipple","","icon","pi pi-plus","iconPos","left",1,"p-button-secondary","p-button-sm",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-sort-alt","iconPos","left",1,"p-button-secondary","p-button-sm","ml-2",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-upload","iconPos","left",1,"p-button-secondary","p-button-sm","ml-2",3,"label","click"],[1,"mb-3"],["dataKey","name","editMode","row",3,"value","loading","contextMenuSelection","contextMenu","contextMenuSelectionChange"],["pTemplate","header"],["pTemplate","body"],[1,"grid","mt-2"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],[1,"col-12","md:col-3"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-warning","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],["appendTo","body",3,"model"],["contextMenu",""],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"show-on-hover-parent",3,"pEditableRow","pContextMenuRow"],[1,"text-500"],["outputType","boolean",3,"value"],[1,"absolute","show-on-hover","pos-top10","pos-right10"],["pButton","","pRipple","","icon","pi pi-pencil","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-clone","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info","ml-2",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-danger","ml-2",3,"pTooltip","click"],[1,"loading-overlay"]],template:function(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",6),t.qZA(),t.TgZ(10,"div")(11,"label",7),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",8),t._UZ(15,"input",9),t.TgZ(16,"button",10),t.NdJ("click",function(p){return o.generateName(o.model,p)}),t.ALo(17,"translate"),t.qZA()()()(),t.TgZ(18,"div",3)(19,"label",11),t._uU(20),t.ALo(21,"translate"),t.qZA(),t._UZ(22,"textarea",12),t.qZA()(),t.TgZ(23,"div",2)(24,"div",13)(25,"label",14),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div",8)(29,"button",15),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(35),d=t.MAs(39);return o.openBlock(a,d,p)}),t.ALo(30,"translate"),t.qZA(),t._UZ(31,"p-dropdown",16),t.TgZ(32,"button",17),t.NdJ("click",function(){return o.deleteCollection()}),t.ALo(33,"translate"),t.qZA()(),t.TgZ(34,"div",18,19)(36,"p-panel",20),t.ALo(37,"translate"),t._UZ(38,"input",21,22),t.TgZ(40,"div",23)(41,"button",24),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(39);return o.addCollection(a,p)}),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"button",24),t.NdJ("click",function(p){t.CHM(n);const a=t.MAs(35);return o.closeBlock(a,p)}),t.ALo(44,"translate"),t.qZA()()()()(),t._UZ(45,"div",13),t.qZA(),t.TgZ(46,"div",25)(47,"div",3),t._UZ(48,"p-inputSwitch",26),t.TgZ(49,"label",27),t._uU(50),t.ALo(51,"translate"),t.qZA()(),t.TgZ(52,"div",3),t._UZ(53,"p-inputSwitch",28),t.TgZ(54,"label",29),t._uU(55),t.ALo(56,"translate"),t.qZA()()(),t.YNc(57,ne,1,1,"p-message",30),t.TgZ(58,"div",31),t._UZ(59,"div",32),t.qZA(),t.TgZ(60,"div",33)(61,"button",34),t.NdJ("click",function(p){return o.addField(p)}),t.ALo(62,"translate"),t.qZA(),t.TgZ(63,"button",35),t.NdJ("click",function(p){return o.sortingStart(p)}),t.ALo(64,"translate"),t.qZA(),t.TgZ(65,"button",36),t.NdJ("click",function(p){return o.fieldsExport(p)}),t.ALo(66,"translate"),t.qZA()(),t.TgZ(67,"div",37)(68,"p-table",38),t.NdJ("contextMenuSelectionChange",function(p){return o.itemSelected=p}),t.YNc(69,ie,16,15,"ng-template",39),t.YNc(70,le,20,17,"ng-template",40),t.qZA()(),t.YNc(71,re,1,1,"p-message",30),t.TgZ(72,"div",41)(73,"div",3)(74,"button",42),t.NdJ("click",function(p){return o.saveData(!0,p)}),t.ALo(75,"translate"),t.qZA()(),t.TgZ(76,"div",43)(77,"button",44),t.NdJ("click",function(p){return o.saveData(!1,p)}),t.ALo(78,"translate"),t.qZA()(),t.TgZ(79,"div",43)(80,"button",45),t.NdJ("click",function(p){return o.closeModal(p)}),t.ALo(81,"translate"),t.qZA()()()()(),t.YNc(82,se,2,0,"div",46),t._UZ(83,"p-contextMenu",47,48)}if(2&e){const n=t.MAs(84);t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(6),t.hij(" ",t.lcZ(8,28,"TITLE")," "),t.xp6(5),t.hij(" ",t.lcZ(13,30,"SYSTEM_NAME")," "),t.xp6(4),t.Q6J("pTooltip",t.lcZ(17,32,"GENERATE")),t.xp6(4),t.hij(" ",t.lcZ(21,34,"DESCRIPTION")," "),t.xp6(6),t.hij(" ",t.lcZ(27,36,"COLLECTION")," "),t.xp6(3),t.Q6J("pTooltip",t.lcZ(30,38,"ADD_COLLECTION")),t.xp6(2),t.Q6J("options",o.collections),t.xp6(1),t.Q6J("pTooltip",t.lcZ(33,40,"DELETE")),t.xp6(4),t.Q6J("header",t.lcZ(37,42,"ADD_COLLECTION")),t.xp6(5),t.Q6J("label",t.lcZ(42,44,"ADD")),t.xp6(2),t.Q6J("label",t.lcZ(44,46,"CANCEL")),t.xp6(7),t.hij(" ",t.lcZ(51,48,"ACTIVE")," "),t.xp6(5),t.hij(" ",t.lcZ(56,50,"CREATE_BY_USERS_ALLOWED")," "),t.xp6(2),t.Q6J("ngIf",o.errorMessageTop),t.xp6(4),t.Q6J("label",t.lcZ(62,52,"ADD")),t.xp6(2),t.Q6J("label",t.lcZ(64,54,"SORT")),t.xp6(2),t.Q6J("label",t.lcZ(66,56,"IMPORT_EXPORT")),t.xp6(3),t.Q6J("value",o.model.fields)("loading",o.loading)("contextMenuSelection",o.itemSelected)("contextMenu",n),t.xp6(3),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(75,58,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("label",t.lcZ(78,60,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(81,62,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("model",o.contextMenuItems)}},directives:[s._Y,s.JL,s.sg,s.Fj,Z.o,s.JJ,s.u,C.Hq,y.H,x.u,q.g,k.Lt,ot.s,S.Ql,_.O5,L.q,u.iA,f.jx,u.D$,u.zi,U.g,F.G,P.xV],pipes:[g.X$],encapsulation:2}),i})();function ae(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10),t._UZ(2,"i",11),t.TgZ(3,"input",12),t.NdJ("input",function(){return t.CHM(e),t.oxw().onInputSearch()})("ngModelChange",function(n){return t.CHM(e),t.oxw().queryOptions.search_word=n}),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",13)(6,"button",14),t.NdJ("click",function(n){return t.CHM(e),t.oxw(),t.MAs(6).toggle(n)}),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",15),t.NdJ("click",function(n){return t.CHM(e),t.oxw().openModal(null,n)}),t.ALo(9,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.MGl("placeholder","",t.lcZ(4,4,"SEARCH"),"..."),t.Q6J("ngModel",e.queryOptions.search_word),t.xp6(3),t.Q6J("label",t.lcZ(7,6,"ACTIONS")),t.xp6(2),t.Q6J("label",t.lcZ(9,8,"ADD"))}}function ce(i,r){if(1&i&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"p-sortIcon",18),t.qZA()),2&i){const e=r.$implicit;t.Q6J("pSortableColumn",e.field),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.header)," "),t.xp6(2),t.Q6J("field",e.field)}}function de(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"th"),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.YNc(3,ce,4,5,"th",16),t.qZA()),2&i){const e=r.$implicit;t.xp6(3),t.Q6J("ngForOf",e)}}function ue(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",24)(2,"button",25),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw(2).$implicit;return t.oxw().openModal(l,n)}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",26),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw(2).$implicit;return t.oxw().openModal(l,n,"",!0)}),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",27),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw(2).$implicit;return t.oxw().deleteItem(l,n)}),t.ALo(7,"translate"),t.qZA()(),t.BQk()}2&i&&(t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,3,"EDIT")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(5,5,"CLONE")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(7,7,"DELETE")))}function me(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td")(1,"app-render-output",22),t.NdJ("changeRequest",function(n){return t.CHM(e),t.oxw(2).onOptionUpdate(n)}),t.qZA(),t.YNc(2,ue,8,9,"ng-container",23),t.qZA()}if(2&i){const e=r.$implicit,o=r.index,n=t.oxw(),l=n.$implicit,p=n.columns;t.xp6(1),t.Q6J("value",l[e.field])("key",e.field)("outputType",e.outputType)("options",e.outputProperties)("object",l),t.xp6(1),t.Q6J("ngIf",p.length==o+1)}}function ge(i,r){if(1&i&&(t.TgZ(0,"tr",19)(1,"td"),t._UZ(2,"p-tableCheckbox",20),t.qZA(),t.YNc(3,me,3,6,"td",21),t.qZA()),2&i){const e=r.$implicit,o=r.columns;t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("value",e),t.xp6(1),t.Q6J("ngForOf",o)}}function _e(i,r){1&i&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NOTHING_FOUND"),". "))}function fe(i,r){1&i&&(t._uU(0),t.ALo(1,"translate")),2&i&&t.hij(" ",t.lcZ(1,1,"EMPTY"),". ")}function he(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td",28),t.YNc(2,_e,3,3,"ng-container",29),t.YNc(3,fe,2,3,"ng-template",null,30,t.W1O),t.qZA()()),2&i){const e=r.$implicit,o=t.MAs(4),n=t.oxw();t.xp6(1),t.Q6J("colSpan",e.length+1),t.xp6(1),t.Q6J("ngIf",n.queryOptions.search_word)("ngIfElse",o)}}let Te=(()=>{class i extends Q.p{constructor(e,o,n,l,p,a){super(e,o,n,l,p,a),this.dialogService=e,this.contentTypesService=o,this.dataService=n,this.translateService=l,this.messageService=p,this.confirmationService=a,this.queryOptions=new O.J(1,12,"name","desc"),this.items=[],this.cols=[{field:"id",header:"ID",outputType:"text-center",outputProperties:{}},{field:"title",header:"TITLE",outputType:"text",outputProperties:{}},{field:"name",header:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{field:"collection",header:"COLLECTION",outputType:"text",outputProperties:{}},{field:"isActive",header:"STATUS",outputType:"boolean",outputProperties:{}}]}ngOnInit(){super.ngOnInit(),this.menuItems.push({label:this.getLangString("DISABLE_ENABLE"),icon:"pi pi-times-circle",command:()=>{this.blockSelected()}})}getModalComponent(){return pe}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.xA),t.Y36(T.s),t.Y36(T.s),t.Y36(g.sK),t.Y36(f.ez),t.Y36(f.YP))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-catalog-category"]],features:[t._Bn([m.xA,T.s]),t.qOj],decls:9,vars:16,consts:[["styleClass","p-datatable-striped","dataKey","id",3,"selection","contextMenuSelection","contextMenu","sortField","sortOrder","lazy","paginator","showJumpToPageDropdown","value","columns","rows","totalRecords","loading","selectionChange","contextMenuSelectionChange","onLazyLoad"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["styleClass","p-menu-nowrap",3,"popup","model"],["menu",""],[3,"model"],["contextMenu",""],[1,"flex","md:justify-content-between","flex-wrap"],[1,"p-input-icon-left","w-full","md:w-auto","mb-2","md:mb-0"],[1,"pi","pi-search"],["pInputText","","type","text",1,"lg:w-auto","w-full",3,"ngModel","placeholder","input","ngModelChange"],[1,"w-full","md:w-auto"],["type","button","pButton","","pRipple","","icon","pi pi-chevron-down","iconPos","left",1,"ml-0","md:ml-2","w-full","md:w-auto","mb-2","md:mb-0",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-plus","iconPos","left",1,"p-button-success","ml-0","md:ml-2","w-full","md:w-auto",3,"label","click"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[1,"show-on-hover-parent",3,"pContextMenuRow"],[3,"value"],[4,"ngFor","ngForOf"],[3,"value","key","outputType","options","object","changeRequest"],[4,"ngIf"],[1,"absolute","show-on-hover","pos-top10","pos-right10"],["pButton","","pRipple","","icon","pi pi-pencil","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-clone","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info","ml-2",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","left",1,"p-button","p-button-sm","p-button-rounded","p-button-danger","ml-2",3,"pTooltip","click"],[3,"colSpan"],[4,"ngIf","ngIfElse"],["emptyMessage",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"p-table",0),t.NdJ("selectionChange",function(l){return o.itemsSelected=l})("contextMenuSelectionChange",function(l){return o.itemSelected=l})("onLazyLoad",function(l){return o.getData(l)}),t.YNc(1,ae,10,10,"ng-template",1),t.YNc(2,de,4,1,"ng-template",2),t.YNc(3,ge,4,3,"ng-template",3),t.YNc(4,he,5,3,"ng-template",4),t.qZA(),t._UZ(5,"p-menu",5,6)(7,"p-contextMenu",7,8)),2&e){const n=t.MAs(8);t.Q6J("selection",o.itemsSelected)("contextMenuSelection",o.itemSelected)("contextMenu",n)("sortField",o.queryOptions.sort_by)("sortOrder","asc"==o.queryOptions.sort_dir?1:-1)("lazy",!0)("paginator",!0)("showJumpToPageDropdown",!0)("value",o.items)("columns",o.cols)("rows",o.queryOptions.limit)("totalRecords",o.itemsTotal)("loading",o.loading),t.xp6(5),t.Q6J("popup",!0)("model",o.menuItems),t.xp6(2),t.Q6J("model",o.contextMenuItems)}},directives:[u.iA,f.jx,s.Fj,Z.o,s.JJ,s.On,C.Hq,y.H,u.Mo,_.sg,u.lQ,u.fz,u.zi,u.UA,U.g,_.O5,x.u,H.v2,P.xV],pipes:[g.X$],encapsulation:2}),i})();class Ce{constructor(r,e,o,n,l,p,a){this.id=r,this.name=e,this.title=o,this.description=n,this.isActive=l,this.inputProperties=p,this.outputProperties=a}}var it=c(3787);function ye(i,r){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"th"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"th"),t.qZA()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,3,"SYSTEM_NAME")),t.xp6(3),t.Oqu(t.lcZ(6,5,"NAME")),t.xp6(3),t.Oqu(t.lcZ(9,7,"DEFAULT_VALUE")))}function be(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"td"),t._UZ(2,"input",33),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"input",34),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"input",35),t.qZA(),t.TgZ(7,"td")(8,"button",36),t.NdJ("click",function(){const l=t.CHM(e).rowIndex;return t.oxw().arrayFieldDelete("inputProperties",l)}),t.ALo(9,"translate"),t.qZA()()()}2&i&&(t.Q6J("formGroupName",r.rowIndex+""),t.xp6(8),t.Q6J("pTooltip",t.lcZ(9,2,"DELETE")))}function Ze(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td",37)(2,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw().arrayFieldAdd("inputProperties")}),t.ALo(3,"translate"),t.qZA()()()}2&i&&(t.xp6(2),t.Q6J("label",t.lcZ(3,1,"ADD")))}function xe(i,r){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"th"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t._UZ(10,"th"),t.qZA()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,3,"SYSTEM_NAME")),t.xp6(3),t.Oqu(t.lcZ(6,5,"NAME")),t.xp6(3),t.Oqu(t.lcZ(9,7,"DEFAULT_VALUE")))}function Ae(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"td"),t._UZ(2,"input",33),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"input",34),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"input",35),t.qZA(),t.TgZ(7,"td")(8,"button",36),t.NdJ("click",function(){const l=t.CHM(e).rowIndex;return t.oxw().arrayFieldDelete("outputProperties",l)}),t.ALo(9,"translate"),t.qZA()()()}2&i&&(t.Q6J("formGroupName",r.rowIndex+""),t.xp6(8),t.Q6J("pTooltip",t.lcZ(9,2,"DELETE")))}function ve(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td",37)(2,"button",38),t.NdJ("click",function(){return t.CHM(e),t.oxw().arrayFieldAdd("outputProperties")}),t.ALo(3,"translate"),t.qZA()()()}2&i&&(t.xp6(2),t.Q6J("label",t.lcZ(3,1,"ADD")))}function Me(i,r){if(1&i&&t._UZ(0,"p-message",39),2&i){const e=t.oxw();t.Q6J("text",e.errorMessage)}}function Ie(i,r){1&i&&(t.TgZ(0,"div",40),t._UZ(1,"p-progressSpinner"),t.qZA())}let we=(()=>{class i extends w.P{constructor(e,o,n,l){super(e,o,n,l),this.ref=e,this.config=o,this.systemNameService=n,this.dataService=l,this.model=new Ce(0,"","","",!0,[],[]),this.form=new s.cw({id:new s.NI("",[]),title:new s.NI("",[s.kI.required]),name:new s.NI("",[s.kI.required,s.kI.pattern("[A-Za-z0-9_-]+")]),description:new s.NI("",[]),isActive:new s.NI("",[]),inputProperties:new s.Oe([]),outputProperties:new s.Oe([])}),this.arrayFieldsData={inputProperties:{name:{validators:[s.kI.required]},title:{validators:[s.kI.required]},default_value:{validators:[]}},outputProperties:{name:{validators:[s.kI.required]},title:{validators:[s.kI.required]},default_value:{validators:[]}}}}ngOnInit(){super.ngOnInit(),this.createArrayFieldsProperty("inputProperties"),this.createArrayFieldsProperty("outputProperties")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.E7),t.Y36(m.S),t.Y36(N.U),t.Y36(J))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-field-type"]],features:[t._Bn([]),t.qOj],decls:59,vars:35,consts:[[3,"formGroup"],["formEl",""],[1,"grid"],[1,"col-12","md:col-6"],[1,"mb-2"],["for","fieldTitle",1,"block","mb-2"],["type","text","id","fieldTitle","pInputText","","formControlName","title",1,"w-full"],["for","fieldSystemName",1,"block","mb-2"],[1,"p-inputgroup","mb-2"],["type","text","id","fieldSystemName","pInputText","","formControlName","name",1,"w-full"],["type","button","pButton","","pRipple","","icon","pi pi-refresh","styleClass","p-button-info","tooltipPosition","bottom",3,"pTooltip","click"],["for","fieldDescription",1,"block","mb-2"],["id","fieldDescription","rows","5","pInputTextarea","","formControlName","description",1,"w-full","mb-2"],[1,"grid","mb-3"],["inputId","fieldActive","styleClass","mr-2 vertical-align-middle","formControlName","isActive"],["for","fieldActive",1,"vertical-align-middle"],[3,"header"],["formArrayName","inputProperties"],["styleClass","p-datatable-sm",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["formArrayName","outputProperties"],["role","separator",1,"p-divider","p-component","p-divider-horizontal","p-divider-solid","p-divider-left"],[1,"p-divider-content"],["styleClass","block w-full text-left mb-3","severity","error",3,"text",4,"ngIf"],[1,"grid","mt-2"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-success","p-button-raised","w-full",3,"label","click"],[1,"col-12","md:col-3"],["pButton","","pRipple","","type","button","icon","pi pi-check",1,"p-button-warning","p-button-raised","w-full",3,"label","click"],["pButton","","pRipple","","type","button",1,"p-button-secondary","p-button-raised","w-full",3,"label","click"],["class","loading-overlay",4,"ngIf"],[3,"formGroupName"],["type","text","pInputText","","formControlName","name",1,"p-inputtext-sm","w-full"],["type","text","pInputText","","formControlName","title",1,"p-inputtext-sm","w-full"],["type","text","pInputText","","formControlName","default_value",1,"p-inputtext-sm","w-full"],["pButton","","pRipple","","type","button","icon","pi pi-times","tooltipPosition","bottom",1,"p-button-raised","p-button-rounded","p-button-secondary","p-button-sm",3,"pTooltip","click"],["colspan","4",1,"text-center"],["type","button","pButton","","pRipple","","icon","pi pi-plus",1,"p-button-secondary","p-button-sm",3,"label","click"],["styleClass","block w-full text-left mb-3","severity","error",3,"text"],[1,"loading-overlay"]],template:function(e,o){1&e&&(t.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"label",5),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",6),t.qZA(),t.TgZ(10,"div",4)(11,"label",7),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",8),t._UZ(15,"input",9),t.TgZ(16,"button",10),t.NdJ("click",function(l){return o.generateName(o.model,l)}),t.ALo(17,"translate"),t.qZA()()()(),t.TgZ(18,"div",3)(19,"label",11),t._uU(20),t.ALo(21,"translate"),t.qZA(),t._UZ(22,"textarea",12),t.qZA()(),t.TgZ(23,"div",13)(24,"div",3)(25,"div"),t._UZ(26,"p-inputSwitch",14),t.TgZ(27,"label",15),t._uU(28),t.ALo(29,"translate"),t.qZA()()()(),t.TgZ(30,"p-accordion")(31,"p-accordionTab",16),t.ALo(32,"translate"),t.TgZ(33,"div",17)(34,"p-table",18),t.YNc(35,ye,11,9,"ng-template",19),t.YNc(36,be,10,4,"ng-template",20),t.YNc(37,Ze,4,3,"ng-template",21),t.qZA()()(),t.TgZ(38,"p-accordionTab",16),t.ALo(39,"translate"),t.TgZ(40,"div",22)(41,"p-table",18),t.YNc(42,xe,11,9,"ng-template",19),t.YNc(43,Ae,10,4,"ng-template",20),t.YNc(44,ve,4,3,"ng-template",21),t.qZA()()()(),t.TgZ(45,"div",23),t._UZ(46,"div",24),t.qZA(),t.YNc(47,Me,1,1,"p-message",25),t.TgZ(48,"div",26)(49,"div",3)(50,"button",27),t.NdJ("click",function(l){return o.saveData(!0,l)}),t.ALo(51,"translate"),t.qZA()(),t.TgZ(52,"div",28)(53,"button",29),t.NdJ("click",function(l){return o.saveData(!1,l)}),t.ALo(54,"translate"),t.qZA()(),t.TgZ(55,"div",28)(56,"button",30),t.NdJ("click",function(l){return o.closeModal(l)}),t.ALo(57,"translate"),t.qZA()()()()(),t.YNc(58,Ie,2,0,"div",31)),2&e&&(t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(6),t.hij(" ",t.lcZ(8,15,"TITLE")," "),t.xp6(5),t.hij(" ",t.lcZ(13,17,"SYSTEM_NAME")," "),t.xp6(4),t.Q6J("pTooltip",t.lcZ(17,19,"GENERATE")),t.xp6(4),t.hij(" ",t.lcZ(21,21,"DESCRIPTION")," "),t.xp6(8),t.hij(" ",t.lcZ(29,23,"ACTIVE")," "),t.xp6(3),t.Q6J("header",t.lcZ(32,25,"INPUT_OPTIONS")),t.xp6(3),t.Q6J("value",o.arrayFields.inputProperties.controls),t.xp6(4),t.Q6J("header",t.lcZ(39,27,"OUTPUT_OPTIONS")),t.xp6(3),t.Q6J("value",o.arrayFields.outputProperties.controls),t.xp6(6),t.Q6J("ngIf",o.errorMessage),t.xp6(3),t.Q6J("label",t.lcZ(51,29,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("label",t.lcZ(54,31,"SAVE")),t.xp6(3),t.Q6J("label",t.lcZ(57,33,"CLOSE")),t.xp6(2),t.Q6J("ngIf",o.loading))},directives:[s._Y,s.JL,s.sg,s.Fj,Z.o,s.JJ,s.u,C.Hq,y.H,x.u,q.g,S.Ql,it.UQ,it.US,s.CE,u.iA,f.jx,s.x0,_.O5,L.q,F.G],pipes:[g.X$],encapsulation:2}),i})();function Ne(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10),t._UZ(2,"i",11),t.TgZ(3,"input",12),t.NdJ("input",function(){return t.CHM(e),t.oxw().onInputSearch()})("ngModelChange",function(n){return t.CHM(e),t.oxw().queryOptions.search_word=n}),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",13)(6,"button",14),t.NdJ("click",function(n){return t.CHM(e),t.oxw(),t.MAs(6).toggle(n)}),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",15),t.NdJ("click",function(n){return t.CHM(e),t.oxw().openModal(null,n)}),t.ALo(9,"translate"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.MGl("placeholder","",t.lcZ(4,4,"SEARCH"),"..."),t.Q6J("ngModel",e.queryOptions.search_word),t.xp6(3),t.Q6J("label",t.lcZ(7,6,"ACTIONS")),t.xp6(2),t.Q6J("label",t.lcZ(9,8,"ADD"))}}function Se(i,r){if(1&i&&(t.TgZ(0,"th",17),t._uU(1),t.ALo(2,"translate"),t._UZ(3,"p-sortIcon",18),t.qZA()),2&i){const e=r.$implicit;t.Q6J("pSortableColumn",e.field),t.xp6(1),t.hij(" ",t.lcZ(2,3,e.header)," "),t.xp6(2),t.Q6J("field",e.field)}}function Le(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"th"),t._UZ(2,"p-tableHeaderCheckbox"),t.qZA(),t.YNc(3,Se,4,5,"th",16),t.qZA()),2&i){const e=r.$implicit;t.xp6(3),t.Q6J("ngForOf",e)}}function Fe(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",24)(2,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw().openModal(n)}),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",26),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw(2).$implicit;return t.oxw().openModal(l,n,"",!0)}),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",27),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw().deleteItem(n)}),t.ALo(7,"translate"),t.qZA()(),t.BQk()}2&i&&(t.xp6(2),t.Q6J("pTooltip",t.lcZ(3,3,"EDIT")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(5,5,"CLONE")),t.xp6(2),t.Q6J("pTooltip",t.lcZ(7,7,"DELETE")))}function Je(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td")(1,"app-render-output",22),t.NdJ("changeRequest",function(n){return t.CHM(e),t.oxw(2).onOptionUpdate(n)}),t.qZA(),t.YNc(2,Fe,8,9,"ng-container",23),t.qZA()}if(2&i){const e=r.$implicit,o=r.index,n=t.oxw(),l=n.$implicit,p=n.columns;t.xp6(1),t.Q6J("value",l[e.field])("key",e.field)("outputType",e.outputType)("options",e.outputProperties)("object",l),t.xp6(1),t.Q6J("ngIf",p.length==o+1)}}function Oe(i,r){if(1&i&&(t.TgZ(0,"tr",19)(1,"td"),t._UZ(2,"p-tableCheckbox",20),t.qZA(),t.YNc(3,Je,3,6,"td",21),t.qZA()),2&i){const e=r.$implicit,o=r.columns;t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("value",e),t.xp6(1),t.Q6J("ngForOf",o)}}function Ee(i,r){1&i&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NOTHING_FOUND"),". "))}function qe(i,r){1&i&&(t._uU(0),t.ALo(1,"translate")),2&i&&t.hij(" ",t.lcZ(1,1,"EMPTY"),". ")}function ke(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td",28),t.YNc(2,Ee,3,3,"ng-container",29),t.YNc(3,qe,2,3,"ng-template",null,30,t.W1O),t.qZA()()),2&i){const e=r.$implicit,o=t.MAs(4),n=t.oxw();t.xp6(1),t.Q6J("colSpan",e.length+1),t.xp6(1),t.Q6J("ngIf",n.queryOptions.search_word)("ngIfElse",o)}}const Ue=[{path:"",component:rt,children:[{path:"",redirectTo:"category/"},{path:"category",redirectTo:"category/"},{path:"category/:categoryId",component:Pt},{path:"content_types",component:Te},{path:"field_types",component:(()=>{class i extends Q.p{constructor(e,o,n,l,p,a){super(e,o,n,l,p,a),this.dialogService=e,this.contentTypesService=o,this.dataService=n,this.translateService=l,this.messageService=p,this.confirmationService=a,this.queryOptions=new O.J(1,12,"name","desc"),this.items=[],this.cols=[{field:"id",header:"ID",outputType:"text-center",outputProperties:{}},{field:"title",header:"TITLE",outputType:"text",outputProperties:{}},{field:"name",header:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{field:"isActive",header:"STATUS",outputType:"boolean",outputProperties:{}}]}ngOnInit(){super.ngOnInit(),this.menuItems.push({label:this.getLangString("DISABLE_ENABLE"),icon:"pi pi-times-circle",command:()=>{this.blockSelected()}})}getModalComponent(){return we}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.xA),t.Y36(T.s),t.Y36(J),t.Y36(g.sK),t.Y36(f.ez),t.Y36(f.YP))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-catalog-category"]],features:[t._Bn([m.xA,J]),t.qOj],decls:9,vars:16,consts:[["styleClass","p-datatable-striped","dataKey","id",3,"selection","contextMenuSelection","contextMenu","sortField","sortOrder","lazy","paginator","showJumpToPageDropdown","value","columns","rows","totalRecords","loading","selectionChange","contextMenuSelectionChange","onLazyLoad"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["styleClass","p-menu-nowrap",3,"popup","model"],["menu",""],[3,"model"],["contextMenu",""],[1,"flex","md:justify-content-between","flex-wrap"],[1,"p-input-icon-left","w-full","md:w-auto","mb-2","md:mb-0"],[1,"pi","pi-search"],["pInputText","","type","text",1,"lg:w-auto","w-full",3,"ngModel","placeholder","input","ngModelChange"],[1,"w-full","md:w-auto"],["type","button","pButton","","pRipple","","icon","pi pi-chevron-down","iconPos","left",1,"ml-0","md:ml-2","w-full","md:w-auto","mb-2","md:mb-0",3,"label","click"],["type","button","pButton","","pRipple","","icon","pi pi-plus","iconPos","left",1,"p-button-success","ml-0","md:ml-2","w-full","md:w-auto",3,"label","click"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[1,"show-on-hover-parent",3,"pContextMenuRow"],[3,"value"],[4,"ngFor","ngForOf"],[3,"value","key","outputType","options","object","changeRequest"],[4,"ngIf"],[1,"absolute","show-on-hover","pos-top10","pos-right10"],["pButton","","pRipple","","icon","pi pi-pencil","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-clone","tooltipPosition","bottom",1,"p-button","p-button-sm","p-button-rounded","p-button-info","ml-2",3,"pTooltip","click"],["pButton","","pRipple","","icon","pi pi-trash","tooltipPosition","left",1,"p-button","p-button-sm","p-button-rounded","p-button-danger","ml-2",3,"pTooltip","click"],[3,"colSpan"],[4,"ngIf","ngIfElse"],["emptyMessage",""]],template:function(e,o){if(1&e&&(t.TgZ(0,"p-table",0),t.NdJ("selectionChange",function(l){return o.itemsSelected=l})("contextMenuSelectionChange",function(l){return o.itemSelected=l})("onLazyLoad",function(l){return o.getData(l)}),t.YNc(1,Ne,10,10,"ng-template",1),t.YNc(2,Le,4,1,"ng-template",2),t.YNc(3,Oe,4,3,"ng-template",3),t.YNc(4,ke,5,3,"ng-template",4),t.qZA(),t._UZ(5,"p-menu",5,6)(7,"p-contextMenu",7,8)),2&e){const n=t.MAs(8);t.Q6J("selection",o.itemsSelected)("contextMenuSelection",o.itemSelected)("contextMenu",n)("sortField",o.queryOptions.sort_by)("sortOrder","asc"==o.queryOptions.sort_dir?1:-1)("lazy",!0)("paginator",!0)("showJumpToPageDropdown",!0)("value",o.items)("columns",o.cols)("rows",o.queryOptions.limit)("totalRecords",o.itemsTotal)("loading",o.loading),t.xp6(5),t.Q6J("popup",!0)("model",o.menuItems),t.xp6(2),t.Q6J("model",o.contextMenuItems)}},directives:[u.iA,f.jx,s.Fj,Z.o,s.JJ,s.On,C.Hq,y.H,u.Mo,_.sg,u.lQ,u.fz,u.zi,u.UA,U.g,_.O5,x.u,H.v2,P.xV],pipes:[g.X$],encapsulation:2}),i})()}]}];let Pe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[b.Bz.forChild(Ue)],b.Bz]}),i})(),Qe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[],imports:[[_.ez,lt.m,Pe]]}),i})()}}]);