"use strict";(self.webpackChunkshk_app=self.webpackChunkshk_app||[]).push([["src_app_catalog_catalog_module_ts"],{88232:function(e,t,i){i.r(t),i.d(t,{CatalogModule:function(){return st}});var o=i(38583),n=i(16964),s=i(5727),r=i(37716),l=i(29790);const a=function(){return["field_types"]},d=function(){return["content_types"]};let c=(()=>{class e{constructor(){}ngOnInit(){}}return e.title="CATALOG",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-catalog"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ms-md-2",3,"routerLink"],[1,"icon-toggle"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-box"],[1,"card"],[1,"card-body"],[1,"float-md-start","mt-4","mt-md-0"],[1,"m-0"],[1,"icon-layers"],[1,"clearfix"],[1,"min-height400"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"a",2),r._UZ(3,"i",3),r._uU(4," \xa0 "),r.TgZ(5,"span"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.TgZ(8,"a",4),r._UZ(9,"i",5),r._uU(10," \xa0 "),r.TgZ(11,"span"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(14,"div",6),r.TgZ(15,"div",7),r.TgZ(16,"div",8),r.TgZ(17,"h3",9),r._UZ(18,"i",10),r._uU(19," \xa0 "),r.TgZ(20,"span"),r._uU(21),r.ALo(22,"translate"),r.qZA(),r.qZA(),r.qZA(),r._UZ(23,"div",11),r._UZ(24,"hr"),r.TgZ(25,"div",12),r._UZ(26,"router-outlet"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("routerLink",r.DdM(11,a)),r.xp6(4),r.Oqu(r.lcZ(7,5,"FIELD_TYPES")),r.xp6(2),r.Q6J("routerLink",r.DdM(12,d)),r.xp6(4),r.Oqu(r.lcZ(13,7,"CONTENT_TYPES")),r.xp6(9),r.Oqu(r.lcZ(22,9,"CATALOG")))},directives:[s.yS,s.Od,s.lC],pipes:[l.X$],encapsulation:2}),e})();var u=i(23815);class p{constructor(e,t,i,o,n,s,r,l,a,d,c,u){this.id=e,this.isFolder=t,this.parentId=i,this.name=o,this.title=n,this.description=s,this.contentTypeName=r,this.isActive=l,this.clearCache=a,this.menuIndex=d,this.translations=c,this.image=u,void 0===this.clearCache&&(this.clearCache=!1),void 0===this.translations&&(this.translations={})}static createTree(e,t=null,i=!0){if(0===e.length)return null;if(!t){const o=(0,u.findIndex)(e,{name:"root"});t=o>-1?p.toTreeNode(e[o],i):{id:0,parentId:0,label:"",expanded:!0,children:[]}}t.children=[];const o=e.filter(e=>0!==e.id&&e.parentId===t.id);return o.length>0&&(o.forEach(e=>{t.children.push(p.toTreeNode(e,i))}),t.children.forEach(t=>{p.createTree(e,t,i)})),0===t.children.length&&(t.children=null),t}static getCurrentNode(e,t){if(!t)return null;if(t.id===e)return t;if(t.children){let i=null;for(let o=0;null==i&&o<t.children.length;o++)i=p.getCurrentNode(e,t.children[o]);return i}return null}static toTreeNode(e,t=!0){return{id:e.id,label:e.title,parentId:e.parentId||0,expanded:t}}}var m=i(3677),g=i(3679);class h{constructor(e,t,i,o,n,s,r,l,a){this.id=e,this.name=t,this.title=i,this.description=o,this.collection=n,this.fields=s,this.groups=r,this.isActive=l,this.isCreateByUsersAllowed=a,this.isCreateByUsersAllowed||(this.isCreateByUsersAllowed=!1)}static getSystemFieldName(e){const t=(0,u.findIndex)(e.fields,{inputType:"system_name"});return t>-1?e.fields[t].name:"name"}static getFieldByName(e,t){const i=(0,u.findIndex)(e.fields,{name:t});return i>-1?e.fields[i]:null}}var f=i(39343),Z=i(63124),b=i(64916),T=i(23056),A=i(6887),v=i(91841);let q=(()=>{class e extends A.D{constructor(e){super(e),this.setRequestUrl("/admin/products")}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(v.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),y=(()=>{class e extends A.D{constructor(e){super(e),this.setRequestUrl("/admin/files")}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(v.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();var C=i(71177),x=i(73844),_=i(95047),I=i(89516),E=i(17330);function L(e,t){if(1&e&&(r.TgZ(0,"div",43),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.parentId," ")}}function N(e,t){if(1&e&&(r.ynx(0),r._UZ(1,"app-input-field-renderer",44),r.BQk()),2&e){const e=r.oxw();r.xp6(1),r.Q6J("fields",e.currentContentType.fields)("groups",e.currentContentType.groups)("formErrors",e.formErrors)("validationMessages",e.validationMessages)("model",e.model)("form",e.form)("files",e.files)("localeFieldsAllowed",e.localeFieldsAllowed)("isLocalizationActive",e.localeCurrent!==e.localeDefault)}}function S(e,t){if(1&e&&(r.TgZ(0,"label",50),r._UZ(1,"input",51),r._uU(2),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("value",e),r.xp6(1),r.hij(" ",e," ")}}const O=function(){return{standalone:!0}};function M(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",45),r.TgZ(1,"button",46),r.NdJ("click",function(t){return r.CHM(e),r.oxw().saveTranslations(t)}),r.ALo(2,"translate"),r._UZ(3,"i",47),r.qZA(),r.TgZ(4,"div",48),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().localeCurrent=t})("ngModelChange",function(){return r.CHM(e),r.oxw().onLocaleSwitch()}),r.YNc(5,S,3,2,"label",49),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.s9C("ngbTooltip",r.lcZ(2,5,"SAVE")),r.Q6J("hidden",e.localeCurrent==e.localeDefault),r.xp6(3),r.Q6J("ngModel",e.localeCurrent)("ngModelOptions",r.DdM(7,O)),r.xp6(1),r.Q6J("ngForOf",e.localeList)}}let F=(()=>{class e extends f.D{constructor(e,t,i,o,n,s,r,l,a,d,c){super(e,t,i,o,n,s,r),this.fb=e,this.dataService=t,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=n,this.translateService=s,this.elRef=r,this.contentTypesService=l,this.categoriesService=a,this.filesService=d,this.appSettings=c,this.categories=[],this.contentTypes=[],this.currentContentType=new h(0,"","","","",[],[],!0),this.model={},this.dataLoaded=!1,this.formFields={parentId:{value:0,validators:[g.kI.required],messages:{required:"Category is required."}},isActive:{value:!0,validators:[],messages:{}},clearCache:{value:!0,validators:[],messages:{}}}}ngOnInit(){this.model={id:0,parentId:this.categoryId},this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),this.model.clearCache=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.buildForm(),this.getCategories(),this.getContentType().then(e=>this.itemId?this.getModelData():Promise.reject(""),e=>(this.dataLoaded=!0,this.errorMessage=e.error||"Error.",Promise.reject(""))).then(e=>{this.dataLoaded=!0,this.onAfterGetData(),this.updateForm()},()=>{this.dataLoaded=!0,this.onAfterGetData()})}onAfterGetData(){this.currentContentType.fields.forEach(e=>{["text","textarea","rich_text"].indexOf(e.inputType)>-1&&this.localeFieldsAllowed.push(e.name)}),(!this.model.translations||Array.isArray(this.model.translations))&&(this.model.translations={})}getSystemFieldName(){return h.getSystemFieldName(this.currentContentType)}getCategories(){this.categoriesService.getListPage().subscribe(e=>{this.categories=e.items},e=>{this.errorMessage=e.error||"Error."})}getContentType(){return this.loading=!0,new Promise((e,t)=>{this.contentTypesService.getItemByCategory(this.categoryId).subscribe(t=>{this.currentContentType=t,this.errorMessage="",this.loading=!1,e(t)},e=>{this.errorMessage=e.error||"Error.",this.loading=!1,t(e)})})}updateForm(e){e||(e=(0,u.clone)(this.model));const t=(0,u.map)(this.currentContentType.fields,function(e){return e.name});t.push("id","parentId","previousParentId","isActive","clearCache","translations"),e.clearCache=!0,Object.keys(this.model).forEach(e=>{if(e.indexOf("__")>-1){const i=C._.getFieldBaseName(e);if(i===e)return;const o=C._.getFieldIndexData(this.currentContentType.fields,i);if(-1===o.index)return;const n=(0,u.cloneDeep)(this.currentContentType.fields[o.index]);n.name=e,this.currentContentType.fields.splice(o.index+o.additFieldsCount+1,0,n),t.push(e)}});for(const i in this.form.controls)this.form.controls.hasOwnProperty(i)&&-1===t.indexOf(i)&&this.form.removeControl(i);this.model=(0,u.pick)(e,t)}onChangeContentType(){const e=parseInt(String(this.model.parentId),10),t=(0,u.findIndex)(this.categories,{id:e});-1!==t&&(!this.currentContentType||this.currentContentType.name!==this.categories[t].contentTypeName)&&(this.model.previousParentId=this.categoryId,this.categoryId=this.categories[t].id,this.getContentType())}saveFiles(e){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),t.append("ownerType",this.currentContentType.name),t.append("categoryId",String(this.model.parentId)),t.append("fieldsSort",this.getFieldsSortData().join(",")),this.filesService.postFormData(t).subscribe(()=>{this.closeModal()},e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1})}getErrorsString(){const e=[];return Object.keys(this.form.controls).forEach(t=>{if(this.form.controls[t].invalid&&this.validationMessages[t]){const i=C._.getFieldBaseName(t),o=h.getFieldByName(this.currentContentType,i);if(!o)return;let n="";n=this.formErrors[t]?this.formErrors[t]:`${o.title} - error.`,e.push(n)}}),e.join(" ")}getFormData(){const e=(0,u.cloneDeep)(this.model);for(const t in e)e.hasOwnProperty(t)&&e[t]&&"object"==typeof e[t]&&e[t].dataUrl&&delete e[t].dataUrl;return e.fieldsSort=this.getFieldsSortData(),e}getFieldsSortData(){let e=this.currentContentType.fields.map(e=>e.name);return e=e.filter(e=>{if(!this.model[e]||-1===e.indexOf("__"))return!1;const t=e.split("__");return!isNaN(t[1])}),e}save(e=!1){if(this.submitted=!0,this.errorMessage=null,!this.form.valid)return this.onValueChanged("form"),this.errorMessage=this.getErrorsString(),void(this.submitted=!1);this.loading=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.saveRequest().subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t.id||t._id):(e?this.closeModal():t&&(t.id||t._id)&&(this.model=t,this.model.id=t.id||t._id,this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1}})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(g.qu),r.Y36(q),r.Y36(Z.U),r.Y36(_.Kz),r.Y36(_.xI),r.Y36(l.sK),r.Y36(r.SBq),r.Y36(T.s),r.Y36(b.G),r.Y36(y),r.Y36(x.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-product-modal-content"]],inputs:{categoryId:"categoryId"},features:[r._Bn([q]),r.qOj],decls:69,vars:50,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],[3,"formGroup"],[1,"modal-body","py-0"],[1,"row","mb-2","form-group-message"],[1,"col-md-5"],["for","fieldCategory"],[1,"col-md-7"],["id","fieldCategory","formControlName","parentId",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"row","mb-2"],[1,"col-md-7","ms-md-auto"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-indicator"],[1,"form-check-label",3,"for"],[1,"form-check","mt-2"],["type","checkbox","value","1","name","clearCache","formControlName","clearCache",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"min-height300"],[4,"ngIf"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0",3,"hidden"],["type","button",1,"btn-close",3,"click"],[1,"modal-footer","d-block"],["class","float-end",4,"ngIf"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[3,"fields","groups","formErrors","validationMessages","model","form","files","localeFieldsAllowed","isLocalizationActive"],[1,"float-end"],["type","button","placement","left",1,"btn","btn-success","me-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",1,"btn-check",3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"button",2),r.NdJ("click",function(e){return t.closeModal(e)}),r._UZ(3,"i",3),r.TgZ(4,"span"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.TgZ(7,"button",2),r.NdJ("click",function(e){return t.minimize(e)}),r._UZ(8,"i",4),r.TgZ(9,"span"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",5),r.TgZ(13,"div",6),r.TgZ(14,"div",7),r.TgZ(15,"button",8),r.NdJ("click",function(e){return t.maximize(e)}),r.ALo(16,"translate"),r._UZ(17,"i",9),r.qZA(),r.TgZ(18,"button",10),r.NdJ("click",function(e){return t.closeModal(e)}),r.ALo(19,"translate"),r._UZ(20,"i",11),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"h4",12),r._uU(22),r.qZA(),r.qZA(),r.TgZ(23,"form",13),r.TgZ(24,"div",14),r.TgZ(25,"div",15),r.TgZ(26,"div",16),r.TgZ(27,"label",17),r._uU(28),r.ALo(29,"translate"),r.qZA(),r.qZA(),r.TgZ(30,"div",18),r.TgZ(31,"app-select-parent-dropdown",19),r.NdJ("ngModelChange",function(e){return t.model.parentId=e})("ngModelChange",function(){return t.onChangeContentType()}),r.qZA(),r.YNc(32,L,2,1,"div",20),r.qZA(),r.qZA(),r.TgZ(33,"div",21),r.TgZ(34,"div",22),r.TgZ(35,"div",23),r.TgZ(36,"div",24),r.TgZ(37,"input",25),r.NdJ("ngModelChange",function(e){return t.model.isActive=e}),r.qZA(),r._UZ(38,"span",26),r.TgZ(39,"label",27),r._uU(40),r.ALo(41,"translate"),r.qZA(),r.qZA(),r.TgZ(42,"div",28),r.TgZ(43,"input",29),r.NdJ("ngModelChange",function(e){return t.model.clearCache=e}),r.qZA(),r.TgZ(44,"label",27),r._uU(45),r.ALo(46,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(47,"div",30),r.YNc(48,N,2,9,"ng-container",31),r.qZA(),r.TgZ(49,"div",32),r._uU(50),r.TgZ(51,"button",33),r.NdJ("click",function(){return t.errorMessage=""}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(52,"div",34),r.YNc(53,M,6,8,"div",35),r.TgZ(54,"div",36),r.TgZ(55,"button",37),r.NdJ("click",function(){return t.save(!0)}),r.TgZ(56,"span"),r._uU(57),r.ALo(58,"translate"),r.qZA(),r.qZA(),r.TgZ(59,"div",38),r._UZ(60,"button",39),r.TgZ(61,"div",40),r.TgZ(62,"button",41),r.NdJ("click",function(){return t.save()}),r._uU(63),r.ALo(64,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(65,"button",42),r.NdJ("click",function(e){return t.closeModal(e)}),r.TgZ(66,"span"),r._uU(67),r.ALo(68,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(6,30,"CLOSE")),r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(11,32,"MINIMIZE")),r.xp6(5),r.Q6J("title",r.lcZ(16,34,"EXPAND")),r.xp6(3),r.Q6J("title",r.lcZ(19,36,"CLOSE")),r.xp6(4),r.Oqu(t.modalTitle),r.xp6(1),r.ekj("loading",t.loading),r.Q6J("formGroup",t.form),r.xp6(5),r.Oqu(r.lcZ(29,38,"PARENT_FOLDER")),r.xp6(3),r.Q6J("ngModel",t.model.parentId),r.xp6(1),r.Q6J("ngIf",t.formErrors.parentId),r.xp6(5),r.MGl("id","fieldIsActive",t.uniqueId,""),r.Q6J("ngModel",t.model.isActive),r.xp6(2),r.MGl("for","fieldIsActive",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(41,40,"ACTIVE")),r.xp6(3),r.MGl("id","fieldClearCache",t.uniqueId,""),r.Q6J("ngModel",t.model.clearCache),r.xp6(1),r.MGl("for","fieldClearCache",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(46,42,"CLEAR_FILE_CACHE")),r.xp6(3),r.Q6J("ngIf",t.dataLoaded),r.xp6(1),r.Q6J("hidden",!t.errorMessage),r.xp6(1),r.hij(" ",t.errorMessage," "),r.xp6(3),r.Q6J("ngIf",t.localeList.length>1),r.xp6(2),r.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),r.xp6(2),r.Oqu(r.lcZ(58,44,"SAVE_AND_CLOSE")),r.xp6(3),r.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),r.xp6(3),r.Oqu(r.lcZ(64,46,"SAVE")),r.xp6(4),r.Oqu(r.lcZ(68,48,"CLOSE")))},directives:[g._Y,g.JL,g.sg,I.F,g.JJ,g.u,o.O5,g.Wl,_.jt,_.iD,_.Vi,_.TH,E.u,_._L,_.py,g.On,o.sg,_.mL,_.aB],pipes:[l.X$],encapsulation:2}),e})();var w=i(35930),U=i(79765),k=i(46782),D=i(49093),J=i(90660),R=i(2917),Y=i(67752);function Q(e,t){if(1&e&&(r.TgZ(0,"div",57),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.formErrors.parentId," ")}}function P(e,t){if(1&e&&(r.TgZ(0,"div",23),r.TgZ(1,"div",18),r.TgZ(2,"label",55),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",20),r._UZ(6,"app-select-parent-dropdown",56),r.YNc(7,Q,2,1,"div",22),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.Oqu(r.lcZ(4,5,"PARENT_FOLDER")),r.xp6(3),r.ekj("is-invalid",e.formErrors.parentId),r.Q6J("filterId",e.model.id),r.xp6(1),r.Q6J("ngIf",e.formErrors.parentId)}}function G(e,t){if(1&e&&(r.TgZ(0,"div",57),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.title," ")}}function j(e,t){if(1&e&&(r.TgZ(0,"div",57),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.name," ")}}function B(e,t){if(1&e&&(r.TgZ(0,"option",58),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.name),r.xp6(1),r.Oqu(e.title)}}function V(e,t){if(1&e&&(r.TgZ(0,"div",57),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.contentTypeName," ")}}function $(e,t){if(1&e&&(r.TgZ(0,"div",57),r._uU(1),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.hij(" ",e.formErrors.menuIndex," ")}}function z(e,t){if(1&e&&(r.TgZ(0,"div",23),r.TgZ(1,"div",18),r.TgZ(2,"label",59),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.qZA(),r.TgZ(5,"div",20),r._UZ(6,"input",60),r.YNc(7,$,2,1,"div",22),r.qZA(),r.qZA()),2&e){const e=r.oxw();r.xp6(3),r.hij(" ",r.lcZ(4,4,"MENU_INDEX")," "),r.xp6(3),r.ekj("is-invalid",e.formErrors.menuIndex),r.xp6(1),r.Q6J("ngIf",e.formErrors.menuIndex)}}function H(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",61),r._uU(1),r.TgZ(2,"button",62),r.NdJ("click",function(){return r.CHM(e),r.oxw().errorMessage=""}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.errorMessage," ")}}function K(e,t){if(1&e&&(r.TgZ(0,"label",68),r._UZ(1,"input",69),r._uU(2),r.qZA()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("value",e),r.xp6(1),r.hij(" ",e," ")}}const X=function(){return{standalone:!0}};function W(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",63),r.TgZ(1,"button",64),r.NdJ("click",function(t){return r.CHM(e),r.oxw().saveTranslations(t)}),r.ALo(2,"translate"),r._UZ(3,"i",65),r.qZA(),r.TgZ(4,"div",66),r.NdJ("ngModelChange",function(t){return r.CHM(e),r.oxw().localeCurrent=t})("ngModelChange",function(){return r.CHM(e),r.oxw().onLocaleSwitch()}),r.YNc(5,K,3,2,"label",67),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.s9C("ngbTooltip",r.lcZ(2,5,"SAVE")),r.Q6J("hidden",e.localeCurrent==e.localeDefault),r.xp6(3),r.Q6J("ngModel",e.localeCurrent)("ngModelOptions",r.DdM(7,X)),r.xp6(1),r.Q6J("ngForOf",e.localeList)}}const ee=function(e){return{"no-events":e}},te=function(e,t){return{"is-invalid":e,"border-success":t}},ie=function(e){return{"is-invalid":e}},oe=function(e){return{"border-success":e}},ne=["categoriesDropdown"];function se(e,t){if(1&e){const e=r.EpF();r.ynx(0),r.TgZ(1,"button",9),r.NdJ("click",function(t){return r.CHM(e),r.oxw().expandAll(t)}),r.ALo(2,"translate"),r._UZ(3,"i",17),r.qZA(),r.TgZ(4,"button",18),r.NdJ("click",function(t){return r.CHM(e),r.oxw().collapseAll(t)}),r.ALo(5,"translate"),r._UZ(6,"i",19),r.qZA(),r.BQk()}2&e&&(r.xp6(1),r.s9C("ngbTooltip",r.lcZ(2,2,"EXPAND_ALL")),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(5,4,"COLLAPSE_ALL")))}function re(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().goToRootCategory()}),r.ALo(1,"translate"),r._UZ(2,"i",20),r.qZA()}2&e&&r.s9C("ngbTooltip",r.lcZ(1,1,"OPEN_ROOT_CATEGORY"))}let le=(()=>{class e extends D.B{constructor(e,t,i,o,n,s,r,l,a){super(e,t,i,o,n,s),this.fb=e,this.activeModal=t,this.translateService=i,this.systemNameService=o,this.dataService=n,this.elRef=s,this.filesService=r,this.contentTypesService=l,this.appSettings=a,this.isRoot=!1,this.model=new p(null,!1,0,"","","","",!0),this.contentTypes=[],this.loadingCategories=!1,this.categories=[],this.isCollapsed=!1,this.localeFieldsAllowed=["title","description"],this.files={},this.formFields=[{name:"title",validators:[g.kI.required]},{name:"name",validators:[g.kI.required]},{name:"description",validators:[]},{name:"parentId",validators:[]},{name:"image",validators:[]},{name:"contentTypeName",validators:[]},{name:"menuIndex",validators:[]},{name:"isActive",validators:[]},{name:"clearCache",validators:[]}]}ngOnInit(){this.uniqueId=this.createUniqueId(),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),void 0!==this.itemId&&(this.model.id=this.itemId),this.model.parentId=this.isEditMode?this.currentCategory.parentId:this.currentCategory.id,this.model.contentTypeName=this.currentCategory.contentTypeName,this.isRoot&&(this.model.id=0,this.model.title=this.getLangString("ROOT_FOLDER"),this.model.name="root"),this.getContentTypes(),super.ngOnInit()}ngAfterViewInit(){this.elRef.nativeElement.querySelector("#fieldTitle")&&this.elRef.nativeElement.querySelector("#fieldTitle").focus()}onAfterGetData(){this.model.clearCache=!0,(!this.model.translations||Array.isArray(this.model.translations))&&(this.model.translations={}),super.onAfterGetData()}getContentTypes(){this.contentTypesService.getListPage().subscribe(e=>{this.contentTypes=e.items},e=>this.errorMessage=e)}onCategorySelect(e){this.form.controls.parentId.setValue(e.node.id),this.model.parentId=e.node.id}saveFiles(e){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),t.append("ownerType","category"),this.filesService.postFormData(t).subscribe(()=>{this.closeModal()},e=>{this.errorMessage=e.error||"Error.",this.submitted=!1,this.loading=!1})}generateName(e,t){t&&t.preventDefault();const i=this.getControl(this.form,null,"title").value||"";e.name=this.systemNameService.generateName(i),this.getControl(this.form,null,"name").setValue(e.name)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(g.qu),r.Y36(_.Kz),r.Y36(l.sK),r.Y36(Z.U),r.Y36(b.G),r.Y36(r.SBq),r.Y36(y),r.Y36(T.s),r.Y36(x.d))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-category-modal-content"]],inputs:{currentCategory:"currentCategory",isRoot:"isRoot"},features:[r.qOj],decls:102,vars:84,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],["class","row mb-2 form-group-message",4,"ngIf"],[1,"row","mb-2","show-on-hover-parent","form-group-message"],[1,"col-md-5"],["for","fieldTitle"],[1,"col-md-7"],["type","text","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"row","mb-2","form-group-message"],["for","fieldName"],[1,"input-group",3,"ngClass"],["type","text","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","disabled","click"],[1,"icon-reload"],[1,"row","mb-2","show-on-hover-parent"],["for","fieldDescription"],["type","text","id","fieldDescription","rows","4","name","description","formControlName","description",1,"form-control",3,"ngClass"],[1,"row","mb-2"],["formControlName","image",3,"hasPreviewImage","allowedExtensions","files","filesChange"],["for","fieldContentType"],["id","fieldContentType","name","contentTypeName","formControlName","contentTypeName",1,"form-select"],["value","1",3,"value",4,"ngFor","ngForOf"],[1,"col-md-7","ms-md-auto"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","mb-2"],["type","checkbox","id","fieldIsActive","value","1","name","isActive","formControlName","isActive",1,"form-check-input"],["for","fieldIsActive",1,"form-check-label"],[1,"form-check","m-0"],["type","checkbox","id","fieldClearCache","value","1","name","clearCache","formControlName","clearCache",1,"form-check-input"],["for","fieldClearCache",1,"form-check-label"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],["class","float-end",4,"ngIf"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"disabled","click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["for","fieldParent"],["formControlName","parentId",3,"filterId"],[1,"alert","alert-danger"],["value","1",3,"value"],["for","fieldMenuIndex"],["type","number","id","fieldMenuIndex","name","menuIndex","formControlName","menuIndex",1,"form-control"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"float-end"],["type","button","placement","left",1,"btn","btn-success","me-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",1,"btn-check",3,"value"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"button",2),r.NdJ("click",function(e){return t.closeModal(e)}),r._UZ(3,"i",3),r.TgZ(4,"span"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.TgZ(7,"button",2),r.NdJ("click",function(e){return t.minimize(e)}),r._UZ(8,"i",4),r.TgZ(9,"span"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",5),r.TgZ(13,"div",6),r.TgZ(14,"div",7),r.TgZ(15,"button",8),r.NdJ("click",function(e){return t.maximize(e)}),r.ALo(16,"translate"),r._UZ(17,"i",9),r.qZA(),r.TgZ(18,"button",10),r.NdJ("click",function(e){return t.closeModal(e)}),r.ALo(19,"translate"),r._UZ(20,"i",11),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"h4",12),r._uU(22),r.qZA(),r.qZA(),r.TgZ(23,"form",13,14),r.NdJ("ngSubmit",function(){return t.onSubmit()}),r.TgZ(25,"div",15),r.YNc(26,P,8,7,"div",16),r.TgZ(27,"div",17),r.TgZ(28,"div",18),r.TgZ(29,"label",19),r._uU(30),r.ALo(31,"translate"),r.qZA(),r.qZA(),r.TgZ(32,"div",20),r._UZ(33,"input",21),r.YNc(34,G,2,1,"div",22),r.qZA(),r.qZA(),r.TgZ(35,"div",23),r.TgZ(36,"div",18),r.TgZ(37,"label",24),r._uU(38),r.ALo(39,"translate"),r.qZA(),r.qZA(),r.TgZ(40,"div",20),r.TgZ(41,"div",25),r._UZ(42,"input",26),r.TgZ(43,"button",27),r.NdJ("click",function(){return t.generateName(t.model)}),r.ALo(44,"translate"),r._UZ(45,"i",28),r.qZA(),r.qZA(),r.YNc(46,j,2,1,"div",22),r.qZA(),r.qZA(),r.TgZ(47,"div",29),r.TgZ(48,"div",18),r.TgZ(49,"label",30),r._uU(50),r.ALo(51,"translate"),r.qZA(),r.qZA(),r.TgZ(52,"div",20),r._UZ(53,"textarea",31),r.qZA(),r.qZA(),r.TgZ(54,"div",32),r.TgZ(55,"div",18),r.TgZ(56,"label"),r._uU(57),r.ALo(58,"translate"),r.qZA(),r.qZA(),r.TgZ(59,"div",20),r.TgZ(60,"app-file-widget",33),r.NdJ("filesChange",function(e){return t.files=e}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(61,"div",23),r.TgZ(62,"div",18),r.TgZ(63,"label",34),r._uU(64),r.ALo(65,"translate"),r.qZA(),r.qZA(),r.TgZ(66,"div",20),r.TgZ(67,"select",35),r.YNc(68,B,2,2,"option",36),r.qZA(),r.YNc(69,V,2,1,"div",22),r.qZA(),r.qZA(),r.YNc(70,z,8,6,"div",16),r.TgZ(71,"div",32),r.TgZ(72,"div",37),r.TgZ(73,"div",38),r.TgZ(74,"div",39),r._UZ(75,"input",40),r.TgZ(76,"label",41),r._uU(77),r.ALo(78,"translate"),r.qZA(),r.qZA(),r.TgZ(79,"div",42),r._UZ(80,"input",43),r.TgZ(81,"label",44),r._uU(82),r.ALo(83,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.YNc(84,H,3,1,"div",45),r.qZA(),r.TgZ(85,"div",46),r.YNc(86,W,6,8,"div",47),r.TgZ(87,"div",48),r.TgZ(88,"button",49),r.NdJ("click",function(e){return t.save(!0,e)}),r.TgZ(89,"span"),r._uU(90),r.ALo(91,"translate"),r.qZA(),r.qZA(),r.TgZ(92,"div",50),r._UZ(93,"button",51),r.TgZ(94,"div",52),r.TgZ(95,"button",53),r.NdJ("click",function(e){return t.save(!1,e)}),r._uU(96),r.ALo(97,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(98,"button",54),r.NdJ("click",function(e){return t.closeModal(e)}),r.TgZ(99,"span"),r._uU(100),r.ALo(101,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(6,43,"CLOSE")),r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(11,45,"MINIMIZE")),r.xp6(5),r.Q6J("title",r.lcZ(16,47,"EXPAND")),r.xp6(3),r.Q6J("title",r.lcZ(19,49,"CLOSE")),r.xp6(4),r.Oqu(t.modalTitle),r.xp6(1),r.Q6J("formGroup",t.form)("ngClass",r.VKq(73,ee,t.submitted)),r.xp6(2),r.ekj("loading",t.loading),r.xp6(1),r.Q6J("ngIf",!t.isRoot),r.xp6(4),r.hij(" ",r.lcZ(31,51,"TITLE")," "),r.xp6(3),r.Q6J("ngClass",r.WLB(75,te,t.form.controls.title.touched&&!t.form.controls.title.valid,t.localeCurrent!=t.localeDefault)),r.xp6(1),r.Q6J("ngIf",t.formErrors.title),r.xp6(4),r.hij(" ",r.lcZ(39,53,"SYSTEM_NAME")," "),r.xp6(3),r.Q6J("ngClass",r.VKq(78,ie,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.xp6(1),r.Q6J("ngClass",r.VKq(80,ie,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(44,55,"GENERATE")),r.Q6J("disabled",t.form.controls.name.disabled),r.xp6(3),r.Q6J("ngIf",t.formErrors.name),r.xp6(4),r.hij(" ",r.lcZ(51,57,"DESCRIPTION")," "),r.xp6(3),r.Q6J("ngClass",r.VKq(82,oe,t.localeCurrent!=t.localeDefault)),r.xp6(4),r.hij(" ",r.lcZ(58,59,"IMAGE")," "),r.xp6(3),r.Q6J("hasPreviewImage",!0)("allowedExtensions","image/*")("files",t.files),r.xp6(4),r.hij(" ",r.lcZ(65,61,"CONTENT_TYPE")," "),r.xp6(3),r.ekj("is-invalid",t.formErrors.contentTypeName),r.xp6(1),r.Q6J("ngForOf",t.contentTypes),r.xp6(1),r.Q6J("ngIf",t.formErrors.contentTypeName),r.xp6(1),r.Q6J("ngIf",!t.isRoot),r.xp6(7),r.Oqu(r.lcZ(78,63,"ACTIVE")),r.xp6(5),r.Oqu(r.lcZ(83,65,"CLEAR_FILE_CACHE")),r.xp6(2),r.Q6J("ngIf",t.errorMessage),r.xp6(2),r.Q6J("ngIf",t.localeList.length>1),r.xp6(2),r.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),r.xp6(2),r.Oqu(r.lcZ(91,67,"SAVE_AND_CLOSE")),r.xp6(3),r.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),r.xp6(2),r.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),r.xp6(1),r.hij(" ",r.lcZ(97,69,"SAVE")," "),r.xp6(4),r.Oqu(r.lcZ(101,71,"CLOSE")))},directives:[g._Y,g.JL,g.sg,o.mk,o.O5,g.Fj,g.JJ,g.u,_._L,R.E,g.EJ,o.sg,g.Wl,_.jt,_.iD,_.Vi,_.TH,I.F,g.YN,g.Kr,g.wV,_.py,g.On,_.mL,_.aB],pipes:[l.X$],encapsulation:2}),e})(),ae=(()=>{class e{constructor(e,t,i,o,n){this.router=e,this.route=t,this.modalService=i,this.categoriesService=o,this.translateService=n,this.rootTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",this.changeRequest=new r.vpe,this.currentCategory=new p(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode={id:0},this.categoriesTree=[{id:0,parentId:0,label:"",expanded:!0,children:null}],this.categories=[],this.errorMessage="",this.categoryId=0,this.loading=!1,this.destroyed$=new U.xQ}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}ngOnInit(){this.loading=!0,this.getCategories().then(e=>{this.loading=!1,this.route.paramMap.pipe((0,k.R)(this.destroyed$)).subscribe(e=>{this.categoryId=e.get("categoryId")?parseInt(e.get("categoryId"),10):0,this.selectCurrent()})})}selectCurrent(){if(this.currentCategory.id===this.categoryId)return;const e=(0,u.findIndex)(this.categories,{id:this.categoryId});e>-1?(this.currentCategory=(0,u.cloneDeep)(this.categories[e]),this.changeRequest.emit(this.currentCategory)):this.openRootCategory(),this.currentCategoryNode=p.getCurrentNode(this.currentCategory.id,this.categoriesTree[0])}getCategories(){return new Promise((e,t)=>{this.categoriesService.getListPage(new w.J("menuIndex,title","asc",1)).subscribe(t=>{t.items&&t.items.length>0&&(this.categories=t.items,this.categoriesTree=[p.createTree(t.items)]),e(t.items)},e=>{this.errorMessage=e,t()})})}openModalCategory(e,t=!1){this.categoriesDropdown.nativeElement.previousSibling.classList.remove("dropdown-toggle-hover"),setTimeout(()=>{this.categoriesDropdown.nativeElement.previousSibling.classList.add("dropdown-toggle-hover")},1);const i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const e=window.document.getElementById(i),t=e.previousElementSibling;return e.classList.add("d-block"),e.classList.remove("modal-minimized"),void t.classList.remove("d-none")}const o=0===e||null===e,n=void 0!==e&&!t;this.modalRef=this.modalService.open(le,{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.modalRef.componentInstance.modalTitle=n?this.getLangString("CATEGORY")+(e?` #${e}`:""):this.getLangString("ADD_NEW_CATEGORY"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.currentCategory=this.currentCategory,this.modalRef.componentInstance.isRoot=o,this.modalRef.componentInstance.isEditMode=n,this.modalRef.result.then(e=>{this.destroyed$.isStopped||(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1}))},e=>{this.destroyed$.isStopped||(e&&["submit","updated"].indexOf(e)>-1&&(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1})),this.loading=!1)})}getModalElementId(e){return["modal","category",e||0].join("-")}deleteCategoryItemConfirm(e){const t=(0,u.findIndex)(this.categories,{id:e});-1!==t&&(this.modalRef=this.modalService.open(J.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE_CATEGORY")+` "${this.categories[t].title}"?`,this.modalRef.result.then(t=>{"accept"===t&&this.deleteCategoryItem(e)},e=>{}))}deleteCategoryItem(e){this.loading=!0,this.categoriesService.deleteItem(e).subscribe(e=>{this.categoryId=0,this.getCategories().then(()=>{this.goToRootCategory(),this.loading=!1})},e=>{e.error&&(this.errorMessage=e.error),this.loading=!1})}openCategory(e){this.router.navigate(["/catalog/category",e.node.id])}goToRootCategory(){this.router.navigate(["/catalog/category",""])}openRootCategory(){this.currentCategory=new p(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode=this.categoriesTree[0],this.changeRequest.emit(this.currentCategory)}copyCategory(){this.openModalCategory(this.currentCategory.id,!0)}expandAll(e){e&&e.preventDefault(),this.categoriesTree.forEach(e=>{this.expandRecursive(e,!0)})}collapseAll(e){e&&e.preventDefault(),this.categoriesTree.forEach(e=>{this.expandRecursive(e,!1)})}expandRecursive(e,t){e.expanded=t,e.children&&e.children.forEach(e=>{this.expandRecursive(e,t)})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.F0),r.Y36(s.gz),r.Y36(_.FF),r.Y36(b.G),r.Y36(l.sK))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-categories-menu"]],viewQuery:function(e,t){if(1&e&&r.Gf(ne,7),2&e){let e;r.iGM(e=r.CRH())&&(t.categoriesDropdown=e.first)}},inputs:{rootTitle:"rootTitle"},outputs:{changeRequest:"changeRequest"},decls:26,vars:26,consts:[[1,"d-block","d-md-inline-block","dropdown"],[1,"btn","btn-secondary","dropdown-toggle","dropdown-toggle-hover","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],[1,"icon-folder","me-1"],[1,"dropdown-menu","main-menu-container","py-3","shadow"],["categoriesDropdown",""],[1,"px-3","pb-3"],[1,"float-end"],[4,"ngIf"],["type","button","class","btn btn-sm btn-secondary me-2",3,"ngbTooltip","click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-secondary","me-2",3,"ngbTooltip","click"],[1,"icon-plus"],[1,"icon-pencil"],["type","button",1,"btn","btn-sm","btn-secondary","me-2",3,"ngbTooltip","hidden","click"],[1,"icon-stack"],[1,"icon-cross"],[1,"px-3","max-height400"],[3,"value","emptyMessage","selectionMode","selection","filter","onNodeSelect"],[1,"pi","pi-angle-double-down"],["type","button",1,"btn","btn-sm","btn-secondary",3,"ngbTooltip","click"],[1,"pi","pi-angle-double-up"],[1,"icon-home"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"button",1),r._UZ(2,"i",2),r._uU(3),r.qZA(),r.TgZ(4,"div",3,4),r.TgZ(6,"div"),r.TgZ(7,"div",5),r.TgZ(8,"div",6),r.YNc(9,se,7,6,"ng-container",7),r.qZA(),r.YNc(10,re,3,3,"button",8),r.TgZ(11,"button",9),r.NdJ("click",function(){return t.openModalCategory()}),r.ALo(12,"translate"),r._UZ(13,"i",10),r.qZA(),r.TgZ(14,"button",9),r.NdJ("click",function(){return t.openModalCategory(t.currentCategory.id)}),r.ALo(15,"translate"),r._UZ(16,"i",11),r.qZA(),r.TgZ(17,"button",12),r.NdJ("click",function(){return t.copyCategory()}),r.ALo(18,"translate"),r._UZ(19,"i",13),r.qZA(),r.TgZ(20,"button",12),r.NdJ("click",function(){return t.deleteCategoryItemConfirm(t.currentCategory.id)}),r.ALo(21,"translate"),r._UZ(22,"i",14),r.qZA(),r.qZA(),r.TgZ(23,"div",15),r.TgZ(24,"p-tree",16),r.NdJ("onNodeSelect",function(e){return t.openCategory(e)}),r.ALo(25,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(3),r.hij(" ",t.currentCategory.title," "),r.xp6(3),r.ekj("loading",t.loading),r.xp6(3),r.Q6J("ngIf",t.categoriesTree[0].children),r.xp6(1),r.Q6J("ngIf",t.currentCategory.id>0),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(12,16,"ADD_NEW_CATEGORY")),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(15,18,"EDIT_CATEGORY")),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(18,20,"COPY_CATEGORY")),r.Q6J("hidden",!t.currentCategory.id),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(21,22,"DELETE_CATEGORY")),r.Q6J("hidden",!t.currentCategory.id),r.xp6(4),r.Q6J("value",t.categoriesTree[0].children)("emptyMessage",r.lcZ(25,24,"NO_CATEGORIES"))("selectionMode","single")("selection",t.currentCategoryNode)("filter",!!t.categoriesTree[0].children))},directives:[o.O5,_._L,Y.mp],pipes:[l.X$],encapsulation:2}),e})();var de=i(53332);const ce=function(e){return{"form-control-search-clear":e}};let ue=(()=>{class e extends m.U{constructor(e,t,i,o,n){super(e,t,i,o),this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=o,this.contentTypesService=n,this.queryOptions=new w.J("id","desc",1,10,0,0),this.tableFields=[]}ngOnInit(){}updateTableConfig(){!this.currentContentType||(this.tableFields=[],this.currentContentType.fields.forEach(e=>{e.showInTable&&this.tableFields.push({name:e.name,sortName:e.name,title:e.title,outputType:e.outputType,outputProperties:e.outputProperties})}),this.tableFields.unshift({name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}}),this.tableFields.push({name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}))}getModalContent(){return F}getContentType(){return this.contentTypesService.getItemByName(this.currentCategory.contentTypeName)}openCategory(e){if(this.currentCategory=(0,u.clone)(e),!this.currentCategory.contentTypeName)return this.items=[],this.tableFields=[],void(this.currentCategory.id=0);this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.loading=!0,this.queryOptions.page=1,this.getContentType().subscribe(e=>{this.currentContentType=e,this.loading=!1,this.updateTableConfig(),this.getList()},()=>{this.items=[],this.tableFields=[],this.currentCategory.id=0})}openRootCategory(){this.currentCategory=new p(0,!1,0,"root","","","",!0),this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.getList()}setModalInputs(e,t=!1,i=""){const o=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=o?`${this.getLangString("PAGE")} #${e}`:this.getLangString("ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=o;const n=this.items.findIndex(t=>t.id===e);this.modalRef.componentInstance.categoryId=n>-1?this.items[n].parentId:this.currentCategory.id}getModalElementId(e){return["modal","product",e||0].join("-")}}return e.title="CATEGORY",e.\u0275fac=function(t){return new(t||e)(r.Y36(q),r.Y36(_.Kz),r.Y36(_.FF),r.Y36(l.sK),r.Y36(T.s))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-catalog-category"]],features:[r._Bn([q]),r.qOj],decls:30,vars:25,consts:[[1,"mb-3"],[1,"float-md-start"],[3,"changeRequest"],[1,"form-control-search","d-block","d-md-inline-block","ms-0","ms-md-3","mb-2","mb-lg-0",3,"ngClass"],["type","text",1,"form-control","min-width250",3,"placeholder","ngModel","ngModelChange"],[3,"click"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div"),r.TgZ(2,"div",1),r.TgZ(3,"app-categories-menu",2),r.NdJ("changeRequest",function(e){return t.openCategory(e)}),r.qZA(),r.TgZ(4,"div",3),r.TgZ(5,"input",4),r.NdJ("ngModelChange",function(e){return t.queryOptions.search_word=e})("ngModelChange",function(){return t.onSearchWordUpdate()}),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"span",5),r.NdJ("click",function(){return t.onSearchWordUpdate("")}),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",6),r.TgZ(9,"div",7),r.TgZ(10,"button",8),r.TgZ(11,"span"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.TgZ(14,"div",9),r.TgZ(15,"button",10),r.NdJ("click",function(){return t.blockSelected()}),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"button",10),r.NdJ("click",function(){return t.deleteSelected()}),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"button",11),r.NdJ("click",function(){return t.modalOpen()}),r._UZ(22,"i",12),r._uU(23," \xa0 "),r.TgZ(24,"span"),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.qZA(),r.qZA(),r._UZ(27,"div",13),r.qZA(),r.qZA(),r.TgZ(28,"app-table",14,15),r.NdJ("selectedIdsChange",function(e){return t.selectedIds=e})("loadingChange",function(e){return t.loading=e})("actionRequest",function(e){return t.actionRequest(e)}),r.qZA()),2&e&&(r.xp6(4),r.Q6J("ngClass",r.VKq(23,ce,!!t.queryOptions.search_word)),r.xp6(1),r.MGl("placeholder","",r.lcZ(6,13,"SEARCH"),"..."),r.Q6J("ngModel",t.queryOptions.search_word),r.xp6(7),r.Oqu(r.lcZ(13,15,"BATCH_ACTIONS")),r.xp6(4),r.Oqu(r.lcZ(17,17,"DISABLE_ENABLE")),r.xp6(3),r.Oqu(r.lcZ(20,19,"DELETE")),r.xp6(6),r.Oqu(r.lcZ(26,21,"ADD")),r.xp6(3),r.Q6J("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("loading",t.loading))},directives:[ae,o.mk,g.Fj,g.JJ,g.On,_.jt,_.iD,_.Vi,de.a],pipes:[l.X$],encapsulation:2}),e})();var pe=i(25917),me=i(5304);let ge=(()=>{class e{constructor(e){this.http=e,this.headers=new v.WM({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="/admin/collections"}setRequestUrl(e){this.requestUrl=e}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe((0,me.K)(this.handleError()))}deleteItemByName(e){const t=`${this.getRequestUrl()}/${e}`;return this.http.delete(t,{headers:this.headers}).pipe((0,me.K)(this.handleError()))}handleError(e="operation",t){return e=>{if(e.error)throw e.error;return(0,pe.of)(t)}}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(v.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})(),he=(()=>{class e extends A.D{constructor(e){super(e),this.setRequestUrl("/admin/field_types")}}return e.\u0275fac=function(t){return new(t||e)(r.LFG(v.eN))},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),e})();var fe=i(6463),Ze=i(79514),be=i(72765);const Te=["addCollectionBlock"],Ae=["addGroupBlock"],ve=["accordion"],qe=["blockFieldList"];function ye(e,t){if(1&e&&(r.TgZ(0,"div",113),r._uU(1),r.qZA()),2&e){const e=r.oxw().message;r.xp6(1),r.Oqu(e)}}function Ce(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"p",110),r._uU(1),r.ALo(2,"translate"),r.qZA(),r.YNc(3,ye,2,1,"div",111),r.TgZ(4,"div",110),r.TgZ(5,"button",112),r.NdJ("click",function(){return r.CHM(e).confirm()}),r._uU(6),r.ALo(7,"translate"),r.qZA(),r._uU(8," \xa0 "),r.TgZ(9,"button",48),r.NdJ("click",function(){return r.CHM(e).p.close()}),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA()}if(2&e){const e=t.message;r.xp6(1),r.Oqu(r.lcZ(2,4,"YOU_SURE_YOU_WANT_DELETE")),r.xp6(2),r.Q6J("ngIf",e),r.xp6(3),r.Oqu(r.lcZ(7,6,"YES")),r.xp6(4),r.Oqu(r.lcZ(11,8,"NO"))}}function xe(e,t){if(1&e&&(r.TgZ(0,"option",114),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.s9C("value",e),r.xp6(1),r.Oqu(e)}}function _e(e,t){if(1&e&&(r.TgZ(0,"div",115),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.newCollection," ")}}function Ie(e,t){if(1&e&&(r.TgZ(0,"option",114),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.s9C("value",e.name),r.xp6(1),r.Oqu(e.title)}}const Ee=function(){return{standalone:!0}};function Le(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",116),r.TgZ(1,"div",58),r.TgZ(2,"label",59),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",60),r.TgZ(5,"input",117),r.NdJ("ngModelChange",function(t){const i=r.CHM(e).$implicit;return r.oxw().fieldModel.inputProperties[i.name]=t}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,i=r.oxw();r.xp6(2),r.hYB("for","parameterInputField",e.name,"",i.uniqueId,""),r.xp6(1),r.Oqu(e.title),r.xp6(2),r.hYB("id","parameterInputField",e.name,"",i.uniqueId,""),r.Q6J("ngModel",i.fieldModel.inputProperties[e.name])("ngModelOptions",r.DdM(7,Ee))}}function Ne(e,t){if(1&e&&(r.TgZ(0,"option",114),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.s9C("value",e.name),r.xp6(1),r.Oqu(e.title)}}function Se(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",116),r.TgZ(1,"div",58),r.TgZ(2,"label",59),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"div",60),r.TgZ(5,"input",117),r.NdJ("ngModelChange",function(t){const i=r.CHM(e).$implicit;return r.oxw().fieldModel.outputProperties[i.name]=t}),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,i=r.oxw();r.xp6(2),r.hYB("for","parameterOutputField",e.name,"",i.uniqueId,""),r.xp6(1),r.Oqu(e.title),r.xp6(2),r.hYB("id","parameterOutputField",e.name,"",i.uniqueId,""),r.Q6J("ngModel",i.fieldModel.outputProperties[e.name])("ngModelOptions",r.DdM(7,Ee))}}function Oe(e,t){if(1&e&&(r.TgZ(0,"option",114),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e),r.xp6(1),r.Oqu(e)}}function Me(e,t){if(1&e&&(r.TgZ(0,"div",22),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.secondFormErrors.group," ")}}function Fe(e,t){if(1&e&&(r.TgZ(0,"div",115),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.secondFormErrors.newGroup," ")}}function we(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",136),r.TgZ(1,"td"),r._uU(2),r.TgZ(3,"span",137),r._uU(4),r.qZA(),r.qZA(),r.TgZ(5,"td"),r._uU(6),r.qZA(),r.TgZ(7,"td",131),r._uU(8),r.qZA(),r.TgZ(9,"td",131),r._UZ(10,"app-output-field",138),r.qZA(),r.TgZ(11,"td"),r.TgZ(12,"div",139),r.TgZ(13,"div",140),r.TgZ(14,"button",141),r.NdJ("click",function(t){const i=r.CHM(e).$implicit;return r.oxw(2).editField(i,t)}),r.ALo(15,"translate"),r._UZ(16,"i",142),r.qZA(),r.TgZ(17,"button",143),r.NdJ("click",function(t){const i=r.CHM(e).$implicit;return r.oxw(2).copyField(i,t)}),r.ALo(18,"translate"),r._UZ(19,"i",144),r.qZA(),r.TgZ(20,"button",141),r.NdJ("click",function(t){const i=r.CHM(e).$implicit;return r.oxw(2).deleteField(i,t)}),r.ALo(21,"translate"),r._UZ(22,"i",11),r.qZA(),r.qZA(),r.qZA(),r._UZ(23,"app-output-field",138),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit,i=r.oxw(2);r.xp6(2),r.hij(" ",e.title," "),r.xp6(2),r.hij("(",e.name,")"),r.xp6(2),r.hij(" ",e.inputType," "),r.xp6(2),r.hij(" ",e.group," "),r.xp6(2),r.Q6J("value",e.required),r.xp6(4),r.s9C("ngbTooltip",r.lcZ(15,11,"EDIT")),r.Q6J("hidden",e.name==i.currentFieldName),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(18,13,"COPY")),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(21,15,"DELETE")),r.Q6J("hidden",e.name==i.currentFieldName),r.xp6(3),r.Q6J("value",e.showInTable)}}function Ue(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",null,118),r.TgZ(2,"div"),r.TgZ(3,"div",119),r.TgZ(4,"select",120,121),r.TgZ(6,"option",66),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"option",122),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"option",123),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"option",124),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.qZA(),r.TgZ(18,"button",125),r.NdJ("click",function(t){r.CHM(e);const i=r.MAs(5);return r.oxw().sortingStart(i.value,t)}),r._UZ(19,"i",126),r._uU(20),r.ALo(21,"translate"),r.qZA(),r.qZA(),r.TgZ(22,"button",127),r.NdJ("click",function(t){return r.CHM(e),r.oxw().fieldsExport(t)}),r._UZ(23,"i",128),r._uU(24),r.ALo(25,"translate"),r.qZA(),r._UZ(26,"div",129),r.TgZ(27,"div"),r.TgZ(28,"table",130),r.TgZ(29,"thead"),r.TgZ(30,"tr"),r.TgZ(31,"th"),r._uU(32),r.ALo(33,"translate"),r.qZA(),r.TgZ(34,"th"),r._uU(35),r.ALo(36,"translate"),r.qZA(),r.TgZ(37,"th",131),r._uU(38),r.ALo(39,"translate"),r.qZA(),r.TgZ(40,"th",131),r._uU(41),r.ALo(42,"translate"),r.qZA(),r.TgZ(43,"th"),r._uU(44),r.ALo(45,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(46,"tbody"),r.YNc(47,we,24,17,"tr",132),r.TgZ(48,"tr",133),r.TgZ(49,"td",134),r._uU(50),r.ALo(51,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(52,"app-sorting-dnd",135),r.NdJ("itemsChange",function(t){return r.CHM(e),r.oxw().sortData=t})("save",function(t){return r.CHM(e),r.oxw().sortingApply(t)})("cancel",function(){return r.CHM(e),r.oxw().sortingReset()}),r.qZA()}if(2&e){const e=r.oxw();r.xp6(3),r.Q6J("hidden",e.model.fields.length<2),r.xp6(4),r.Oqu(r.lcZ(8,16,"SORT_FIELDS")),r.xp6(3),r.Oqu(r.lcZ(11,18,"SORT_FIELDS_LIST")),r.xp6(3),r.Oqu(r.lcZ(14,20,"SORT_FIELDS_PAGE")),r.xp6(3),r.Oqu(r.lcZ(17,22,"SORT_FILTERS")),r.xp6(4),r.hij(" ",r.lcZ(21,24,"SORT")," "),r.xp6(4),r.hij(" ",r.lcZ(25,26,"EXPORT")," "),r.xp6(8),r.Oqu(r.lcZ(33,28,"TITLE")),r.xp6(3),r.Oqu(r.lcZ(36,30,"INPUT_TYPE")),r.xp6(3),r.Oqu(r.lcZ(39,32,"GROUP")),r.xp6(3),r.hij("",r.lcZ(42,34,"REQUIRED"),"?"),r.xp6(3),r.hij("",r.lcZ(45,36,"SHOW_IN_TABLE"),"?"),r.xp6(3),r.Q6J("ngForOf",e.model.fields),r.xp6(1),r.Q6J("hidden",e.model.fields.length>0),r.xp6(2),r.hij(" ",r.lcZ(51,38,"EMPTY")," "),r.xp6(2),r.Q6J("items",e.sortData)}}function ke(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",145),r._uU(1),r.TgZ(2,"button",91),r.NdJ("click",function(){return r.CHM(e),r.oxw().errorMessage=""}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.errorMessage," ")}}const De=function(e){return{"no-events":e}},Je=function(e){return{"is-invalid":e}},Re=function(){return["/catalog"]};let Ye=(()=>{class e extends D.B{constructor(e,t,i,o,n,s,r,l,a){super(e,t,i,o,n,s),this.fb=e,this.activeModal=t,this.translateService=i,this.systemNameService=o,this.dataService=n,this.elRef=s,this.fieldTypesService=r,this.collectionsService=l,this.modalService=a,this._secondFormFieldsErrors={},this.model=new h(0,"","","","products",[],["General","Service"],!0,!1),this.fieldModel=new C._(0,"","","","",{},"",{},""),this.sortData=[],this.sortingFieldName="",this.fld_submitted=!1,this.action="add_field",this.currentFieldName="",this.collections=["products"],this.fieldTypeProperties={input:[],output:[]},this.formFields=[{name:"title",validators:[g.kI.required]},{name:"name",validators:[g.kI.required,g.kI.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"collection",validators:[g.kI.required]},{name:"newCollection",validators:[g.kI.pattern("[A-Za-z0-9_-]+")]},{name:"isCreateByUsersAllowed",validators:[]},{name:"isActive",validators:[]}],this.secondFormFields=[{name:"title",validators:[g.kI.required]},{name:"name",validators:[g.kI.required,g.kI.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"inputType",validators:[g.kI.required]},{name:"outputType",validators:[g.kI.required]},{name:"group",validators:[g.kI.required]},{name:"newGroup",validators:[]},{name:"required",validators:[]},{name:"showInTable",validators:[]},{name:"showOnPage",validators:[]},{name:"showInList",validators:[]},{name:"isFilter",validators:[]}]}set secondFormErrors(e){for(const t in e)if(e.hasOwnProperty(t)){const e=this.getControl(this.form,null,t);e&&e.setErrors({incorrect:!0})}this._secondFormFieldsErrors=e}get secondFormErrors(){return this._secondFormFieldsErrors}onAfterInit(){this.buildForm("secondForm",this.secondFormFields,this.secondFormErrors,"fieldModel"),this.onValueChanged("secondForm",this.secondFormErrors),this.getFieldTypes(),this.getCollectionsList()}getFieldTypes(){const e=new w.J("title","asc",0,0,1);this.fieldTypesService.getListPage(e).subscribe(e=>{this.fieldTypes=e.items},e=>this.errorMessage=e)}getCollectionsList(){this.collectionsService.getList().subscribe(e=>{e.length>0&&(this.collections=e)})}selectFieldTypeProperties(e,t){t?this.secondForm.get(`${e}Type`).setValue(t):t=this.secondForm.get(`${e}Type`).value,this.fieldModel[`${e}Type`]=t;const i=(0,u.find)(this.fieldTypes,{name:t});if(!i)return void(this.fieldTypeProperties[e]=[]);const o=`${e}Properties`,n=(0,u.map)(i[`${e}Properties`],"name");this.fieldTypeProperties[e].splice(0),i[e+"Properties"].forEach((t,i)=>{this.fieldTypeProperties[e].push(t)});for(const s in this.fieldModel[o])this.fieldModel[o].hasOwnProperty(s)&&-1===n.indexOf(s)&&delete this.fieldModel[o][s];for(const s in this.fieldTypeProperties[e])if(this.fieldTypeProperties[e].hasOwnProperty(s)){const t=this.fieldTypeProperties[e][s].name;void 0===this.fieldModel[o][t]&&(this.fieldModel[o][t]=this.fieldTypeProperties[e][s].default_value)}"input"===e&&!this.fieldModel.outputType&&this.selectFieldTypeProperties("output",t)}addCollectionToggle(e,t){this.displayToggle(this.elementAddCollectionBlock.nativeElement),e.value="",this.onValueChanged(),e.focus()}addCollection(e){e&&e.preventDefault();const t="newCollection",i=this.form.get(t);if(!i.valid||!i.value)return!1;this.formErrors[t]="";const o=i.value;return this.collections.indexOf(o)>-1?(this.getControl(this.form,null,t).setErrors({exists:"COLLECTION_EXISTS"}),this.formErrors[t]=this.getLangString("COLLECTION_EXISTS"),!1):(this.collections.push(o),this.model.collection=o,this.getControl(this.form,null,t).setValue(o),this.elementAddCollectionBlock.nativeElement.style.display="none",!0)}deleteCollection(e){if(!this.model.collection)return;if(e.isOpen())return void e.close();let t;e.placement="top",e.popoverTitle=this.getLangString("CONFIRM"),t={p:e,confirm:(()=>{this.loading=!0,this.collectionsService.deleteItemByName(this.model.collection).subscribe(t=>{const i=this.collections.indexOf(this.model.collection);i>-1&&(this.collections.splice(i,1),this.model.collection=this.collections[0]||""),e.close(),this.loading=!1},e=>{this.errorMessage=e.error||"Error.",this.loading=!1})}).bind(this),message:""},e.open(t)}addGroup(e){e&&e.preventDefault();const t="newGroup",i=this.secondForm.get(t);if(!i||!i.valid||!i.value)return!1;this.errorFieldMessage="",this.secondFormErrors[t]="";const o=i.value;return this.model.groups.indexOf(o)>-1?(this.getControl(this.secondForm,null,t).setErrors({exists:"GROUP_ALREADY_EXISTS"}),this.secondFormErrors[t]=this.getLangString("GROUP_ALREADY_EXISTS"),!1):(this.model.groups.push(o),this.fieldModel.group=o,this.getControl(this.secondForm,null,"group").setValue(this.fieldModel.group),this.elementAddGroupBlock.nativeElement.style.display="none",!0)}deleteGroup(){const e=this.secondForm.get("group").value;let t=(0,u.findIndex)(this.model.fields,{group:e});this.errorFieldMessage="",t>-1?this.errorFieldMessage=this.getLangString("YOU_CANT_DELETE_NOTEMPTY_GROUP"):(t=this.model.groups.indexOf(e),t>-1&&this.model.groups.splice(t,1))}editField(e,t){t&&t.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="edit_field",this.fieldModel=(0,u.cloneDeep)(e);const i={};this.secondFormFields.forEach(t=>{i[t.name]=e[t.name]||null}),this.secondForm.setValue(i),this.selectFieldTypeProperties("input"),this.selectFieldTypeProperties("output"),this.currentFieldName=this.fieldModel.name,this.fld_submitted=!1}copyField(e,t){t&&t.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="add_field",this.fieldModel=(0,u.cloneDeep)(e),this.fieldModel.name="",this.secondForm.setValue(this.fieldModel),this.currentFieldName="",this.fld_submitted=!1}deleteField(e,t){t&&t.preventDefault();const i=(0,u.findIndex)(this.model.fields,{name:e.name});-1!==i?this.model.fields.splice(i,1):this.errorMessage="Field not found."}resetFieldForm(){this.action="add_field",this.errorMessage="",this.errorFieldMessage="",this.fld_submitted=!1,this.currentFieldName="",this.secondForm.reset(),this.fieldModel=new C._(0,"","","","",{},"",{},"")}editFieldCancel(e){e&&e.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.resetFieldForm(),this.onValueChanged("secondForm",this.secondFormErrors)}fieldMove(e,t){if("up"===t&&0===e||"down"===t&&e===this.model.fields.length-1)return;const i="up"===t?e-1:e+1,o=this.model.fields[e];this.model.fields.splice(e,1),this.model.fields.splice(i,0,o)}submitField(e){if(e&&e.preventDefault(),this.errorFieldMessage="",this.fld_submitted=!0,!this.secondForm.valid)return this.formGroupMarkTouched(this.secondForm),this.onValueChanged("secondForm",this.secondFormErrors),void(this.fld_submitted=!1);const t=(0,u.cloneDeep)(Object.assign({},this.secondForm.value,{inputProperties:this.fieldModel.inputProperties,outputProperties:this.fieldModel.outputProperties}));let i=(0,u.findIndex)(this.model.fields,{name:t.name});i>-1&&this.currentFieldName!==t.name?this.errorFieldMessage=this.getLangString("FIELD_NAME_EXISTS"):(this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),"add_field"===this.action?this.model.fields.push(t):"edit_field"===this.action&&(i=(0,u.findIndex)(this.model.fields,{name:this.currentFieldName}),i>-1&&(this.model.fields[i]=t)),this.resetFieldForm())}getFieldTypeProperty(e,t){if(!e)return null;let i=null;const o=(0,u.findIndex)(this.fieldTypes,{name:e});return o>-1&&void 0!==this.fieldTypes[o][t]&&(i=this.fieldTypes[o][t]),i}sortingInit(e,t,i){let o;i&&i.preventDefault(),this.sortingFieldName=e,o=t?this.model.fields.filter(e=>e[t]):this.model.fields,e&&o.sort(function(t,i){return t[e]-i[e]}),this.sortData=[],o.forEach(e=>{this.sortData.push({name:e.name,title:e.title})}),this.blockFieldList.nativeElement.style.display="none"}sortingStart(e,t){t&&t.preventDefault(),this.errorMessage="";const i=e.split("-");this.sortingFieldName=i[0];const o=i[1]?this.model.fields.filter(e=>e[i[1]]):this.model.fields;o.sort(function(e,t){return e[i[0]]-t[i[0]]}),0!==o.length?(this.sortData=o.map(e=>({name:e.name,title:e.title})),this.blockFieldList.nativeElement.style.display="none"):this.errorMessage=this.getLangString("SORT_FIELDS_EMPTY")}sortingApply(e){if(this.sortingFieldName)this.sortData.forEach((e,t)=>{const i=this.model.fields.findIndex(t=>t.name===e.name);i>-1&&(this.model.fields[i][this.sortingFieldName]=t)});else{const e=this.sortData.map(e=>e.name);this.model.fields.sort(function(t,i){return e.indexOf(t.name)-e.indexOf(i.name)})}this.sortingReset()}sortingReset(){this.action=(0,u.findIndex)(this.model.fields,{name:this.currentFieldName})>-1?"edit_field":"add_field",this.sortData.splice(0,this.sortData.length),this.sortingFieldName="",this.blockFieldList.nativeElement.style.display="block"}getSaveRequest(e){return e.id?this.dataService.update(e):this.dataService.create(e)}getFormData(){this.sortData.length>0&&this.sortingApply();const e=this.form.value;return e.id=this.model.id||0,e.groups=this.model.groups,e.fields=this.model.fields,e}toggleAccordion(e,t,i){e.activeIds.indexOf(t)>-1&&i||e.toggle(t)}fieldsExport(e){e&&e.preventDefault(),this.errorMessage="",this.model.fields||(this.model.fields=[]),this.errorMessage="";const t=JSON.stringify(this.model.fields,null,"\t"),i=this.modalService.open(fe.O,{backdrop:"static",keyboard:!1,container:"#modals-container"});i.componentInstance.modalTitle=`${this.getLangString("EXPORT")} JSON`,i.componentInstance.textValue=t,i.result.then(e=>{if(e.data)try{const t=JSON.parse(e.data);this.model.fields.splice(0,this.model.fields.length),this.model.fields.push(...t)}catch(t){this.errorMessage=this.getLangString("JSON_SYNTAX_ERROR")}},e=>{})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(g.qu),r.Y36(_.Kz),r.Y36(l.sK),r.Y36(Z.U),r.Y36(T.s),r.Y36(r.SBq),r.Y36(he),r.Y36(ge),r.Y36(_.FF))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-content-type-modal-content"]],viewQuery:function(e,t){if(1&e&&(r.Gf(Te,7),r.Gf(Ae,7),r.Gf(ve,7),r.Gf(qe,5)),2&e){let e;r.iGM(e=r.CRH())&&(t.elementAddCollectionBlock=e.first),r.iGM(e=r.CRH())&&(t.elementAddGroupBlock=e.first),r.iGM(e=r.CRH())&&(t.accordion=e.first),r.iGM(e=r.CRH())&&(t.blockFieldList=e.first)}},features:[r.qOj],decls:289,vars:254,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["confirmPopover",""],[1,"modal-body","py-0"],[1,"row","mb-3"],[1,"col-lg-4",3,"formGroup"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"mb-2","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],[1,"alert","alert-danger"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"mb-2"],["for","fieldDescription",1,"label-filled"],["type","text","rows","3","name","description","id","fieldDescription","formControlName","description",1,"form-control"],[1,"mb-2","row","form-group-message"],[1,"col-12"],[1,"mb-0"],["for","fieldCollectionName",1,"label-filled"],["id","fieldCollectionName","name","collection","formControlName","collection",1,"form-select","form-select-sm",3,"ngModel","ngClass","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],[1,"icon-plus"],["triggers","manual",1,"d-flex",3,"ngbPopover"],["buttonDeleteCollection","ngbPopover"],["type","button",1,"btn","btn-secondary","btn-sm","rounded-top-start-0","rounded-bottom-start-0",3,"ngbTooltip","click"],[1,"card","p-1","mt-2","form-group-message",2,"display","none"],["addCollectionBlock",""],["type","text","formControlName","newCollection",1,"form-control","form-control-sm",3,"ngClass"],["addCollectionField",""],["class","alert alert-danger mb-1",4,"ngIf"],[1,"text-end","mt-1"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"form-check","m-0"],["type","checkbox","value","1","name","isCreateByUsersAllowed","formControlName","isCreateByUsersAllowed",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],[1,"card","card-body","p-2","ps-3"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"form-check-input",3,"id"],[1,"col-lg-8",3,"formGroup"],[1,"label-filled",3,"hidden"],[1,"card"],[1,"card-body"],[1,"col-md-5"],[3,"for"],[1,"col-md-7"],["type","text","name","field_title","formControlName","title",1,"form-control","form-control-sm",3,"id","ngClass"],["type","text","name","field_name","formControlName","name",1,"form-control","form-control-sm",3,"id","ngClass"],[1,"mb-2","row"],["type","text","rows","3","name","field_description","formControlName","description",1,"form-control","form-control-sm",3,"id","ngClass"],["name","field_inputType","formControlName","inputType","placement","left",1,"form-select","form-select-sm",3,"id","ngbTooltip","change"],["value",""],[1,"icon-cog"],[1,"card","card-body","bg-light","mb-3",2,"display","none",3,"hidden"],["inputTypeOptionsBlock",""],[1,"alert","alert-secondary","small",3,"hidden"],["class","row mb-2",4,"ngFor","ngForOf"],["name","field_outputType","formControlName","outputType","placement","left",1,"form-select","form-select-sm",3,"id","ngbTooltip","ngClass","change"],["outputTypeOptionsBlock",""],["for","field_fieldGroup"],[1,"form-group-message"],[1,"input-group","input-group-sm",3,"ngClass"],["id","field_fieldGroup","name","field_group","formControlName","group",1,"form-select",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["addGroupBlock",""],["type","text","formControlName","newGroup",1,"form-control","form-control-sm",3,"ngClass"],["addGroupField",""],[1,"row","mb-0"],[1,"col-md-7","offset-md-5"],[1,"form-check"],["type","checkbox","value","1","name","required","formControlName","required",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","showInTable","formControlName","showInTable",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","showOnPage","formControlName","showOnPage",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","showInList","formControlName","showInList",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","isFilter","formControlName","isFilter",1,"form-check-input",3,"id"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-3",3,"hidden"],["type","button",1,"btn-close",3,"click"],[1,"mt-3"],["type","button",1,"btn","btn-sm","btn-info","btn-wide",3,"hidden","click"],["type","button",1,"btn","btn-sm","btn-success","btn-wide",3,"hidden","click"],[1,"icon-check"],["type","button",1,"btn","btn-sm","btn-secondary","btn-wide",3,"click"],["activeIds","accordion-content-type-fields",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-content-type-fields",3,"title"],["ngbPanelContent",""],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"text-center"],["class","alert alert-danger p-2",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"alert","alert-danger","p-2"],[3,"value"],[1,"alert","alert-danger","mb-1"],[1,"row","mb-2"],["type","text",1,"form-control","form-control-sm",3,"id","ngModel","ngModelOptions","ngModelChange"],["blockFieldList",""],[1,"float-end","mb-2",3,"hidden"],[1,"form-select","form-select-sm","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["sortTypeSelect",""],["value","listOrder-showInList"],["value","pageOrder-showOnPage"],["value","filterOrder-isFilter"],["type","button",1,"btn","btn-sm","btn-secondary","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2","mb-2","mb-md-0",3,"click"],[1,"icon-shuffle"],["type","button",1,"btn","btn-sm","btn-secondary","d-inline-block",3,"click"],[1,"icon-inbox","me-2"],[1,"clearfix"],[1,"table","table-striped","table-divided","mb-0"],[1,"d-none","d-lg-table-cell"],["class","show-on-hover-parent",4,"ngFor","ngForOf"],[1,"table-active",3,"hidden"],["colspan","5",1,"text-center","p-3"],[3,"items","itemsChange","save","cancel"],[1,"show-on-hover-parent"],[1,"text-muted"],["outputType","boolean",3,"value"],[1,"relative"],[1,"show-on-hover-right"],["type","button",1,"btn","btn-secondary","btn-sm","ms-2",3,"hidden","ngbTooltip","click"],[1,"icon-pencil"],["type","button",1,"btn","btn-secondary","btn-sm","ms-2",3,"ngbTooltip","click"],[1,"icon-stack"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"]],template:function(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"button",2),r.NdJ("click",function(e){return t.closeModal(e)}),r._UZ(3,"i",3),r.TgZ(4,"span"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.TgZ(7,"button",2),r.NdJ("click",function(e){return t.minimize(e)}),r._UZ(8,"i",4),r.TgZ(9,"span"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",5),r.TgZ(13,"div",6),r.TgZ(14,"div",7),r.TgZ(15,"button",8),r.NdJ("click",function(e){return t.maximize(e)}),r.ALo(16,"translate"),r._UZ(17,"i",9),r.qZA(),r.TgZ(18,"button",10),r.NdJ("click",function(e){return t.closeModal(e)}),r.ALo(19,"translate"),r._UZ(20,"i",11),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"h4",12),r._uU(22),r.qZA(),r.qZA(),r.YNc(23,Ce,12,10,"ng-template",null,13,r.W1O),r.TgZ(25,"div",14),r.TgZ(26,"div",15),r.TgZ(27,"div",16),r.TgZ(28,"form",17,18),r.NdJ("ngSubmit",function(){return t.onSubmit()}),r.TgZ(30,"div",19),r.TgZ(31,"label",20),r._uU(32),r.ALo(33,"translate"),r.qZA(),r._UZ(34,"input",21),r.TgZ(35,"div",22),r._uU(36),r.qZA(),r.qZA(),r.TgZ(37,"div",19),r.TgZ(38,"label",23),r._uU(39),r.ALo(40,"translate"),r.qZA(),r.TgZ(41,"div",24),r._UZ(42,"input",25),r.TgZ(43,"button",26),r.NdJ("click",function(){return t.generateName(t.model)}),r.ALo(44,"translate"),r._UZ(45,"i",27),r.qZA(),r.qZA(),r.TgZ(46,"div",22),r._uU(47),r.qZA(),r.qZA(),r.TgZ(48,"div",28),r.TgZ(49,"label",29),r._uU(50),r.ALo(51,"translate"),r.qZA(),r._UZ(52,"textarea",30),r.qZA(),r.TgZ(53,"div",31),r.TgZ(54,"div",32),r.TgZ(55,"div",33),r.TgZ(56,"label",34),r._uU(57),r.ALo(58,"translate"),r.qZA(),r.TgZ(59,"div",24),r.TgZ(60,"select",35),r.NdJ("ngModelChange",function(e){return t.model.collection=e}),r.YNc(61,xe,2,2,"option",36),r.qZA(),r.TgZ(62,"button",37),r.NdJ("click",function(i){r.CHM(e);const o=r.MAs(73);return t.addCollectionToggle(o,i)}),r.ALo(63,"translate"),r._UZ(64,"i",38),r.qZA(),r.TgZ(65,"div",39,40),r.TgZ(67,"button",41),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(66);return t.deleteCollection(i)}),r.ALo(68,"translate"),r._UZ(69,"i",11),r.qZA(),r.qZA(),r.qZA(),r.TgZ(70,"div",42,43),r._UZ(72,"input",44,45),r.YNc(74,_e,2,1,"div",46),r.TgZ(75,"div",47),r.TgZ(76,"button",48),r.NdJ("click",function(e){return t.addCollection(e)}),r._uU(77),r.ALo(78,"translate"),r.qZA(),r._uU(79," \xa0 "),r.TgZ(80,"button",48),r.NdJ("click",function(){return r.CHM(e),r.MAs(71).style.display="none",t.formErrors.newCollection=""}),r._uU(81),r.ALo(82,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(83,"div",28),r.TgZ(84,"div",49),r._UZ(85,"input",50),r.TgZ(86,"label",51),r._uU(87),r.ALo(88,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(89,"div",28),r.TgZ(90,"div",52),r.TgZ(91,"div",49),r._UZ(92,"input",53),r.TgZ(93,"label",51),r._uU(94),r.ALo(95,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(96,"div",54),r.TgZ(97,"label",55),r._uU(98),r.ALo(99,"translate"),r.qZA(),r.TgZ(100,"label",55),r._uU(101),r.ALo(102,"translate"),r.qZA(),r.TgZ(103,"div",56),r.TgZ(104,"div",57),r.TgZ(105,"div",31),r.TgZ(106,"div",58),r.TgZ(107,"label",59),r._uU(108),r.ALo(109,"translate"),r.qZA(),r.qZA(),r.TgZ(110,"div",60),r._UZ(111,"input",61),r.TgZ(112,"div",22),r._uU(113),r.qZA(),r.qZA(),r.qZA(),r.TgZ(114,"div",31),r.TgZ(115,"div",58),r.TgZ(116,"label",59),r._uU(117),r.ALo(118,"translate"),r.qZA(),r.qZA(),r.TgZ(119,"div",60),r.TgZ(120,"div",24),r._UZ(121,"input",62),r.TgZ(122,"button",37),r.NdJ("click",function(e){return t.generateName(t.fieldModel,e,t.secondForm)}),r.ALo(123,"translate"),r._UZ(124,"i",27),r.qZA(),r.qZA(),r.TgZ(125,"div",22),r._uU(126),r.qZA(),r.qZA(),r.qZA(),r.TgZ(127,"div",63),r.TgZ(128,"div",58),r.TgZ(129,"label",59),r._uU(130),r.ALo(131,"translate"),r.qZA(),r.qZA(),r.TgZ(132,"div",60),r._UZ(133,"textarea",64),r.qZA(),r.qZA(),r.TgZ(134,"div",31),r.TgZ(135,"div",58),r.TgZ(136,"label",59),r._uU(137),r.ALo(138,"translate"),r.qZA(),r.qZA(),r.TgZ(139,"div",60),r.TgZ(140,"div",24),r.TgZ(141,"select",65),r.NdJ("change",function(){return t.selectFieldTypeProperties("input")}),r._UZ(142,"option",66),r.YNc(143,Ie,2,2,"option",36),r.qZA(),r.TgZ(144,"button",37),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(150);return t.displayToggle(i)}),r.ALo(145,"translate"),r._UZ(146,"i",67),r.qZA(),r.qZA(),r.TgZ(147,"div",22),r._uU(148),r.qZA(),r.qZA(),r.qZA(),r.TgZ(149,"div",68,69),r.TgZ(151,"div"),r.TgZ(152,"div",70),r._uU(153),r.ALo(154,"translate"),r.qZA(),r.YNc(155,Le,6,8,"div",71),r.qZA(),r.TgZ(156,"div",47),r.TgZ(157,"button",48),r.NdJ("click",function(){return r.CHM(e),r.MAs(150).style.display="none"}),r._uU(158),r.ALo(159,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(160,"div",31),r.TgZ(161,"div",58),r.TgZ(162,"label",59),r._uU(163),r.ALo(164,"translate"),r.qZA(),r.qZA(),r.TgZ(165,"div",60),r.TgZ(166,"div",24),r.TgZ(167,"select",72),r.NdJ("change",function(){return t.selectFieldTypeProperties("output")}),r._UZ(168,"option",66),r.YNc(169,Ne,2,2,"option",36),r.qZA(),r.TgZ(170,"button",37),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(176);return t.displayToggle(i)}),r.ALo(171,"translate"),r._UZ(172,"i",67),r.qZA(),r.qZA(),r.TgZ(173,"div",22),r._uU(174),r.qZA(),r.qZA(),r.qZA(),r.TgZ(175,"div",68,73),r.TgZ(177,"div",70),r._uU(178),r.ALo(179,"translate"),r.qZA(),r.YNc(180,Se,6,8,"div",71),r.TgZ(181,"div",47),r.TgZ(182,"button",48),r.NdJ("click",function(){return r.CHM(e),r.MAs(176).style.display="none"}),r._uU(183),r.ALo(184,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(185,"div",63),r.TgZ(186,"div",58),r.TgZ(187,"label",74),r._uU(188),r.ALo(189,"translate"),r.qZA(),r.qZA(),r.TgZ(190,"div",60),r.TgZ(191,"div",75),r.TgZ(192,"div",76),r.TgZ(193,"select",77),r._UZ(194,"option",66),r.YNc(195,Oe,2,2,"option",36),r.qZA(),r.TgZ(196,"button",37),r.NdJ("click",function(){r.CHM(e);const i=r.MAs(204),o=r.MAs(206);return t.displayToggle(i),o.value="",o.focus()}),r.ALo(197,"translate"),r._UZ(198,"i",38),r.qZA(),r.TgZ(199,"button",37),r.NdJ("click",function(){return t.deleteGroup()}),r.ALo(200,"translate"),r._UZ(201,"i",11),r.qZA(),r.qZA(),r.YNc(202,Me,2,1,"div",78),r.TgZ(203,"div",42,79),r._UZ(205,"input",80,81),r.YNc(207,Fe,2,1,"div",46),r.TgZ(208,"div",47),r.TgZ(209,"button",48),r.NdJ("click",function(e){return t.addGroup(e)}),r._uU(210),r.ALo(211,"translate"),r.qZA(),r._uU(212," \xa0 "),r.TgZ(213,"button",48),r.NdJ("click",function(){return r.CHM(e),r.MAs(204).style.display="none",t.secondFormErrors.fld_newGroup=""}),r._uU(214),r.ALo(215,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(216,"div",82),r.TgZ(217,"div",83),r.TgZ(218,"div",84),r._UZ(219,"input",85),r.TgZ(220,"label",51),r._uU(221),r.ALo(222,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(223,"div",82),r.TgZ(224,"div",83),r.TgZ(225,"div",84),r._UZ(226,"input",86),r.TgZ(227,"label",51),r._uU(228),r.ALo(229,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(230,"div",82),r.TgZ(231,"div",83),r.TgZ(232,"div",84),r._UZ(233,"input",87),r.TgZ(234,"label",51),r._uU(235),r.ALo(236,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(237,"div",82),r.TgZ(238,"div",83),r.TgZ(239,"div",84),r._UZ(240,"input",88),r.TgZ(241,"label",51),r._uU(242),r.ALo(243,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(244,"div",82),r.TgZ(245,"div",83),r.TgZ(246,"div",84),r._UZ(247,"input",89),r.TgZ(248,"label",51),r._uU(249),r.ALo(250,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(251,"div",90),r._uU(252),r.TgZ(253,"button",91),r.NdJ("click",function(){return t.errorFieldMessage=""}),r.qZA(),r.qZA(),r.TgZ(254,"div",92),r.TgZ(255,"button",93),r.NdJ("click",function(e){return t.submitField(e)}),r._UZ(256,"i",38),r._uU(257),r.ALo(258,"translate"),r.qZA(),r.TgZ(259,"button",94),r.NdJ("click",function(e){return t.submitField(e)}),r._UZ(260,"i",95),r._uU(261),r.ALo(262,"translate"),r.qZA(),r._uU(263," \xa0 "),r.TgZ(264,"button",96),r.NdJ("click",function(e){return t.editFieldCancel(e)}),r._uU(265),r.ALo(266,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(267,"ngb-accordion",97,98),r.TgZ(269,"ngb-panel",99),r.ALo(270,"translate"),r.YNc(271,Ue,53,40,"ng-template",100),r.qZA(),r.qZA(),r.YNc(272,ke,3,1,"div",101),r.qZA(),r.TgZ(273,"div",102),r.TgZ(274,"div",103),r.TgZ(275,"button",104),r.NdJ("click",function(e){return t.save(!0,e)}),r.TgZ(276,"span"),r._uU(277),r.ALo(278,"translate"),r.qZA(),r.qZA(),r.TgZ(279,"div",105),r._UZ(280,"button",106),r.TgZ(281,"div",107),r.TgZ(282,"button",108),r.NdJ("click",function(e){return t.save(!1,e)}),r._uU(283),r.ALo(284,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(285,"button",109),r.NdJ("click",function(e){return t.closeModal(e)}),r.TgZ(286,"span"),r._uU(287),r.ALo(288,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.MAs(24);r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(6,128,"CLOSE")),r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(11,130,"MINIMIZE")),r.xp6(5),r.Q6J("title",r.lcZ(16,132,"EXPAND")),r.xp6(3),r.Q6J("title",r.lcZ(19,134,"CLOSE")),r.xp6(4),r.Oqu(t.modalTitle),r.xp6(5),r.Q6J("formGroup",t.form),r.xp6(1),r.Q6J("formGroup",t.form)("ngClass",r.VKq(220,De,t.submitted)),r.xp6(4),r.hij(" ",r.lcZ(33,136,"TITLE")," "),r.xp6(2),r.Q6J("ngClass",r.VKq(222,Je,t.form.controls.title.touched&&!t.form.controls.title.valid)),r.xp6(2),r.hij(" ",t.formErrors.title," "),r.xp6(3),r.hij(" ",r.lcZ(40,138,"SYSTEM_NAME")," "),r.xp6(2),r.Q6J("ngClass",r.VKq(224,Je,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.xp6(1),r.Q6J("ngClass",r.VKq(226,Je,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(44,140,"GENERATE")),r.xp6(4),r.hij(" ",t.formErrors.name," "),r.xp6(3),r.hij(" ",r.lcZ(51,142,"DESCRIPTION")," "),r.xp6(7),r.Oqu(r.lcZ(58,144,"COLLECTION")),r.xp6(2),r.Q6J("ngClass",r.VKq(228,Je,t.form.controls.collection.touched&&!t.form.controls.collection.valid)),r.xp6(1),r.Q6J("ngModel",t.model.collection)("ngClass",r.VKq(230,Je,t.form.controls.collection.touched&&!t.form.controls.collection.valid)),r.xp6(1),r.Q6J("ngForOf",t.collections),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(63,146,"ADD_COLLECTION")),r.xp6(3),r.Q6J("ngbPopover",e),r.xp6(2),r.s9C("ngbTooltip",r.lcZ(68,148,"DELETE")),r.xp6(5),r.Q6J("ngClass",r.VKq(232,Je,t.form.controls.newCollection.touched&&!t.form.controls.newCollection.valid)),r.xp6(2),r.Q6J("ngIf",t.formErrors.newCollection),r.xp6(3),r.hij(" ",r.lcZ(78,150,"ADD")," "),r.xp6(4),r.hij(" ",r.lcZ(82,152,"CANCEL")," "),r.xp6(4),r.MGl("id","fieldIsCreateByUsersAllowed",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldIsCreateByUsersAllowed",t.uniqueId,""),r.xp6(1),r.hij(" ",r.lcZ(88,154,"CREATE_BY_USERS_ALLOWED")," "),r.xp6(5),r.MGl("id","fieldIsActive",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldIsActive",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(95,156,"ACTIVE")),r.xp6(2),r.Q6J("formGroup",t.secondForm),r.xp6(1),r.Q6J("hidden","add_field"!=t.action),r.xp6(1),r.hij(" ",r.lcZ(99,158,"ADD_FIELD")," "),r.xp6(2),r.Q6J("hidden","edit_field"!=t.action),r.xp6(1),r.hij(" ",r.lcZ(102,160,"EDIT_FIELD")," "),r.xp6(6),r.MGl("for","field_fieldTitle",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(109,162,"TITLE")),r.xp6(3),r.MGl("id","field_fieldTitle",t.uniqueId,""),r.Q6J("ngClass",r.VKq(234,Je,t.secondForm.controls.title.touched&&!t.secondForm.controls.title.valid)),r.xp6(2),r.Oqu(t.secondFormErrors.title),r.xp6(3),r.MGl("for","field_fieldName",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(118,164,"SYSTEM_NAME")),r.xp6(3),r.Q6J("ngClass",r.VKq(236,Je,t.secondForm.controls.name.touched&&!t.secondForm.controls.name.valid)),r.xp6(1),r.MGl("id","field_fieldName",t.uniqueId,""),r.Q6J("ngClass",r.VKq(238,Je,t.secondForm.controls.name.touched&&!t.secondForm.controls.name.valid)),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(123,166,"GENERATE")),r.xp6(4),r.Oqu(t.secondFormErrors.name),r.xp6(3),r.MGl("for","field_fieldDescription",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(131,168,"DESCRIPTION")),r.xp6(3),r.MGl("id","field_fieldDescription",t.uniqueId,""),r.Q6J("ngClass",r.VKq(240,Je,t.secondForm.controls.description.touched&&!t.secondForm.controls.description.valid)),r.xp6(3),r.MGl("for","field_fieldInputType",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(138,170,"INPUT_TYPE")),r.xp6(3),r.Q6J("ngClass",r.VKq(242,Je,t.secondForm.controls.inputType.touched&&!t.secondForm.controls.inputType.valid)),r.xp6(1),r.ekj("is-invalid",t.secondFormErrors.fld_inputType),r.MGl("id","field_fieldInputType",t.uniqueId,""),r.Q6J("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.inputType,"description")),r.xp6(2),r.Q6J("ngForOf",t.fieldTypes),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(145,172,"OPTIONS")),r.xp6(4),r.Oqu(t.secondFormErrors.inputType),r.xp6(1),r.Q6J("hidden",!t.fieldModel.inputType),r.xp6(3),r.Q6J("hidden",t.fieldTypeProperties.input.length>0),r.xp6(1),r.hij(" ",r.lcZ(154,174,"THERE_NO_PARAMETERS")," "),r.xp6(2),r.Q6J("ngForOf",t.fieldTypeProperties.input),r.xp6(3),r.hij(" ",r.lcZ(159,176,"CLOSE")," "),r.xp6(4),r.MGl("for","field_fieldOutputType",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(164,178,"OUTPUT_TYPE")),r.xp6(3),r.Q6J("ngClass",r.VKq(244,Je,t.secondForm.controls.outputType.touched&&!t.secondForm.controls.outputType.valid)),r.xp6(1),r.MGl("id","field_fieldOutputType",t.uniqueId,""),r.Q6J("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.outputType,"description"))("ngClass",r.VKq(246,Je,t.secondForm.controls.outputType.touched&&!t.secondForm.controls.outputType.valid)),r.xp6(2),r.Q6J("ngForOf",t.fieldTypes),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(171,180,"OPTIONS")),r.xp6(4),r.Oqu(t.secondFormErrors.outputType),r.xp6(1),r.Q6J("hidden",!t.fieldModel.outputType),r.xp6(2),r.Q6J("hidden",t.fieldTypeProperties.output.length>0),r.xp6(1),r.hij(" ",r.lcZ(179,182,"THERE_NO_PARAMETERS")," "),r.xp6(2),r.Q6J("ngForOf",t.fieldTypeProperties.output),r.xp6(3),r.hij(" ",r.lcZ(184,184,"CLOSE")," "),r.xp6(5),r.Oqu(r.lcZ(189,186,"GROUP")),r.xp6(4),r.Q6J("ngClass",r.VKq(248,Je,t.secondForm.controls.group.touched&&!t.secondForm.controls.group.valid)),r.xp6(1),r.Q6J("ngClass",r.VKq(250,Je,t.secondForm.controls.group.touched&&!t.secondForm.controls.group.valid)),r.xp6(2),r.Q6J("ngForOf",t.model.groups),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(197,188,"ADD_GROUP")),r.xp6(3),r.s9C("ngbTooltip",r.lcZ(200,190,"DELETE_GROUP")),r.xp6(3),r.Q6J("ngIf",t.secondFormErrors.group),r.xp6(3),r.Q6J("ngClass",r.VKq(252,Je,t.secondForm.controls.newGroup.touched&&!t.secondForm.controls.newGroup.valid)),r.xp6(2),r.Q6J("ngIf",t.secondFormErrors.newGroup),r.xp6(3),r.hij(" ",r.lcZ(211,192,"ADD")," "),r.xp6(4),r.hij(" ",r.lcZ(215,194,"CANCEL")," "),r.xp6(5),r.MGl("id","fieldRequired",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldRequired",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(222,196,"REQUIRED")),r.xp6(5),r.MGl("id","fieldShowInTable",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldShowInTable",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(229,198,"SHOW_IN_TABLE")),r.xp6(5),r.MGl("id","fieldShowOnPage",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldShowOnPage",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(236,200,"SHOW_ON_PAGE")),r.xp6(5),r.MGl("id","fieldShowInList",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldShowInList",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(243,202,"SHOW_IN_LIST")),r.xp6(5),r.MGl("id","fieldIsFilter",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldIsFilter",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(250,204,"SHOW_IN_FILTER")),r.xp6(2),r.Q6J("hidden",!t.errorFieldMessage),r.xp6(1),r.hij(" ",t.errorFieldMessage," "),r.xp6(3),r.Q6J("hidden","add_field"!=t.action),r.xp6(2),r.hij(" ",r.lcZ(258,206,"ADD_FIELD")," "),r.xp6(2),r.Q6J("hidden","edit_field"!=t.action),r.xp6(2),r.hij(" ",r.lcZ(262,208,"SAVE_FIELD")," "),r.xp6(4),r.hij(" ",r.lcZ(266,210,"CANCEL")," "),r.xp6(2),r.Q6J("closeOthers",!0),r.xp6(2),r.Q6J("title",r.lcZ(270,212,"FIELDS")),r.xp6(3),r.Q6J("ngIf",t.errorMessage),r.xp6(3),r.Q6J("disabled",t.submitted),r.xp6(2),r.Oqu(r.lcZ(278,214,"SAVE_AND_CLOSE")),r.xp6(3),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(284,216,"SAVE")),r.xp6(4),r.Oqu(r.lcZ(288,218,"CLOSE"))}},directives:[g.JL,g.sg,g._Y,o.mk,g.Fj,g.JJ,g.u,_._L,g.EJ,o.sg,_.o8,o.O5,g.Wl,g.YN,g.Kr,_.gY,_.Gk,_.gW,_.jt,_.iD,_.Vi,_.TH,g.On,Ze.i,be.D],pipes:[l.X$],encapsulation:2}),e})(),Qe=(()=>{class e extends m.U{constructor(e,t,i,o){super(e,t,i,o),this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=o,this.title="\u0422\u0438\u043f\u044b \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430",this.queryOptions=new w.J("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"collection",sortName:"collection",title:"COLLECTION",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}getModalContent(){return Ye}getModalElementId(e){return["modal","content_type",e||0].join("-")}setModalInputs(e,t=!1,i=""){super.setModalInputs(e,t,i),this.modalRef.componentInstance.modalTitle=e&&!t?`${this.getLangString("CONTENT_TYPE")} #${e}`:this.getLangString("ADD_CONTENT_TYPE")}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(T.s),r.Y36(_.Kz),r.Y36(_.FF),r.Y36(l.sK))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-shk-content-types"]],features:[r.qOj],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"a",2),r._UZ(3,"i",3),r._uU(4," \xa0 "),r.TgZ(5,"span"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",4),r.TgZ(9,"div",5),r.TgZ(10,"button",6),r.TgZ(11,"span"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.TgZ(14,"div",7),r.TgZ(15,"button",8),r.NdJ("click",function(){return t.blockSelected()}),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"button",8),r.NdJ("click",function(){return t.deleteSelected()}),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"button",9),r.NdJ("click",function(){return t.modalOpen()}),r._UZ(22,"i",10),r._uU(23," \xa0 "),r.TgZ(24,"span"),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.qZA(),r.qZA(),r._UZ(27,"div",11),r.qZA(),r.TgZ(28,"app-table",12,13),r.NdJ("selectedIdsChange",function(e){return t.selectedIds=e})("loadingChange",function(e){return t.loading=e})("actionRequest",function(e){return t.actionRequest(e)}),r.qZA()),2&e&&(r.xp6(2),r.Q6J("routerLink",r.DdM(23,Re)),r.xp6(4),r.Oqu(r.lcZ(7,13,"CATALOG")),r.xp6(6),r.Oqu(r.lcZ(13,15,"BATCH_ACTIONS")),r.xp6(4),r.Oqu(r.lcZ(17,17,"DISABLE_ENABLE")),r.xp6(3),r.Oqu(r.lcZ(20,19,"DELETE")),r.xp6(6),r.Oqu(r.lcZ(26,21,"ADD")),r.xp6(3),r.Q6J("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[s.yS,_.jt,_.iD,_.Vi,de.a],pipes:[l.X$],encapsulation:2}),e})();class Pe{constructor(e,t,i,o,n,s,r){this.id=e,this.name=t,this.title=i,this.description=o,this.isActive=n,this.inputProperties=s,this.outputProperties=r}}function Ge(e,t){if(1&e&&(r.TgZ(0,"div",50),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.title," ")}}function je(e,t){if(1&e&&(r.TgZ(0,"div",50),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.formErrors.name," ")}}const Be=function(e){return{"is-invalid":e}};function Ve(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",59),r.TgZ(1,"td"),r._UZ(2,"input",60),r.qZA(),r.TgZ(3,"td",61),r._UZ(4,"input",62),r.qZA(),r.TgZ(5,"td",61),r._UZ(6,"input",63),r.qZA(),r.TgZ(7,"td",61),r.TgZ(8,"button",64),r.NdJ("click",function(t){const i=r.CHM(e).index;return r.oxw(3).arrayFieldDelete("inputProperties",i,t)}),r.ALo(9,"translate"),r._UZ(10,"i",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("formGroupName",t.index+""),r.xp6(2),r.Q6J("ngClass",r.VKq(7,Be,e.controls.name.touched&&!e.controls.name.valid)),r.xp6(2),r.Q6J("ngClass",r.VKq(9,Be,e.controls.title.touched&&!e.controls.title.valid)),r.xp6(2),r.Q6J("ngClass",r.VKq(11,Be,e.controls.default_value.touched&&!e.controls.default_value.valid)),r.xp6(2),r.s9C("ngbTooltip",r.lcZ(9,5,"DELETE"))}}function $e(e,t){if(1&e&&(r.TgZ(0,"tbody"),r.YNc(1,Ve,11,13,"tr",58),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",e.arrayFields.inputProperties.controls)}}function ze(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",51),r.TgZ(1,"table",52),r.TgZ(2,"thead"),r.TgZ(3,"tr"),r.TgZ(4,"th"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"th"),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"th"),r._uU(11),r.ALo(12,"translate"),r.qZA(),r._UZ(13,"th"),r.qZA(),r.qZA(),r.YNc(14,$e,2,1,"tbody",53),r.TgZ(15,"tfoot"),r.TgZ(16,"tr",54),r.TgZ(17,"td",55),r.TgZ(18,"button",56),r.NdJ("click",function(t){return r.CHM(e),r.oxw().arrayFieldAdd("inputProperties",t)}),r._UZ(19,"i",57),r._uU(20," \xa0 "),r.TgZ(21,"span"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(5),r.hij(" ",r.lcZ(6,5,"SYSTEM_NAME")," "),r.xp6(3),r.hij(" ",r.lcZ(9,7,"TITLE")," "),r.xp6(3),r.hij(" ",r.lcZ(12,9,"DEFAULT_VALUE")," "),r.xp6(3),r.Q6J("ngIf",e.arrayFields.inputProperties),r.xp6(8),r.Oqu(r.lcZ(23,11,"ADD"))}}function He(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",59),r.TgZ(1,"td"),r._UZ(2,"input",60),r.qZA(),r.TgZ(3,"td",61),r._UZ(4,"input",62),r.qZA(),r.TgZ(5,"td",61),r._UZ(6,"input",63),r.qZA(),r.TgZ(7,"td",61),r.TgZ(8,"button",64),r.NdJ("click",function(t){const i=r.CHM(e).index;return r.oxw(3).arrayFieldDelete("outputProperties",i,t)}),r.ALo(9,"translate"),r._UZ(10,"i",11),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=t.$implicit;r.Q6J("formGroupName",t.index+""),r.xp6(2),r.Q6J("ngClass",r.VKq(7,Be,e.controls.name.touched&&!e.controls.name.valid)),r.xp6(2),r.Q6J("ngClass",r.VKq(9,Be,e.controls.title.touched&&!e.controls.title.valid)),r.xp6(2),r.Q6J("ngClass",r.VKq(11,Be,e.controls.default_value.touched&&!e.controls.default_value.valid)),r.xp6(2),r.s9C("ngbTooltip",r.lcZ(9,5,"DELETE"))}}function Ke(e,t){if(1&e&&(r.TgZ(0,"tbody"),r.YNc(1,He,11,13,"tr",58),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",e.arrayFields.outputProperties.controls)}}function Xe(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",65),r.TgZ(1,"table",52),r.TgZ(2,"thead"),r.TgZ(3,"tr"),r.TgZ(4,"th"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"th"),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"th"),r._uU(11),r.ALo(12,"translate"),r.qZA(),r._UZ(13,"th"),r.qZA(),r.qZA(),r.YNc(14,Ke,2,1,"tbody",53),r.TgZ(15,"tfoot"),r.TgZ(16,"tr",54),r.TgZ(17,"td",55),r.TgZ(18,"button",56),r.NdJ("click",function(t){return r.CHM(e),r.oxw().arrayFieldAdd("outputProperties",t)}),r._UZ(19,"i",57),r._uU(20," \xa0 "),r.TgZ(21,"span"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(5),r.hij(" ",r.lcZ(6,5,"SYSTEM_NAME")," "),r.xp6(3),r.hij(" ",r.lcZ(9,7,"TITLE")," "),r.xp6(3),r.hij(" ",r.lcZ(12,9,"DEFAULT_VALUE")," "),r.xp6(3),r.Q6J("ngIf",e.arrayFields.outputProperties),r.xp6(8),r.Oqu(r.lcZ(23,11,"ADD"))}}function We(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",66),r._uU(1),r.TgZ(2,"button",67),r.NdJ("click",function(){return r.CHM(e),r.oxw().errorMessage=""}),r.qZA(),r.qZA()}if(2&e){const e=r.oxw();r.xp6(1),r.hij(" ",e.errorMessage," ")}}const et=function(e){return{"no-events":e}},tt=function(){return["/catalog"]};let it=(()=>{class e extends D.B{constructor(e,t,i,o,n,s){super(e,t,i,o,n,s),this.fb=e,this.activeModal=t,this.translateService=i,this.systemNameService=o,this.dataService=n,this.elRef=s,this.model=new Pe(0,"","","",!0,[],[]),this.formFields=[{name:"title",validators:[g.kI.required]},{name:"name",validators:[g.kI.required,g.kI.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"isActive",validators:[]},{name:"inputProperties",validators:[],children:[{name:"name",validators:[g.kI.required]},{name:"title",validators:[g.kI.required]},{name:"default_value",validators:[]}]},{name:"outputProperties",validators:[],children:[{name:"name",validators:[g.kI.required]},{name:"title",validators:[g.kI.required]},{name:"default_value",validators:[]}]}]}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(g.qu),r.Y36(_.Kz),r.Y36(l.sK),r.Y36(Z.U),r.Y36(he),r.Y36(r.SBq))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-field-type-modal-content"]],features:[r.qOj],decls:83,vars:68,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"row"],[1,"col-md-6"],[1,"mb-2","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","formControlName","title","id","fieldTitle",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"mb-2","row"],[1,"col-12"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],[1,"mb-2"],["for","fieldDescription",1,"label-filled"],["rows","5","name","description","formControlName","description","id","fieldDescription",1,"form-control"],["activeIds","accordion-input-options",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-input-options",3,"title"],["ngbPanelContent",""],["id","accordion-output-options",3,"title"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","display-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],["formArrayName","inputProperties"],[1,"table","table-bordered","table-divided","mb-0"],[4,"ngIf"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],[1,"text-center"],["type","text","formControlName","title",1,"form-control",3,"ngClass"],["type","text","formControlName","default_value",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],["formArrayName","outputProperties"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"button",2),r.NdJ("click",function(e){return t.closeModal(e)}),r._UZ(3,"i",3),r.TgZ(4,"span"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.TgZ(7,"button",2),r.NdJ("click",function(e){return t.minimize(e)}),r._UZ(8,"i",4),r.TgZ(9,"span"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",5),r.TgZ(13,"div",6),r.TgZ(14,"div",7),r.TgZ(15,"button",8),r.NdJ("click",function(e){return t.maximize(e)}),r.ALo(16,"translate"),r._UZ(17,"i",9),r.qZA(),r.TgZ(18,"button",10),r.NdJ("click",function(e){return t.closeModal(e)}),r.ALo(19,"translate"),r._UZ(20,"i",11),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"h4",12),r._uU(22),r.qZA(),r.qZA(),r.TgZ(23,"form",13,14),r.NdJ("ngSubmit",function(){return t.onSubmit()}),r.TgZ(25,"div",15),r.TgZ(26,"div",16),r.TgZ(27,"div",17),r.TgZ(28,"div",18),r.TgZ(29,"label",19),r._uU(30),r.ALo(31,"translate"),r.qZA(),r._UZ(32,"input",20),r.YNc(33,Ge,2,1,"div",21),r.qZA(),r.TgZ(34,"div",18),r.TgZ(35,"label",22),r._uU(36),r.ALo(37,"translate"),r.qZA(),r.TgZ(38,"div",23),r._UZ(39,"input",24),r.TgZ(40,"button",25),r.NdJ("click",function(){return t.generateName(t.model)}),r.ALo(41,"translate"),r._UZ(42,"i",26),r.qZA(),r.qZA(),r.YNc(43,je,2,1,"div",21),r.qZA(),r.TgZ(44,"div",27),r.TgZ(45,"div",28),r.TgZ(46,"div",29),r.TgZ(47,"div",30),r._UZ(48,"input",31),r.TgZ(49,"label",32),r._uU(50),r.ALo(51,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(52,"div",17),r.TgZ(53,"div",33),r.TgZ(54,"label",34),r._uU(55),r.ALo(56,"translate"),r.qZA(),r._UZ(57,"textarea",35),r.qZA(),r.qZA(),r.qZA(),r.TgZ(58,"ngb-accordion",36,37),r.TgZ(60,"ngb-panel",38),r.ALo(61,"translate"),r.YNc(62,ze,24,13,"ng-template",39),r.qZA(),r.TgZ(63,"ngb-panel",40),r.ALo(64,"translate"),r.YNc(65,Xe,24,13,"ng-template",39),r.qZA(),r.qZA(),r.YNc(66,We,3,1,"div",41),r.qZA(),r.TgZ(67,"div",42),r.TgZ(68,"div",43),r.TgZ(69,"button",44),r.NdJ("click",function(e){return t.save(!0,e)}),r.TgZ(70,"span"),r._uU(71),r.ALo(72,"translate"),r.qZA(),r.qZA(),r.TgZ(73,"div",45),r._UZ(74,"button",46),r.TgZ(75,"div",47),r.TgZ(76,"button",48),r.NdJ("click",function(e){return t.save(!1,e)}),r._uU(77),r.ALo(78,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(79,"button",49),r.NdJ("click",function(e){return t.closeModal(e)}),r.TgZ(80,"span"),r._uU(81),r.ALo(82,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(6,32,"CLOSE")),r.xp6(2),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(11,34,"MINIMIZE")),r.xp6(5),r.Q6J("title",r.lcZ(16,36,"EXPAND")),r.xp6(3),r.Q6J("title",r.lcZ(19,38,"CLOSE")),r.xp6(4),r.Oqu(t.modalTitle),r.xp6(1),r.Q6J("formGroup",t.form)("ngClass",r.VKq(60,et,t.submitted)),r.xp6(2),r.ekj("loading",t.loading),r.xp6(5),r.Oqu(r.lcZ(31,40,"TITLE")),r.xp6(2),r.Q6J("ngClass",r.VKq(62,Be,t.form.controls.title.touched&&!t.form.controls.title.valid)),r.xp6(1),r.Q6J("ngIf",t.formErrors.title),r.xp6(3),r.Oqu(r.lcZ(37,42,"SYSTEM_NAME")),r.xp6(2),r.Q6J("ngClass",r.VKq(64,Be,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.xp6(1),r.Q6J("ngClass",r.VKq(66,Be,t.form.controls.name.touched&&!t.form.controls.name.valid)),r.xp6(1),r.s9C("ngbTooltip",r.lcZ(41,44,"GENERATE")),r.xp6(3),r.Q6J("ngIf",t.formErrors.name),r.xp6(5),r.MGl("id","fieldIsActive",t.uniqueId,""),r.xp6(1),r.MGl("for","fieldIsActive",t.uniqueId,""),r.xp6(1),r.Oqu(r.lcZ(51,46,"ACTIVE")),r.xp6(5),r.Oqu(r.lcZ(56,48,"DESCRIPTION")),r.xp6(3),r.Q6J("closeOthers",!1),r.xp6(2),r.Q6J("title",r.lcZ(61,50,"INPUT_OPTIONS")),r.xp6(3),r.Q6J("title",r.lcZ(64,52,"OUTPUT_OPTIONS")),r.xp6(3),r.Q6J("ngIf",t.errorMessage),r.xp6(3),r.Q6J("disabled",t.submitted),r.xp6(2),r.Oqu(r.lcZ(72,54,"SAVE_AND_CLOSE")),r.xp6(3),r.Q6J("disabled",t.submitted),r.xp6(3),r.Oqu(r.lcZ(78,56,"SAVE")),r.xp6(4),r.Oqu(r.lcZ(82,58,"CLOSE")))},directives:[g._Y,g.JL,g.sg,o.mk,g.Fj,g.JJ,g.u,o.O5,_._L,g.Wl,_.gY,_.Gk,_.gW,_.jt,_.iD,_.Vi,_.TH,g.CE,o.sg,g.x0],pipes:[l.X$],encapsulation:2}),e})();const ot=[{path:"",component:c,children:[{path:"",redirectTo:"category/"},{path:"category",redirectTo:"category/"},{path:"category/:categoryId",component:ue},{path:"content_types",component:Qe},{path:"field_types",component:(()=>{class e extends m.U{constructor(e,t,i,o){super(e,t,i,o),this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=o,this.title="Field types",this.queryOptions=new w.J("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}setModalInputs(e,t=!1,i=""){super.setModalInputs(e,t,i),this.modalRef.componentInstance.modalTitle=e&&!t?`${this.getLangString("FIELD_TYPE")} #${e}`:this.getLangString("ADD_FIELD_TYPE")}getModalElementId(e){return["modal","field_type",e||0].join("-")}getModalContent(){return it}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(he),r.Y36(_.Kz),r.Y36(_.FF),r.Y36(l.sK))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-shk-field-types"]],features:[r.qOj],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"a",2),r._UZ(3,"i",3),r._uU(4," \xa0 "),r.TgZ(5,"span"),r._uU(6),r.ALo(7,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",4),r.TgZ(9,"div",5),r.TgZ(10,"button",6),r.TgZ(11,"span"),r._uU(12),r.ALo(13,"translate"),r.qZA(),r.qZA(),r.TgZ(14,"div",7),r.TgZ(15,"button",8),r.NdJ("click",function(){return t.blockSelected()}),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"button",8),r.NdJ("click",function(){return t.deleteSelected()}),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"button",9),r.NdJ("click",function(){return t.modalOpen()}),r._UZ(22,"i",10),r._uU(23," \xa0 "),r.TgZ(24,"span"),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.qZA(),r.qZA(),r._UZ(27,"div",11),r.qZA(),r.TgZ(28,"app-table",12,13),r.NdJ("selectedIdsChange",function(e){return t.selectedIds=e})("loadingChange",function(e){return t.loading=e})("actionRequest",function(e){return t.actionRequest(e)}),r.qZA()),2&e&&(r.xp6(2),r.Q6J("routerLink",r.DdM(23,tt)),r.xp6(4),r.Oqu(r.lcZ(7,13,"CATALOG")),r.xp6(6),r.Oqu(r.lcZ(13,15,"BATCH_ACTIONS")),r.xp6(4),r.Oqu(r.lcZ(17,17,"DISABLE_ENABLE")),r.xp6(3),r.Oqu(r.lcZ(20,19,"DELETE")),r.xp6(6),r.Oqu(r.lcZ(26,21,"ADD")),r.xp6(3),r.Q6J("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[s.yS,_.jt,_.iD,_.Vi,de.a],pipes:[l.X$],encapsulation:2}),e})()}]}];let nt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[s.Bz.forChild(ot)],s.Bz]}),e})(),st=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({providers:[q,he,ge,y],imports:[[o.ez,n.m,nt]]}),e})()},23056:function(e,t,i){i.d(t,{s:function(){return l}});var o=i(5304),n=i(6887),s=i(37716),r=i(91841);let l=(()=>{class e extends n.D{constructor(e){super(e),this.setRequestUrl("/admin/content_types")}getItemByName(e){const t=this.getRequestUrl()+`/by_name/${e}`;return this.http.get(t).pipe((0,o.K)(this.handleError()))}getItemByCategory(e){const t=this.getRequestUrl()+`/by_category/${e}`;return this.http.get(t).pipe((0,o.K)(this.handleError()))}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(r.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},49093:function(e,t,i){i.d(t,{B:function(){return p}});var o=i(3679),n=i(79765),s=i(46782),r=i(6887),l=i(63124),a=i(37716),d=i(95047),c=i(29790);const u=["formEl"];let p=(()=>{class e{constructor(e,t,i,o,s,r){this.fb=e,this.activeModal=t,this.translateService=i,this.systemNameService=o,this.dataService=s,this.elRef=r,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.dataLoaded=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new n.xQ}set formErrors(e){for(const t in e)if(e.hasOwnProperty(t)){const e=this.getControl(this.form,null,t);e&&e.setErrors({incorrect:!0})}this._formFieldsErrors=e}get formErrors(){return this._formFieldsErrors}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){this.dataLoaded=!0,this.buildControls(this.form,this.formFields)}getSystemFieldName(){return""}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}getModelData(){return this.loading=!0,new Promise((e,t)=>{this.dataService.getItem(this.itemId).pipe((0,s.R)(this.destroyed$)).subscribe({next:t=>{if(this.isItemCopy){t.id=null;const e=this.getSystemFieldName();e&&(t[e]="")}Object.assign(this.model,t),this.loading=!1,e(t)},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.loading=!1,t(e)}})})}buildForm(e="form",t=null,i=null,o="model"){t||(t=this.formFields),this[e]=this.fb.group(this.buildControls(null,t,o)),this[e].valueChanges.pipe((0,s.R)(this.destroyed$)).subscribe(()=>this.onValueChanged(e,i))}buildControls(e=null,t=[],i="model"){const o={};return t.forEach(t=>{const n=e?this.getControl(e,t):null;let s=null;if(i&&this[i]?(this[i].options||(this[i].options={}),s=0===t.name.indexOf("options_")?this[i].options[t.name.substr(8)]||null:this[i][t.name]||null):s=null,n)if(t.disabled&&n.disable(),t.children){const e=s,i=n;i.clear(),e.forEach((e,o)=>{const n=this.getFormFieldByName(t.name),s=this.buildControls(null,n.children,null);i.push(this.fb.group(s))}),i.patchValue(e)}else n.setValue(s);else t.children?(o[t.name]=this.fb.array([]),this.createArrayFieldsProperty(t.name)):o[t.name]=this.fb.control({value:s,disabled:t.disabled||!1},t.validators)}),o}onValueChanged(e="form",t=null){this[e]&&(t||(t=this.formErrors),this[e].valid&&(this.errorMessage=""),Object.keys(this[e].value).forEach(i=>{t[i]="";const o=this.getControl(this[e],null,i);if(o&&!o.valid&&o.errors){let e="";Object.keys(o.errors).forEach(t=>{e+=(e?" ":"")+this.getLangString("INVALID_"+t.toUpperCase())}),t[i]=e}}))}getFormFieldByName(e){const t=this.formFields.filter(t=>t.name===e);return t.length>0?t[0]:null}createArrayFieldsProperty(e){Object.defineProperty(this.arrayFields,e,{get:()=>this.form?this.form.get(e):null})}getControl(e,t,i){return e?e.get(i||t.name):null}focusFormError(){setTimeout(()=>{this.formEl.nativeElement.querySelector(".form-control.is-invalid")&&this.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()},1)}formGroupMarkTouched(e){Object.keys(e.controls).forEach(t=>{e.controls[t].markAsTouched(),e.controls[t]instanceof o.Oe&&Array.from(this.form.controls[t].controls).forEach(e=>{this.formGroupMarkTouched(e)})})}getSaveRequest(e){return e.id||"root"===e.name?this.dataService.update(e):this.dataService.create(e)}getFormData(){const e=this.form.value;return e.id=this.model.id||0,void 0!==this.model.translations&&(e.translations=this.model.translations||null),e}arrayFieldDelete(e,t,i){i&&i.preventDefault(),this.arrayFields[e].removeAt(t)}arrayFieldAdd(e,t){t&&t.preventDefault();const i=this.getFormFieldByName(e);if(!i)return;const o=this.buildControls(null,i.children,null);this.arrayFields[e].push(this.fb.group(o))}generateName(e,t,i=null){t&&t.preventDefault(),i||(i=this.form);const o=this.getControl(i,null,"title").value||"";e.name=this.systemNameService.generateName(o),this.getControl(i,null,"name").setValue(e.name)}closeModal(e){e&&e.preventDefault(),this.close(this.closeReason)}close(e,t){t&&t.preventDefault(),"submit"===e?this.activeModal.close(e):this.activeModal.dismiss(e)}minimize(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),i.classList.remove("d-none")}save(e=!1,t){t&&t.preventDefault(),this.onSubmit(e)}saveFiles(e){if(0===Object.keys(this.files).length)return void this.close("submit");const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),this.dataService.postFormData(t).pipe((0,s.R)(this.destroyed$)).subscribe({next:()=>{this.close("submit")},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}onSubmit(e=!1){if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;const t=this.getFormData();this.getSaveRequest(t).pipe((0,s.R)(this.destroyed$)).subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t._id||t.id):e&&this.close("submit"),t&&t.id&&(this.model.id=t.id),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:e=>{e.error&&(this.errorMessage=e.error),e.errors&&(this.formErrors=e.errors,this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS")),this.loading=!1,this.submitted=!1}})}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(e=>{this.model[e]=this.localePreviousValues[e],this.getControl(this.form,null,e).setValue(this.localePreviousValues[e])}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(e=>{this.localePreviousValues[e]=this.getControl(this.form,null,e).value,this.model.translations[e]?(this.model[e]=this.model.translations[e][this.localeCurrent]||"",this.getControl(this.form,null,e).setValue(this.model[e])):(this.model[e]="",this.getControl(this.form,null,e).setValue(""))})}saveTranslations(e){e&&e.preventDefault(),this.localeFieldsAllowed.forEach(e=>{this.getControl(this.form,null,e)&&this.getControl(this.form,null,e).value?(this.model.translations[e]||(this.model.translations[e]={}),this.model.translations[e][this.localeCurrent]=this.getControl(this.form,null,e).value):this.model.translations[e]&&(this.model.translations[e][this.localeCurrent]&&delete this.model.translations[e][this.localeCurrent],0===Object.keys(this.model.translations[e]).length&&delete this.model.translations[e])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}emailValidator(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}displayToggle(e,t,i){i&&i.preventDefault(),e.style.display=(t=t||"none"===e.style.display)?"block":"none"}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(o.qu),a.Y36(d.Kz),a.Y36(c.sK),a.Y36(l.U),a.Y36(r.D),a.Y36(a.SBq))},e.\u0275cmp=a.Xpm({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&a.Gf(u,5),2&e){let e;a.iGM(e=a.CRH())&&(t.formEl=e.first)}},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},39343:function(e,t,i){i.d(t,{D:function(){return p}});var o=i(3679),n=i(79765),s=i(46782),r=i(63124),l=i(6887),a=i(12946),d=i(37716),c=i(95047),u=i(29790);let p=(()=>{class e{constructor(e,t,i,o,s,r,l){this.fb=e,this.dataService=t,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=s,this.translateService=r,this.elRef=l,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new n.xQ,s.placement="bottom",s.container="body",s.triggers="hover click"}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){}getSystemFieldName(){return"name"}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}getModelData(){return this.loading=!0,new Promise((e,t)=>{this.dataService.getItem(this.itemId).pipe((0,s.R)(this.destroyed$)).subscribe({next:t=>{this.isItemCopy&&(t.id=null,t[this.getSystemFieldName()]=""),this.model=t,this.loading=!1,e(t)},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.loading=!1,t(e)}})})}buildForm(){const e=this.buildControls(this.formFields);this.form=this.fb.group(e),this.form.valueChanges.pipe((0,s.R)(this.destroyed$)).subscribe({next:e=>this.onValueChanged("form","",e)})}buildControls(e,t="model",i=""){const n={};for(const s in e){if(!e.hasOwnProperty(s))continue;const r=e[s],l=r.dataKey?this[t][r.dataKey]:this[t];l[s]||(l[s]=r.value),n[s]=new o.NI({value:l[s]||"",disabled:r.disabled||!1},r.validators),this.formErrors[i+s]="",this.translateValidationMessages(i,s,r)}return n}translateValidationMessages(e,t,i){const n={};!i.fieldLabel||(Object.keys(i.messages).forEach(e=>{"required"!==e&&this.translateService.get(String(i.messages[e])).subscribe(t=>{n[e]=t})}),i.validators.indexOf(o.kI.required)>-1&&this.translateService.get(i.fieldLabel).subscribe(e=>{this.translateService.get("FIELD_REQUIRED",{name:e}).subscribe(e=>{n.required=e})}),this.validationMessages[e+t]=n)}getControl(e){return this.form.controls.name}onValueChanged(e,t="",i){if(!this[e])return;const o=this[e].value;for(const n in o){if(!o.hasOwnProperty(n))continue;this.formErrors[t+n]="";const i=this[e].get(n);if(i&&(i.dirty||this[t+"submitted"])&&!i.valid)for(const e in i.errors)this.formErrors[t+n]+=this.validationMessages[t+n][e]?this.validationMessages[t+n][e]+" ":this.getLangString("ERROR")+" "}}displayToggle(e,t){e.style.display=(t=t||"none"===e.style.display)?"block":"none"}toggleAccordion(e,t,i){e.activeIds.indexOf(t)>-1&&i||e.toggle(t)}generateName(e){e.name=this.systemNameService.generateName(e.title||"")}closeModal(e){e&&e.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}close(e){e&&e.preventDefault(),this.activeModal.dismiss(this.closeReason)}minimize(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");const t=this.getRootElement(),i=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),i.classList.remove("d-none")}getFormData(){const e={};return Object.keys(this.model).forEach(t=>{e[t]=this.files[t]?Array.isArray(this.model[t])?[a.O.getFileData(this.files[t])]:a.O.getFileData(this.files[t]):this.model[t]}),e}fileChange(e,t,i=!1){const o=e.target.files;o.length>0&&(this.model[t]=i?[a.O.getFileData(o[0])]:a.O.getFileData(o[0]),this.files[t]=o[0],this.form.controls[t].setValue(this.files[t].name))}fileClear(e,t){this.model[e]=null,this.form.controls[e].reset(null),t.files=null,t.value="",delete this.files[e]}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(e=>{this.model[e]=this.localePreviousValues[e]}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(e=>{this.localePreviousValues[e]=this.model[e]||"",this.model[e]=this.model.translations[e]&&this.model.translations[e][this.localeCurrent]||""})}saveTranslations(e){e&&e.preventDefault(),this.localeFieldsAllowed.forEach(e=>{this.model[e]?(this.model.translations[e]||(this.model.translations[e]={}),this.model.translations[e][this.localeCurrent]=this.model[e]):this.model.translations[e]&&(this.model.translations[e][this.localeCurrent]&&delete this.model.translations[e][this.localeCurrent],0===Object.keys(this.model.translations[e]).length&&delete this.model.translations[e])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}onSubmit(){this.submitted=!0,this.closeModal()}appendFormData(e){}saveFiles(e){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&t.append(i,this.files[i],this.files[i].name);t.append("itemId",String(e)),this.appendFormData(t),this.dataService.postFormData(t).pipe((0,s.R)(this.destroyed$)).subscribe({next:()=>{this.closeModal()},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}save(e=!1,t){if(t&&t.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe((0,s.R)(this.destroyed$)).subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t._id||t.id):(e?this.closeModal():t&&t.id&&(this.model=t,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:e=>{this.errorMessage=e.error||this.getLangString("ERROR"),this.loading=!1,this.submitted=!1}})}emailValidator(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(o.qu),d.Y36(l.D),d.Y36(r.U),d.Y36(c.Kz),d.Y36(c.xI),d.Y36(u.sK),d.Y36(d.SBq))},e.\u0275cmp=d.Xpm({type:e,selectors:[["ng-component"]],inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})()},3677:function(e,t,i){i.d(t,{U:function(){return p}});var o=i(79765),n=i(46782),s=i(35930),r=i(6887),l=i(90660),a=i(37716),d=i(95047),c=i(29790);const u=["table"];let p=(()=>{class e{constructor(e,t,i,n){this.dataService=e,this.activeModal=t,this.modalService=i,this.translateService=n,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new s.J("name","asc",1,10,0,0),this.destroyed$=new o.xQ}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(e){}onSearchWordUpdate(e){if(void 0!==e)return this.queryOptions.search_word=e,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(e){return["modal",e||0].join("-")}setModalInputs(e,t=!1,i=""){const o=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=this.getLangString(o?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=o}modalOpen(e,t=!1){const i=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const e=window.document.getElementById(i),t=e.previousElementSibling;return e.classList.add("d-block"),e.classList.remove("modal-minimized"),void t.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(e,t,i),this.modalRef.result.then(e=>{this.destroyed$.isStopped||(this.onModalClose(e),this.getList())},e=>{this.destroyed$.isStopped||(this.onModalClose(e),e&&["submit","updated"].indexOf(e)>-1&&this.getList())})}deleteItemConfirm(e){this.modalRef=this.modalService.open(l.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(t=>{"accept"===t&&this.deleteItem(e)})}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}confirmAction(e){return this.modalRef=this.modalService.open(l.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(e=>{this.clearSelected(),this.getList()},e=>this.showAlert(e.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(e=>{"accept"===e&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(e=>{this.clearSelected(),this.getList()},e=>this.showAlert(e.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(e){this.modalRef=this.modalService.open(l.$N),this.modalRef.componentInstance.modalContent=e,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(e){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(t=>{"accept"===t&&this.dataService.deleteItem(e).subscribe(e=>{this.getList()},e=>{e.error&&this.showAlert(e.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(e){switch(e[0]){case"edit":this.modalOpen(e[1]);break;case"copy":this.modalOpen(e[1],!0);break;case"delete":this.deleteItem(e[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe((0,n.R)(this.destroyed$)).subscribe({next:e=>{this.items=e.items,this.collectionSize=e.total,this.loading=!1},error:e=>{this.items=[],this.collectionSize=0,e.error&&this.showAlert(e.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return e.title="",e.\u0275fac=function(t){return new(t||e)(a.Y36(r.D),a.Y36(d.Kz),a.Y36(d.FF),a.Y36(c.sK))},e.\u0275dir=a.lG2({type:e,viewQuery:function(e,t){if(1&e&&a.Gf(u,7),2&e){let e;a.iGM(e=a.CRH())&&(t.table=e.first)}}}),e})()}}]);