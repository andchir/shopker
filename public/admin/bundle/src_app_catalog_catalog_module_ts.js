"use strict";(self.webpackChunkshk_app=self.webpackChunkshk_app||[]).push([["src_app_catalog_catalog_module_ts"],{9138:(R,x,u)=>{u.r(x),u.d(x,{CatalogModule:()=>Ct});var b=u(6019),O=u(7367),A=u(8922),e=u(3668),C=u(8319);const f=function(){return["field_types"]},q=function(){return["content_types"]};let I=(()=>{class i{constructor(){}ngOnInit(){}}return i.title="CATALOG",i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-catalog"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ms-md-2",3,"routerLink"],[1,"icon-toggle"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-box"],[1,"card","card-responsive"],[1,"card-body"],[1,"float-md-start","mt-4","mt-md-0"],[1,"m-0"],[1,"icon-layers"],[1,"clearfix"],[1,"min-height400"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"a",2),e._UZ(3,"i",3),e._uU(4," \xa0 "),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA(),e.TgZ(8,"a",4),e._UZ(9,"i",5),e._uU(10," \xa0 "),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",6),e.TgZ(15,"div",7),e.TgZ(16,"div",8),e.TgZ(17,"h3",9),e._UZ(18,"i",10),e._uU(19," \xa0 "),e.TgZ(20,"span"),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.qZA(),e.qZA(),e._UZ(23,"div",11),e._UZ(24,"hr"),e.TgZ(25,"div",12),e._UZ(26,"router-outlet"),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("routerLink",e.DdM(11,f)),e.xp6(4),e.Oqu(e.lcZ(7,5,"FIELD_TYPES")),e.xp6(2),e.Q6J("routerLink",e.DdM(12,q)),e.xp6(4),e.Oqu(e.lcZ(13,7,"CONTENT_TYPES")),e.xp6(9),e.Oqu(e.lcZ(22,9,"CATALOG")))},directives:[A.yS,A.Od,A.lC],pipes:[C.X$],encapsulation:2}),i})();var T=u(3132);class M{constructor(a,n,t,o,l,c,g,L,S,D,B,j){this.id=a,this.isFolder=n,this.parentId=t,this.name=o,this.title=l,this.description=c,this.contentTypeName=g,this.isActive=L,this.clearCache=S,this.menuIndex=D,this.translations=B,this.image=j,void 0===this.clearCache&&(this.clearCache=!1),void 0===this.translations&&(this.translations={})}static createTree(a,n=null,t=!0){if(0===a.length)return null;if(!n){const l=(0,T.findIndex)(a,{name:"root"});n=l>-1?M.toTreeNode(a[l],t):{id:0,key:0,parentId:0,label:"",expanded:!0,children:[]}}n.children=[];const o=a.filter(l=>0!==l.id&&l.parentId===n.id);return o.length>0&&(o.forEach(l=>{n.children.push(M.toTreeNode(l,t))}),n.children.forEach(l=>{M.createTree(a,l,t)})),0===n.children.length&&(n.children=null),n}static getCurrentNode(a,n){if(!n)return null;if(n.id===a)return n;if(n.children){let t=null;for(let o=0;null==t&&o<n.children.length;o++)t=M.getCurrentNode(a,n.children[o]);return t}return null}static toTreeNode(a,n=!0){return{id:a.id,key:a.id,label:a.title,parentId:a.parentId||0,expanded:n}}}var v=u(5243),p=u(9133);class s{constructor(a,n,t,o,l,c,g,L,S){this.id=a,this.name=n,this.title=t,this.description=o,this.collection=l,this.fields=c,this.groups=g,this.isActive=L,this.isCreateByUsersAllowed=S,this.isCreateByUsersAllowed||(this.isCreateByUsersAllowed=!1)}static getSystemFieldName(a){const n=(0,T.findIndex)(a.fields,{inputType:"system_name"});return n>-1?a.fields[n].name:"name"}static getFieldByName(a,n){const t=(0,T.findIndex)(a.fields,{name:n});return t>-1?a.fields[t]:null}}var r=u(6726),d=u(103),_=u(3196),h=u(1504),Z=u(1599),y=u(4522);let U=(()=>{class i extends Z.D{constructor(n){super(n),this.setRequestUrl("/admin/products")}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(y.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),k=(()=>{class i extends Z.D{constructor(n){super(n),this.setRequestUrl("/admin/files")}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(y.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var N=u(7336),Y=u(6721),m=u(7283),J=u(60),H=u(2774);function W(i,a){if(1&i&&(e.TgZ(0,"div",43),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.parentId," ")}}function X(i,a){if(1&i&&(e.ynx(0),e._UZ(1,"app-input-field-renderer",44),e.BQk()),2&i){const n=e.oxw();e.xp6(1),e.Q6J("fields",n.currentContentType.fields)("groups",n.currentContentType.groups)("formErrors",n.formErrors)("validationMessages",n.validationMessages)("model",n.model)("form",n.form)("files",n.files)("localeFieldsAllowed",n.localeFieldsAllowed)("isLocalizationActive",n.localeCurrent!==n.localeDefault)}}function ee(i,a){if(1&i&&(e.TgZ(0,"label",50),e._UZ(1,"input",51),e._uU(2),e.qZA()),2&i){const n=a.$implicit;e.xp6(1),e.Q6J("value",n),e.xp6(1),e.hij(" ",n," ")}}const te=function(){return{standalone:!0}};function ne(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",45),e.TgZ(1,"button",46),e.NdJ("click",function(o){return e.CHM(n),e.oxw().saveTranslations(o)}),e.ALo(2,"translate"),e._UZ(3,"i",47),e.qZA(),e.TgZ(4,"div",48),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().localeCurrent=o})("ngModelChange",function(){return e.CHM(n),e.oxw().onLocaleSwitch()}),e.YNc(5,ee,3,2,"label",49),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(1),e.s9C("ngbTooltip",e.lcZ(2,5,"SAVE")),e.Q6J("hidden",n.localeCurrent==n.localeDefault),e.xp6(3),e.Q6J("ngModel",n.localeCurrent)("ngModelOptions",e.DdM(7,te)),e.xp6(1),e.Q6J("ngForOf",n.localeList)}}let oe=(()=>{class i extends r.D{constructor(n,t,o,l,c,g,L,S,D,B,j){super(n,t,o,l,c,g,L),this.fb=n,this.dataService=t,this.systemNameService=o,this.activeModal=l,this.tooltipConfig=c,this.translateService=g,this.elRef=L,this.contentTypesService=S,this.categoriesService=D,this.filesService=B,this.appSettings=j,this.categories=[],this.contentTypes=[],this.currentContentType=new s(0,"","","","",[],[],!0),this.model={},this.dataLoaded=!1,this.formFields={parentId:{value:0,validators:[p.kI.required],messages:{required:"Category is required."}},isActive:{value:!0,validators:[],messages:{}},clearCache:{value:!0,validators:[],messages:{}}}}ngOnInit(){this.model={id:0,parentId:this.categoryId},this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),this.model.clearCache=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.buildForm(),this.getCategories(),this.getContentType().then(n=>this.itemId?this.getModelData():Promise.reject(""),n=>(this.dataLoaded=!0,this.errorMessage=n.error||"Error.",Promise.reject(""))).then(n=>{this.dataLoaded=!0,this.onAfterGetData(),this.updateForm()},()=>{this.dataLoaded=!0,this.onAfterGetData()})}onAfterGetData(){this.currentContentType.fields.forEach(n=>{["text","textarea","rich_text"].indexOf(n.inputType)>-1&&this.localeFieldsAllowed.push(n.name)}),(!this.model.translations||Array.isArray(this.model.translations))&&(this.model.translations={})}getSystemFieldName(){return s.getSystemFieldName(this.currentContentType)}getCategories(){this.categoriesService.getListPage().subscribe(n=>{this.categories=n.items},n=>{this.errorMessage=n.error||"Error."})}getContentType(){return this.loading=!0,new Promise((n,t)=>{this.contentTypesService.getItemByCategory(this.categoryId).subscribe(o=>{this.currentContentType=o,this.errorMessage="",this.loading=!1,n(o)},o=>{this.errorMessage=o.error||"Error.",this.loading=!1,t(o)})})}updateForm(n){n||(n=(0,T.clone)(this.model));const t=(0,T.map)(this.currentContentType.fields,function(o){return o.name});t.push("id","parentId","previousParentId","isActive","clearCache","translations"),n.clearCache=!0,Object.keys(this.model).forEach(o=>{if(o.indexOf("__")>-1){const l=N._.getFieldBaseName(o);if(l===o)return;const c=N._.getFieldIndexData(this.currentContentType.fields,l);if(-1===c.index)return;const g=(0,T.cloneDeep)(this.currentContentType.fields[c.index]);g.name=o,this.currentContentType.fields.splice(c.index+c.additFieldsCount+1,0,g),t.push(o)}});for(const o in this.form.controls)this.form.controls.hasOwnProperty(o)&&-1===t.indexOf(o)&&this.form.removeControl(o);this.model=(0,T.pick)(n,t)}onChangeContentType(){const n=parseInt(String(this.model.parentId),10),t=(0,T.findIndex)(this.categories,{id:n});-1!==t&&(!this.currentContentType||this.currentContentType.name!==this.categories[t].contentTypeName)&&(this.model.previousParentId=this.categoryId,this.categoryId=this.categories[t].id,this.getContentType())}saveFiles(n){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const o in this.files)this.files.hasOwnProperty(o)&&this.files[o]instanceof File&&t.append(o,this.files[o],this.files[o].name);t.append("itemId",String(n)),t.append("ownerType",this.currentContentType.name),t.append("categoryId",String(this.model.parentId)),t.append("fieldsSort",this.getFieldsSortData().join(",")),this.filesService.postFormData(t).subscribe(()=>{this.closeModal()},o=>{this.errorMessage=o.error||"Error.",this.submitted=!1,this.loading=!1})}getErrorsString(){const n=[];return Object.keys(this.form.controls).forEach(t=>{if(this.form.controls[t].invalid&&this.validationMessages[t]){const o=N._.getFieldBaseName(t),l=s.getFieldByName(this.currentContentType,o);if(!l)return;let c="";c=this.formErrors[t]?this.formErrors[t]:`${l.title} - error.`,n.push(c)}}),n.join(" ")}getFormData(){const n=(0,T.cloneDeep)(this.model);for(const t in n)n.hasOwnProperty(t)&&n[t]&&"object"==typeof n[t]&&n[t].dataUrl&&delete n[t].dataUrl;return n.fieldsSort=this.getFieldsSortData(),n}getFieldsSortData(){let n=this.currentContentType.fields.map(t=>t.name);return n=n.filter(t=>{if(!this.model[t]||-1===t.indexOf("__"))return!1;const o=t.split("__");return!isNaN(o[1])}),n}save(n=!1){if(this.submitted=!0,this.errorMessage=null,!this.form.valid)return this.onValueChanged("form"),this.errorMessage=this.getErrorsString(),void(this.submitted=!1);this.loading=!0,this.dataService.setRequestUrl(`/admin/products/${this.categoryId}`),this.saveRequest().subscribe({next:t=>{Object.keys(this.files).length>0?this.saveFiles(t.id||t._id):(n?this.closeModal():t&&(t.id||t._id)&&(this.model=t,this.model.id=t.id||t._id,this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:t=>{this.errorMessage=t.error||"Error.",this.submitted=!1,this.loading=!1}})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(p.qu),e.Y36(U),e.Y36(d.U),e.Y36(m.Kz),e.Y36(m.xI),e.Y36(C.sK),e.Y36(e.SBq),e.Y36(h.s),e.Y36(_.G),e.Y36(k),e.Y36(Y.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-product-modal-content"]],inputs:{categoryId:"categoryId"},features:[e._Bn([U]),e.qOj],decls:69,vars:50,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],[3,"formGroup"],[1,"modal-body","py-0"],[1,"row","mb-2","form-group-message"],[1,"col-md-5"],["for","fieldCategory"],[1,"col-md-7"],["id","fieldCategory","formControlName","parentId",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"row","mb-2"],[1,"col-md-7","ms-md-auto"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-indicator"],[1,"form-check-label",3,"for"],[1,"form-check","mt-2"],["type","checkbox","value","1","name","clearCache","formControlName","clearCache",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"min-height300"],[4,"ngIf"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0",3,"hidden"],["type","button",1,"btn-close",3,"click"],[1,"modal-footer","d-block"],["class","float-end",4,"ngIf"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[3,"fields","groups","formErrors","validationMessages","model","form","files","localeFieldsAllowed","isLocalizationActive"],[1,"float-end"],["type","button","placement","left",1,"btn","btn-success","me-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",1,"btn-check",3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(l){return t.closeModal(l)}),e._UZ(3,"i",3),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.TgZ(7,"button",2),e.NdJ("click",function(l){return t.minimize(l)}),e._UZ(8,"i",4),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"div",6),e.TgZ(14,"div",7),e.TgZ(15,"button",8),e.NdJ("click",function(l){return t.maximize(l)}),e.ALo(16,"translate"),e._UZ(17,"i",9),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(l){return t.closeModal(l)}),e.ALo(19,"translate"),e._UZ(20,"i",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"h4",12),e._uU(22),e.qZA(),e.qZA(),e.TgZ(23,"form",13),e.TgZ(24,"div",14),e.TgZ(25,"div",15),e.TgZ(26,"div",16),e.TgZ(27,"label",17),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.qZA(),e.TgZ(30,"div",18),e.TgZ(31,"app-select-parent-dropdown",19),e.NdJ("ngModelChange",function(l){return t.model.parentId=l})("ngModelChange",function(){return t.onChangeContentType()}),e.qZA(),e.YNc(32,W,2,1,"div",20),e.qZA(),e.qZA(),e.TgZ(33,"div",21),e.TgZ(34,"div",22),e.TgZ(35,"div",23),e.TgZ(36,"div",24),e.TgZ(37,"input",25),e.NdJ("ngModelChange",function(l){return t.model.isActive=l}),e.qZA(),e._UZ(38,"span",26),e.TgZ(39,"label",27),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.qZA(),e.TgZ(42,"div",28),e.TgZ(43,"input",29),e.NdJ("ngModelChange",function(l){return t.model.clearCache=l}),e.qZA(),e.TgZ(44,"label",27),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(47,"div",30),e.YNc(48,X,2,9,"ng-container",31),e.qZA(),e.TgZ(49,"div",32),e._uU(50),e.TgZ(51,"button",33),e.NdJ("click",function(){return t.errorMessage=""}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(52,"div",34),e.YNc(53,ne,6,8,"div",35),e.TgZ(54,"div",36),e.TgZ(55,"button",37),e.NdJ("click",function(){return t.save(!0)}),e.TgZ(56,"span"),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.qZA(),e.TgZ(59,"div",38),e._UZ(60,"button",39),e.TgZ(61,"div",40),e.TgZ(62,"button",41),e.NdJ("click",function(){return t.save()}),e._uU(63),e.ALo(64,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(65,"button",42),e.NdJ("click",function(l){return t.closeModal(l)}),e.TgZ(66,"span"),e._uU(67),e.ALo(68,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(6,30,"CLOSE")),e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(11,32,"MINIMIZE")),e.xp6(5),e.Q6J("title",e.lcZ(16,34,"EXPAND")),e.xp6(3),e.Q6J("title",e.lcZ(19,36,"CLOSE")),e.xp6(4),e.Oqu(t.modalTitle),e.xp6(1),e.ekj("loading",t.loading),e.Q6J("formGroup",t.form),e.xp6(5),e.Oqu(e.lcZ(29,38,"PARENT_FOLDER")),e.xp6(3),e.Q6J("ngModel",t.model.parentId),e.xp6(1),e.Q6J("ngIf",t.formErrors.parentId),e.xp6(5),e.MGl("id","fieldIsActive",t.uniqueId,""),e.Q6J("ngModel",t.model.isActive),e.xp6(2),e.MGl("for","fieldIsActive",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(41,40,"ACTIVE")),e.xp6(3),e.MGl("id","fieldClearCache",t.uniqueId,""),e.Q6J("ngModel",t.model.clearCache),e.xp6(1),e.MGl("for","fieldClearCache",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(46,42,"CLEAR_FILE_CACHE")),e.xp6(3),e.Q6J("ngIf",t.dataLoaded),e.xp6(1),e.Q6J("hidden",!t.errorMessage),e.xp6(1),e.hij(" ",t.errorMessage," "),e.xp6(3),e.Q6J("ngIf",t.localeList.length>1),e.xp6(2),e.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),e.xp6(2),e.Oqu(e.lcZ(58,44,"SAVE_AND_CLOSE")),e.xp6(3),e.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),e.xp6(3),e.Oqu(e.lcZ(64,46,"SAVE")),e.xp6(4),e.Oqu(e.lcZ(68,48,"CLOSE")))},directives:[p._Y,p.JL,p.sg,J.F,p.JJ,p.u,b.O5,p.Wl,m.jt,m.iD,m.Vi,m.TH,H.u,m._L,m.py,p.On,b.sg,m.mL,m.aB],pipes:[C.X$],encapsulation:2}),i})();var w=u(417),ie=u(3405),se=u(8805),Q=u(3240),le=u(9985),re=u(3961),ae=u(1577);function de(i,a){if(1&i&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&i){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.formErrors.parentId," ")}}function ce(i,a){if(1&i&&(e.TgZ(0,"div",23),e.TgZ(1,"div",18),e.TgZ(2,"label",55),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.TgZ(5,"div",20),e._UZ(6,"app-select-parent-dropdown",56),e.YNc(7,de,2,1,"div",22),e.qZA(),e.qZA()),2&i){const n=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,5,"PARENT_FOLDER")),e.xp6(3),e.ekj("is-invalid",n.formErrors.parentId),e.Q6J("filterId",n.model.id),e.xp6(1),e.Q6J("ngIf",n.formErrors.parentId)}}function pe(i,a){if(1&i&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.title," ")}}function ue(i,a){if(1&i&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.name," ")}}function me(i,a){if(1&i&&(e.TgZ(0,"option",58),e._uU(1),e.qZA()),2&i){const n=a.$implicit;e.Q6J("value",n.name),e.xp6(1),e.Oqu(n.title)}}function ge(i,a){if(1&i&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.contentTypeName," ")}}function he(i,a){if(1&i&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&i){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.formErrors.menuIndex," ")}}function _e(i,a){if(1&i&&(e.TgZ(0,"div",23),e.TgZ(1,"div",18),e.TgZ(2,"label",59),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.TgZ(5,"div",20),e._UZ(6,"input",60),e.YNc(7,he,2,1,"div",22),e.qZA(),e.qZA()),2&i){const n=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,4,"MENU_INDEX")," "),e.xp6(3),e.ekj("is-invalid",n.formErrors.menuIndex),e.xp6(1),e.Q6J("ngIf",n.formErrors.menuIndex)}}function fe(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",61),e._uU(1),e.TgZ(2,"button",62),e.NdJ("click",function(){return e.CHM(n),e.oxw().errorMessage=""}),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.errorMessage," ")}}function Te(i,a){if(1&i&&(e.TgZ(0,"label",68),e._UZ(1,"input",69),e._uU(2),e.qZA()),2&i){const n=a.$implicit;e.xp6(1),e.Q6J("value",n),e.xp6(1),e.hij(" ",n," ")}}const Ze=function(){return{standalone:!0}};function Ce(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",63),e.TgZ(1,"button",64),e.NdJ("click",function(o){return e.CHM(n),e.oxw().saveTranslations(o)}),e.ALo(2,"translate"),e._UZ(3,"i",65),e.qZA(),e.TgZ(4,"div",66),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().localeCurrent=o})("ngModelChange",function(){return e.CHM(n),e.oxw().onLocaleSwitch()}),e.YNc(5,Te,3,2,"label",67),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(1),e.s9C("ngbTooltip",e.lcZ(2,5,"SAVE")),e.Q6J("hidden",n.localeCurrent==n.localeDefault),e.xp6(3),e.Q6J("ngModel",n.localeCurrent)("ngModelOptions",e.DdM(7,Ze)),e.xp6(1),e.Q6J("ngForOf",n.localeList)}}const be=function(i){return{"no-events":i}},Ae=function(i,a){return{"is-invalid":i,"border-success":a}},V=function(i){return{"is-invalid":i}},ve=function(i){return{"border-success":i}},Me=["categoriesDropdown"];function Ie(i,a){if(1&i){const n=e.EpF();e.ynx(0),e.TgZ(1,"button",9),e.NdJ("click",function(o){return e.CHM(n),e.oxw().expandAll(o)}),e.ALo(2,"translate"),e._UZ(3,"i",17),e.qZA(),e.TgZ(4,"button",18),e.NdJ("click",function(o){return e.CHM(n),e.oxw().collapseAll(o)}),e.ALo(5,"translate"),e._UZ(6,"i",19),e.qZA(),e.BQk()}2&i&&(e.xp6(1),e.s9C("ngbTooltip",e.lcZ(2,2,"EXPAND_ALL")),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(5,4,"COLLAPSE_ALL")))}function Ee(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(n),e.oxw().goToRootCategory()}),e.ALo(1,"translate"),e._UZ(2,"i",20),e.qZA()}2&i&&e.s9C("ngbTooltip",e.lcZ(1,1,"OPEN_ROOT_CATEGORY"))}let Le=(()=>{class i extends Q.B{constructor(n,t,o,l,c,g,L,S,D){super(n,t,o,l,c,g),this.fb=n,this.activeModal=t,this.translateService=o,this.systemNameService=l,this.dataService=c,this.elRef=g,this.filesService=L,this.contentTypesService=S,this.appSettings=D,this.isRoot=!1,this.model=new M(null,!1,0,"","","","",!0),this.contentTypes=[],this.loadingCategories=!1,this.categories=[],this.isCollapsed=!1,this.localeFieldsAllowed=["title","description"],this.files={},this.formFields=[{name:"title",validators:[p.kI.required]},{name:"name",validators:[p.kI.required]},{name:"description",validators:[]},{name:"parentId",validators:[]},{name:"image",validators:[]},{name:"contentTypeName",validators:[]},{name:"menuIndex",validators:[]},{name:"isActive",validators:[]},{name:"clearCache",validators:[]}]}ngOnInit(){this.uniqueId=this.createUniqueId(),this.localeList=this.appSettings.settings.localeList,this.localeList.length>0&&(this.localeDefault=this.localeList[0],this.localeCurrent=this.localeList[0]),void 0!==this.itemId&&(this.model.id=this.itemId),this.model.parentId=this.isEditMode?this.currentCategory.parentId:this.currentCategory.id,this.model.contentTypeName=this.currentCategory.contentTypeName,this.isRoot&&(this.model.id=0,this.model.title=this.getLangString("ROOT_FOLDER"),this.model.name="root"),this.getContentTypes(),super.ngOnInit()}ngAfterViewInit(){this.elRef.nativeElement.querySelector("#fieldTitle")&&this.elRef.nativeElement.querySelector("#fieldTitle").focus()}onAfterGetData(){this.model.clearCache=!0,(!this.model.translations||Array.isArray(this.model.translations))&&(this.model.translations={}),super.onAfterGetData()}getContentTypes(){this.contentTypesService.getListPage().subscribe(n=>{this.contentTypes=n.items},n=>this.errorMessage=n)}onCategorySelect(n){this.form.controls.parentId.setValue(n.node.id),this.model.parentId=n.node.id}saveFiles(n){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const o in this.files)this.files.hasOwnProperty(o)&&this.files[o]instanceof File&&t.append(o,this.files[o],this.files[o].name);t.append("itemId",String(n)),t.append("ownerType","category"),this.filesService.postFormData(t).subscribe(()=>{this.closeModal()},o=>{this.errorMessage=o.error||"Error.",this.submitted=!1,this.loading=!1})}generateName(n,t){t&&t.preventDefault();const o=this.getControl(this.form,null,"title").value||"";n.name=this.systemNameService.generateName(o),this.getControl(this.form,null,"name").setValue(n.name)}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(p.qu),e.Y36(m.Kz),e.Y36(C.sK),e.Y36(d.U),e.Y36(_.G),e.Y36(e.SBq),e.Y36(k),e.Y36(h.s),e.Y36(Y.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-category-modal-content"]],inputs:{currentCategory:"currentCategory",isRoot:"isRoot"},features:[e.qOj],decls:102,vars:84,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],["class","row mb-2 form-group-message",4,"ngIf"],[1,"row","mb-2","show-on-hover-parent","form-group-message"],[1,"col-md-5"],["for","fieldTitle"],[1,"col-md-7"],["type","text","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],[1,"row","mb-2","form-group-message"],["for","fieldName"],[1,"input-group",3,"ngClass"],["type","text","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","disabled","click"],[1,"icon-reload"],[1,"row","mb-2","show-on-hover-parent"],["for","fieldDescription"],["type","text","id","fieldDescription","rows","4","name","description","formControlName","description",1,"form-control",3,"ngClass"],[1,"row","mb-2"],["formControlName","image",3,"hasPreviewImage","allowedExtensions","files","filesChange"],["for","fieldContentType"],["id","fieldContentType","name","contentTypeName","formControlName","contentTypeName",1,"form-select"],["value","1",3,"value",4,"ngFor","ngForOf"],[1,"col-md-7","ms-md-auto"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","mb-2"],["type","checkbox","id","fieldIsActive","value","1","name","isActive","formControlName","isActive",1,"form-check-input"],["for","fieldIsActive",1,"form-check-label"],[1,"form-check","m-0"],["type","checkbox","id","fieldClearCache","value","1","name","clearCache","formControlName","clearCache",1,"form-check-input"],["for","fieldClearCache",1,"form-check-label"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],["class","float-end",4,"ngIf"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"disabled","click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["for","fieldParent"],["formControlName","parentId",3,"filterId"],[1,"alert","alert-danger"],["value","1",3,"value"],["for","fieldMenuIndex"],["type","number","id","fieldMenuIndex","name","menuIndex","formControlName","menuIndex",1,"form-control"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"float-end"],["type","button","placement","left",1,"btn","btn-success","me-2",3,"ngbTooltip","hidden","click"],[1,"icon-check"],["ngbRadioGroup","","name","radioBasic",1,"btn-group","btn-group-toggle",3,"ngModel","ngModelOptions","ngModelChange"],["ngbButtonLabel","","class","btn-secondary",4,"ngFor","ngForOf"],["ngbButtonLabel","",1,"btn-secondary"],["ngbButton","","type","radio",1,"btn-check",3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(l){return t.closeModal(l)}),e._UZ(3,"i",3),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.TgZ(7,"button",2),e.NdJ("click",function(l){return t.minimize(l)}),e._UZ(8,"i",4),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"div",6),e.TgZ(14,"div",7),e.TgZ(15,"button",8),e.NdJ("click",function(l){return t.maximize(l)}),e.ALo(16,"translate"),e._UZ(17,"i",9),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(l){return t.closeModal(l)}),e.ALo(19,"translate"),e._UZ(20,"i",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"h4",12),e._uU(22),e.qZA(),e.qZA(),e.TgZ(23,"form",13,14),e.NdJ("ngSubmit",function(){return t.onSubmit()}),e.TgZ(25,"div",15),e.YNc(26,ce,8,7,"div",16),e.TgZ(27,"div",17),e.TgZ(28,"div",18),e.TgZ(29,"label",19),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.qZA(),e.TgZ(32,"div",20),e._UZ(33,"input",21),e.YNc(34,pe,2,1,"div",22),e.qZA(),e.qZA(),e.TgZ(35,"div",23),e.TgZ(36,"div",18),e.TgZ(37,"label",24),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.qZA(),e.TgZ(40,"div",20),e.TgZ(41,"div",25),e._UZ(42,"input",26),e.TgZ(43,"button",27),e.NdJ("click",function(){return t.generateName(t.model)}),e.ALo(44,"translate"),e._UZ(45,"i",28),e.qZA(),e.qZA(),e.YNc(46,ue,2,1,"div",22),e.qZA(),e.qZA(),e.TgZ(47,"div",29),e.TgZ(48,"div",18),e.TgZ(49,"label",30),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.qZA(),e.TgZ(52,"div",20),e._UZ(53,"textarea",31),e.qZA(),e.qZA(),e.TgZ(54,"div",32),e.TgZ(55,"div",18),e.TgZ(56,"label"),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.qZA(),e.TgZ(59,"div",20),e.TgZ(60,"app-file-widget",33),e.NdJ("filesChange",function(l){return t.files=l}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(61,"div",23),e.TgZ(62,"div",18),e.TgZ(63,"label",34),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.qZA(),e.TgZ(66,"div",20),e.TgZ(67,"select",35),e.YNc(68,me,2,2,"option",36),e.qZA(),e.YNc(69,ge,2,1,"div",22),e.qZA(),e.qZA(),e.YNc(70,_e,8,6,"div",16),e.TgZ(71,"div",32),e.TgZ(72,"div",37),e.TgZ(73,"div",38),e.TgZ(74,"div",39),e._UZ(75,"input",40),e.TgZ(76,"label",41),e._uU(77),e.ALo(78,"translate"),e.qZA(),e.qZA(),e.TgZ(79,"div",42),e._UZ(80,"input",43),e.TgZ(81,"label",44),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(84,fe,3,1,"div",45),e.qZA(),e.TgZ(85,"div",46),e.YNc(86,Ce,6,8,"div",47),e.TgZ(87,"div",48),e.TgZ(88,"button",49),e.NdJ("click",function(l){return t.save(!0,l)}),e.TgZ(89,"span"),e._uU(90),e.ALo(91,"translate"),e.qZA(),e.qZA(),e.TgZ(92,"div",50),e._UZ(93,"button",51),e.TgZ(94,"div",52),e.TgZ(95,"button",53),e.NdJ("click",function(l){return t.save(!1,l)}),e._uU(96),e.ALo(97,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(98,"button",54),e.NdJ("click",function(l){return t.closeModal(l)}),e.TgZ(99,"span"),e._uU(100),e.ALo(101,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(6,43,"CLOSE")),e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(11,45,"MINIMIZE")),e.xp6(5),e.Q6J("title",e.lcZ(16,47,"EXPAND")),e.xp6(3),e.Q6J("title",e.lcZ(19,49,"CLOSE")),e.xp6(4),e.Oqu(t.modalTitle),e.xp6(1),e.Q6J("formGroup",t.form)("ngClass",e.VKq(73,be,t.submitted)),e.xp6(2),e.ekj("loading",t.loading),e.xp6(1),e.Q6J("ngIf",!t.isRoot),e.xp6(4),e.hij(" ",e.lcZ(31,51,"TITLE")," "),e.xp6(3),e.Q6J("ngClass",e.WLB(75,Ae,t.form.controls.title.touched&&!t.form.controls.title.valid,t.localeCurrent!=t.localeDefault)),e.xp6(1),e.Q6J("ngIf",t.formErrors.title),e.xp6(4),e.hij(" ",e.lcZ(39,53,"SYSTEM_NAME")," "),e.xp6(3),e.Q6J("ngClass",e.VKq(78,V,t.form.controls.name.touched&&!t.form.controls.name.valid)),e.xp6(1),e.Q6J("ngClass",e.VKq(80,V,t.form.controls.name.touched&&!t.form.controls.name.valid)),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(44,55,"GENERATE")),e.Q6J("disabled",t.form.controls.name.disabled),e.xp6(3),e.Q6J("ngIf",t.formErrors.name),e.xp6(4),e.hij(" ",e.lcZ(51,57,"DESCRIPTION")," "),e.xp6(3),e.Q6J("ngClass",e.VKq(82,ve,t.localeCurrent!=t.localeDefault)),e.xp6(4),e.hij(" ",e.lcZ(58,59,"IMAGE")," "),e.xp6(3),e.Q6J("hasPreviewImage",!0)("allowedExtensions","image/*")("files",t.files),e.xp6(4),e.hij(" ",e.lcZ(65,61,"CONTENT_TYPE")," "),e.xp6(3),e.ekj("is-invalid",t.formErrors.contentTypeName),e.xp6(1),e.Q6J("ngForOf",t.contentTypes),e.xp6(1),e.Q6J("ngIf",t.formErrors.contentTypeName),e.xp6(1),e.Q6J("ngIf",!t.isRoot),e.xp6(7),e.Oqu(e.lcZ(78,63,"ACTIVE")),e.xp6(5),e.Oqu(e.lcZ(83,65,"CLEAR_FILE_CACHE")),e.xp6(2),e.Q6J("ngIf",t.errorMessage),e.xp6(2),e.Q6J("ngIf",t.localeList.length>1),e.xp6(2),e.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),e.xp6(2),e.Oqu(e.lcZ(91,67,"SAVE_AND_CLOSE")),e.xp6(3),e.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),e.xp6(2),e.Q6J("disabled",t.submitted||t.isSaveButtonDisabled),e.xp6(1),e.hij(" ",e.lcZ(97,69,"SAVE")," "),e.xp6(4),e.Oqu(e.lcZ(101,71,"CLOSE")))},directives:[p._Y,p.JL,p.sg,b.mk,b.O5,p.Fj,p.JJ,p.u,m._L,re.E,p.EJ,b.sg,p.Wl,m.jt,m.iD,m.Vi,m.TH,J.F,p.YN,p.Kr,p.wV,m.py,p.On,m.mL,m.aB],pipes:[C.X$],encapsulation:2}),i})(),xe=(()=>{class i{constructor(n,t,o,l,c){this.router=n,this.route=t,this.modalService=o,this.categoriesService=l,this.translateService=c,this.rootTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",this.changeRequest=new e.vpe,this.currentCategory=new M(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode={id:0,key:0},this.categoriesTree=[{id:0,key:0,parentId:0,label:"",expanded:!0,children:null}],this.categories=[],this.errorMessage="",this.categoryId=0,this.loading=!1,this.destroyed$=new ie.xQ}getLangString(n){return this.translateService.store.translations[this.translateService.currentLang][n]||n}ngOnInit(){this.loading=!0,this.getCategories().then(n=>{this.loading=!1,this.route.paramMap.pipe((0,se.R)(this.destroyed$)).subscribe(t=>{this.categoryId=t.get("categoryId")?parseInt(t.get("categoryId"),10):0,this.selectCurrent()})})}selectCurrent(){if(this.currentCategory.id===this.categoryId)return;const n=(0,T.findIndex)(this.categories,{id:this.categoryId});n>-1?(this.currentCategory=(0,T.cloneDeep)(this.categories[n]),this.changeRequest.emit(this.currentCategory)):this.openRootCategory(),this.currentCategoryNode=M.getCurrentNode(this.currentCategory.id,this.categoriesTree[0])}getCategories(){return new Promise((n,t)=>{this.categoriesService.getListPage(new w.J("menuIndex,title","asc",1)).subscribe(o=>{o.items&&o.items.length>0&&(this.categories=o.items,this.categoriesTree=[M.createTree(o.items)]),n(o.items)},o=>{this.errorMessage=o,t()})})}openModalCategory(n,t=!1){this.categoriesDropdown.nativeElement.previousSibling.classList.remove("dropdown-toggle-hover"),setTimeout(()=>{this.categoriesDropdown.nativeElement.previousSibling.classList.add("dropdown-toggle-hover")},1);const o=this.getModalElementId(n);if(window.document.body.classList.add("modal-open"),window.document.getElementById(o)){const g=window.document.getElementById(o),L=g.previousElementSibling;return g.classList.add("d-block"),g.classList.remove("modal-minimized"),void L.classList.remove("d-none")}const l=0===n||null===n,c=void 0!==n&&!t;this.modalRef=this.modalService.open(Le,{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.modalRef.componentInstance.modalTitle=c?this.getLangString("CATEGORY")+(n?` #${n}`:""):this.getLangString("ADD_NEW_CATEGORY"),this.modalRef.componentInstance.modalId=o,this.modalRef.componentInstance.itemId=n||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.currentCategory=this.currentCategory,this.modalRef.componentInstance.isRoot=l,this.modalRef.componentInstance.isEditMode=c,this.modalRef.result.then(g=>{this.destroyed$.isStopped||(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1}))},g=>{this.destroyed$.isStopped||(g&&["submit","updated"].indexOf(g)>-1&&(this.currentCategory.id=null,this.loading=!0,this.getCategories().then(()=>{this.selectCurrent(),this.loading=!1})),this.loading=!1)})}getModalElementId(n){return["modal","category",n||0].join("-")}deleteCategoryItemConfirm(n){const t=(0,T.findIndex)(this.categories,{id:n});-1!==t&&(this.modalRef=this.modalService.open(le.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE_CATEGORY")+` "${this.categories[t].title}"?`,this.modalRef.result.then(o=>{"accept"===o&&this.deleteCategoryItem(n)},o=>{}))}deleteCategoryItem(n){this.loading=!0,this.categoriesService.deleteItem(n).subscribe(t=>{this.categoryId=0,this.getCategories().then(()=>{this.goToRootCategory(),this.loading=!1})},t=>{t.error&&(this.errorMessage=t.error),this.loading=!1})}openCategory(n){this.router.navigate(["/catalog/category",n.node.id])}goToRootCategory(){this.router.navigate(["/catalog/category",""])}openRootCategory(){this.currentCategory=new M(null,!1,0,"root",this.rootTitle,"","",!0),this.currentCategoryNode=this.categoriesTree[0],this.changeRequest.emit(this.currentCategory)}copyCategory(){this.openModalCategory(this.currentCategory.id,!0)}expandAll(n){n&&n.preventDefault(),this.categoriesTree.forEach(t=>{this.expandRecursive(t,!0)})}collapseAll(n){n&&n.preventDefault(),this.categoriesTree.forEach(t=>{this.expandRecursive(t,!1)})}expandRecursive(n,t){n.expanded=t,n.children&&n.children.forEach(o=>{this.expandRecursive(o,t)})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(A.F0),e.Y36(A.gz),e.Y36(m.FF),e.Y36(_.G),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-categories-menu"]],viewQuery:function(n,t){if(1&n&&e.Gf(Me,7),2&n){let o;e.iGM(o=e.CRH())&&(t.categoriesDropdown=o.first)}},inputs:{rootTitle:"rootTitle"},outputs:{changeRequest:"changeRequest"},decls:26,vars:26,consts:[[1,"d-block","d-md-inline-block","dropdown"],[1,"btn","btn-secondary","dropdown-toggle","dropdown-toggle-hover","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],[1,"icon-folder","me-1"],[1,"dropdown-menu","main-menu-container","py-3","shadow"],["categoriesDropdown",""],[1,"px-3","pb-3"],[1,"float-end"],[4,"ngIf"],["type","button","class","btn btn-sm btn-secondary me-2",3,"ngbTooltip","click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-secondary","me-2",3,"ngbTooltip","click"],[1,"icon-plus"],[1,"icon-pencil"],["type","button",1,"btn","btn-sm","btn-secondary","me-2",3,"ngbTooltip","hidden","click"],[1,"icon-stack"],[1,"icon-cross"],[1,"px-3","max-height400"],[3,"value","emptyMessage","selectionMode","selection","filter","selectionChange","onNodeSelect"],[1,"pi","pi-angle-double-down"],["type","button",1,"btn","btn-sm","btn-secondary",3,"ngbTooltip","click"],[1,"pi","pi-angle-double-up"],[1,"icon-home"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"button",1),e._UZ(2,"i",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3,4),e.TgZ(6,"div"),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.YNc(9,Ie,7,6,"ng-container",7),e.qZA(),e.YNc(10,Ee,3,3,"button",8),e.TgZ(11,"button",9),e.NdJ("click",function(){return t.openModalCategory()}),e.ALo(12,"translate"),e._UZ(13,"i",10),e.qZA(),e.TgZ(14,"button",9),e.NdJ("click",function(){return t.openModalCategory(t.currentCategory.id)}),e.ALo(15,"translate"),e._UZ(16,"i",11),e.qZA(),e.TgZ(17,"button",12),e.NdJ("click",function(){return t.copyCategory()}),e.ALo(18,"translate"),e._UZ(19,"i",13),e.qZA(),e.TgZ(20,"button",12),e.NdJ("click",function(){return t.deleteCategoryItemConfirm(t.currentCategory.id)}),e.ALo(21,"translate"),e._UZ(22,"i",14),e.qZA(),e.qZA(),e.TgZ(23,"div",15),e.TgZ(24,"p-tree",16),e.NdJ("selectionChange",function(l){return t.currentCategoryNode=l})("onNodeSelect",function(l){return t.openCategory(l)}),e.ALo(25,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.hij(" ",t.currentCategory.title," "),e.xp6(3),e.ekj("loading",t.loading),e.xp6(3),e.Q6J("ngIf",t.categoriesTree[0].children),e.xp6(1),e.Q6J("ngIf",t.currentCategory.id>0),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(12,16,"ADD_NEW_CATEGORY")),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(15,18,"EDIT_CATEGORY")),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(18,20,"COPY_CATEGORY")),e.Q6J("hidden",!t.currentCategory.id),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(21,22,"DELETE_CATEGORY")),e.Q6J("hidden",!t.currentCategory.id),e.xp6(4),e.Q6J("value",t.categoriesTree[0].children)("emptyMessage",e.lcZ(25,24,"NO_CATEGORIES"))("selectionMode","single")("selection",t.currentCategoryNode)("filter",!0))},directives:[b.O5,m._L,ae.mp],pipes:[C.X$],encapsulation:2}),i})();var G=u(9518);const Oe=function(i){return{"form-control-search-clear":i}};let Fe=(()=>{class i extends v.U{constructor(n,t,o,l,c){super(n,t,o,l),this.dataService=n,this.activeModal=t,this.modalService=o,this.translateService=l,this.contentTypesService=c,this.queryOptions=new w.J("id","desc",1,10,0,0),this.tableFields=[]}ngOnInit(){}updateTableConfig(){!this.currentContentType||(this.tableFields=[],this.currentContentType.fields.forEach(n=>{n.showInTable&&this.tableFields.push({name:n.name,sortName:n.name,title:n.title,outputType:n.outputType,outputProperties:n.outputProperties})}),this.tableFields.unshift({name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}}),this.tableFields.push({name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}))}getModalContent(){return oe}getContentType(){return this.contentTypesService.getItemByName(this.currentCategory.contentTypeName)}openCategory(n){if(this.currentCategory=(0,T.clone)(n),!this.currentCategory.contentTypeName)return this.items=[],this.tableFields=[],void(this.currentCategory.id=0);this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.loading=!0,this.queryOptions.page=1,this.getContentType().subscribe(t=>{this.currentContentType=t,this.loading=!1,this.updateTableConfig(),this.getList()},()=>{this.items=[],this.tableFields=[],this.currentCategory.id=0})}openRootCategory(){this.currentCategory=new M(0,!1,0,"root","","","",!0),this.dataService.setRequestUrl("/admin/products/"+this.currentCategory.id),this.getList()}setModalInputs(n,t=!1,o=""){const l=void 0!==n&&!t;this.modalRef.componentInstance.modalTitle=l?`${this.getLangString("PAGE")} #${n}`:this.getLangString("ADD"),this.modalRef.componentInstance.modalId=o,this.modalRef.componentInstance.itemId=n||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=l;const c=this.items.findIndex(g=>g.id===n);this.modalRef.componentInstance.categoryId=c>-1?this.items[c].parentId:this.currentCategory.id}getModalElementId(n){return["modal","product",n||0].join("-")}}return i.title="CATEGORY",i.\u0275fac=function(n){return new(n||i)(e.Y36(U),e.Y36(m.Kz),e.Y36(m.FF),e.Y36(C.sK),e.Y36(h.s))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-catalog-category"]],features:[e._Bn([U]),e.qOj],decls:30,vars:25,consts:[[1,"mb-3"],[1,"float-md-start"],[3,"changeRequest"],[1,"form-control-search","d-block","d-md-inline-block","ms-0","ms-md-3","mb-2","mb-lg-0",3,"ngClass"],["type","text",1,"form-control","min-width250",3,"placeholder","ngModel","ngModelChange"],[3,"click"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"div",1),e.TgZ(3,"app-categories-menu",2),e.NdJ("changeRequest",function(l){return t.openCategory(l)}),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"input",4),e.NdJ("ngModelChange",function(l){return t.queryOptions.search_word=l})("ngModelChange",function(){return t.onSearchWordUpdate()}),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span",5),e.NdJ("click",function(){return t.onSearchWordUpdate("")}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",6),e.TgZ(9,"div",7),e.TgZ(10,"button",8),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.TgZ(14,"div",9),e.TgZ(15,"button",10),e.NdJ("click",function(){return t.blockSelected()}),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(){return t.deleteSelected()}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"button",11),e.NdJ("click",function(){return t.modalOpen()}),e._UZ(22,"i",12),e._uU(23," \xa0 "),e.TgZ(24,"span"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.qZA(),e.qZA(),e._UZ(27,"div",13),e.qZA(),e.qZA(),e.TgZ(28,"app-table",14,15),e.NdJ("selectedIdsChange",function(l){return t.selectedIds=l})("loadingChange",function(l){return t.loading=l})("actionRequest",function(l){return t.actionRequest(l)}),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngClass",e.VKq(23,Oe,!!t.queryOptions.search_word)),e.xp6(1),e.MGl("placeholder","",e.lcZ(6,13,"SEARCH"),"..."),e.Q6J("ngModel",t.queryOptions.search_word),e.xp6(7),e.Oqu(e.lcZ(13,15,"BATCH_ACTIONS")),e.xp6(4),e.Oqu(e.lcZ(17,17,"DISABLE_ENABLE")),e.xp6(3),e.Oqu(e.lcZ(20,19,"DELETE")),e.xp6(6),e.Oqu(e.lcZ(26,21,"ADD")),e.xp6(3),e.Q6J("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("loading",t.loading))},directives:[xe,b.mk,p.Fj,p.JJ,p.On,m.jt,m.iD,m.Vi,G.a],pipes:[C.X$],encapsulation:2}),i})();var Se=u(2411),K=u(2047);let $=(()=>{class i{constructor(n){this.http=n,this.headers=new y.WM({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="/admin/collections"}setRequestUrl(n){this.requestUrl=n}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe((0,K.K)(this.handleError()))}deleteItemByName(n){const t=`${this.getRequestUrl()}/${n}`;return this.http.delete(t,{headers:this.headers}).pipe((0,K.K)(this.handleError()))}handleError(n="operation",t){return o=>{if(o.error)throw o.error;return(0,Se.of)(t)}}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(y.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),P=(()=>{class i extends Z.D{constructor(n){super(n),this.setRequestUrl("/admin/field_types")}}return i.\u0275fac=function(n){return new(n||i)(e.LFG(y.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var Ue=u(2189),ke=u(4127),De=u(8706);const Ne=["addCollectionBlock"],we=["addGroupBlock"],Re=["accordion"],Je=["blockFieldList"];function Pe(i,a){if(1&i&&(e.TgZ(0,"div",113),e._uU(1),e.qZA()),2&i){const n=e.oxw().message;e.xp6(1),e.Oqu(n)}}function Ye(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"p",110),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.YNc(3,Pe,2,1,"div",111),e.TgZ(4,"div",110),e.TgZ(5,"button",112),e.NdJ("click",function(){return e.CHM(n).confirm()}),e._uU(6),e.ALo(7,"translate"),e.qZA(),e._uU(8," \xa0 "),e.TgZ(9,"button",48),e.NdJ("click",function(){return e.CHM(n).p.close()}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA()}if(2&i){const n=a.message;e.xp6(1),e.Oqu(e.lcZ(2,4,"YOU_SURE_YOU_WANT_DELETE")),e.xp6(2),e.Q6J("ngIf",n),e.xp6(3),e.Oqu(e.lcZ(7,6,"YES")),e.xp6(4),e.Oqu(e.lcZ(11,8,"NO"))}}function Qe(i,a){if(1&i&&(e.TgZ(0,"option",114),e._uU(1),e.qZA()),2&i){const n=a.$implicit;e.s9C("value",n),e.xp6(1),e.Oqu(n)}}function Ge(i,a){if(1&i&&(e.TgZ(0,"div",115),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.newCollection," ")}}function Be(i,a){if(1&i&&(e.TgZ(0,"option",114),e._uU(1),e.qZA()),2&i){const n=a.$implicit;e.s9C("value",n.name),e.xp6(1),e.Oqu(n.title)}}const z=function(){return{standalone:!0}};function je(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",116),e.TgZ(1,"div",58),e.TgZ(2,"label",59),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",60),e.TgZ(5,"input",117),e.NdJ("ngModelChange",function(o){const c=e.CHM(n).$implicit;return e.oxw().fieldModel.inputProperties[c.name]=o}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const n=a.$implicit,t=e.oxw();e.xp6(2),e.hYB("for","parameterInputField",n.name,"",t.uniqueId,""),e.xp6(1),e.Oqu(n.title),e.xp6(2),e.hYB("id","parameterInputField",n.name,"",t.uniqueId,""),e.Q6J("ngModel",t.fieldModel.inputProperties[n.name])("ngModelOptions",e.DdM(7,z))}}function Ve(i,a){if(1&i&&(e.TgZ(0,"option",114),e._uU(1),e.qZA()),2&i){const n=a.$implicit;e.s9C("value",n.name),e.xp6(1),e.Oqu(n.title)}}function Ke(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",116),e.TgZ(1,"div",58),e.TgZ(2,"label",59),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",60),e.TgZ(5,"input",117),e.NdJ("ngModelChange",function(o){const c=e.CHM(n).$implicit;return e.oxw().fieldModel.outputProperties[c.name]=o}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const n=a.$implicit,t=e.oxw();e.xp6(2),e.hYB("for","parameterOutputField",n.name,"",t.uniqueId,""),e.xp6(1),e.Oqu(n.title),e.xp6(2),e.hYB("id","parameterOutputField",n.name,"",t.uniqueId,""),e.Q6J("ngModel",t.fieldModel.outputProperties[n.name])("ngModelOptions",e.DdM(7,z))}}function $e(i,a){if(1&i&&(e.TgZ(0,"option",114),e._uU(1),e.qZA()),2&i){const n=a.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function ze(i,a){if(1&i&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.secondFormErrors.group," ")}}function He(i,a){if(1&i&&(e.TgZ(0,"div",115),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.secondFormErrors.newGroup," ")}}function We(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"tr",136),e.TgZ(1,"td"),e._uU(2),e.TgZ(3,"span",137),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",131),e._uU(8),e.qZA(),e.TgZ(9,"td",131),e._UZ(10,"app-output-field",138),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"div",139),e.TgZ(13,"div",140),e.TgZ(14,"button",141),e.NdJ("click",function(o){const c=e.CHM(n).$implicit;return e.oxw(2).editField(c,o)}),e.ALo(15,"translate"),e._UZ(16,"i",142),e.qZA(),e.TgZ(17,"button",143),e.NdJ("click",function(o){const c=e.CHM(n).$implicit;return e.oxw(2).copyField(c,o)}),e.ALo(18,"translate"),e._UZ(19,"i",144),e.qZA(),e.TgZ(20,"button",141),e.NdJ("click",function(o){const c=e.CHM(n).$implicit;return e.oxw(2).deleteField(c,o)}),e.ALo(21,"translate"),e._UZ(22,"i",11),e.qZA(),e.qZA(),e.qZA(),e._UZ(23,"app-output-field",138),e.qZA(),e.qZA()}if(2&i){const n=a.$implicit,t=e.oxw(2);e.xp6(2),e.hij(" ",n.title," "),e.xp6(2),e.hij("(",n.name,")"),e.xp6(2),e.hij(" ",n.inputType," "),e.xp6(2),e.hij(" ",n.group," "),e.xp6(2),e.Q6J("value",n.required),e.xp6(4),e.s9C("ngbTooltip",e.lcZ(15,11,"EDIT")),e.Q6J("hidden",n.name==t.currentFieldName),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(18,13,"COPY")),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(21,15,"DELETE")),e.Q6J("hidden",n.name==t.currentFieldName),e.xp6(3),e.Q6J("value",n.showInTable)}}function Xe(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",null,118),e.TgZ(2,"div"),e.TgZ(3,"div",119),e.TgZ(4,"select",120,121),e.TgZ(6,"option",66),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"option",122),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"option",123),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"option",124),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.qZA(),e.TgZ(18,"button",125),e.NdJ("click",function(o){e.CHM(n);const l=e.MAs(5);return e.oxw().sortingStart(l.value,o)}),e._UZ(19,"i",126),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.qZA(),e.TgZ(22,"button",127),e.NdJ("click",function(o){return e.CHM(n),e.oxw().fieldsExport(o)}),e._UZ(23,"i",128),e._uU(24),e.ALo(25,"translate"),e.qZA(),e._UZ(26,"div",129),e.TgZ(27,"div"),e.TgZ(28,"table",130),e.TgZ(29,"thead"),e.TgZ(30,"tr"),e.TgZ(31,"th"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"th"),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"th",131),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"th",131),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"th"),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(46,"tbody"),e.YNc(47,We,24,17,"tr",132),e.TgZ(48,"tr",133),e.TgZ(49,"td",134),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(52,"app-sorting-dnd",135),e.NdJ("itemsChange",function(o){return e.CHM(n),e.oxw().sortData=o})("save",function(o){return e.CHM(n),e.oxw().sortingApply(o)})("cancel",function(){return e.CHM(n),e.oxw().sortingReset()}),e.qZA()}if(2&i){const n=e.oxw();e.xp6(3),e.Q6J("hidden",n.model.fields.length<2),e.xp6(4),e.Oqu(e.lcZ(8,16,"SORT_FIELDS")),e.xp6(3),e.Oqu(e.lcZ(11,18,"SORT_FIELDS_LIST")),e.xp6(3),e.Oqu(e.lcZ(14,20,"SORT_FIELDS_PAGE")),e.xp6(3),e.Oqu(e.lcZ(17,22,"SORT_FILTERS")),e.xp6(4),e.hij(" ",e.lcZ(21,24,"SORT")," "),e.xp6(4),e.hij(" ",e.lcZ(25,26,"EXPORT")," "),e.xp6(8),e.Oqu(e.lcZ(33,28,"TITLE")),e.xp6(3),e.Oqu(e.lcZ(36,30,"INPUT_TYPE")),e.xp6(3),e.Oqu(e.lcZ(39,32,"GROUP")),e.xp6(3),e.hij("",e.lcZ(42,34,"REQUIRED"),"?"),e.xp6(3),e.hij("",e.lcZ(45,36,"SHOW_IN_TABLE"),"?"),e.xp6(3),e.Q6J("ngForOf",n.model.fields),e.xp6(1),e.Q6J("hidden",n.model.fields.length>0),e.xp6(2),e.hij(" ",e.lcZ(51,38,"EMPTY")," "),e.xp6(2),e.Q6J("items",n.sortData)}}function et(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",145),e._uU(1),e.TgZ(2,"button",91),e.NdJ("click",function(){return e.CHM(n),e.oxw().errorMessage=""}),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.errorMessage," ")}}const tt=function(i){return{"no-events":i}},E=function(i){return{"is-invalid":i}},nt=function(){return["/catalog"]};let ot=(()=>{class i extends Q.B{constructor(n,t,o,l,c,g,L,S,D){super(n,t,o,l,c,g),this.fb=n,this.activeModal=t,this.translateService=o,this.systemNameService=l,this.dataService=c,this.elRef=g,this.fieldTypesService=L,this.collectionsService=S,this.modalService=D,this._secondFormFieldsErrors={},this.model=new s(0,"","","","products",[],["General","Service"],!0,!1),this.fieldModel=new N._(0,"","","","",{},"",{},""),this.sortData=[],this.sortingFieldName="",this.fld_submitted=!1,this.action="add_field",this.currentFieldName="",this.collections=["products"],this.fieldTypeProperties={input:[],output:[]},this.formFields=[{name:"title",validators:[p.kI.required]},{name:"name",validators:[p.kI.required,p.kI.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"collection",validators:[p.kI.required]},{name:"newCollection",validators:[p.kI.pattern("[A-Za-z0-9_-]+")]},{name:"isCreateByUsersAllowed",validators:[]},{name:"isActive",validators:[]}],this.secondFormFields=[{name:"title",validators:[p.kI.required]},{name:"name",validators:[p.kI.required,p.kI.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"inputType",validators:[p.kI.required]},{name:"outputType",validators:[p.kI.required]},{name:"group",validators:[p.kI.required]},{name:"newGroup",validators:[]},{name:"required",validators:[]},{name:"showInTable",validators:[]},{name:"showOnPage",validators:[]},{name:"showInList",validators:[]},{name:"isFilter",validators:[]}]}set secondFormErrors(n){for(const t in n)if(n.hasOwnProperty(t)){const o=this.getControl(this.form,null,t);o&&o.setErrors({incorrect:!0})}this._secondFormFieldsErrors=n}get secondFormErrors(){return this._secondFormFieldsErrors}onAfterInit(){this.buildForm("secondForm",this.secondFormFields,this.secondFormErrors,"fieldModel"),this.onValueChanged("secondForm",this.secondFormErrors),this.getFieldTypes(),this.getCollectionsList()}getFieldTypes(){const n=new w.J("title","asc",0,0,1);this.fieldTypesService.getListPage(n).subscribe(t=>{this.fieldTypes=t.items},t=>this.errorMessage=t)}getCollectionsList(){this.collectionsService.getList().subscribe(n=>{n.length>0&&(this.collections=n)})}selectFieldTypeProperties(n,t){t?this.secondForm.get(`${n}Type`).setValue(t):t=this.secondForm.get(`${n}Type`).value,this.fieldModel[`${n}Type`]=t;const o=(0,T.find)(this.fieldTypes,{name:t});if(!o)return void(this.fieldTypeProperties[n]=[]);const l=`${n}Properties`,c=(0,T.map)(o[`${n}Properties`],"name");this.fieldTypeProperties[n].splice(0),o[n+"Properties"].forEach((g,L)=>{this.fieldTypeProperties[n].push(g)});for(const g in this.fieldModel[l])this.fieldModel[l].hasOwnProperty(g)&&-1===c.indexOf(g)&&delete this.fieldModel[l][g];for(const g in this.fieldTypeProperties[n])if(this.fieldTypeProperties[n].hasOwnProperty(g)){const L=this.fieldTypeProperties[n][g].name;void 0===this.fieldModel[l][L]&&(this.fieldModel[l][L]=this.fieldTypeProperties[n][g].default_value)}"input"===n&&!this.fieldModel.outputType&&this.selectFieldTypeProperties("output",t)}addCollectionToggle(n,t){this.displayToggle(this.elementAddCollectionBlock.nativeElement),n.value="",this.onValueChanged(),n.focus()}addCollection(n){n&&n.preventDefault();const t="newCollection",o=this.form.get(t);if(!o.valid||!o.value)return!1;this.formErrors[t]="";const l=o.value;return this.collections.indexOf(l)>-1?(this.getControl(this.form,null,t).setErrors({exists:"COLLECTION_EXISTS"}),this.formErrors[t]=this.getLangString("COLLECTION_EXISTS"),!1):(this.collections.push(l),this.model.collection=l,this.getControl(this.form,null,t).setValue(l),this.elementAddCollectionBlock.nativeElement.style.display="none",!0)}deleteCollection(n){if(!this.model.collection)return;if(n.isOpen())return void n.close();let t;n.placement="top",n.popoverTitle=this.getLangString("CONFIRM"),t={p:n,confirm:(()=>{this.loading=!0,this.collectionsService.deleteItemByName(this.model.collection).subscribe(l=>{const c=this.collections.indexOf(this.model.collection);c>-1&&(this.collections.splice(c,1),this.model.collection=this.collections[0]||""),n.close(),this.loading=!1},l=>{this.errorMessage=l.error||"Error.",this.loading=!1})}).bind(this),message:""},n.open(t)}addGroup(n){n&&n.preventDefault();const t="newGroup",o=this.secondForm.get(t);if(!o||!o.valid||!o.value)return!1;this.errorFieldMessage="",this.secondFormErrors[t]="";const l=o.value;return this.model.groups.indexOf(l)>-1?(this.getControl(this.secondForm,null,t).setErrors({exists:"GROUP_ALREADY_EXISTS"}),this.secondFormErrors[t]=this.getLangString("GROUP_ALREADY_EXISTS"),!1):(this.model.groups.push(l),this.fieldModel.group=l,this.getControl(this.secondForm,null,"group").setValue(this.fieldModel.group),this.elementAddGroupBlock.nativeElement.style.display="none",!0)}deleteGroup(){const n=this.secondForm.get("group").value;let t=(0,T.findIndex)(this.model.fields,{group:n});this.errorFieldMessage="",t>-1?this.errorFieldMessage=this.getLangString("YOU_CANT_DELETE_NOTEMPTY_GROUP"):(t=this.model.groups.indexOf(n),t>-1&&this.model.groups.splice(t,1))}editField(n,t){t&&t.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="edit_field",this.fieldModel=(0,T.cloneDeep)(n);const o={};this.secondFormFields.forEach(l=>{o[l.name]=n[l.name]||null}),this.secondForm.setValue(o),this.selectFieldTypeProperties("input"),this.selectFieldTypeProperties("output"),this.currentFieldName=this.fieldModel.name,this.fld_submitted=!1}copyField(n,t){t&&t.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields"),this.action="add_field",this.fieldModel=(0,T.cloneDeep)(n),this.fieldModel.name="",this.secondForm.setValue(this.fieldModel),this.currentFieldName="",this.fld_submitted=!1}deleteField(n,t){t&&t.preventDefault();const o=(0,T.findIndex)(this.model.fields,{name:n.name});-1!==o?this.model.fields.splice(o,1):this.errorMessage="Field not found."}resetFieldForm(){this.action="add_field",this.errorMessage="",this.errorFieldMessage="",this.fld_submitted=!1,this.currentFieldName="",this.secondForm.reset(),this.fieldModel=new N._(0,"","","","",{},"",{},"")}editFieldCancel(n){n&&n.preventDefault(),this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),this.resetFieldForm(),this.onValueChanged("secondForm",this.secondFormErrors)}fieldMove(n,t){if("up"===t&&0===n||"down"===t&&n===this.model.fields.length-1)return;const o="up"===t?n-1:n+1,l=this.model.fields[n];this.model.fields.splice(n,1),this.model.fields.splice(o,0,l)}submitField(n){if(n&&n.preventDefault(),this.errorFieldMessage="",this.fld_submitted=!0,!this.secondForm.valid)return this.formGroupMarkTouched(this.secondForm),this.onValueChanged("secondForm",this.secondFormErrors),void(this.fld_submitted=!1);const t=(0,T.cloneDeep)(Object.assign({},this.secondForm.value,{inputProperties:this.fieldModel.inputProperties,outputProperties:this.fieldModel.outputProperties}));let o=(0,T.findIndex)(this.model.fields,{name:t.name});o>-1&&this.currentFieldName!==t.name?this.errorFieldMessage=this.getLangString("FIELD_NAME_EXISTS"):(this.toggleAccordion(this.accordion,"accordion-content-type-fields",!0),"add_field"===this.action?this.model.fields.push(t):"edit_field"===this.action&&(o=(0,T.findIndex)(this.model.fields,{name:this.currentFieldName}),o>-1&&(this.model.fields[o]=t)),this.resetFieldForm())}getFieldTypeProperty(n,t){if(!n)return null;let o=null;const l=(0,T.findIndex)(this.fieldTypes,{name:n});return l>-1&&void 0!==this.fieldTypes[l][t]&&(o=this.fieldTypes[l][t]),o}sortingInit(n,t,o){let l;o&&o.preventDefault(),this.sortingFieldName=n,l=t?this.model.fields.filter(c=>c[t]):this.model.fields,n&&l.sort(function(c,g){return c[n]-g[n]}),this.sortData=[],l.forEach(c=>{this.sortData.push({name:c.name,title:c.title})}),this.blockFieldList.nativeElement.style.display="none"}sortingStart(n,t){t&&t.preventDefault(),this.errorMessage="";const o=n.split("-");this.sortingFieldName=o[0];const l=o[1]?this.model.fields.filter(c=>c[o[1]]):this.model.fields;l.sort(function(c,g){return c[o[0]]-g[o[0]]}),0!==l.length?(this.sortData=l.map(c=>({name:c.name,title:c.title})),this.blockFieldList.nativeElement.style.display="none"):this.errorMessage=this.getLangString("SORT_FIELDS_EMPTY")}sortingApply(n){if(this.sortingFieldName)this.sortData.forEach((t,o)=>{const l=this.model.fields.findIndex(c=>c.name===t.name);l>-1&&(this.model.fields[l][this.sortingFieldName]=o)});else{const t=this.sortData.map(o=>o.name);this.model.fields.sort(function(o,l){return t.indexOf(o.name)-t.indexOf(l.name)})}this.sortingReset()}sortingReset(){this.action=(0,T.findIndex)(this.model.fields,{name:this.currentFieldName})>-1?"edit_field":"add_field",this.sortData.splice(0,this.sortData.length),this.sortingFieldName="",this.blockFieldList.nativeElement.style.display="block"}getSaveRequest(n){return n.id?this.dataService.update(n):this.dataService.create(n)}getFormData(){this.sortData.length>0&&this.sortingApply();const n=this.form.value;return n.id=this.model.id||0,n.groups=this.model.groups,n.fields=this.model.fields,n}toggleAccordion(n,t,o){n.activeIds.indexOf(t)>-1&&o||n.toggle(t)}fieldsExport(n){n&&n.preventDefault(),this.errorMessage="",this.model.fields||(this.model.fields=[]),this.errorMessage="";const t=JSON.stringify(this.model.fields,null,"\t"),o=this.modalService.open(Ue.O,{backdrop:"static",keyboard:!1,container:"#modals-container"});o.componentInstance.modalTitle=`${this.getLangString("EXPORT")} JSON`,o.componentInstance.textValue=t,o.result.then(l=>{if(l.data)try{const c=JSON.parse(l.data);this.model.fields.splice(0,this.model.fields.length),this.model.fields.push(...c)}catch(c){this.errorMessage=this.getLangString("JSON_SYNTAX_ERROR")}},l=>{})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(p.qu),e.Y36(m.Kz),e.Y36(C.sK),e.Y36(d.U),e.Y36(h.s),e.Y36(e.SBq),e.Y36(P),e.Y36($),e.Y36(m.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-content-type-modal-content"]],viewQuery:function(n,t){if(1&n&&(e.Gf(Ne,7),e.Gf(we,7),e.Gf(Re,7),e.Gf(Je,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.elementAddCollectionBlock=o.first),e.iGM(o=e.CRH())&&(t.elementAddGroupBlock=o.first),e.iGM(o=e.CRH())&&(t.accordion=o.first),e.iGM(o=e.CRH())&&(t.blockFieldList=o.first)}},features:[e.qOj],decls:289,vars:254,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["confirmPopover",""],[1,"modal-body","py-0"],[1,"row","mb-3"],[1,"col-lg-4",3,"formGroup"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"mb-2","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","id","fieldTitle","formControlName","title",1,"form-control",3,"ngClass"],[1,"alert","alert-danger"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","id","fieldName","formControlName","name",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"mb-2"],["for","fieldDescription",1,"label-filled"],["type","text","rows","3","name","description","id","fieldDescription","formControlName","description",1,"form-control"],[1,"mb-2","row","form-group-message"],[1,"col-12"],[1,"mb-0"],["for","fieldCollectionName",1,"label-filled"],["id","fieldCollectionName","name","collection","formControlName","collection",1,"form-select","form-select-sm",3,"ngModel","ngClass","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],[1,"icon-plus"],["triggers","manual",1,"d-flex",3,"ngbPopover"],["buttonDeleteCollection","ngbPopover"],["type","button",1,"btn","btn-secondary","btn-sm","rounded-top-start-0","rounded-bottom-start-0",3,"ngbTooltip","click"],[1,"card","p-1","mt-2","form-group-message",2,"display","none"],["addCollectionBlock",""],["type","text","formControlName","newCollection",1,"form-control","form-control-sm",3,"ngClass"],["addCollectionField",""],["class","alert alert-danger mb-1",4,"ngIf"],[1,"text-end","mt-1"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"form-check","m-0"],["type","checkbox","value","1","name","isCreateByUsersAllowed","formControlName","isCreateByUsersAllowed",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],[1,"card","card-body","p-2","ps-3"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"form-check-input",3,"id"],[1,"col-lg-8",3,"formGroup"],[1,"label-filled",3,"hidden"],[1,"card"],[1,"card-body"],[1,"col-md-5"],[3,"for"],[1,"col-md-7"],["type","text","name","field_title","formControlName","title",1,"form-control","form-control-sm",3,"id","ngClass"],["type","text","name","field_name","formControlName","name",1,"form-control","form-control-sm",3,"id","ngClass"],[1,"mb-2","row"],["type","text","rows","3","name","field_description","formControlName","description",1,"form-control","form-control-sm",3,"id","ngClass"],["name","field_inputType","formControlName","inputType","placement","left",1,"form-select","form-select-sm",3,"id","ngbTooltip","change"],["value",""],[1,"icon-cog"],[1,"card","card-body","bg-light","mb-3",2,"display","none",3,"hidden"],["inputTypeOptionsBlock",""],[1,"alert","alert-secondary","small",3,"hidden"],["class","row mb-2",4,"ngFor","ngForOf"],["name","field_outputType","formControlName","outputType","placement","left",1,"form-select","form-select-sm",3,"id","ngbTooltip","ngClass","change"],["outputTypeOptionsBlock",""],["for","field_fieldGroup"],[1,"form-group-message"],[1,"input-group","input-group-sm",3,"ngClass"],["id","field_fieldGroup","name","field_group","formControlName","group",1,"form-select",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["addGroupBlock",""],["type","text","formControlName","newGroup",1,"form-control","form-control-sm",3,"ngClass"],["addGroupField",""],[1,"row","mb-0"],[1,"col-md-7","offset-md-5"],[1,"form-check"],["type","checkbox","value","1","name","required","formControlName","required",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","showInTable","formControlName","showInTable",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","showOnPage","formControlName","showOnPage",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","showInList","formControlName","showInList",1,"form-check-input",3,"id"],["type","checkbox","value","1","name","isFilter","formControlName","isFilter",1,"form-check-input",3,"id"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-3",3,"hidden"],["type","button",1,"btn-close",3,"click"],[1,"mt-3"],["type","button",1,"btn","btn-sm","btn-info","btn-wide",3,"hidden","click"],["type","button",1,"btn","btn-sm","btn-success","btn-wide",3,"hidden","click"],[1,"icon-check"],["type","button",1,"btn","btn-sm","btn-secondary","btn-wide",3,"click"],["activeIds","accordion-content-type-fields",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-content-type-fields",3,"title"],["ngbPanelContent",""],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"text-center"],["class","alert alert-danger p-2",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm",3,"click"],[1,"alert","alert-danger","p-2"],[3,"value"],[1,"alert","alert-danger","mb-1"],[1,"row","mb-2"],["type","text",1,"form-control","form-control-sm",3,"id","ngModel","ngModelOptions","ngModelChange"],["blockFieldList",""],[1,"float-end","mb-2",3,"hidden"],[1,"form-select","form-select-sm","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["sortTypeSelect",""],["value","listOrder-showInList"],["value","pageOrder-showOnPage"],["value","filterOrder-isFilter"],["type","button",1,"btn","btn-sm","btn-secondary","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2","mb-2","mb-md-0",3,"click"],[1,"icon-shuffle"],["type","button",1,"btn","btn-sm","btn-secondary","d-inline-block",3,"click"],[1,"icon-inbox","me-2"],[1,"clearfix"],[1,"table","table-striped","table-divided","mb-0"],[1,"d-none","d-lg-table-cell"],["class","show-on-hover-parent",4,"ngFor","ngForOf"],[1,"table-active",3,"hidden"],["colspan","5",1,"text-center","p-3"],[3,"items","itemsChange","save","cancel"],[1,"show-on-hover-parent"],[1,"text-muted"],["outputType","boolean",3,"value"],[1,"relative"],[1,"show-on-hover-right"],["type","button",1,"btn","btn-secondary","btn-sm","ms-2",3,"hidden","ngbTooltip","click"],[1,"icon-pencil"],["type","button",1,"btn","btn-secondary","btn-sm","ms-2",3,"ngbTooltip","click"],[1,"icon-stack"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(c){return t.closeModal(c)}),e._UZ(3,"i",3),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.TgZ(7,"button",2),e.NdJ("click",function(c){return t.minimize(c)}),e._UZ(8,"i",4),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"div",6),e.TgZ(14,"div",7),e.TgZ(15,"button",8),e.NdJ("click",function(c){return t.maximize(c)}),e.ALo(16,"translate"),e._UZ(17,"i",9),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(c){return t.closeModal(c)}),e.ALo(19,"translate"),e._UZ(20,"i",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"h4",12),e._uU(22),e.qZA(),e.qZA(),e.YNc(23,Ye,12,10,"ng-template",null,13,e.W1O),e.TgZ(25,"div",14),e.TgZ(26,"div",15),e.TgZ(27,"div",16),e.TgZ(28,"form",17,18),e.NdJ("ngSubmit",function(){return t.onSubmit()}),e.TgZ(30,"div",19),e.TgZ(31,"label",20),e._uU(32),e.ALo(33,"translate"),e.qZA(),e._UZ(34,"input",21),e.TgZ(35,"div",22),e._uU(36),e.qZA(),e.qZA(),e.TgZ(37,"div",19),e.TgZ(38,"label",23),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"div",24),e._UZ(42,"input",25),e.TgZ(43,"button",26),e.NdJ("click",function(){return t.generateName(t.model)}),e.ALo(44,"translate"),e._UZ(45,"i",27),e.qZA(),e.qZA(),e.TgZ(46,"div",22),e._uU(47),e.qZA(),e.qZA(),e.TgZ(48,"div",28),e.TgZ(49,"label",29),e._uU(50),e.ALo(51,"translate"),e.qZA(),e._UZ(52,"textarea",30),e.qZA(),e.TgZ(53,"div",31),e.TgZ(54,"div",32),e.TgZ(55,"div",33),e.TgZ(56,"label",34),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.TgZ(59,"div",24),e.TgZ(60,"select",35),e.NdJ("ngModelChange",function(c){return t.model.collection=c}),e.YNc(61,Qe,2,2,"option",36),e.qZA(),e.TgZ(62,"button",37),e.NdJ("click",function(c){e.CHM(o);const g=e.MAs(73);return t.addCollectionToggle(g,c)}),e.ALo(63,"translate"),e._UZ(64,"i",38),e.qZA(),e.TgZ(65,"div",39,40),e.TgZ(67,"button",41),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(66);return t.deleteCollection(c)}),e.ALo(68,"translate"),e._UZ(69,"i",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(70,"div",42,43),e._UZ(72,"input",44,45),e.YNc(74,Ge,2,1,"div",46),e.TgZ(75,"div",47),e.TgZ(76,"button",48),e.NdJ("click",function(c){return t.addCollection(c)}),e._uU(77),e.ALo(78,"translate"),e.qZA(),e._uU(79," \xa0 "),e.TgZ(80,"button",48),e.NdJ("click",function(){return e.CHM(o),e.MAs(71).style.display="none",t.formErrors.newCollection=""}),e._uU(81),e.ALo(82,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(83,"div",28),e.TgZ(84,"div",49),e._UZ(85,"input",50),e.TgZ(86,"label",51),e._uU(87),e.ALo(88,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(89,"div",28),e.TgZ(90,"div",52),e.TgZ(91,"div",49),e._UZ(92,"input",53),e.TgZ(93,"label",51),e._uU(94),e.ALo(95,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(96,"div",54),e.TgZ(97,"label",55),e._uU(98),e.ALo(99,"translate"),e.qZA(),e.TgZ(100,"label",55),e._uU(101),e.ALo(102,"translate"),e.qZA(),e.TgZ(103,"div",56),e.TgZ(104,"div",57),e.TgZ(105,"div",31),e.TgZ(106,"div",58),e.TgZ(107,"label",59),e._uU(108),e.ALo(109,"translate"),e.qZA(),e.qZA(),e.TgZ(110,"div",60),e._UZ(111,"input",61),e.TgZ(112,"div",22),e._uU(113),e.qZA(),e.qZA(),e.qZA(),e.TgZ(114,"div",31),e.TgZ(115,"div",58),e.TgZ(116,"label",59),e._uU(117),e.ALo(118,"translate"),e.qZA(),e.qZA(),e.TgZ(119,"div",60),e.TgZ(120,"div",24),e._UZ(121,"input",62),e.TgZ(122,"button",37),e.NdJ("click",function(c){return t.generateName(t.fieldModel,c,t.secondForm)}),e.ALo(123,"translate"),e._UZ(124,"i",27),e.qZA(),e.qZA(),e.TgZ(125,"div",22),e._uU(126),e.qZA(),e.qZA(),e.qZA(),e.TgZ(127,"div",63),e.TgZ(128,"div",58),e.TgZ(129,"label",59),e._uU(130),e.ALo(131,"translate"),e.qZA(),e.qZA(),e.TgZ(132,"div",60),e._UZ(133,"textarea",64),e.qZA(),e.qZA(),e.TgZ(134,"div",31),e.TgZ(135,"div",58),e.TgZ(136,"label",59),e._uU(137),e.ALo(138,"translate"),e.qZA(),e.qZA(),e.TgZ(139,"div",60),e.TgZ(140,"div",24),e.TgZ(141,"select",65),e.NdJ("change",function(){return t.selectFieldTypeProperties("input")}),e._UZ(142,"option",66),e.YNc(143,Be,2,2,"option",36),e.qZA(),e.TgZ(144,"button",37),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(150);return t.displayToggle(c)}),e.ALo(145,"translate"),e._UZ(146,"i",67),e.qZA(),e.qZA(),e.TgZ(147,"div",22),e._uU(148),e.qZA(),e.qZA(),e.qZA(),e.TgZ(149,"div",68,69),e.TgZ(151,"div"),e.TgZ(152,"div",70),e._uU(153),e.ALo(154,"translate"),e.qZA(),e.YNc(155,je,6,8,"div",71),e.qZA(),e.TgZ(156,"div",47),e.TgZ(157,"button",48),e.NdJ("click",function(){return e.CHM(o),e.MAs(150).style.display="none"}),e._uU(158),e.ALo(159,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(160,"div",31),e.TgZ(161,"div",58),e.TgZ(162,"label",59),e._uU(163),e.ALo(164,"translate"),e.qZA(),e.qZA(),e.TgZ(165,"div",60),e.TgZ(166,"div",24),e.TgZ(167,"select",72),e.NdJ("change",function(){return t.selectFieldTypeProperties("output")}),e._UZ(168,"option",66),e.YNc(169,Ve,2,2,"option",36),e.qZA(),e.TgZ(170,"button",37),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(176);return t.displayToggle(c)}),e.ALo(171,"translate"),e._UZ(172,"i",67),e.qZA(),e.qZA(),e.TgZ(173,"div",22),e._uU(174),e.qZA(),e.qZA(),e.qZA(),e.TgZ(175,"div",68,73),e.TgZ(177,"div",70),e._uU(178),e.ALo(179,"translate"),e.qZA(),e.YNc(180,Ke,6,8,"div",71),e.TgZ(181,"div",47),e.TgZ(182,"button",48),e.NdJ("click",function(){return e.CHM(o),e.MAs(176).style.display="none"}),e._uU(183),e.ALo(184,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(185,"div",63),e.TgZ(186,"div",58),e.TgZ(187,"label",74),e._uU(188),e.ALo(189,"translate"),e.qZA(),e.qZA(),e.TgZ(190,"div",60),e.TgZ(191,"div",75),e.TgZ(192,"div",76),e.TgZ(193,"select",77),e._UZ(194,"option",66),e.YNc(195,$e,2,2,"option",36),e.qZA(),e.TgZ(196,"button",37),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(204),g=e.MAs(206);return t.displayToggle(c),g.value="",g.focus()}),e.ALo(197,"translate"),e._UZ(198,"i",38),e.qZA(),e.TgZ(199,"button",37),e.NdJ("click",function(){return t.deleteGroup()}),e.ALo(200,"translate"),e._UZ(201,"i",11),e.qZA(),e.qZA(),e.YNc(202,ze,2,1,"div",78),e.TgZ(203,"div",42,79),e._UZ(205,"input",80,81),e.YNc(207,He,2,1,"div",46),e.TgZ(208,"div",47),e.TgZ(209,"button",48),e.NdJ("click",function(c){return t.addGroup(c)}),e._uU(210),e.ALo(211,"translate"),e.qZA(),e._uU(212," \xa0 "),e.TgZ(213,"button",48),e.NdJ("click",function(){return e.CHM(o),e.MAs(204).style.display="none",t.secondFormErrors.fld_newGroup=""}),e._uU(214),e.ALo(215,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(216,"div",82),e.TgZ(217,"div",83),e.TgZ(218,"div",84),e._UZ(219,"input",85),e.TgZ(220,"label",51),e._uU(221),e.ALo(222,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(223,"div",82),e.TgZ(224,"div",83),e.TgZ(225,"div",84),e._UZ(226,"input",86),e.TgZ(227,"label",51),e._uU(228),e.ALo(229,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(230,"div",82),e.TgZ(231,"div",83),e.TgZ(232,"div",84),e._UZ(233,"input",87),e.TgZ(234,"label",51),e._uU(235),e.ALo(236,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(237,"div",82),e.TgZ(238,"div",83),e.TgZ(239,"div",84),e._UZ(240,"input",88),e.TgZ(241,"label",51),e._uU(242),e.ALo(243,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(244,"div",82),e.TgZ(245,"div",83),e.TgZ(246,"div",84),e._UZ(247,"input",89),e.TgZ(248,"label",51),e._uU(249),e.ALo(250,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(251,"div",90),e._uU(252),e.TgZ(253,"button",91),e.NdJ("click",function(){return t.errorFieldMessage=""}),e.qZA(),e.qZA(),e.TgZ(254,"div",92),e.TgZ(255,"button",93),e.NdJ("click",function(c){return t.submitField(c)}),e._UZ(256,"i",38),e._uU(257),e.ALo(258,"translate"),e.qZA(),e.TgZ(259,"button",94),e.NdJ("click",function(c){return t.submitField(c)}),e._UZ(260,"i",95),e._uU(261),e.ALo(262,"translate"),e.qZA(),e._uU(263," \xa0 "),e.TgZ(264,"button",96),e.NdJ("click",function(c){return t.editFieldCancel(c)}),e._uU(265),e.ALo(266,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(267,"ngb-accordion",97,98),e.TgZ(269,"ngb-panel",99),e.ALo(270,"translate"),e.YNc(271,Xe,53,40,"ng-template",100),e.qZA(),e.qZA(),e.YNc(272,et,3,1,"div",101),e.qZA(),e.TgZ(273,"div",102),e.TgZ(274,"div",103),e.TgZ(275,"button",104),e.NdJ("click",function(c){return t.save(!0,c)}),e.TgZ(276,"span"),e._uU(277),e.ALo(278,"translate"),e.qZA(),e.qZA(),e.TgZ(279,"div",105),e._UZ(280,"button",106),e.TgZ(281,"div",107),e.TgZ(282,"button",108),e.NdJ("click",function(c){return t.save(!1,c)}),e._uU(283),e.ALo(284,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(285,"button",109),e.NdJ("click",function(c){return t.closeModal(c)}),e.TgZ(286,"span"),e._uU(287),e.ALo(288,"translate"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.MAs(24);e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(6,128,"CLOSE")),e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(11,130,"MINIMIZE")),e.xp6(5),e.Q6J("title",e.lcZ(16,132,"EXPAND")),e.xp6(3),e.Q6J("title",e.lcZ(19,134,"CLOSE")),e.xp6(4),e.Oqu(t.modalTitle),e.xp6(5),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("formGroup",t.form)("ngClass",e.VKq(220,tt,t.submitted)),e.xp6(4),e.hij(" ",e.lcZ(33,136,"TITLE")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(222,E,t.form.controls.title.touched&&!t.form.controls.title.valid)),e.xp6(2),e.hij(" ",t.formErrors.title," "),e.xp6(3),e.hij(" ",e.lcZ(40,138,"SYSTEM_NAME")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(224,E,t.form.controls.name.touched&&!t.form.controls.name.valid)),e.xp6(1),e.Q6J("ngClass",e.VKq(226,E,t.form.controls.name.touched&&!t.form.controls.name.valid)),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(44,140,"GENERATE")),e.xp6(4),e.hij(" ",t.formErrors.name," "),e.xp6(3),e.hij(" ",e.lcZ(51,142,"DESCRIPTION")," "),e.xp6(7),e.Oqu(e.lcZ(58,144,"COLLECTION")),e.xp6(2),e.Q6J("ngClass",e.VKq(228,E,t.form.controls.collection.touched&&!t.form.controls.collection.valid)),e.xp6(1),e.Q6J("ngModel",t.model.collection)("ngClass",e.VKq(230,E,t.form.controls.collection.touched&&!t.form.controls.collection.valid)),e.xp6(1),e.Q6J("ngForOf",t.collections),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(63,146,"ADD_COLLECTION")),e.xp6(3),e.Q6J("ngbPopover",o),e.xp6(2),e.s9C("ngbTooltip",e.lcZ(68,148,"DELETE")),e.xp6(5),e.Q6J("ngClass",e.VKq(232,E,t.form.controls.newCollection.touched&&!t.form.controls.newCollection.valid)),e.xp6(2),e.Q6J("ngIf",t.formErrors.newCollection),e.xp6(3),e.hij(" ",e.lcZ(78,150,"ADD")," "),e.xp6(4),e.hij(" ",e.lcZ(82,152,"CANCEL")," "),e.xp6(4),e.MGl("id","fieldIsCreateByUsersAllowed",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldIsCreateByUsersAllowed",t.uniqueId,""),e.xp6(1),e.hij(" ",e.lcZ(88,154,"CREATE_BY_USERS_ALLOWED")," "),e.xp6(5),e.MGl("id","fieldIsActive",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldIsActive",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(95,156,"ACTIVE")),e.xp6(2),e.Q6J("formGroup",t.secondForm),e.xp6(1),e.Q6J("hidden","add_field"!=t.action),e.xp6(1),e.hij(" ",e.lcZ(99,158,"ADD_FIELD")," "),e.xp6(2),e.Q6J("hidden","edit_field"!=t.action),e.xp6(1),e.hij(" ",e.lcZ(102,160,"EDIT_FIELD")," "),e.xp6(6),e.MGl("for","field_fieldTitle",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(109,162,"TITLE")),e.xp6(3),e.MGl("id","field_fieldTitle",t.uniqueId,""),e.Q6J("ngClass",e.VKq(234,E,t.secondForm.controls.title.touched&&!t.secondForm.controls.title.valid)),e.xp6(2),e.Oqu(t.secondFormErrors.title),e.xp6(3),e.MGl("for","field_fieldName",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(118,164,"SYSTEM_NAME")),e.xp6(3),e.Q6J("ngClass",e.VKq(236,E,t.secondForm.controls.name.touched&&!t.secondForm.controls.name.valid)),e.xp6(1),e.MGl("id","field_fieldName",t.uniqueId,""),e.Q6J("ngClass",e.VKq(238,E,t.secondForm.controls.name.touched&&!t.secondForm.controls.name.valid)),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(123,166,"GENERATE")),e.xp6(4),e.Oqu(t.secondFormErrors.name),e.xp6(3),e.MGl("for","field_fieldDescription",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(131,168,"DESCRIPTION")),e.xp6(3),e.MGl("id","field_fieldDescription",t.uniqueId,""),e.Q6J("ngClass",e.VKq(240,E,t.secondForm.controls.description.touched&&!t.secondForm.controls.description.valid)),e.xp6(3),e.MGl("for","field_fieldInputType",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(138,170,"INPUT_TYPE")),e.xp6(3),e.Q6J("ngClass",e.VKq(242,E,t.secondForm.controls.inputType.touched&&!t.secondForm.controls.inputType.valid)),e.xp6(1),e.ekj("is-invalid",t.secondFormErrors.fld_inputType),e.MGl("id","field_fieldInputType",t.uniqueId,""),e.Q6J("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.inputType,"description")),e.xp6(2),e.Q6J("ngForOf",t.fieldTypes),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(145,172,"OPTIONS")),e.xp6(4),e.Oqu(t.secondFormErrors.inputType),e.xp6(1),e.Q6J("hidden",!t.fieldModel.inputType),e.xp6(3),e.Q6J("hidden",t.fieldTypeProperties.input.length>0),e.xp6(1),e.hij(" ",e.lcZ(154,174,"THERE_NO_PARAMETERS")," "),e.xp6(2),e.Q6J("ngForOf",t.fieldTypeProperties.input),e.xp6(3),e.hij(" ",e.lcZ(159,176,"CLOSE")," "),e.xp6(4),e.MGl("for","field_fieldOutputType",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(164,178,"OUTPUT_TYPE")),e.xp6(3),e.Q6J("ngClass",e.VKq(244,E,t.secondForm.controls.outputType.touched&&!t.secondForm.controls.outputType.valid)),e.xp6(1),e.MGl("id","field_fieldOutputType",t.uniqueId,""),e.Q6J("ngbTooltip",t.getFieldTypeProperty(t.fieldModel.outputType,"description"))("ngClass",e.VKq(246,E,t.secondForm.controls.outputType.touched&&!t.secondForm.controls.outputType.valid)),e.xp6(2),e.Q6J("ngForOf",t.fieldTypes),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(171,180,"OPTIONS")),e.xp6(4),e.Oqu(t.secondFormErrors.outputType),e.xp6(1),e.Q6J("hidden",!t.fieldModel.outputType),e.xp6(2),e.Q6J("hidden",t.fieldTypeProperties.output.length>0),e.xp6(1),e.hij(" ",e.lcZ(179,182,"THERE_NO_PARAMETERS")," "),e.xp6(2),e.Q6J("ngForOf",t.fieldTypeProperties.output),e.xp6(3),e.hij(" ",e.lcZ(184,184,"CLOSE")," "),e.xp6(5),e.Oqu(e.lcZ(189,186,"GROUP")),e.xp6(4),e.Q6J("ngClass",e.VKq(248,E,t.secondForm.controls.group.touched&&!t.secondForm.controls.group.valid)),e.xp6(1),e.Q6J("ngClass",e.VKq(250,E,t.secondForm.controls.group.touched&&!t.secondForm.controls.group.valid)),e.xp6(2),e.Q6J("ngForOf",t.model.groups),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(197,188,"ADD_GROUP")),e.xp6(3),e.s9C("ngbTooltip",e.lcZ(200,190,"DELETE_GROUP")),e.xp6(3),e.Q6J("ngIf",t.secondFormErrors.group),e.xp6(3),e.Q6J("ngClass",e.VKq(252,E,t.secondForm.controls.newGroup.touched&&!t.secondForm.controls.newGroup.valid)),e.xp6(2),e.Q6J("ngIf",t.secondFormErrors.newGroup),e.xp6(3),e.hij(" ",e.lcZ(211,192,"ADD")," "),e.xp6(4),e.hij(" ",e.lcZ(215,194,"CANCEL")," "),e.xp6(5),e.MGl("id","fieldRequired",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldRequired",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(222,196,"REQUIRED")),e.xp6(5),e.MGl("id","fieldShowInTable",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldShowInTable",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(229,198,"SHOW_IN_TABLE")),e.xp6(5),e.MGl("id","fieldShowOnPage",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldShowOnPage",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(236,200,"SHOW_ON_PAGE")),e.xp6(5),e.MGl("id","fieldShowInList",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldShowInList",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(243,202,"SHOW_IN_LIST")),e.xp6(5),e.MGl("id","fieldIsFilter",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldIsFilter",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(250,204,"SHOW_IN_FILTER")),e.xp6(2),e.Q6J("hidden",!t.errorFieldMessage),e.xp6(1),e.hij(" ",t.errorFieldMessage," "),e.xp6(3),e.Q6J("hidden","add_field"!=t.action),e.xp6(2),e.hij(" ",e.lcZ(258,206,"ADD_FIELD")," "),e.xp6(2),e.Q6J("hidden","edit_field"!=t.action),e.xp6(2),e.hij(" ",e.lcZ(262,208,"SAVE_FIELD")," "),e.xp6(4),e.hij(" ",e.lcZ(266,210,"CANCEL")," "),e.xp6(2),e.Q6J("closeOthers",!0),e.xp6(2),e.Q6J("title",e.lcZ(270,212,"FIELDS")),e.xp6(3),e.Q6J("ngIf",t.errorMessage),e.xp6(3),e.Q6J("disabled",t.submitted),e.xp6(2),e.Oqu(e.lcZ(278,214,"SAVE_AND_CLOSE")),e.xp6(3),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(284,216,"SAVE")),e.xp6(4),e.Oqu(e.lcZ(288,218,"CLOSE"))}},directives:[p.JL,p.sg,p._Y,b.mk,p.Fj,p.JJ,p.u,m._L,p.EJ,b.sg,m.o8,b.O5,p.Wl,p.YN,p.Kr,m.gY,m.Gk,m.gW,m.jt,m.iD,m.Vi,m.TH,p.On,ke.i,De.D],pipes:[C.X$],encapsulation:2}),i})(),it=(()=>{class i extends v.U{constructor(n,t,o,l){super(n,t,o,l),this.dataService=n,this.activeModal=t,this.modalService=o,this.translateService=l,this.title="\u0422\u0438\u043f\u044b \u043a\u043e\u043d\u0442\u0435\u043d\u0442\u0430",this.queryOptions=new w.J("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"collection",sortName:"collection",title:"COLLECTION",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}getModalContent(){return ot}getModalElementId(n){return["modal","content_type",n||0].join("-")}setModalInputs(n,t=!1,o=""){super.setModalInputs(n,t,o),this.modalRef.componentInstance.modalTitle=n&&!t?`${this.getLangString("CONTENT_TYPE")} #${n}`:this.getLangString("ADD_CONTENT_TYPE")}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.s),e.Y36(m.Kz),e.Y36(m.FF),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-shk-content-types"]],features:[e.qOj],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"a",2),e._UZ(3,"i",3),e._uU(4," \xa0 "),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e.TgZ(9,"div",5),e.TgZ(10,"button",6),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.TgZ(14,"div",7),e.TgZ(15,"button",8),e.NdJ("click",function(){return t.blockSelected()}),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"button",8),e.NdJ("click",function(){return t.deleteSelected()}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"button",9),e.NdJ("click",function(){return t.modalOpen()}),e._UZ(22,"i",10),e._uU(23," \xa0 "),e.TgZ(24,"span"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.qZA(),e.qZA(),e._UZ(27,"div",11),e.qZA(),e.TgZ(28,"app-table",12,13),e.NdJ("selectedIdsChange",function(l){return t.selectedIds=l})("loadingChange",function(l){return t.loading=l})("actionRequest",function(l){return t.actionRequest(l)}),e.qZA()),2&n&&(e.xp6(2),e.Q6J("routerLink",e.DdM(23,nt)),e.xp6(4),e.Oqu(e.lcZ(7,13,"CATALOG")),e.xp6(6),e.Oqu(e.lcZ(13,15,"BATCH_ACTIONS")),e.xp6(4),e.Oqu(e.lcZ(17,17,"DISABLE_ENABLE")),e.xp6(3),e.Oqu(e.lcZ(20,19,"DELETE")),e.xp6(6),e.Oqu(e.lcZ(26,21,"ADD")),e.xp6(3),e.Q6J("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[A.yS,m.jt,m.iD,m.Vi,G.a],pipes:[C.X$],encapsulation:2}),i})();class st{constructor(a,n,t,o,l,c,g){this.id=a,this.name=n,this.title=t,this.description=o,this.isActive=l,this.inputProperties=c,this.outputProperties=g}}function lt(i,a){if(1&i&&(e.TgZ(0,"div",50),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.title," ")}}function rt(i,a){if(1&i&&(e.TgZ(0,"div",50),e._uU(1),e.qZA()),2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.formErrors.name," ")}}const F=function(i){return{"is-invalid":i}};function at(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"tr",59),e.TgZ(1,"td"),e._UZ(2,"input",60),e.qZA(),e.TgZ(3,"td",61),e._UZ(4,"input",62),e.qZA(),e.TgZ(5,"td",61),e._UZ(6,"input",63),e.qZA(),e.TgZ(7,"td",61),e.TgZ(8,"button",64),e.NdJ("click",function(o){const c=e.CHM(n).index;return e.oxw(3).arrayFieldDelete("inputProperties",c,o)}),e.ALo(9,"translate"),e._UZ(10,"i",11),e.qZA(),e.qZA(),e.qZA()}if(2&i){const n=a.$implicit;e.Q6J("formGroupName",a.index+""),e.xp6(2),e.Q6J("ngClass",e.VKq(7,F,n.controls.name.touched&&!n.controls.name.valid)),e.xp6(2),e.Q6J("ngClass",e.VKq(9,F,n.controls.title.touched&&!n.controls.title.valid)),e.xp6(2),e.Q6J("ngClass",e.VKq(11,F,n.controls.default_value.touched&&!n.controls.default_value.valid)),e.xp6(2),e.s9C("ngbTooltip",e.lcZ(9,5,"DELETE"))}}function dt(i,a){if(1&i&&(e.TgZ(0,"tbody"),e.YNc(1,at,11,13,"tr",58),e.qZA()),2&i){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.arrayFields.inputProperties.controls)}}function ct(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",51),e.TgZ(1,"table",52),e.TgZ(2,"thead"),e.TgZ(3,"tr"),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e._UZ(13,"th"),e.qZA(),e.qZA(),e.YNc(14,dt,2,1,"tbody",53),e.TgZ(15,"tfoot"),e.TgZ(16,"tr",54),e.TgZ(17,"td",55),e.TgZ(18,"button",56),e.NdJ("click",function(o){return e.CHM(n),e.oxw().arrayFieldAdd("inputProperties",o)}),e._UZ(19,"i",57),e._uU(20," \xa0 "),e.TgZ(21,"span"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(5),e.hij(" ",e.lcZ(6,5,"SYSTEM_NAME")," "),e.xp6(3),e.hij(" ",e.lcZ(9,7,"TITLE")," "),e.xp6(3),e.hij(" ",e.lcZ(12,9,"DEFAULT_VALUE")," "),e.xp6(3),e.Q6J("ngIf",n.arrayFields.inputProperties),e.xp6(8),e.Oqu(e.lcZ(23,11,"ADD"))}}function pt(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"tr",59),e.TgZ(1,"td"),e._UZ(2,"input",60),e.qZA(),e.TgZ(3,"td",61),e._UZ(4,"input",62),e.qZA(),e.TgZ(5,"td",61),e._UZ(6,"input",63),e.qZA(),e.TgZ(7,"td",61),e.TgZ(8,"button",64),e.NdJ("click",function(o){const c=e.CHM(n).index;return e.oxw(3).arrayFieldDelete("outputProperties",c,o)}),e.ALo(9,"translate"),e._UZ(10,"i",11),e.qZA(),e.qZA(),e.qZA()}if(2&i){const n=a.$implicit;e.Q6J("formGroupName",a.index+""),e.xp6(2),e.Q6J("ngClass",e.VKq(7,F,n.controls.name.touched&&!n.controls.name.valid)),e.xp6(2),e.Q6J("ngClass",e.VKq(9,F,n.controls.title.touched&&!n.controls.title.valid)),e.xp6(2),e.Q6J("ngClass",e.VKq(11,F,n.controls.default_value.touched&&!n.controls.default_value.valid)),e.xp6(2),e.s9C("ngbTooltip",e.lcZ(9,5,"DELETE"))}}function ut(i,a){if(1&i&&(e.TgZ(0,"tbody"),e.YNc(1,pt,11,13,"tr",58),e.qZA()),2&i){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.arrayFields.outputProperties.controls)}}function mt(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",65),e.TgZ(1,"table",52),e.TgZ(2,"thead"),e.TgZ(3,"tr"),e.TgZ(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e._UZ(13,"th"),e.qZA(),e.qZA(),e.YNc(14,ut,2,1,"tbody",53),e.TgZ(15,"tfoot"),e.TgZ(16,"tr",54),e.TgZ(17,"td",55),e.TgZ(18,"button",56),e.NdJ("click",function(o){return e.CHM(n),e.oxw().arrayFieldAdd("outputProperties",o)}),e._UZ(19,"i",57),e._uU(20," \xa0 "),e.TgZ(21,"span"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(5),e.hij(" ",e.lcZ(6,5,"SYSTEM_NAME")," "),e.xp6(3),e.hij(" ",e.lcZ(9,7,"TITLE")," "),e.xp6(3),e.hij(" ",e.lcZ(12,9,"DEFAULT_VALUE")," "),e.xp6(3),e.Q6J("ngIf",n.arrayFields.outputProperties),e.xp6(8),e.Oqu(e.lcZ(23,11,"ADD"))}}function gt(i,a){if(1&i){const n=e.EpF();e.TgZ(0,"div",66),e._uU(1),e.TgZ(2,"button",67),e.NdJ("click",function(){return e.CHM(n),e.oxw().errorMessage=""}),e.qZA(),e.qZA()}if(2&i){const n=e.oxw();e.xp6(1),e.hij(" ",n.errorMessage," ")}}const ht=function(i){return{"no-events":i}},_t=function(){return["/catalog"]};let ft=(()=>{class i extends Q.B{constructor(n,t,o,l,c,g){super(n,t,o,l,c,g),this.fb=n,this.activeModal=t,this.translateService=o,this.systemNameService=l,this.dataService=c,this.elRef=g,this.model=new st(0,"","","",!0,[],[]),this.formFields=[{name:"title",validators:[p.kI.required]},{name:"name",validators:[p.kI.required,p.kI.pattern("[A-Za-z0-9_-]+")]},{name:"description",validators:[]},{name:"isActive",validators:[]},{name:"inputProperties",validators:[],children:[{name:"name",validators:[p.kI.required]},{name:"title",validators:[p.kI.required]},{name:"default_value",validators:[]}]},{name:"outputProperties",validators:[],children:[{name:"name",validators:[p.kI.required]},{name:"title",validators:[p.kI.required]},{name:"default_value",validators:[]}]}]}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(p.qu),e.Y36(m.Kz),e.Y36(C.sK),e.Y36(d.U),e.Y36(P),e.Y36(e.SBq))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-field-type-modal-content"]],features:[e.qOj],decls:83,vars:68,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"row"],[1,"col-md-6"],[1,"mb-2","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","name","title","formControlName","title","id","fieldTitle",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["for","fieldName",1,"label-filled"],[1,"input-group",3,"ngClass"],["type","text","name","name","formControlName","name","id","fieldName",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"mb-2","row"],[1,"col-12"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","m-0"],["type","checkbox","value","1","name","isActive","formControlName","isActive",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],[1,"mb-2"],["for","fieldDescription",1,"label-filled"],["rows","5","name","description","formControlName","description","id","fieldDescription",1,"form-control"],["activeIds","accordion-input-options",1,"ngb-accordion",3,"closeOthers"],["accordion","ngbAccordion"],["id","accordion-input-options",3,"title"],["ngbPanelContent",""],["id","accordion-output-options",3,"title"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","display-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],["formArrayName","inputProperties"],[1,"table","table-bordered","table-divided","mb-0"],[4,"ngIf"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],[1,"text-center"],["type","text","formControlName","title",1,"form-control",3,"ngClass"],["type","text","formControlName","default_value",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],["formArrayName","outputProperties"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(l){return t.closeModal(l)}),e._UZ(3,"i",3),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.TgZ(7,"button",2),e.NdJ("click",function(l){return t.minimize(l)}),e._UZ(8,"i",4),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"div",6),e.TgZ(14,"div",7),e.TgZ(15,"button",8),e.NdJ("click",function(l){return t.maximize(l)}),e.ALo(16,"translate"),e._UZ(17,"i",9),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(l){return t.closeModal(l)}),e.ALo(19,"translate"),e._UZ(20,"i",11),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"h4",12),e._uU(22),e.qZA(),e.qZA(),e.TgZ(23,"form",13,14),e.NdJ("ngSubmit",function(){return t.onSubmit()}),e.TgZ(25,"div",15),e.TgZ(26,"div",16),e.TgZ(27,"div",17),e.TgZ(28,"div",18),e.TgZ(29,"label",19),e._uU(30),e.ALo(31,"translate"),e.qZA(),e._UZ(32,"input",20),e.YNc(33,lt,2,1,"div",21),e.qZA(),e.TgZ(34,"div",18),e.TgZ(35,"label",22),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"div",23),e._UZ(39,"input",24),e.TgZ(40,"button",25),e.NdJ("click",function(){return t.generateName(t.model)}),e.ALo(41,"translate"),e._UZ(42,"i",26),e.qZA(),e.qZA(),e.YNc(43,rt,2,1,"div",21),e.qZA(),e.TgZ(44,"div",27),e.TgZ(45,"div",28),e.TgZ(46,"div",29),e.TgZ(47,"div",30),e._UZ(48,"input",31),e.TgZ(49,"label",32),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(52,"div",17),e.TgZ(53,"div",33),e.TgZ(54,"label",34),e._uU(55),e.ALo(56,"translate"),e.qZA(),e._UZ(57,"textarea",35),e.qZA(),e.qZA(),e.qZA(),e.TgZ(58,"ngb-accordion",36,37),e.TgZ(60,"ngb-panel",38),e.ALo(61,"translate"),e.YNc(62,ct,24,13,"ng-template",39),e.qZA(),e.TgZ(63,"ngb-panel",40),e.ALo(64,"translate"),e.YNc(65,mt,24,13,"ng-template",39),e.qZA(),e.qZA(),e.YNc(66,gt,3,1,"div",41),e.qZA(),e.TgZ(67,"div",42),e.TgZ(68,"div",43),e.TgZ(69,"button",44),e.NdJ("click",function(l){return t.save(!0,l)}),e.TgZ(70,"span"),e._uU(71),e.ALo(72,"translate"),e.qZA(),e.qZA(),e.TgZ(73,"div",45),e._UZ(74,"button",46),e.TgZ(75,"div",47),e.TgZ(76,"button",48),e.NdJ("click",function(l){return t.save(!1,l)}),e._uU(77),e.ALo(78,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(79,"button",49),e.NdJ("click",function(l){return t.closeModal(l)}),e.TgZ(80,"span"),e._uU(81),e.ALo(82,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(6,32,"CLOSE")),e.xp6(2),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(11,34,"MINIMIZE")),e.xp6(5),e.Q6J("title",e.lcZ(16,36,"EXPAND")),e.xp6(3),e.Q6J("title",e.lcZ(19,38,"CLOSE")),e.xp6(4),e.Oqu(t.modalTitle),e.xp6(1),e.Q6J("formGroup",t.form)("ngClass",e.VKq(60,ht,t.submitted)),e.xp6(2),e.ekj("loading",t.loading),e.xp6(5),e.Oqu(e.lcZ(31,40,"TITLE")),e.xp6(2),e.Q6J("ngClass",e.VKq(62,F,t.form.controls.title.touched&&!t.form.controls.title.valid)),e.xp6(1),e.Q6J("ngIf",t.formErrors.title),e.xp6(3),e.Oqu(e.lcZ(37,42,"SYSTEM_NAME")),e.xp6(2),e.Q6J("ngClass",e.VKq(64,F,t.form.controls.name.touched&&!t.form.controls.name.valid)),e.xp6(1),e.Q6J("ngClass",e.VKq(66,F,t.form.controls.name.touched&&!t.form.controls.name.valid)),e.xp6(1),e.s9C("ngbTooltip",e.lcZ(41,44,"GENERATE")),e.xp6(3),e.Q6J("ngIf",t.formErrors.name),e.xp6(5),e.MGl("id","fieldIsActive",t.uniqueId,""),e.xp6(1),e.MGl("for","fieldIsActive",t.uniqueId,""),e.xp6(1),e.Oqu(e.lcZ(51,46,"ACTIVE")),e.xp6(5),e.Oqu(e.lcZ(56,48,"DESCRIPTION")),e.xp6(3),e.Q6J("closeOthers",!1),e.xp6(2),e.Q6J("title",e.lcZ(61,50,"INPUT_OPTIONS")),e.xp6(3),e.Q6J("title",e.lcZ(64,52,"OUTPUT_OPTIONS")),e.xp6(3),e.Q6J("ngIf",t.errorMessage),e.xp6(3),e.Q6J("disabled",t.submitted),e.xp6(2),e.Oqu(e.lcZ(72,54,"SAVE_AND_CLOSE")),e.xp6(3),e.Q6J("disabled",t.submitted),e.xp6(3),e.Oqu(e.lcZ(78,56,"SAVE")),e.xp6(4),e.Oqu(e.lcZ(82,58,"CLOSE")))},directives:[p._Y,p.JL,p.sg,b.mk,p.Fj,p.JJ,p.u,b.O5,m._L,p.Wl,m.gY,m.Gk,m.gW,m.jt,m.iD,m.Vi,m.TH,p.CE,b.sg,p.x0],pipes:[C.X$],encapsulation:2}),i})();const Tt=[{path:"",component:I,children:[{path:"",redirectTo:"category/"},{path:"category",redirectTo:"category/"},{path:"category/:categoryId",component:Fe},{path:"content_types",component:it},{path:"field_types",component:(()=>{class i extends v.U{constructor(n,t,o,l){super(n,t,o,l),this.dataService=n,this.activeModal=t,this.modalService=o,this.translateService=l,this.title="Field types",this.queryOptions=new w.J("name","asc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"name",sortName:"name",title:"SYSTEM_NAME",outputType:"text",outputProperties:{}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}setModalInputs(n,t=!1,o=""){super.setModalInputs(n,t,o),this.modalRef.componentInstance.modalTitle=n&&!t?`${this.getLangString("FIELD_TYPE")} #${n}`:this.getLangString("ADD_FIELD_TYPE")}getModalElementId(n){return["modal","field_type",n||0].join("-")}getModalContent(){return ft}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(P),e.Y36(m.Kz),e.Y36(m.FF),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-shk-field-types"]],features:[e.qOj],decls:30,vars:24,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"btn","btn-outline-secondary","btn-wide","mb-2","mb-md-0",3,"routerLink"],[1,"icon-arrow-left"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","isCloneAllowed","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"a",2),e._UZ(3,"i",3),e._uU(4," \xa0 "),e.TgZ(5,"span"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e.TgZ(9,"div",5),e.TgZ(10,"button",6),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.TgZ(14,"div",7),e.TgZ(15,"button",8),e.NdJ("click",function(){return t.blockSelected()}),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"button",8),e.NdJ("click",function(){return t.deleteSelected()}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"button",9),e.NdJ("click",function(){return t.modalOpen()}),e._UZ(22,"i",10),e._uU(23," \xa0 "),e.TgZ(24,"span"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.qZA(),e.qZA(),e._UZ(27,"div",11),e.qZA(),e.TgZ(28,"app-table",12,13),e.NdJ("selectedIdsChange",function(l){return t.selectedIds=l})("loadingChange",function(l){return t.loading=l})("actionRequest",function(l){return t.actionRequest(l)}),e.qZA()),2&n&&(e.xp6(2),e.Q6J("routerLink",e.DdM(23,_t)),e.xp6(4),e.Oqu(e.lcZ(7,13,"CATALOG")),e.xp6(6),e.Oqu(e.lcZ(13,15,"BATCH_ACTIONS")),e.xp6(4),e.Oqu(e.lcZ(17,17,"DISABLE_ENABLE")),e.xp6(3),e.Oqu(e.lcZ(20,19,"DELETE")),e.xp6(6),e.Oqu(e.lcZ(26,21,"ADD")),e.xp6(3),e.Q6J("items",t.items)("selectedIds",t.selectedIds)("collectionSize",t.collectionSize)("queryOptions",t.queryOptions)("tableFields",t.tableFields)("isCloneAllowed",!0)("loading",t.loading))},directives:[A.yS,m.jt,m.iD,m.Vi,G.a],pipes:[C.X$],encapsulation:2}),i})()}]}];let Zt=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[A.Bz.forChild(Tt)],A.Bz]}),i})(),Ct=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[U,P,$,k],imports:[[b.ez,O.m,Zt]]}),i})()},1504:(R,x,u)=>{u.d(x,{s:()=>C});var b=u(2047),O=u(1599),A=u(3668),e=u(4522);let C=(()=>{class f extends O.D{constructor(I){super(I),this.setRequestUrl("/admin/content_types")}getItemByName(I){const T=this.getRequestUrl()+`/by_name/${I}`;return this.http.get(T).pipe((0,b.K)(this.handleError()))}getItemByCategory(I){const T=this.getRequestUrl()+`/by_category/${I}`;return this.http.get(T).pipe((0,b.K)(this.handleError()))}}return f.\u0275fac=function(I){return new(I||f)(A.LFG(e.eN))},f.\u0275prov=A.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},3240:(R,x,u)=>{u.d(x,{B:()=>M});var b=u(9133),O=u(3405),A=u(8805),e=u(1599),C=u(103),f=u(3668),q=u(7283),I=u(8319);const T=["formEl"];let M=(()=>{class v{constructor(s,r,d,_,h,Z){this.fb=s,this.activeModal=r,this.translateService=d,this.systemNameService=_,this.dataService=h,this.elRef=Z,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.dataLoaded=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new O.xQ}set formErrors(s){for(const r in s)if(s.hasOwnProperty(r)){const d=this.getControl(this.form,null,r);d&&d.setErrors({incorrect:!0})}this._formFieldsErrors=s}get formErrors(){return this._formFieldsErrors}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){this.dataLoaded=!0,this.buildControls(this.form,this.formFields)}getSystemFieldName(){return""}getLangString(s){return this.translateService.store.translations[this.translateService.currentLang][s]||s}getModelData(){return this.loading=!0,new Promise((s,r)=>{this.dataService.getItem(this.itemId).pipe((0,A.R)(this.destroyed$)).subscribe({next:d=>{if(this.isItemCopy){d.id=null;const _=this.getSystemFieldName();_&&(d[_]="")}Object.assign(this.model,d),this.loading=!1,s(d)},error:d=>{this.errorMessage=d.error||this.getLangString("ERROR"),this.loading=!1,r(d)}})})}buildForm(s="form",r=null,d=null,_="model"){r||(r=this.formFields),this[s]=this.fb.group(this.buildControls(null,r,_)),this[s].valueChanges.pipe((0,A.R)(this.destroyed$)).subscribe(()=>this.onValueChanged(s,d))}buildControls(s=null,r=[],d="model"){const _={};return r.forEach(h=>{const Z=s?this.getControl(s,h):null;let y=null;if(d&&this[d]?(this[d].options||(this[d].options={}),y=0===h.name.indexOf("options_")?this[d].options[h.name.substr(8)]||null:this[d][h.name]||null):y=null,Z)if(h.disabled&&Z.disable(),h.children){const U=y,k=Z;k.clear(),U.forEach((N,Y)=>{const m=this.getFormFieldByName(h.name),J=this.buildControls(null,m.children,null);k.push(this.fb.group(J))}),k.patchValue(U)}else Z.setValue(y);else h.children?(_[h.name]=this.fb.array([]),this.createArrayFieldsProperty(h.name)):_[h.name]=this.fb.control({value:y,disabled:h.disabled||!1},h.validators)}),_}onValueChanged(s="form",r=null){this[s]&&(r||(r=this.formErrors),this[s].valid&&(this.errorMessage=""),Object.keys(this[s].value).forEach(_=>{r[_]="";const h=this.getControl(this[s],null,_);if(h&&!h.valid&&h.errors){let Z="";Object.keys(h.errors).forEach(y=>{Z+=(Z?" ":"")+this.getLangString("INVALID_"+y.toUpperCase())}),r[_]=Z}}))}getFormFieldByName(s){const r=this.formFields.filter(d=>d.name===s);return r.length>0?r[0]:null}createArrayFieldsProperty(s){Object.defineProperty(this.arrayFields,s,{get:()=>this.form?this.form.get(s):null})}getControl(s,r,d){return s?s.get(d||r.name):null}focusFormError(){setTimeout(()=>{this.formEl.nativeElement.querySelector(".form-control.is-invalid")&&this.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()},1)}formGroupMarkTouched(s){Object.keys(s.controls).forEach(r=>{s.controls[r].markAsTouched(),s.controls[r]instanceof b.Oe&&Array.from(this.form.controls[r].controls).forEach(d=>{this.formGroupMarkTouched(d)})})}getSaveRequest(s){return s.id||"root"===s.name?this.dataService.update(s):this.dataService.create(s)}getFormData(){const s=this.form.value;return s.id=this.model.id||0,void 0!==this.model.translations&&(s.translations=this.model.translations||null),s}arrayFieldDelete(s,r,d){d&&d.preventDefault(),this.arrayFields[s].removeAt(r)}arrayFieldAdd(s,r){r&&r.preventDefault();const d=this.getFormFieldByName(s);if(!d)return;const _=this.buildControls(null,d.children,null);this.arrayFields[s].push(this.fb.group(_))}generateName(s,r,d=null){r&&r.preventDefault(),d||(d=this.form);const _=this.getControl(d,null,"title").value||"";s.name=this.systemNameService.generateName(_),this.getControl(d,null,"name").setValue(s.name)}closeModal(s){s&&s.preventDefault(),this.close(this.closeReason)}close(s,r){r&&r.preventDefault(),"submit"===s?this.activeModal.close(s):this.activeModal.dismiss(s)}minimize(s){s&&s.preventDefault(),window.document.body.classList.remove("modal-open");const r=this.getRootElement(),d=r.previousElementSibling;r.classList.remove("d-block"),r.classList.add("modal-minimized"),d.classList.add("d-none")}maximize(s){s&&s.preventDefault(),window.document.body.classList.add("modal-open");const r=this.getRootElement(),d=r.previousElementSibling;r.classList.add("d-block"),r.classList.remove("modal-minimized"),d.classList.remove("d-none")}save(s=!1,r){r&&r.preventDefault(),this.onSubmit(s)}saveFiles(s){if(0===Object.keys(this.files).length)return void this.close("submit");const r=new FormData;for(const d in this.files)this.files.hasOwnProperty(d)&&this.files[d]instanceof File&&r.append(d,this.files[d],this.files[d].name);r.append("itemId",String(s)),this.dataService.postFormData(r).pipe((0,A.R)(this.destroyed$)).subscribe({next:()=>{this.close("submit")},error:d=>{this.errorMessage=d.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}onSubmit(s=!1){if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;const r=this.getFormData();this.getSaveRequest(r).pipe((0,A.R)(this.destroyed$)).subscribe({next:d=>{Object.keys(this.files).length>0?this.saveFiles(d._id||d.id):s&&this.close("submit"),d&&d.id&&(this.model.id=d.id),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:d=>{d.error&&(this.errorMessage=d.error),d.errors&&(this.formErrors=d.errors,this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS")),this.loading=!1,this.submitted=!1}})}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(s=>{this.model[s]=this.localePreviousValues[s],this.getControl(this.form,null,s).setValue(this.localePreviousValues[s])}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(s=>{this.localePreviousValues[s]=this.getControl(this.form,null,s).value,this.model.translations[s]?(this.model[s]=this.model.translations[s][this.localeCurrent]||"",this.getControl(this.form,null,s).setValue(this.model[s])):(this.model[s]="",this.getControl(this.form,null,s).setValue(""))})}saveTranslations(s){s&&s.preventDefault(),this.localeFieldsAllowed.forEach(r=>{this.getControl(this.form,null,r)&&this.getControl(this.form,null,r).value?(this.model.translations[r]||(this.model.translations[r]={}),this.model.translations[r][this.localeCurrent]=this.getControl(this.form,null,r).value):this.model.translations[r]&&(this.model.translations[r][this.localeCurrent]&&delete this.model.translations[r][this.localeCurrent],0===Object.keys(this.model.translations[r]).length&&delete this.model.translations[r])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}emailValidator(s){return s.value?/\S+@\S+\.\S+/.test(s.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}displayToggle(s,r,d){d&&d.preventDefault(),s.style.display=(r=r||"none"===s.style.display)?"block":"none"}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return v.\u0275fac=function(s){return new(s||v)(f.Y36(b.qu),f.Y36(q.Kz),f.Y36(I.sK),f.Y36(C.U),f.Y36(e.D),f.Y36(f.SBq))},v.\u0275cmp=f.Xpm({type:v,selectors:[["ng-component"]],viewQuery:function(s,r){if(1&s&&f.Gf(T,5),2&s){let d;f.iGM(d=f.CRH())&&(r.formEl=d.first)}},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(s,r){},encapsulation:2}),v})()},6726:(R,x,u)=>{u.d(x,{D:()=>M});var b=u(9133),O=u(3405),A=u(8805),e=u(103),C=u(1599),f=u(701),q=u(3668),I=u(7283),T=u(8319);let M=(()=>{class v{constructor(s,r,d,_,h,Z,y){this.fb=s,this.dataService=r,this.systemNameService=d,this.activeModal=_,this.tooltipConfig=h,this.translateService=Z,this.elRef=y,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new O.xQ,h.placement="bottom",h.container="body",h.triggers="hover click"}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){}getSystemFieldName(){return"name"}getLangString(s){return this.translateService.store.translations[this.translateService.currentLang][s]||s}getModelData(){return this.loading=!0,new Promise((s,r)=>{this.dataService.getItem(this.itemId).pipe((0,A.R)(this.destroyed$)).subscribe({next:d=>{this.isItemCopy&&(d.id=null,d[this.getSystemFieldName()]=""),this.model=d,this.loading=!1,s(d)},error:d=>{this.errorMessage=d.error||this.getLangString("ERROR"),this.loading=!1,r(d)}})})}buildForm(){const s=this.buildControls(this.formFields);this.form=this.fb.group(s),this.form.valueChanges.pipe((0,A.R)(this.destroyed$)).subscribe({next:r=>this.onValueChanged("form","",r)})}buildControls(s,r="model",d=""){const _={};for(const h in s){if(!s.hasOwnProperty(h))continue;const Z=s[h],y=Z.dataKey?this[r][Z.dataKey]:this[r];y[h]||(y[h]=Z.value),_[h]=new b.NI({value:y[h]||"",disabled:Z.disabled||!1},Z.validators),this.formErrors[d+h]="",this.translateValidationMessages(d,h,Z)}return _}translateValidationMessages(s,r,d){const _={};!d.fieldLabel||(Object.keys(d.messages).forEach(h=>{"required"!==h&&this.translateService.get(String(d.messages[h])).subscribe(Z=>{_[h]=Z})}),d.validators.indexOf(b.kI.required)>-1&&this.translateService.get(d.fieldLabel).subscribe(h=>{this.translateService.get("FIELD_REQUIRED",{name:h}).subscribe(Z=>{_.required=Z})}),this.validationMessages[s+r]=_)}getControl(s){return this.form.controls.name}onValueChanged(s,r="",d){if(!this[s])return;const _=this[s].value;for(const h in _){if(!_.hasOwnProperty(h))continue;this.formErrors[r+h]="";const Z=this[s].get(h);if(Z&&(Z.dirty||this[r+"submitted"])&&!Z.valid)for(const y in Z.errors)this.formErrors[r+h]+=this.validationMessages[r+h][y]?this.validationMessages[r+h][y]+" ":this.getLangString("ERROR")+" "}}displayToggle(s,r){s.style.display=(r=r||"none"===s.style.display)?"block":"none"}toggleAccordion(s,r,d){s.activeIds.indexOf(r)>-1&&d||s.toggle(r)}generateName(s){s.name=this.systemNameService.generateName(s.title||"")}closeModal(s){s&&s.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}close(s){s&&s.preventDefault(),this.activeModal.dismiss(this.closeReason)}minimize(s){s&&s.preventDefault(),window.document.body.classList.remove("modal-open");const r=this.getRootElement(),d=r.previousElementSibling;r.classList.remove("d-block"),r.classList.add("modal-minimized"),d.classList.add("d-none")}maximize(s){s&&s.preventDefault(),window.document.body.classList.add("modal-open");const r=this.getRootElement(),d=r.previousElementSibling;r.classList.add("d-block"),r.classList.remove("modal-minimized"),d.classList.remove("d-none")}getFormData(){const s={};return Object.keys(this.model).forEach(r=>{s[r]=this.files[r]?Array.isArray(this.model[r])?[f.O.getFileData(this.files[r])]:f.O.getFileData(this.files[r]):this.model[r]}),s}fileChange(s,r,d=!1){const _=s.target.files;_.length>0&&(this.model[r]=d?[f.O.getFileData(_[0])]:f.O.getFileData(_[0]),this.files[r]=_[0],this.form.controls[r].setValue(this.files[r].name))}fileClear(s,r){this.model[s]=null,this.form.controls[s].reset(null),r.files=null,r.value="",delete this.files[s]}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(s=>{this.model[s]=this.localePreviousValues[s]}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(s=>{this.localePreviousValues[s]=this.model[s]||"",this.model[s]=this.model.translations[s]&&this.model.translations[s][this.localeCurrent]||""})}saveTranslations(s){s&&s.preventDefault(),this.localeFieldsAllowed.forEach(r=>{this.model[r]?(this.model.translations[r]||(this.model.translations[r]={}),this.model.translations[r][this.localeCurrent]=this.model[r]):this.model.translations[r]&&(this.model.translations[r][this.localeCurrent]&&delete this.model.translations[r][this.localeCurrent],0===Object.keys(this.model.translations[r]).length&&delete this.model.translations[r])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}onSubmit(){this.submitted=!0,this.closeModal()}appendFormData(s){}saveFiles(s){if(0===Object.keys(this.files).length)return void this.closeModal();const r=new FormData;for(const d in this.files)this.files.hasOwnProperty(d)&&this.files[d]instanceof File&&r.append(d,this.files[d],this.files[d].name);r.append("itemId",String(s)),this.appendFormData(r),this.dataService.postFormData(r).pipe((0,A.R)(this.destroyed$)).subscribe({next:()=>{this.closeModal()},error:d=>{this.errorMessage=d.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}save(s=!1,r){if(r&&r.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe((0,A.R)(this.destroyed$)).subscribe({next:d=>{Object.keys(this.files).length>0?this.saveFiles(d._id||d.id):(s?this.closeModal():d&&d.id&&(this.model=d,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:d=>{this.errorMessage=d.error||this.getLangString("ERROR"),this.loading=!1,this.submitted=!1}})}emailValidator(s){return s.value?/\S+@\S+\.\S+/.test(s.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return v.\u0275fac=function(s){return new(s||v)(q.Y36(b.qu),q.Y36(C.D),q.Y36(e.U),q.Y36(I.Kz),q.Y36(I.xI),q.Y36(T.sK),q.Y36(q.SBq))},v.\u0275cmp=q.Xpm({type:v,selectors:[["ng-component"]],inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(s,r){},encapsulation:2}),v})()},5243:(R,x,u)=>{u.d(x,{U:()=>M});var b=u(3405),O=u(8805),A=u(417),e=u(1599),C=u(9985),f=u(3668),q=u(7283),I=u(8319);const T=["table"];let M=(()=>{class v{constructor(s,r,d,_){this.dataService=s,this.activeModal=r,this.modalService=d,this.translateService=_,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new A.J("name","asc",1,10,0,0),this.destroyed$=new b.xQ}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(s){}onSearchWordUpdate(s){if(void 0!==s)return this.queryOptions.search_word=s,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(s){return["modal",s||0].join("-")}setModalInputs(s,r=!1,d=""){const _=void 0!==s&&!r;this.modalRef.componentInstance.modalTitle=this.getLangString(_?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=d,this.modalRef.componentInstance.itemId=s||0,this.modalRef.componentInstance.isItemCopy=r||!1,this.modalRef.componentInstance.isEditMode=_}modalOpen(s,r=!1){const d=this.getModalElementId(s);if(window.document.body.classList.add("modal-open"),window.document.getElementById(d)){const _=window.document.getElementById(d),h=_.previousElementSibling;return _.classList.add("d-block"),_.classList.remove("modal-minimized"),void h.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(s,r,d),this.modalRef.result.then(_=>{this.destroyed$.isStopped||(this.onModalClose(_),this.getList())},_=>{this.destroyed$.isStopped||(this.onModalClose(_),_&&["submit","updated"].indexOf(_)>-1&&this.getList())})}deleteItemConfirm(s){this.modalRef=this.modalService.open(C.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(r=>{"accept"===r&&this.deleteItem(s)})}getLangString(s){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][s]||s}confirmAction(s){return this.modalRef=this.modalService.open(C.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=s,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(s=>{this.clearSelected(),this.getList()},s=>this.showAlert(s.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(s=>{"accept"===s&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(r=>{this.clearSelected(),this.getList()},r=>this.showAlert(r.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(s){this.modalRef=this.modalService.open(C.$N),this.modalRef.componentInstance.modalContent=s,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(s){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(r=>{"accept"===r&&this.dataService.deleteItem(s).subscribe(d=>{this.getList()},d=>{d.error&&this.showAlert(d.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(s){switch(s[0]){case"edit":this.modalOpen(s[1]);break;case"copy":this.modalOpen(s[1],!0);break;case"delete":this.deleteItem(s[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe((0,O.R)(this.destroyed$)).subscribe({next:s=>{this.items=s.items,this.collectionSize=s.total,this.loading=!1},error:s=>{this.items=[],this.collectionSize=0,s.error&&this.showAlert(s.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return v.title="",v.\u0275fac=function(s){return new(s||v)(f.Y36(e.D),f.Y36(q.Kz),f.Y36(q.FF),f.Y36(I.sK))},v.\u0275dir=f.lG2({type:v,viewQuery:function(s,r){if(1&s&&f.Gf(T,7),2&s){let d;f.iGM(d=f.CRH())&&(r.table=d.first)}}}),v})()}}]);