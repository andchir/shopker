"use strict";(self.webpackChunkshk_app=self.webpackChunkshk_app||[]).push([["src_app_import-export_import-export_module_ts"],{23056:function(t,e,i){i.d(e,{s:function(){return l}});var o=i(5304),n=i(6887),s=i(37716),r=i(91841);let l=(()=>{class t extends n.D{constructor(t){super(t),this.setRequestUrl("/admin/content_types")}getItemByName(t){const e=this.getRequestUrl()+`/by_name/${t}`;return this.http.get(e).pipe((0,o.K)(this.handleError()))}getItemByCategory(t){const e=this.getRequestUrl()+`/by_category/${t}`;return this.http.get(e).pipe((0,o.K)(this.handleError()))}}return t.\u0275fac=function(e){return new(e||t)(s.LFG(r.eN))},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},91577:function(t,e,i){i.r(e),i.d(e,{ImportExportModule:function(){return Lt}});var o=i(38583),n=i(16964),s=i(64916),r=i(99639),l=i(63124),a=i(5727),d=i(23815),c=i(33013),p=i(3677),g=i(35930),u=i(91841),h=i(5304),m=i(6887),Z=i(37716);let f=(()=>{class t extends m.D{constructor(t){super(t),this.setRequestUrl("import")}getSheetProperties(t){const e=this.getRequestUrl()+`/${t.id}/properties`;return this.http.post(e,t,{headers:this.headers}).pipe((0,h.K)(this.handleError()))}getFieldsOptions(t,e){const i=this.getRequestUrl()+`/${t}/fields_options`;let o=this.createHttpParams(e);return this.http.get(i,{params:o,headers:this.headers}).pipe((0,h.K)(this.handleError()))}splitFileAction(t){const e=this.getRequestUrl()+`/${t}/split_file`;return this.http.post(e,{},{headers:this.headers}).pipe((0,h.K)(this.handleError()))}testData(t){const e=this.getRequestUrl()+`/${t.id}/do_import_test`;return this.http.post(e,t,{headers:this.headers}).pipe((0,h.K)(this.handleError()))}importData(t){const e=this.getRequestUrl()+`/${t.id}/do_import`;return this.http.post(e,t,{headers:this.headers}).pipe((0,h.K)(this.handleError()))}importDataProgress(t){const e=this.getRequestUrl()+`/${t.id}/do_import`;return this.http.request(new u.aW("POST",e,t,{reportProgress:!0,responseType:"text",headers:this.headers}))}getPercent(t){const e=this.getRequestUrl()+`/${t.id}/percent`;return this.http.get(e,{headers:this.headers}).pipe((0,h.K)(this.handleError()))}}return t.\u0275fac=function(e){return new(e||t)(Z.LFG(u.eN))},t.\u0275prov=Z.Yz7({token:t,factory:t.\u0275fac}),t})();var T=i(3679),A=i(88002),b=i(39343);class q{constructor(t,e,i,o,n,s,r,l,a,d){this.id=t,this.title=e,this.fileData=i,this.type=o,this.fileSize=n,this.rowsQuantity=s,this.sheetsQuantity=r,this.sheetsNames=l,this.options=a,this.fieldsOptions=d,void 0===this.options&&q.setOptiontDefaults(this)}static setOptiontDefaults(t){t.options||(t.options={}),t.options=Object.assign({parentId:0,rowNumberHeaders:1,rowNumberFirst:2,rowNumberLast:0,stepsNumber:1,step:1,categoriesSeparator:"",sheetName:"",contentType:"",articulFieldName:"",aliasAdditionalFieldName:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"',skipFound:!1,filesDownload:!1},t.options)}}var x=i(73844),v=i(5041),M=i(23056),C=i(90660),N=i(95047),S=i(29790),y=i(2917),E=i(89516);function O(t,e){if(1&t&&(Z.TgZ(0,"div",47),Z._uU(1),Z.qZA()),2&t){const t=Z.oxw();Z.xp6(1),Z.hij(" ",t.formErrors.title," ")}}function _(t,e){if(1&t&&(Z.TgZ(0,"div",48),Z._uU(1),Z.qZA()),2&t){const t=Z.oxw();Z.xp6(1),Z.hij(" ",t.formErrors.fileData," ")}}function w(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",16),Z.TgZ(2,"div",17),Z.TgZ(3,"div",16),Z.TgZ(4,"div",27),Z.TgZ(5,"div",22),Z.TgZ(6,"label",49),Z.TgZ(7,"span",29),Z.ALo(8,"translate"),Z._uU(9),Z.ALo(10,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(11,"input",50),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.csvSeparator=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(12,"div",27),Z.TgZ(13,"div",22),Z.TgZ(14,"label",51),Z.TgZ(15,"span",29),Z.ALo(16,"translate"),Z._uU(17),Z.ALo(18,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(19,"input",52),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.csvEnclosure=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(20,"div",17),Z.TgZ(21,"div",22),Z.TgZ(22,"label",53),Z._uU(23),Z.ALo(24,"translate"),Z.qZA(),Z.TgZ(25,"input",54),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.csvEncoding=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw();Z.xp6(7),Z.Q6J("title",Z.lcZ(8,8,"CSV_SEPARATOR")),Z.xp6(2),Z.Oqu(Z.lcZ(10,10,"CSV_SEPARATOR")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.csvSeparator),Z.xp6(4),Z.Q6J("title",Z.lcZ(16,12,"CSV_ENCLOSURE")),Z.xp6(2),Z.Oqu(Z.lcZ(18,14,"CSV_ENCLOSURE")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.csvEnclosure),Z.xp6(4),Z.Oqu(Z.lcZ(24,16,"CSV_ENCODING")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.csvEncoding)}}function I(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t),Z.xp6(1),Z.Oqu(t)}}function L(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.Oqu(t.title)}}function R(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.hij(" ",t.title," ")}}function U(t,e){if(1&t&&(Z.ynx(0),Z.YNc(1,R,2,2,"option",58),Z.BQk()),2&t){const t=Z.oxw(2);Z.xp6(1),Z.Q6J("ngForOf",t.contentType.fields)}}function J(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.hij(" ",t.title," ")}}function F(t,e){if(1&t&&(Z.ynx(0),Z.YNc(1,J,2,2,"option",58),Z.BQk()),2&t){const t=Z.oxw(2);Z.xp6(1),Z.Q6J("ngForOf",t.contentType.fields)}}function D(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t),Z.xp6(1),Z.Oqu(t)}}const k=function(){return{standalone:!0}};function Q(t,e){if(1&t){const t=Z.EpF();Z.TgZ(0,"div",83),Z.TgZ(1,"div",84),Z.TgZ(2,"div",85),Z.TgZ(3,"span",86),Z._uU(4),Z.ALo(5,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(6,"select",87),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw(3).model.options.step=e}),Z.YNc(7,D,2,2,"option",58),Z.qZA(),Z.qZA(),Z.qZA()}if(2&t){const t=Z.oxw(3);Z.xp6(4),Z.hij(" ",Z.lcZ(5,4,"STEP")," "),Z.xp6(2),Z.Q6J("ngModel",t.model.options.step)("ngModelOptions",Z.DdM(6,k)),Z.xp6(1),Z.Q6J("ngForOf",t.steps)}}function Y(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",99),Z.TgZ(2,"input",100),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().$implicit.targetName=e}),Z.ALo(3,"translate"),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw().$implicit;Z.xp6(2),Z.Q6J("ngbTooltip",Z.lcZ(3,2,"SYSTEM_NAME"))("ngModel",t.targetName)}}function P(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.hij(" ",t.title," ")}}function B(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"select",61),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw(2).$implicit.targetName=e}),Z.YNc(2,P,2,2,"option",58),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw(2).$implicit,e=Z.oxw(3);Z.xp6(1),Z.Q6J("ngModel",t.targetName),Z.xp6(1),Z.Q6J("ngForOf",e.contentType.fields)}}function $(t,e){if(1&t&&(Z.ynx(0),Z.TgZ(1,"div",99),Z.YNc(2,B,3,2,"ng-container",37),Z.qZA(),Z.BQk()),2&t){const t=Z.oxw(4);Z.xp6(2),Z.Q6J("ngIf",t.contentType)}}function H(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",99),Z.TgZ(2,"input",100),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().$implicit.separator=e}),Z.ALo(3,"translate"),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw().$implicit;Z.xp6(2),Z.Q6J("ngbTooltip",Z.lcZ(3,2,"SEPARATOR"))("ngModel",t.separator)}}function j(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",107),Z.TgZ(2,"input",100),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().$implicit.targetTitle=e}),Z.ALo(3,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(4,"div",108),Z.TgZ(5,"input",100),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().$implicit.targetName=e}),Z.ALo(6,"translate"),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw().$implicit;Z.xp6(2),Z.Q6J("ngbTooltip",Z.lcZ(3,4,"FIELD_NAME"))("ngModel",t.targetTitle),Z.xp6(3),Z.Q6J("ngbTooltip",Z.lcZ(6,6,"SYSTEM_NAME"))("ngModel",t.targetName)}}function z(t,e){if(1&t){const t=Z.EpF();Z.TgZ(0,"div",107),Z.TgZ(1,"input",100),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw(2).$implicit.targetTitle=e}),Z.ALo(2,"translate"),Z.qZA(),Z.qZA()}if(2&t){const t=Z.oxw(2).$implicit;Z.xp6(1),Z.Q6J("ngbTooltip",Z.lcZ(2,2,"FIELD_NAME"))("ngModel",t.targetTitle)}}function V(t,e){if(1&t&&(Z.TgZ(0,"option",70),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.hij(" ",t.title," ")}}function G(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"select",61),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw(2).$implicit.targetName=e}),Z.YNc(2,V,2,2,"option",58),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw(2).$implicit,e=Z.oxw(5);Z.xp6(1),Z.Q6J("ngModel",t.targetName),Z.xp6(1),Z.Q6J("ngForOf",e.contentType.fields)}}const K=function(t,e){return{"col-4":t,"col-6":e}};function X(t,e){if(1&t&&(Z.ynx(0),Z.YNc(1,z,3,4,"div",109),Z.TgZ(2,"div",110),Z.YNc(3,G,3,2,"ng-container",37),Z.qZA(),Z.BQk()),2&t){const t=Z.oxw().$implicit,e=Z.oxw(5);Z.xp6(1),Z.Q6J("ngIf",e.getIsParametersField(t.targetName)),Z.xp6(1),Z.Q6J("ngClass",Z.WLB(3,K,e.getIsParametersField(t.targetName),!e.getIsParametersField(t.targetName))),Z.xp6(1),Z.Q6J("ngIf",e.contentType)}}function W(t,e){if(1&t){const t=Z.EpF();Z.TgZ(0,"div",105),Z.TgZ(1,"div",91),Z.TgZ(2,"select",61),Z.NdJ("ngModelChange",function(e){return Z.CHM(t).$implicit.targetAction=e})("ngModelChange",function(e){const i=Z.CHM(t).$implicit,o=Z.oxw(2).$implicit;return Z.oxw(3).onChangeFieldAction(i,e,o)}),Z.TgZ(3,"option",57),Z._uU(4),Z.ALo(5,"translate"),Z.qZA(),Z.TgZ(6,"option",93),Z._uU(7),Z.ALo(8,"translate"),Z.qZA(),Z.TgZ(9,"option",95),Z._uU(10),Z.ALo(11,"translate"),Z.qZA(),Z.TgZ(12,"option",106),Z._uU(13),Z.ALo(14,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.ynx(15,97),Z.YNc(16,j,7,8,"ng-container",98),Z.YNc(17,X,4,6,"ng-container",98),Z.BQk(),Z.qZA()}if(2&t){const t=e.$implicit,i=Z.oxw(5);Z.xp6(1),Z.Q6J("ngClass",i.getFieldsColumnClass(t,"field_sub")),Z.xp6(1),Z.Q6J("ngModel",t.targetAction),Z.xp6(2),Z.Oqu(Z.lcZ(5,9,"NO_IMPORT")),Z.xp6(3),Z.Oqu(Z.lcZ(8,11,"SELECT_FIELD")),Z.xp6(3),Z.Oqu(Z.lcZ(11,13,"CREATE_FIELD")),Z.xp6(3),Z.hij("\xd7 ",Z.lcZ(14,15,"DELETE"),""),Z.xp6(2),Z.Q6J("ngSwitch",t.targetAction),Z.xp6(1),Z.Q6J("ngSwitchCase","new"),Z.xp6(1),Z.Q6J("ngSwitchCase","field")}}function tt(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",16),Z.TgZ(2,"div",101),Z._UZ(3,"hr"),Z.YNc(4,W,18,17,"div",102),Z.TgZ(5,"div",103),Z.TgZ(6,"button",104),Z.NdJ("click",function(e){Z.CHM(t);const i=Z.oxw().$implicit;return Z.oxw(3).fieldAddOptions(i,e)}),Z._uU(7),Z.ALo(8,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw().$implicit;Z.xp6(4),Z.Q6J("ngForOf",t.options),Z.xp6(3),Z.hij(" ",Z.lcZ(8,2,"ADD")," ")}}function et(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"tr"),Z.TgZ(2,"td"),Z.TgZ(3,"div",16),Z.TgZ(4,"div",88),Z._uU(5),Z.qZA(),Z.TgZ(6,"div",89),Z.TgZ(7,"div",90),Z.TgZ(8,"div",91),Z.TgZ(9,"select",61),Z.NdJ("ngModelChange",function(e){return Z.CHM(t).$implicit.targetAction=e})("ngModelChange",function(e){const i=Z.CHM(t).$implicit;return Z.oxw(3).onChangeFieldAction(i,"field",e)}),Z.TgZ(10,"option",57),Z._uU(11),Z.ALo(12,"translate"),Z.qZA(),Z.TgZ(13,"option",92),Z._uU(14),Z.ALo(15,"translate"),Z.qZA(),Z.TgZ(16,"option",93),Z._uU(17),Z.ALo(18,"translate"),Z.qZA(),Z.TgZ(19,"option",94),Z._uU(20),Z.ALo(21,"translate"),Z.qZA(),Z.TgZ(22,"option",95),Z._uU(23),Z.ALo(24,"translate"),Z.qZA(),Z.TgZ(25,"option",96),Z._uU(26),Z.ALo(27,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.ynx(28,97),Z.YNc(29,Y,4,4,"ng-container",98),Z.YNc(30,$,3,1,"ng-container",98),Z.YNc(31,H,4,4,"ng-container",98),Z.BQk(),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(32,tt,9,4,"ng-container",37),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=e.$implicit,i=Z.oxw(3);Z.xp6(5),Z.hij(" ",t.sourceTitle," "),Z.xp6(3),Z.Q6J("ngClass",i.getFieldsColumnClass(t,"field")),Z.xp6(1),Z.Q6J("ngModel",t.targetAction),Z.xp6(2),Z.Oqu(Z.lcZ(12,14,"NO_IMPORT")),Z.xp6(3),Z.Oqu(Z.lcZ(15,16,"CATEGORY")),Z.xp6(3),Z.Oqu(Z.lcZ(18,18,"SELECT_FIELD")),Z.xp6(3),Z.Oqu(Z.lcZ(21,20,"TRANSLATIONS")),Z.xp6(3),Z.Oqu(Z.lcZ(24,22,"CREATE_FIELD")),Z.xp6(3),Z.Oqu(Z.lcZ(27,24,"SPLIT")),Z.xp6(2),Z.Q6J("ngSwitch",t.targetAction),Z.xp6(1),Z.Q6J("ngSwitchCase","new"),Z.xp6(1),Z.Q6J("ngSwitchCase","field"),Z.xp6(1),Z.Q6J("ngSwitchCase","split"),Z.xp6(1),Z.Q6J("ngIf","split"==t.targetAction)}}function it(t,e){if(1&t&&(Z.TgZ(0,"tr"),Z.TgZ(1,"td"),Z._uU(2),Z.qZA(),Z.qZA()),2&t){const t=e.$implicit;Z.xp6(2),Z.hij(" ",t," ")}}function ot(t,e){if(1&t&&(Z.TgZ(0,"table",124),Z.TgZ(1,"thead"),Z.TgZ(2,"tr"),Z.TgZ(3,"th"),Z._uU(4),Z.ALo(5,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(6,"tbody"),Z.YNc(7,it,3,1,"tr",82),Z.qZA(),Z.qZA()),2&t){const t=Z.oxw(4);Z.xp6(4),Z.Oqu(Z.lcZ(5,2,"CATEGORIES")),Z.xp6(3),Z.Q6J("ngForOf",t.testData.categories)}}function nt(t,e){if(1&t&&(Z.TgZ(0,"tr"),Z.TgZ(1,"td"),Z._uU(2),Z.qZA(),Z.TgZ(3,"td"),Z._uU(4),Z.ALo(5,"json"),Z.qZA(),Z.qZA()),2&t){const t=e.$implicit;Z.xp6(2),Z.hij(" ",t.key," "),Z.xp6(2),Z.hij(" ",Z.lcZ(5,2,t.value)," ")}}function st(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",111),Z.TgZ(2,"div",112),Z.TgZ(3,"div",113),Z.TgZ(4,"button",114),Z.NdJ("click",function(e){return Z.CHM(t),Z.oxw(3).clearTestData(e)}),Z._uU(5),Z.ALo(6,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(7,"div",16),Z.TgZ(8,"div",115),Z.YNc(9,ot,8,4,"table",116),Z.TgZ(10,"table",117),Z.TgZ(11,"colgroup"),Z._UZ(12,"col",118),Z.qZA(),Z.TgZ(13,"tr"),Z.TgZ(14,"td"),Z._uU(15),Z.ALo(16,"translate"),Z.qZA(),Z.TgZ(17,"td"),Z._uU(18),Z.qZA(),Z.qZA(),Z.TgZ(19,"tr"),Z.TgZ(20,"td"),Z._uU(21),Z.ALo(22,"translate"),Z.qZA(),Z.TgZ(23,"td"),Z._uU(24),Z.qZA(),Z.qZA(),Z.TgZ(25,"tr"),Z.TgZ(26,"td"),Z._uU(27),Z.ALo(28,"translate"),Z.qZA(),Z.TgZ(29,"td"),Z._uU(30),Z.ALo(31,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(32,"div",119),Z.TgZ(33,"div",120),Z.TgZ(34,"table",117),Z.TgZ(35,"colgroup"),Z._UZ(36,"col",121),Z._UZ(37,"col",122),Z.qZA(),Z.TgZ(38,"thead"),Z.TgZ(39,"tr"),Z.TgZ(40,"th",123),Z._uU(41),Z.ALo(42,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(43,"tbody"),Z.YNc(44,nt,6,4,"tr",82),Z.ALo(45,"keyvalue"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw(3);Z.xp6(5),Z.hij(" ",Z.lcZ(6,11,"CLOSE")," "),Z.xp6(4),Z.Q6J("ngIf",t.testData.categories.length),Z.xp6(6),Z.hij(" ",Z.lcZ(16,13,"ROW_NUMBER")," "),Z.xp6(3),Z.hij(" ",t.testData.row_number_first," "),Z.xp6(3),Z.hij(" ",Z.lcZ(22,15,"MEMORY_USED")," "),Z.xp6(3),Z.hij(" ",t.testData.memory_peak_usage," "),Z.xp6(3),Z.hij(" ",Z.lcZ(28,17,"TIME_EXECUTION")," "),Z.xp6(3),Z.AsE(" ",t.testData.time_execution," ",Z.lcZ(31,19,"TIME_EXECUTION_SEC")," "),Z.xp6(11),Z.Oqu(Z.lcZ(42,21,"PRODUCT_DATA")),Z.xp6(3),Z.Q6J("ngForOf",Z.lcZ(45,23,t.testData.data))}}function rt(t,e){if(1&t){const t=Z.EpF();Z.TgZ(0,"div",71),Z.TgZ(1,"div",72),Z.TgZ(2,"div",73),Z.YNc(3,Q,8,7,"div",74),Z.TgZ(4,"button",75),Z.NdJ("click",function(e){return Z.CHM(t),Z.oxw(2).startImport(e)}),Z._uU(5),Z.ALo(6,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(7,"button",76),Z.NdJ("click",function(e){return Z.CHM(t),Z.oxw(2).updateData(e)}),Z.ALo(8,"translate"),Z._UZ(9,"i",77),Z.qZA(),Z.TgZ(10,"button",78),Z.NdJ("click",function(e){return Z.CHM(t),Z.oxw(2).getTestData(e)}),Z._uU(11),Z.ALo(12,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(13,"div",79),Z.TgZ(14,"div",80),Z.TgZ(15,"table",81),Z.YNc(16,et,33,26,"ng-container",82),Z.qZA(),Z.qZA(),Z.YNc(17,st,46,25,"ng-container",37),Z.qZA(),Z.qZA()}if(2&t){const t=Z.oxw(2);Z.xp6(3),Z.Q6J("ngIf",t.model.options.stepsNumber>1),Z.xp6(2),Z.hij(" ",Z.lcZ(6,7,"START_IMPORT")," "),Z.xp6(2),Z.Q6J("ngbTooltip",Z.lcZ(8,9,"REFRESH")),Z.xp6(3),Z.Q6J("disabled",t.testData),Z.xp6(1),Z.hij(" ",Z.lcZ(12,11,"TEST")," "),Z.xp6(5),Z.Q6J("ngForOf",t.model.fieldsOptions),Z.xp6(1),Z.Q6J("ngIf",t.testData)}}function lt(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div"),Z._UZ(2,"hr"),Z.TgZ(3,"div",16),Z.TgZ(4,"div",17),Z.TgZ(5,"div",22),Z.TgZ(6,"label",55),Z._uU(7),Z.ALo(8,"translate"),Z.qZA(),Z.TgZ(9,"select",56),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.sheetName=e})("ngModelChange",function(){return Z.CHM(t),Z.oxw().getSheetProperties()}),Z._UZ(10,"option",57),Z.YNc(11,I,2,2,"option",58),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(12,"div",17),Z.TgZ(13,"div",22),Z.TgZ(14,"label",59),Z._uU(15),Z.ALo(16,"translate"),Z.qZA(),Z.TgZ(17,"app-select-parent-dropdown",60),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.parentId=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(18,"div",16),Z.TgZ(19,"div",17),Z.TgZ(20,"div",22),Z.TgZ(21,"label",55),Z._uU(22),Z.ALo(23,"translate"),Z.qZA(),Z.TgZ(24,"select",61),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.contentType=e})("ngModelChange",function(e){return Z.CHM(t),Z.oxw().getContentType(e)}),Z._UZ(25,"option",57),Z.YNc(26,L,2,2,"option",58),Z.ALo(27,"async"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(28,"div",17),Z.TgZ(29,"div",22),Z.TgZ(30,"label",62),Z._uU(31),Z.ALo(32,"translate"),Z.qZA(),Z.TgZ(33,"select",63),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.articulFieldName=e}),Z._UZ(34,"option",57),Z.YNc(35,U,2,1,"ng-container",37),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(36,"div",16),Z.TgZ(37,"div",17),Z.TgZ(38,"label",64),Z.TgZ(39,"span",29),Z.ALo(40,"translate"),Z._uU(41),Z.ALo(42,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(43,"select",65),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.aliasAdditionalFieldName=e}),Z._UZ(44,"option",57),Z.YNc(45,F,2,1,"ng-container",37),Z.qZA(),Z.qZA(),Z.TgZ(46,"div",17),Z.TgZ(47,"div",22),Z.TgZ(48,"div",66),Z.TgZ(49,"input",67),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.filesDownload=e}),Z.qZA(),Z.TgZ(50,"label",68),Z._uU(51),Z.ALo(52,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(53,"div",22),Z.TgZ(54,"div",66),Z.TgZ(55,"input",67),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.skipFound=e}),Z.qZA(),Z.TgZ(56,"label",68),Z._uU(57),Z.ALo(58,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(59,rt,18,13,"div",69),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw();Z.xp6(1),Z.ekj("loading",t.loadingConfiguration),Z.xp6(6),Z.Oqu(Z.lcZ(8,26,"SHEET")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.sheetName),Z.xp6(2),Z.Q6J("ngForOf",t.model.sheetsNames),Z.xp6(4),Z.Oqu(Z.lcZ(16,28,"PARENT_FOLDER")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.parentId),Z.xp6(5),Z.Oqu(Z.lcZ(23,30,"CONTENT_TYPE")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.contentType),Z.xp6(2),Z.Q6J("ngForOf",Z.lcZ(27,32,t.contentTypes$)),Z.xp6(5),Z.Oqu(Z.lcZ(32,34,"SEARCH_FIELD")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.articulFieldName),Z.xp6(2),Z.Q6J("ngIf",t.contentType),Z.xp6(4),Z.Q6J("title",Z.lcZ(40,36,"ALIAS_ADDITIONAL_FIELD")),Z.xp6(2),Z.Oqu(Z.lcZ(42,38,"ALIAS_ADDITIONAL_FIELD")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.aliasAdditionalFieldName),Z.xp6(2),Z.Q6J("ngIf",t.contentType),Z.xp6(4),Z.MGl("id","fieldFilesDownload",t.uniqueId,""),Z.Q6J("ngModel",t.model.options.filesDownload),Z.xp6(1),Z.MGl("for","fieldFilesDownload",t.uniqueId,""),Z.xp6(1),Z.Oqu(Z.lcZ(52,40,"FILES_DOWNLOAD")),Z.xp6(4),Z.MGl("id","fieldSkipFound",t.uniqueId,""),Z.Q6J("ngModel",t.model.options.skipFound),Z.xp6(1),Z.MGl("for","fieldSkipFound",t.uniqueId,""),Z.xp6(1),Z.Oqu(Z.lcZ(58,42,"SKIP_FOUND")),Z.xp6(2),Z.Q6J("ngIf",t.model.options.sheetName)}}function at(t,e){if(1&t){const t=Z.EpF();Z.TgZ(0,"div",125),Z._uU(1),Z.TgZ(2,"button",126),Z.NdJ("click",function(){return Z.CHM(t),Z.oxw().errorMessage=""}),Z.qZA(),Z.qZA()}if(2&t){const t=Z.oxw();Z.xp6(1),Z.hij(" ",t.errorMessage," ")}}function dt(t,e){if(1&t&&(Z.TgZ(0,"span"),Z._uU(1),Z.qZA()),2&t){const t=Z.oxw(2);Z.xp6(1),Z.hij("",t.percent,"%")}}function ct(t,e){if(1&t&&(Z.ynx(0),Z.TgZ(1,"div",127),Z.TgZ(2,"ngb-progressbar",128),Z.YNc(3,dt,2,1,"span",37),Z.qZA(),Z.qZA(),Z.BQk()),2&t){const t=Z.oxw();Z.xp6(2),Z.Q6J("value",t.percent)("animated",!0)("striped",!0),Z.xp6(1),Z.Q6J("ngIf",t.percent>10)}}let pt=(()=>{class t extends b.D{constructor(t,e,i,o,n,s,r,l,a,d,c,p){super(t,e,i,o,n,s,r),this.fb=t,this.dataService=e,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=n,this.translateService=s,this.elRef=r,this.modalService=l,this.settingsService=a,this.contentTypeService=d,this.appSettings=c,this.messageService=p,this.model=new q(0,""),this.modalTitle="Import",this.loadingConfiguration=!1,this.isInitialised=!1,this.sheetHeaders=[],this.contentTypes=[],this.percent=0,this.showProgressBar=!1,this.steps=[1],this.formFields={title:{fieldLabel:"TITLE",value:"",validators:[T.kI.required],messages:{}},fileData:{fieldLabel:"FILE",value:"",validators:[T.kI.required],messages:{}},rowNumberHeaders:{fieldLabel:"ROW_NUMBER_HEADERS",value:1,dataKey:"options",validators:[],messages:{}},rowNumberFirst:{fieldLabel:"ROW_NUMBER_FIRST",value:2,dataKey:"options",validators:[],messages:{}},rowNumberLast:{fieldLabel:"ROW_NUMBER_LAST",value:0,dataKey:"options",validators:[],messages:{}},categoriesSeparator:{fieldLabel:"SEPARATOR_CATEGORIES",value:"",dataKey:"options",validators:[],messages:{}}},this.files={}}onBeforeInit(){this.model&&!this.model.options&&(this.model.options={})}onAfterInit(){this.itemId&&this.getContentTypesList()}onAfterGetData(){setTimeout(()=>{this.isInitialised=!0},1),this.model.options.contentType&&this.getContentType(),(!this.model.fieldsOptions||0===this.model.fieldsOptions.length)&&this.getSheetProperties(),this.updateStepsArr()}getFileName(t){return"string"==typeof t?t:v.q.getFileName(t)}onOptionChanged(){!this.isInitialised||(clearTimeout(this.timerConfiguration),this.timerConfiguration=setTimeout(this.getSheetProperties.bind(this),700))}getContentTypesList(){this.contentTypes$=this.contentTypeService.getListPage().pipe((0,A.U)(({items:t})=>t))}getContentType(t){t||(t=this.model.options.contentType),t?(this.loadingConfiguration=!0,this.contentTypeService.getItemByName(t).subscribe({next:t=>{this.contentType=t,this.loadingConfiguration=!1},error:t=>{t.error&&(this.errorMessage=t.error),this.contentType=null,this.loadingConfiguration=!1}})):this.contentType=null}onChangeFieldAction(t,e,i){if(t.targetName="",t.targetTitle="",t.separator="",t.options=[],"delete"===e&&i){const t=(0,d.findIndex)(i.options,{targetAction:"delete"});t>-1&&i.options.splice(t,1)}}getSheetProperties(t){t&&t.preventDefault(),this.model.options.sheetName?(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.getSheetProperties(this.model).subscribe({next:t=>{this.model.fieldsOptions=t.fieldsOptions,this.model.options.rowNumberLast=t.rowsQuantity,this.loadingConfiguration=!1},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loadingConfiguration=!1}})):this.sheetHeaders=[]}getTestData(t){t&&t.preventDefault(),!this.loading&&!this.loadingConfiguration&&(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.testData(this.model).subscribe({next:t=>{t?this.testData=t:this.errorMessage=this.getLangString("ERROR"),this.loadingConfiguration=!1},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loadingConfiguration=!1}}))}updateData(t){t&&t.preventDefault(),this.testData?this.getTestData():this.getSheetProperties()}fieldAddOptions(t,e){e&&e.preventDefault(),t.options.push({targetAction:""})}getIsFieldsCount(t,e){switch(e){case 1:return!t.targetAction||["category"].indexOf(t.targetAction)>-1;case 2:return["field","split"].indexOf(t.targetAction)>-1;case 3:return["new"].indexOf(t.targetAction)>-1}return!0}getIsParametersField(t){return!!this.contentType&&this.contentType.fields.filter(t=>"parameters"===t.inputType).map(t=>t.name).indexOf(t)>-1}getFieldsColumnClass(t,e){let i=[["split","field","new"],[]],o=["col-6 pe-2","col-4 pe-2"];const n=this.getIsParametersField(t.targetName);"field_sub"==e&&(i=[["split"],["new"]],n?i[1].push("field"):i[0].push("field"),o=["col-6 pe-2","col-4 pe-2"]);let s="col-12";return i.forEach((e,i)=>{e.indexOf(t.targetAction)>-1&&(s=o[i])}),s}onStepNumberChange(){this.updateStepsArr()}onImportCompleted(){this.showProgressBar=!1,this.loading=!1,this.activeModal.close({reason:"import_completed"})}updateStepsArr(){this.steps=(0,d.range)(1,Math.max(1,parseInt(String(this.model.options.stepsNumber))+1)),this.model.options.step=1}startImport(t){if(t&&t.preventDefault(),this.loading||this.loadingConfiguration)return;this.errorMessage="",this.testData=null,this.loading=!0,this.percent=0;let e=0,i="",o={};this.dataService.importDataProgress(this.model).subscribe({next:t=>{if(t instanceof u.Zn)this.updatePercent(100);else if(t instanceof u.ZM)200!==t.status&&400!==t.status&&this.onImportCompleted();else if(t.type===u.dt.DownloadProgress){i=t.partialText.substr(e).trim();const n=i.split("\n");i=n[n.length-1],e=t.partialText.length,"{"===i.substr(0,1)&&"}"===i.substr(i.length-1,1)&&(o=JSON.parse(i),this.updatePercent((o.currentIndex-o.rowNumberFirst)/(o.rowNumberLast-o.rowNumberFirst)*100))}},error:t=>{t.error&&t.error.indexOf("{")>-1&&(t.error=JSON.parse(t.error),t.error=t.error.error||this.getLangString("ERROR")),this.errorMessage=t.error||this.getLangString("ERROR"),this.showProgressBar=!1,this.loading=!1}})}updatePercent(t){this.percent=Math.min(100,Math.floor(t)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout(()=>{this.onImportCompleted()},1e3)}confirmAction(t){return this.modalRef=this.modalService.open(C.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=t,this.modalRef.result}clearTestData(t){t&&t.preventDefault(),this.testData=null}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}}return t.\u0275fac=function(e){return new(e||t)(Z.Y36(T.qu),Z.Y36(f),Z.Y36(l.U),Z.Y36(N.Kz),Z.Y36(N.xI),Z.Y36(S.sK),Z.Y36(Z.SBq),Z.Y36(N.FF),Z.Y36(r.g),Z.Y36(M.s),Z.Y36(x.d),Z.Y36(c.ez))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-modal-import"]],inputs:{model:"model"},features:[Z._Bn([f,c.ez]),Z.qOj],decls:96,vars:76,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5",3,"title"],[1,"modal-body","py-0"],[3,"formGroup"],["formElement","ngForm"],[1,"row"],[1,"col-md-6"],[1,"mb-2","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","id","fieldTitle","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"mb-2"],["formControlName","fileData",3,"allowedExtensions","fieldName","largeFieldMode","files","ngModel","filesChange","ngModelChange"],["class","alert alert-danger d-block px-2 py-0 mt-2",4,"ngIf"],["for","fieldRowNumberHeaders",1,"label-filled"],["type","number","id","fieldRowNumberHeaders","step","1","min","1","name","rowNumberHeaders","formControlName","rowNumberHeaders",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-lg-6"],["for","fieldRowNumberFirst",1,"label-filled","max-width95"],[1,"text-overflow",3,"title"],["type","number","id","fieldRowNumberFirst","step","1","min","1","name","rowNumberFirst","formControlName","rowNumberFirst",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldRowNumberLast",1,"label-filled","max-width95"],["type","number","id","fieldRowNumberLast","step","1","min","1","name","rowNumberLast","formControlName","rowNumberLast",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCategoriesSeparator",1,"label-filled"],["type","text","id","fieldCategoriesSeparator","name","categoriesSeparator","formControlName","categoriesSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldStepsNumber",1,"label-filled"],["type","number","id","fieldStepsNumber","step","1","min","1","max","100",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[4,"ngIf"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"disabled","click"],[1,"alert","alert-danger"],[1,"alert","alert-danger","d-block","px-2","py-0","mt-2"],["for","fieldCSVSeparator",1,"label-filled","max-width95"],["type","text","id","fieldCSVSeparator","name","csvSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEnclosure",1,"label-filled","max-width95"],["type","text","id","fieldCSVEnclosure","name","csvEnclosure",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEncoding",1,"label-filled"],["type","text","id","fieldCSVEncoding","name","csvEncoding",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldSheetsNames",1,"label-filled"],["id","fieldSheetsNames",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"label-filled"],[3,"ngModel","ngModelChange"],[1,"form-select",3,"ngModel","ngModelChange"],["for","fieldArticulFieldName",1,"label-filled"],["id","fieldArticulFieldName",1,"form-select",3,"ngModel","ngModelChange"],["for","fieldAliasAdditionalFieldName",1,"label-filled","max-width95"],["id","fieldAliasAdditionalFieldName",1,"form-select",3,"ngModel","ngModelChange"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"form-check-label",3,"for"],["class","card",4,"ngIf"],[3,"value"],[1,"card"],[1,"card-header"],[1,"float-none","float-lg-end","mb-2","mb-lg-0"],["class","d-inline-block me-2","style","width: 150px;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-wide",3,"click"],["type","button",1,"btn","btn-secondary","me-2",3,"ngbTooltip","click"],[1,"icon-repeat"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],[1,"p-0"],[1,"max-height400"],[1,"table","border-top-0","my-0","bg-light"],[4,"ngFor","ngForOf"],[1,"d-inline-block","me-2",2,"width","150px"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["id","fieldStep",1,"form-select",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","no-gutters"],[3,"ngClass"],["value","category"],["value","field"],["value","translations"],["value","new"],["value","split"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-6","ps-2"],["type","text",1,"form-control",3,"ngbTooltip","ngModel","ngModelChange"],[1,"col-12","col-lg-8","offset-lg-4"],["class","row no-gutters mb-3",4,"ngFor","ngForOf"],[1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm","btn-wide",3,"click"],[1,"row","no-gutters","mb-3"],["value","delete"],[1,"col-4","px-1"],[1,"col-4","ps-2"],["class","col-4 px-1",4,"ngIf"],[1,"ps-2",3,"ngClass"],[1,"p-2","border-top"],[1,"position-relative"],[1,"position-absolute","pos-absolute-right2",2,"z-index","10"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"col-lg-5"],["class","table table-striped table-bordered bg-light table-sm mt-0",4,"ngIf"],[1,"table","table-striped","table-bordered","bg-light","table-sm","my-0"],["width","50%","span","2"],[1,"col-lg-7"],[1,"table-responsive"],["width","40%"],["width","60%"],["colspan","2"],[1,"table","table-striped","table-bordered","bg-light","table-sm","mt-0"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"app-progress",2,"width","400px","position","absolute","left","50%","top","50%","margin-left","-200px","margin-top","50px","z-index","2222"],["type","success","height","1.4rem",3,"value","animated","striped"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z.TgZ(1,"div",1),Z.TgZ(2,"button",2),Z.NdJ("click",function(t){return e.closeModal(t)}),Z._UZ(3,"i",3),Z.TgZ(4,"span"),Z._uU(5),Z.ALo(6,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(7,"button",2),Z.NdJ("click",function(t){return e.minimize(t)}),Z._UZ(8,"i",4),Z.TgZ(9,"span"),Z._uU(10),Z.ALo(11,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(12,"div",5),Z.TgZ(13,"div",6),Z.TgZ(14,"div",7),Z.TgZ(15,"button",8),Z.NdJ("click",function(t){return e.maximize(t)}),Z.ALo(16,"translate"),Z._UZ(17,"i",9),Z.qZA(),Z.TgZ(18,"button",10),Z.NdJ("click",function(t){return e.closeModal(t)}),Z.ALo(19,"translate"),Z._UZ(20,"i",11),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(21,"h4",12),Z._uU(22),Z.qZA(),Z.qZA(),Z.TgZ(23,"div",13),Z.TgZ(24,"form",14,15),Z.TgZ(26,"div",16),Z.TgZ(27,"div",17),Z.TgZ(28,"div",18),Z.TgZ(29,"label",19),Z._uU(30),Z.ALo(31,"translate"),Z.qZA(),Z.TgZ(32,"input",20),Z.NdJ("ngModelChange",function(t){return e.model.title=t}),Z.qZA(),Z.YNc(33,O,2,1,"div",21),Z.qZA(),Z.qZA(),Z.TgZ(34,"div",17),Z.TgZ(35,"div",22),Z.TgZ(36,"app-file-widget",23),Z.NdJ("filesChange",function(t){return e.files=t})("ngModelChange",function(t){return e.model.fileData=t}),Z.qZA(),Z.YNc(37,_,2,1,"div",24),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(38,"div",16),Z.TgZ(39,"div",17),Z.TgZ(40,"div",22),Z.TgZ(41,"label",25),Z._uU(42),Z.ALo(43,"translate"),Z.qZA(),Z.TgZ(44,"input",26),Z.NdJ("ngModelChange",function(t){return e.model.options.rowNumberHeaders=t})("ngModelChange",function(){return e.onOptionChanged()}),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(45,"div",17),Z.TgZ(46,"div",16),Z.TgZ(47,"div",27),Z.TgZ(48,"div",22),Z.TgZ(49,"label",28),Z.TgZ(50,"span",29),Z.ALo(51,"translate"),Z._uU(52),Z.ALo(53,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(54,"input",30),Z.NdJ("ngModelChange",function(t){return e.model.options.rowNumberFirst=t}),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(55,"div",27),Z.TgZ(56,"div",22),Z.TgZ(57,"label",31),Z.TgZ(58,"span",29),Z.ALo(59,"translate"),Z._uU(60),Z.ALo(61,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(62,"input",32),Z.NdJ("ngModelChange",function(t){return e.model.options.rowNumberLast=t}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(63,"div",16),Z.TgZ(64,"div",17),Z.TgZ(65,"div",22),Z.TgZ(66,"label",33),Z._uU(67),Z.ALo(68,"translate"),Z.qZA(),Z.TgZ(69,"input",34),Z.NdJ("ngModelChange",function(t){return e.model.options.categoriesSeparator=t}),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(70,"div",17),Z.TgZ(71,"div",22),Z.TgZ(72,"label",35),Z._uU(73),Z.ALo(74,"translate"),Z.qZA(),Z.TgZ(75,"input",36),Z.NdJ("ngModelChange",function(t){return e.model.options.stepsNumber=t})("ngModelChange",function(){return e.onStepNumberChange()}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(76,w,26,18,"ng-container",37),Z.YNc(77,lt,60,44,"ng-container",37),Z.YNc(78,at,3,1,"div",38),Z.YNc(79,ct,4,4,"ng-container",37),Z.qZA(),Z.TgZ(80,"div",39),Z.TgZ(81,"div",40),Z.TgZ(82,"button",41),Z.NdJ("click",function(t){return e.save(!0,t)}),Z.TgZ(83,"span"),Z._uU(84),Z.ALo(85,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(86,"div",42),Z._UZ(87,"button",43),Z.TgZ(88,"div",44),Z.TgZ(89,"button",45),Z.NdJ("click",function(t){return e.save(!1,t)}),Z._uU(90),Z.ALo(91,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(92,"button",46),Z.NdJ("click",function(t){return e.closeModal(t)}),Z.TgZ(93,"span"),Z._uU(94),Z.ALo(95,"translate"),Z.qZA(),Z.qZA(),Z.qZA()),2&t&&(Z.xp6(2),Z.Q6J("disabled",e.submitted),Z.xp6(3),Z.Oqu(Z.lcZ(6,45,"CLOSE")),Z.xp6(2),Z.Q6J("disabled",e.submitted),Z.xp6(3),Z.Oqu(Z.lcZ(11,47,"MINIMIZE")),Z.xp6(5),Z.Q6J("title",Z.lcZ(16,49,"EXPAND")),Z.xp6(3),Z.Q6J("title",Z.lcZ(19,51,"CLOSE")),Z.xp6(3),Z.Q6J("title",e.modalTitle),Z.xp6(1),Z.Oqu(e.modalTitle),Z.xp6(1),Z.ekj("loading",e.loading),Z.xp6(1),Z.Q6J("formGroup",e.form),Z.xp6(6),Z.Oqu(Z.lcZ(31,53,"TITLE")),Z.xp6(2),Z.ekj("is-invalid",e.formErrors.title),Z.Q6J("ngModel",e.model.title),Z.xp6(1),Z.Q6J("ngIf",e.formErrors.title),Z.xp6(3),Z.Q6J("allowedExtensions",".xls,.xlsx,.csv")("fieldName","fileData")("largeFieldMode",!1)("files",e.files)("ngModel",e.model.fileData),Z.xp6(1),Z.Q6J("ngIf",e.formErrors.fileData),Z.xp6(5),Z.Oqu(Z.lcZ(43,55,"ROW_NUMBER_HEADERS")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.rowNumberHeaders),Z.xp6(6),Z.Q6J("title",Z.lcZ(51,57,"ROW_NUMBER_FIRST")),Z.xp6(2),Z.Oqu(Z.lcZ(53,59,"ROW_NUMBER_FIRST")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.rowNumberFirst),Z.xp6(4),Z.Q6J("title",Z.lcZ(59,61,"ROW_NUMBER_LAST")),Z.xp6(2),Z.Oqu(Z.lcZ(61,63,"ROW_NUMBER_LAST")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.rowNumberLast),Z.xp6(5),Z.Oqu(Z.lcZ(68,65,"SEPARATOR_CATEGORIES")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.categoriesSeparator),Z.xp6(4),Z.Oqu(Z.lcZ(74,67,"STEPS_NUMBER")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.stepsNumber)("ngModelOptions",Z.DdM(75,k)),Z.xp6(1),Z.Q6J("ngIf","csv"==e.model.type),Z.xp6(1),Z.Q6J("ngIf",e.model.id),Z.xp6(1),Z.Q6J("ngIf",e.errorMessage),Z.xp6(1),Z.Q6J("ngIf",e.showProgressBar),Z.xp6(3),Z.Q6J("disabled",e.submitted&&e.form.valid),Z.xp6(2),Z.Oqu(Z.lcZ(85,69,"SAVE_AND_CLOSE")),Z.xp6(3),Z.Q6J("disabled",e.submitted&&e.form.valid),Z.xp6(3),Z.Oqu(Z.lcZ(91,71,"SAVE")),Z.xp6(2),Z.Q6J("disabled",e.submitted||e.loading),Z.xp6(2),Z.Oqu(Z.lcZ(95,73,"CLOSE")))},directives:[T._Y,T.JL,T.sg,T.Fj,T.JJ,T.u,o.O5,y.E,T.qQ,T.wV,T.Fd,T.On,N.jt,N.iD,N.Vi,N.TH,T.EJ,T.YN,T.Kr,o.sg,E.F,T.Wl,N._L,o.mk,o.RF,o.n9,N.Ly],pipes:[S.X$,o.Ov,o.Nd,o.Ts],encapsulation:2}),t})();var gt=i(53332),ut=i(27965);let ht=(()=>{class t extends p.U{constructor(t,e,i,o,n){super(t,e,i,o),this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=o,this.messageService=n,this.queryOptions=new g.J("id","desc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"fileSize",sortName:"fileSize",title:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{name:"type",sortName:"type",title:"FILE_TYPE",outputType:"text",outputProperties:{}},{name:"sheetsQuantity",sortName:"sheetsQuantity",title:"SHEETS_QUANTITY",outputType:"text",outputProperties:{}},{name:"rowsQuantity",sortName:"rowsQuantity",title:"ROWS_QUANTITY",outputType:"text",outputProperties:{}}]}onModalClose(t){"import_completed"===(t&&t.reason?t.reason:"")&&this.messageService.add({key:"message",severity:"success",summary:this.getLangString("MESSAGE"),detail:this.getLangString("IMPORT_COMPLETED")})}getModalContent(){return pt}appendFormData(t){t.append("ownerType","import_export")}getModalElementId(t){return["modal","export-config",t||0].join("-")}setModalInputs(t,e=!1,i=""){super.setModalInputs(t,e,i),this.modalRef.componentInstance.modalTitle=void 0===t||e?this.getLangString("ADD_IMPORT_CONFIGURATION"):`${this.getLangString("EDIT_IMPORT_CONFIGURATION")} #${t}`;const o=(0,d.findIndex)(this.items,{id:t});o>-1&&(this.modalRef.componentInstance.model=this.items[o])}}return t.title="IMPORT_EXPORT",t.\u0275fac=function(e){return new(e||t)(Z.Y36(f),Z.Y36(N.Kz),Z.Y36(N.FF),Z.Y36(S.sK),Z.Y36(c.ez))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-import"]],features:[Z._Bn([f,c.ez]),Z.qOj],decls:22,vars:15,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""],["key","message","position","bottom-right"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z._UZ(1,"div",1),Z.TgZ(2,"div",2),Z.TgZ(3,"div",3),Z.TgZ(4,"button",4),Z.TgZ(5,"span"),Z._uU(6),Z.ALo(7,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(8,"div",5),Z.TgZ(9,"button",6),Z.NdJ("click",function(){return e.deleteSelected()}),Z._uU(10),Z.ALo(11,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(12,"button",7),Z.NdJ("click",function(){return e.modalOpen()}),Z._UZ(13,"i",8),Z._uU(14," \xa0 "),Z.TgZ(15,"span"),Z._uU(16),Z.ALo(17,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z._UZ(18,"div",9),Z.qZA(),Z.TgZ(19,"app-table",10,11),Z.NdJ("selectedIdsChange",function(t){return e.selectedIds=t})("loadingChange",function(t){return e.loading=t})("actionRequest",function(t){return e.actionRequest(t)}),Z.qZA(),Z._UZ(21,"p-toast",12)),2&t&&(Z.xp6(6),Z.Oqu(Z.lcZ(7,9,"BATCH_ACTIONS")),Z.xp6(4),Z.Oqu(Z.lcZ(11,11,"DELETE")),Z.xp6(6),Z.Oqu(Z.lcZ(17,13,"ADD")),Z.xp6(3),Z.Q6J("items",e.items)("selectedIds",e.selectedIds)("collectionSize",e.collectionSize)("queryOptions",e.queryOptions)("tableFields",e.tableFields)("loading",e.loading))},directives:[N.jt,N.iD,N.Vi,gt.a,ut.FN],pipes:[S.X$],styles:[""]}),t})();class mt{constructor(t,e,i,o,n,s,r){this.id=t,this.title=e,this.fileData=i,this.type=o,this.fileSize=n,this.options=s,this.fieldsOptions=r,void 0===this.options&&mt.setOptiontDefaults(this)}static setOptiontDefaults(t){t.options||(t.options={}),t.options=Object.assign({parentId:0,contentType:"",categoryType:"column",categoriesSeparator:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"'},t.options)}}let Zt=(()=>{class t extends m.D{constructor(t){super(t),this.setRequestUrl("export")}exportDataProgress(t){const e=this.getRequestUrl()+`/${t.id}/do_export`;return this.http.request(new u.aW("POST",e,t,{reportProgress:!0,responseType:"text",headers:this.headers}))}}return t.\u0275fac=function(e){return new(e||t)(Z.LFG(u.eN))},t.\u0275prov=Z.Yz7({token:t,factory:t.\u0275fac}),t})();function ft(t,e){if(1&t&&(Z.TgZ(0,"div",60),Z._uU(1),Z.qZA()),2&t){const t=Z.oxw();Z.xp6(1),Z.hij(" ",t.formErrors.title," ")}}function Tt(t,e){if(1&t&&(Z.TgZ(0,"option",61),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.Oqu(t.title)}}function At(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"div",16),Z.TgZ(2,"div",17),Z.TgZ(3,"div",22),Z.TgZ(4,"label",62),Z._uU(5),Z.ALo(6,"translate"),Z.qZA(),Z.TgZ(7,"input",63),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.csvSeparator=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(8,"div",17),Z.TgZ(9,"div",22),Z.TgZ(10,"label",64),Z._uU(11),Z.ALo(12,"translate"),Z.qZA(),Z.TgZ(13,"input",65),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.csvEncoding=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(14,"div",16),Z.TgZ(15,"div",17),Z.TgZ(16,"div",22),Z.TgZ(17,"label",66),Z._uU(18),Z.ALo(19,"translate"),Z.qZA(),Z.TgZ(20,"input",67),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw().model.options.csvEnclosure=e}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw();Z.xp6(5),Z.Oqu(Z.lcZ(6,6,"CSV_SEPARATOR")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.csvSeparator),Z.xp6(4),Z.Oqu(Z.lcZ(12,8,"CSV_ENCODING")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.csvEncoding),Z.xp6(5),Z.Oqu(Z.lcZ(19,10,"CSV_ENCLOSURE")),Z.xp6(2),Z.Q6J("ngModel",t.model.options.csvEnclosure)}}function bt(t,e){if(1&t&&(Z.ynx(0),Z.TgZ(1,"a",68),Z._UZ(2,"i",69),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.BQk()),2&t){const t=Z.oxw();Z.xp6(1),Z.hYB("href","",t.baseUrl,"/admin/files/download/",t.model.fileData.fileId,"",Z.LSH),Z.xp6(2),Z.hij(" ",Z.lcZ(4,3,"DOWNLOAD")," ")}}function qt(t,e){if(1&t&&(Z.TgZ(0,"option",61),Z._uU(1),Z.qZA()),2&t){const t=e.$implicit;Z.Q6J("value",t.name),Z.xp6(1),Z.hij(" ",t.title," ")}}function xt(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"select",74),Z.NdJ("ngModelChange",function(e){return Z.CHM(t),Z.oxw(2).$implicit.targetName=e})("ngModelChange",function(e){Z.CHM(t);const i=Z.oxw(2).$implicit;return Z.oxw().onChangeFieldName(i,e)}),Z.TgZ(2,"option",83),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.YNc(5,qt,2,2,"option",33),Z.qZA(),Z.BQk()}if(2&t){const t=Z.oxw(2).$implicit,e=Z.oxw();Z.xp6(1),Z.Q6J("ngModel",t.targetName),Z.xp6(2),Z.Oqu(Z.lcZ(4,3,"ID")),Z.xp6(2),Z.Q6J("ngForOf",e.contentType.fields)}}function vt(t,e){if(1&t&&(Z.ynx(0),Z.TgZ(1,"div",82),Z.YNc(2,xt,6,5,"ng-container",40),Z.qZA(),Z.BQk()),2&t){const t=Z.oxw(2);Z.xp6(2),Z.Q6J("ngIf",t.contentType)}}function Mt(t,e){if(1&t){const t=Z.EpF();Z.ynx(0),Z.TgZ(1,"tr"),Z.TgZ(2,"td"),Z.TgZ(3,"div",16),Z.TgZ(4,"div",70),Z._uU(5),Z.qZA(),Z.TgZ(6,"div",71),Z.TgZ(7,"div",72),Z.TgZ(8,"div",73),Z.TgZ(9,"select",74),Z.NdJ("ngModelChange",function(e){return Z.CHM(t).$implicit.targetAction=e})("ngModelChange",function(e){const i=Z.CHM(t),o=i.$implicit,n=i.index;return Z.oxw().onChangeFieldAction(o,n,e)}),Z.TgZ(10,"option",75),Z._uU(11),Z.ALo(12,"translate"),Z.qZA(),Z.TgZ(13,"option",76),Z._uU(14),Z.ALo(15,"translate"),Z.qZA(),Z.TgZ(16,"option",77),Z._uU(17),Z.ALo(18,"translate"),Z.qZA(),Z.TgZ(19,"option",78),Z._uU(20),Z.ALo(21,"translate"),Z.qZA(),Z.TgZ(22,"option",79),Z._uU(23),Z.ALo(24,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.ynx(25,80),Z.YNc(26,vt,3,1,"ng-container",81),Z.BQk(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.BQk()}if(2&t){const t=e.$implicit,i=e.index,o=Z.oxw();Z.xp6(5),Z.hij(" \u041a\u043e\u043b\u043e\u043d\u043a\u0430 #",i+1," "),Z.xp6(3),Z.Q6J("ngClass",o.getFieldsColumnClass(t)),Z.xp6(1),Z.Q6J("ngModel",t.targetAction),Z.xp6(2),Z.Oqu(Z.lcZ(12,10,"CATEGORY")),Z.xp6(3),Z.Oqu(Z.lcZ(15,12,"CATEGORIES_WITH_SEPARATOR")),Z.xp6(3),Z.Oqu(Z.lcZ(18,14,"SELECT_FIELD")),Z.xp6(3),Z.Oqu(Z.lcZ(21,16,"TRANSLATIONS")),Z.xp6(3),Z.hij("\xd7 ",Z.lcZ(24,18,"DELETE"),""),Z.xp6(2),Z.Q6J("ngSwitch",t.targetAction),Z.xp6(1),Z.Q6J("ngSwitchCase","field")}}function Ct(t,e){if(1&t){const t=Z.EpF();Z.TgZ(0,"div",84),Z._uU(1),Z.TgZ(2,"button",85),Z.NdJ("click",function(){return Z.CHM(t),Z.oxw().errorMessage=""}),Z.qZA(),Z.qZA()}if(2&t){const t=Z.oxw();Z.xp6(1),Z.hij(" ",t.errorMessage," ")}}function Nt(t,e){if(1&t&&(Z.TgZ(0,"span"),Z._uU(1),Z.qZA()),2&t){const t=Z.oxw(2);Z.xp6(1),Z.hij("",t.percent,"%")}}function St(t,e){if(1&t&&(Z.ynx(0),Z.TgZ(1,"div",86),Z.TgZ(2,"ngb-progressbar",87),Z.YNc(3,Nt,2,1,"span",40),Z.qZA(),Z.qZA(),Z.BQk()),2&t){const t=Z.oxw();Z.xp6(2),Z.Q6J("value",t.percent)("animated",!0)("striped",!0),Z.xp6(1),Z.Q6J("ngIf",t.percent>10)}}let yt=(()=>{class t extends b.D{constructor(t,e,i,o,n,s,r,l,a,d,c){super(t,e,i,o,n,s,r),this.fb=t,this.dataService=e,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=n,this.translateService=s,this.elRef=r,this.modalService=l,this.settingsService=a,this.contentTypeService=d,this.appSettings=c,this.model=new mt(0,""),this.modalTitle="Export",this.loadingConfiguration=!1,this.isInitialised=!1,this.sheetHeaders=[],this.contentTypes=[],this.percent=0,this.showProgressBar=!1,this.baseUrl="",this.formFields={title:{fieldLabel:"TITLE",value:"",validators:[T.kI.required],messages:{}},parentId:{fieldLabel:"PARENT_FOLDER",value:"",dataKey:"options",validators:[],messages:{}},type:{fieldLabel:"FORMAT",value:"xls",validators:[],messages:{}},contentType:{fieldLabel:"CONTENT_TYPE",value:"",dataKey:"options",validators:[],messages:{}}}}onBeforeInit(){this.model&&!this.model.options&&(this.model.options={}),this.model&&!this.model.fieldsOptions&&(this.model.fieldsOptions=[]),this.baseUrl=this.appSettings.settings.webApiUrl}onAfterInit(){this.getContentTypesList()}getContentTypesList(){this.contentTypes$=this.contentTypeService.getListPage().pipe((0,A.U)(({items:t})=>t))}getContentType(t){t||(t=this.model.options.contentType),t?(this.loading=!0,this.contentTypeService.getItemByName(t).subscribe(t=>{this.contentType=t,this.loading=!1},t=>{t.error&&(this.errorMessage=t.error),this.contentType=null,this.loading=!1})):this.contentType=null}updateFieldOptions(){if(!this.contentType)return;const t=(0,d.cloneDeep)(this.model.fieldsOptions);this.model.fieldsOptions=[],this.contentType.fields.forEach(e=>{const i=(0,d.findIndex)(t,{sourceName:e.name}),o=i>-1?t[i]:{};this.model.fieldsOptions.push({sourceTitle:o.sourceTitle||e.title,sourceName:o.sourceName||e.name,targetName:o.targetName||"",targetTitle:o.targetTitle||"",targetAction:o.targetAction||""})})}getFieldsColumnClass(t){let e=["col-6 pe-2","col-4 pe-2"],i="col-12";return[["field"],[]].forEach((o,n)=>{o.indexOf(t.targetAction)>-1&&(i=e[n])}),i}onChangeFieldAction(t,e,i){switch(t.targetName="",t.targetTitle="",t.separator="",t.options=[],i){case"delete":this.model.fieldsOptions.splice(e,1);break;case"category":t.targetTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f";break;case"categories_splitted":t.targetTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"}}onChangeFieldName(t,e){if("_id"===e)t.targetTitle="ID";else{const i=(0,d.findIndex)(this.contentType.fields,{name:e});t.targetTitle=this.contentType.fields[i].title}}fieldOptionsAdd(t){t&&t.preventDefault(),this.model.fieldsOptions.push({targetAction:"category",targetTitle:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"})}startExport(t){if(t&&t.preventDefault(),this.loading)return;this.errorMessage="",this.loading=!0,this.percent=0;let e=0,i="",o={};this.dataService.exportDataProgress(this.model).subscribe({next:t=>{if(t instanceof u.Zn)this.updatePercent(100);else if(!(t instanceof u.ZM)&&t.type===u.dt.DownloadProgress){i=t.partialText.substr(e).trim();const n=i.split("\n");i=n[n.length-1],e=t.partialText.length,"{"===i.substr(0,1)&&"}"===i.substr(i.length-1,1)&&(o=JSON.parse(i),this.updatePercent((o.currentIndex-o.rowNumberFirst)/(o.rowNumberLast-o.rowNumberFirst)*100))}},error:t=>{t.error&&t.error.indexOf("{")>-1&&(t.error=JSON.parse(t.error),t.error=t.error.error||this.getLangString("ERROR")),t.error&&(this.errorMessage=t.error),this.loading=!1,this.showProgressBar=!1}})}updatePercent(t){this.percent=Math.min(100,Math.floor(t)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout(()=>{this.showProgressBar=!1,this.loading=!1,this.getModelData()},1e3)}}return t.\u0275fac=function(e){return new(e||t)(Z.Y36(T.qu),Z.Y36(Zt),Z.Y36(l.U),Z.Y36(N.Kz),Z.Y36(N.xI),Z.Y36(S.sK),Z.Y36(Z.SBq),Z.Y36(N.FF),Z.Y36(r.g),Z.Y36(M.s),Z.Y36(x.d))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-modal-export"]],inputs:{model:"model"},features:[Z._Bn([Zt]),Z.qOj],decls:116,vars:79,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5",3,"title"],[1,"modal-body","py-0"],[3,"formGroup"],["formElement","ngForm"],[1,"row"],[1,"col-md-6"],[1,"mb-2","mb-2-message"],["for","fieldTitle",1,"label-filled"],["type","text","id","fieldTitle","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"mb-2"],[1,"label-filled"],["name","parentId","formControlName","parentId",3,"ngModel","ngModelChange"],["for","fieldType",1,"label-filled"],["id","fieldType","name","type","formControlName","type",1,"form-select",3,"ngModel","ngModelChange"],["value","xls"],["value","xlsx"],["value","csv"],["for","fieldContentType",1,"label-filled"],["id","fieldContentType","name","contentType","formControlName","contentType",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","fieldCategoryType",1,"label-filled"],["id","fieldCategoryType",1,"form-select",3,"ngModel","ngModelChange"],["value","column"],["value","row"],["for","fieldCategoriesSeparator",1,"label-filled"],["type","text","id","fieldCategoriesSeparator",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"float-end"],["type","button",1,"btn","btn-primary","btn-wide",3,"disabled","click"],[1,"p-0"],[1,"max-height400"],[1,"table","border-top-0","my-0","bg-light"],[4,"ngFor","ngForOf"],[1,"text-center","py-2"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"disabled","click"],[1,"alert","alert-danger"],[3,"value"],["for","fieldCSVSeparator",1,"label-filled"],["type","text","id","fieldCSVSeparator","name","csvSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEncoding",1,"label-filled"],["type","text","id","fieldCSVEncoding","name","csvEncoding",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEnclosure",1,"label-filled"],["type","text","id","fieldCSVEnclosure","name","csvEnclosure",1,"form-control",3,"ngModel","ngModelChange"],["target","_blank",1,"btn","btn-success",3,"href"],[1,"icon-download"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","no-gutters"],[3,"ngClass"],[1,"form-select",3,"ngModel","ngModelChange"],["value","category"],["value","categories_splitted"],["value","field"],["value","translations"],["value","delete"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-6","ps-2"],["value","_id"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"app-progress",2,"width","400px","position","absolute","left","50%","top","50%","margin-left","-200px","margin-top","50px","z-index","2222"],["type","success","height","1.4rem",3,"value","animated","striped"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z.TgZ(1,"div",1),Z.TgZ(2,"button",2),Z.NdJ("click",function(t){return e.closeModal(t)}),Z._UZ(3,"i",3),Z.TgZ(4,"span"),Z._uU(5),Z.ALo(6,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(7,"button",2),Z.NdJ("click",function(t){return e.minimize(t)}),Z._UZ(8,"i",4),Z.TgZ(9,"span"),Z._uU(10),Z.ALo(11,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(12,"div",5),Z.TgZ(13,"div",6),Z.TgZ(14,"div",7),Z.TgZ(15,"button",8),Z.NdJ("click",function(t){return e.maximize(t)}),Z.ALo(16,"translate"),Z._UZ(17,"i",9),Z.qZA(),Z.TgZ(18,"button",10),Z.NdJ("click",function(t){return e.closeModal(t)}),Z.ALo(19,"translate"),Z._UZ(20,"i",11),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(21,"h4",12),Z._uU(22),Z.qZA(),Z.qZA(),Z.TgZ(23,"div",13),Z.TgZ(24,"form",14,15),Z.TgZ(26,"div",16),Z.TgZ(27,"div",17),Z.TgZ(28,"div",18),Z.TgZ(29,"label",19),Z._uU(30),Z.ALo(31,"translate"),Z.qZA(),Z.TgZ(32,"input",20),Z.NdJ("ngModelChange",function(t){return e.model.title=t}),Z.qZA(),Z.YNc(33,ft,2,1,"div",21),Z.qZA(),Z.qZA(),Z.TgZ(34,"div",17),Z.TgZ(35,"div",22),Z.TgZ(36,"label",23),Z._uU(37),Z.ALo(38,"translate"),Z.qZA(),Z.TgZ(39,"app-select-parent-dropdown",24),Z.NdJ("ngModelChange",function(t){return e.model.options.parentId=t}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(40,"div",16),Z.TgZ(41,"div",17),Z.TgZ(42,"div",22),Z.TgZ(43,"label",25),Z._uU(44),Z.ALo(45,"translate"),Z.qZA(),Z.TgZ(46,"select",26),Z.NdJ("ngModelChange",function(t){return e.model.type=t}),Z.TgZ(47,"option",27),Z._uU(48,"XLS"),Z.qZA(),Z.TgZ(49,"option",28),Z._uU(50,"XLSX"),Z.qZA(),Z.TgZ(51,"option",29),Z._uU(52,"CSV"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(53,"div",17),Z.TgZ(54,"div",22),Z.TgZ(55,"label",30),Z._uU(56),Z.ALo(57,"translate"),Z.qZA(),Z.TgZ(58,"select",31),Z.NdJ("ngModelChange",function(t){return e.model.options.contentType=t})("ngModelChange",function(t){return e.getContentType(t)}),Z._UZ(59,"option",32),Z.YNc(60,Tt,2,2,"option",33),Z.ALo(61,"async"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(62,"div",16),Z.TgZ(63,"div",17),Z.TgZ(64,"div",22),Z.TgZ(65,"label",34),Z._uU(66),Z.ALo(67,"translate"),Z.qZA(),Z.TgZ(68,"select",35),Z.NdJ("ngModelChange",function(t){return e.model.options.categoryType=t}),Z.TgZ(69,"option",36),Z._uU(70),Z.ALo(71,"translate"),Z.qZA(),Z.TgZ(72,"option",37),Z._uU(73),Z.ALo(74,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(75,"div",17),Z.TgZ(76,"div",22),Z.TgZ(77,"label",38),Z._uU(78),Z.ALo(79,"translate"),Z.qZA(),Z.TgZ(80,"input",39),Z.NdJ("ngModelChange",function(t){return e.model.options.categoriesSeparator=t}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(81,At,21,12,"ng-container",40),Z.TgZ(82,"div",41),Z.TgZ(83,"div",42),Z.TgZ(84,"div",43),Z.TgZ(85,"button",44),Z.NdJ("click",function(t){return e.startExport(t)}),Z._uU(86),Z.ALo(87,"translate"),Z.qZA(),Z.qZA(),Z.YNc(88,bt,5,5,"ng-container",40),Z.qZA(),Z.TgZ(89,"div",45),Z.TgZ(90,"div",46),Z.TgZ(91,"table",47),Z.YNc(92,Mt,27,20,"ng-container",48),Z.TgZ(93,"tr"),Z.TgZ(94,"td",49),Z.TgZ(95,"button",50),Z.NdJ("click",function(t){return e.fieldOptionsAdd(t)}),Z._uU(96),Z.ALo(97,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(98,Ct,3,1,"div",51),Z.YNc(99,St,4,4,"ng-container",40),Z.qZA(),Z.TgZ(100,"div",52),Z.TgZ(101,"div",53),Z.TgZ(102,"button",54),Z.NdJ("click",function(t){return e.save(!0,t)}),Z.TgZ(103,"span"),Z._uU(104),Z.ALo(105,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(106,"div",55),Z._UZ(107,"button",56),Z.TgZ(108,"div",57),Z.TgZ(109,"button",58),Z.NdJ("click",function(t){return e.save(!1,t)}),Z._uU(110),Z.ALo(111,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(112,"button",59),Z.NdJ("click",function(t){return e.closeModal(t)}),Z.TgZ(113,"span"),Z._uU(114),Z.ALo(115,"translate"),Z.qZA(),Z.qZA(),Z.qZA()),2&t&&(Z.xp6(2),Z.Q6J("disabled",e.submitted),Z.xp6(3),Z.Oqu(Z.lcZ(6,43,"CLOSE")),Z.xp6(2),Z.Q6J("disabled",e.submitted),Z.xp6(3),Z.Oqu(Z.lcZ(11,45,"MINIMIZE")),Z.xp6(5),Z.Q6J("title",Z.lcZ(16,47,"EXPAND")),Z.xp6(3),Z.Q6J("title",Z.lcZ(19,49,"CLOSE")),Z.xp6(3),Z.Q6J("title",e.modalTitle),Z.xp6(1),Z.Oqu(e.modalTitle),Z.xp6(1),Z.ekj("loading",e.loading),Z.xp6(1),Z.Q6J("formGroup",e.form),Z.xp6(6),Z.Oqu(Z.lcZ(31,51,"TITLE")),Z.xp6(2),Z.ekj("is-invalid",e.formErrors.title),Z.Q6J("ngModel",e.model.title),Z.xp6(1),Z.Q6J("ngIf",e.formErrors.title),Z.xp6(4),Z.Oqu(Z.lcZ(38,53,"PARENT_FOLDER")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.parentId),Z.xp6(5),Z.Oqu(Z.lcZ(45,55,"FORMAT")),Z.xp6(2),Z.Q6J("ngModel",e.model.type),Z.xp6(10),Z.Oqu(Z.lcZ(57,57,"CONTENT_TYPE")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.contentType),Z.xp6(2),Z.Q6J("ngForOf",Z.lcZ(61,59,e.contentTypes$)),Z.xp6(6),Z.Oqu(Z.lcZ(67,61,"SAVE_CATEGORIES_TYPE")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.categoryType),Z.xp6(2),Z.Oqu(Z.lcZ(71,63,"COLUMNS")),Z.xp6(3),Z.Oqu(Z.lcZ(74,65,"ROWS")),Z.xp6(5),Z.Oqu(Z.lcZ(79,67,"SEPARATOR_CATEGORIES")),Z.xp6(2),Z.Q6J("ngModel",e.model.options.categoriesSeparator),Z.xp6(1),Z.Q6J("ngIf","csv"==e.model.type),Z.xp6(4),Z.Q6J("disabled",0==e.model.fieldsOptions.length),Z.xp6(1),Z.hij(" ",Z.lcZ(87,69,"EXPORT")," "),Z.xp6(2),Z.Q6J("ngIf",e.model.fileData),Z.xp6(4),Z.Q6J("ngForOf",e.model.fieldsOptions),Z.xp6(4),Z.hij(" ",Z.lcZ(97,71,"ADD")," "),Z.xp6(2),Z.Q6J("ngIf",e.errorMessage),Z.xp6(1),Z.Q6J("ngIf",e.showProgressBar),Z.xp6(3),Z.Q6J("disabled",e.submitted&&e.form.valid),Z.xp6(2),Z.Oqu(Z.lcZ(105,73,"SAVE_AND_CLOSE")),Z.xp6(3),Z.Q6J("disabled",e.submitted&&e.form.valid),Z.xp6(3),Z.Oqu(Z.lcZ(111,75,"SAVE")),Z.xp6(2),Z.Q6J("disabled",e.submitted||e.loading),Z.xp6(2),Z.Oqu(Z.lcZ(115,77,"CLOSE")))},directives:[T._Y,T.JL,T.sg,T.Fj,T.JJ,T.u,o.O5,E.F,T.EJ,T.YN,T.Kr,o.sg,T.On,N.jt,N.iD,N.Vi,N.TH,o.mk,o.RF,o.n9,N.Ly],pipes:[S.X$,o.Ov],encapsulation:2}),t})(),Et=(()=>{class t extends p.U{constructor(t,e,i,o,n){super(t,e,i,o),this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=o,this.messageService=n,this.queryOptions=new g.J("id","desc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"fileSize",sortName:"fileSize",title:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{name:"type",sortName:"type",title:"FILE_TYPE",outputType:"text",outputProperties:{}}]}getModalContent(){return yt}getModalElementId(t){return["modal","import-config",t||0].join("-")}setModalInputs(t,e=!1,i=""){super.setModalInputs(t,e,i),this.modalRef.componentInstance.modalTitle=void 0===t||e?this.getLangString("ADD_EXPORT_CONFIGURATION"):`${this.getLangString("EDIT_EXPORT_CONFIGURATION")} #${t}`}}return t.title="IMPORT_EXPORT",t.\u0275fac=function(e){return new(e||t)(Z.Y36(Zt),Z.Y36(N.Kz),Z.Y36(N.FF),Z.Y36(S.sK),Z.Y36(c.ez))},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-export"]],features:[Z._Bn([Zt,c.ez]),Z.qOj],decls:22,vars:15,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""],["key","message","position","bottom-right"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z._UZ(1,"div",1),Z.TgZ(2,"div",2),Z.TgZ(3,"div",3),Z.TgZ(4,"button",4),Z.TgZ(5,"span"),Z._uU(6),Z.ALo(7,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(8,"div",5),Z.TgZ(9,"button",6),Z.NdJ("click",function(){return e.deleteSelected()}),Z._uU(10),Z.ALo(11,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(12,"button",7),Z.NdJ("click",function(){return e.modalOpen()}),Z._UZ(13,"i",8),Z._uU(14," \xa0 "),Z.TgZ(15,"span"),Z._uU(16),Z.ALo(17,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z._UZ(18,"div",9),Z.qZA(),Z.TgZ(19,"app-table",10,11),Z.NdJ("selectedIdsChange",function(t){return e.selectedIds=t})("loadingChange",function(t){return e.loading=t})("actionRequest",function(t){return e.actionRequest(t)}),Z.qZA(),Z._UZ(21,"p-toast",12)),2&t&&(Z.xp6(6),Z.Oqu(Z.lcZ(7,9,"BATCH_ACTIONS")),Z.xp6(4),Z.Oqu(Z.lcZ(11,11,"DELETE")),Z.xp6(6),Z.Oqu(Z.lcZ(17,13,"ADD")),Z.xp6(3),Z.Q6J("items",e.items)("selectedIds",e.selectedIds)("collectionSize",e.collectionSize)("queryOptions",e.queryOptions)("tableFields",e.tableFields)("loading",e.loading))},directives:[N.jt,N.iD,N.Vi,gt.a,ut.FN],pipes:[S.X$],styles:[""]}),t})();const Ot=function(){return["/import-export/export"]},_t=function(){return["/import-export/import"]},wt=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.title="IMPORT_EXPORT",t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Z.Xpm({type:t,selectors:[["app-import-export"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ms-md-2",3,"routerLink"],[1,"icon-outbox"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-inbox"],[1,"card"],[1,"card-body"],[1,"float-md-start","mt-4","mt-md-0"],[1,"clearfix"],[1,"min-height400"]],template:function(t,e){1&t&&(Z.TgZ(0,"div",0),Z.TgZ(1,"div",1),Z.TgZ(2,"a",2),Z._UZ(3,"i",3),Z._uU(4," \xa0 "),Z.TgZ(5,"span"),Z._uU(6),Z.ALo(7,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(8,"a",4),Z._UZ(9,"i",5),Z._uU(10," \xa0 "),Z.TgZ(11,"span"),Z._uU(12),Z.ALo(13,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(14,"div",6),Z.TgZ(15,"div",7),Z.TgZ(16,"div",8),Z.TgZ(17,"h3"),Z._UZ(18,"i",3),Z._uU(19," \xa0 "),Z.TgZ(20,"span"),Z._uU(21),Z.ALo(22,"translate"),Z.qZA(),Z.qZA(),Z.qZA(),Z._UZ(23,"div",9),Z._UZ(24,"hr"),Z.TgZ(25,"div",10),Z._UZ(26,"router-outlet"),Z.qZA(),Z.qZA(),Z.qZA()),2&t&&(Z.xp6(2),Z.Q6J("routerLink",Z.DdM(11,Ot)),Z.xp6(4),Z.Oqu(Z.lcZ(7,5,"EXPORT")),Z.xp6(2),Z.Q6J("routerLink",Z.DdM(12,_t)),Z.xp6(4),Z.Oqu(Z.lcZ(13,7,"IMPORT")),Z.xp6(9),Z.Oqu(Z.lcZ(22,9,"IMPORT_EXPORT")))},directives:[a.yS,a.Od,a.lC],pipes:[S.X$],encapsulation:2}),t})(),children:[{path:"",redirectTo:"import"},{path:"import",component:ht},{path:"export",component:Et}]}];let It=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Z.oAB({type:t}),t.\u0275inj=Z.cJS({imports:[[a.Bz.forChild(wt)],a.Bz]}),t})(),Lt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Z.oAB({type:t}),t.\u0275inj=Z.cJS({providers:[r.g,l.U,f,Zt,s.G],imports:[[o.ez,n.m,It]]}),t})()},39343:function(t,e,i){i.d(e,{D:function(){return g}});var o=i(3679),n=i(79765),s=i(46782),r=i(63124),l=i(6887),a=i(12946),d=i(37716),c=i(95047),p=i(29790);let g=(()=>{class t{constructor(t,e,i,o,s,r,l){this.fb=t,this.dataService=e,this.systemNameService=i,this.activeModal=o,this.tooltipConfig=s,this.translateService=r,this.elRef=l,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new n.xQ,s.placement="bottom",s.container="body",s.triggers="hover click"}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){}getSystemFieldName(){return"name"}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang][t]||t}getModelData(){return this.loading=!0,new Promise((t,e)=>{this.dataService.getItem(this.itemId).pipe((0,s.R)(this.destroyed$)).subscribe({next:e=>{this.isItemCopy&&(e.id=null,e[this.getSystemFieldName()]=""),this.model=e,this.loading=!1,t(e)},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loading=!1,e(t)}})})}buildForm(){const t=this.buildControls(this.formFields);this.form=this.fb.group(t),this.form.valueChanges.pipe((0,s.R)(this.destroyed$)).subscribe({next:t=>this.onValueChanged("form","",t)})}buildControls(t,e="model",i=""){const n={};for(const s in t){if(!t.hasOwnProperty(s))continue;const r=t[s],l=r.dataKey?this[e][r.dataKey]:this[e];l[s]||(l[s]=r.value),n[s]=new o.NI({value:l[s]||"",disabled:r.disabled||!1},r.validators),this.formErrors[i+s]="",this.translateValidationMessages(i,s,r)}return n}translateValidationMessages(t,e,i){const n={};!i.fieldLabel||(Object.keys(i.messages).forEach(t=>{"required"!==t&&this.translateService.get(String(i.messages[t])).subscribe(e=>{n[t]=e})}),i.validators.indexOf(o.kI.required)>-1&&this.translateService.get(i.fieldLabel).subscribe(t=>{this.translateService.get("FIELD_REQUIRED",{name:t}).subscribe(t=>{n.required=t})}),this.validationMessages[t+e]=n)}getControl(t){return this.form.controls.name}onValueChanged(t,e="",i){if(!this[t])return;const o=this[t].value;for(const n in o){if(!o.hasOwnProperty(n))continue;this.formErrors[e+n]="";const i=this[t].get(n);if(i&&(i.dirty||this[e+"submitted"])&&!i.valid)for(const t in i.errors)this.formErrors[e+n]+=this.validationMessages[e+n][t]?this.validationMessages[e+n][t]+" ":this.getLangString("ERROR")+" "}}displayToggle(t,e){t.style.display=(e=e||"none"===t.style.display)?"block":"none"}toggleAccordion(t,e,i){t.activeIds.indexOf(e)>-1&&i||t.toggle(e)}generateName(t){t.name=this.systemNameService.generateName(t.title||"")}closeModal(t){t&&t.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}close(t){t&&t.preventDefault(),this.activeModal.dismiss(this.closeReason)}minimize(t){t&&t.preventDefault(),window.document.body.classList.remove("modal-open");const e=this.getRootElement(),i=e.previousElementSibling;e.classList.remove("d-block"),e.classList.add("modal-minimized"),i.classList.add("d-none")}maximize(t){t&&t.preventDefault(),window.document.body.classList.add("modal-open");const e=this.getRootElement(),i=e.previousElementSibling;e.classList.add("d-block"),e.classList.remove("modal-minimized"),i.classList.remove("d-none")}getFormData(){const t={};return Object.keys(this.model).forEach(e=>{t[e]=this.files[e]?Array.isArray(this.model[e])?[a.O.getFileData(this.files[e])]:a.O.getFileData(this.files[e]):this.model[e]}),t}fileChange(t,e,i=!1){const o=t.target.files;o.length>0&&(this.model[e]=i?[a.O.getFileData(o[0])]:a.O.getFileData(o[0]),this.files[e]=o[0],this.form.controls[e].setValue(this.files[e].name))}fileClear(t,e){this.model[t]=null,this.form.controls[t].reset(null),e.files=null,e.value="",delete this.files[t]}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(t=>{this.model[t]=this.localePreviousValues[t]}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(t=>{this.localePreviousValues[t]=this.model[t]||"",this.model[t]=this.model.translations[t]&&this.model.translations[t][this.localeCurrent]||""})}saveTranslations(t){t&&t.preventDefault(),this.localeFieldsAllowed.forEach(t=>{this.model[t]?(this.model.translations[t]||(this.model.translations[t]={}),this.model.translations[t][this.localeCurrent]=this.model[t]):this.model.translations[t]&&(this.model.translations[t][this.localeCurrent]&&delete this.model.translations[t][this.localeCurrent],0===Object.keys(this.model.translations[t]).length&&delete this.model.translations[t])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}onSubmit(){this.submitted=!0,this.closeModal()}appendFormData(t){}saveFiles(t){if(0===Object.keys(this.files).length)return void this.closeModal();const e=new FormData;for(const i in this.files)this.files.hasOwnProperty(i)&&this.files[i]instanceof File&&e.append(i,this.files[i],this.files[i].name);e.append("itemId",String(t)),this.appendFormData(e),this.dataService.postFormData(e).pipe((0,s.R)(this.destroyed$)).subscribe({next:()=>{this.closeModal()},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}save(t=!1,e){if(e&&e.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe((0,s.R)(this.destroyed$)).subscribe({next:e=>{Object.keys(this.files).length>0?this.saveFiles(e._id||e.id):(t?this.closeModal():e&&e.id&&(this.model=e,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loading=!1,this.submitted=!1}})}emailValidator(t){return t.value?/\S+@\S+\.\S+/.test(t.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(o.qu),d.Y36(l.D),d.Y36(r.U),d.Y36(c.Kz),d.Y36(c.xI),d.Y36(p.sK),d.Y36(d.SBq))},t.\u0275cmp=d.Xpm({type:t,selectors:[["ng-component"]],inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})()},3677:function(t,e,i){i.d(e,{U:function(){return g}});var o=i(79765),n=i(46782),s=i(35930),r=i(6887),l=i(90660),a=i(37716),d=i(95047),c=i(29790);const p=["table"];let g=(()=>{class t{constructor(t,e,i,n){this.dataService=t,this.activeModal=e,this.modalService=i,this.translateService=n,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new s.J("name","asc",1,10,0,0),this.destroyed$=new o.xQ}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(t){}onSearchWordUpdate(t){if(void 0!==t)return this.queryOptions.search_word=t,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(t){return["modal",t||0].join("-")}setModalInputs(t,e=!1,i=""){const o=void 0!==t&&!e;this.modalRef.componentInstance.modalTitle=this.getLangString(o?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=i,this.modalRef.componentInstance.itemId=t||0,this.modalRef.componentInstance.isItemCopy=e||!1,this.modalRef.componentInstance.isEditMode=o}modalOpen(t,e=!1){const i=this.getModalElementId(t);if(window.document.body.classList.add("modal-open"),window.document.getElementById(i)){const t=window.document.getElementById(i),e=t.previousElementSibling;return t.classList.add("d-block"),t.classList.remove("modal-minimized"),void e.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(t,e,i),this.modalRef.result.then(t=>{this.destroyed$.isStopped||(this.onModalClose(t),this.getList())},t=>{this.destroyed$.isStopped||(this.onModalClose(t),t&&["submit","updated"].indexOf(t)>-1&&this.getList())})}deleteItemConfirm(t){this.modalRef=this.modalService.open(l.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(e=>{"accept"===e&&this.deleteItem(t)})}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][t]||t}confirmAction(t){return this.modalRef=this.modalService.open(l.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=t,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(t=>{"accept"===t&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(t){this.modalRef=this.modalService.open(l.$N),this.modalRef.componentInstance.modalContent=t,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(t){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(e=>{"accept"===e&&this.dataService.deleteItem(t).subscribe(t=>{this.getList()},t=>{t.error&&this.showAlert(t.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(t){switch(t[0]){case"edit":this.modalOpen(t[1]);break;case"copy":this.modalOpen(t[1],!0);break;case"delete":this.deleteItem(t[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe((0,n.R)(this.destroyed$)).subscribe({next:t=>{this.items=t.items,this.collectionSize=t.total,this.loading=!1},error:t=>{this.items=[],this.collectionSize=0,t.error&&this.showAlert(t.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.title="",t.\u0275fac=function(e){return new(e||t)(a.Y36(r.D),a.Y36(d.Kz),a.Y36(d.FF),a.Y36(c.sK))},t.\u0275dir=a.lG2({type:t,viewQuery:function(t,e){if(1&t&&a.Gf(p,7),2&t){let t;a.iGM(t=a.CRH())&&(e.table=t.first)}}}),t})()},49103:function(t,e,i){i.d(e,{e:function(){return o}});class o{constructor(t,e,i,o,n){this.changed=t,this.loading=e,this.values=i,this.defaultOptions=o,this.defaultValues=n}}},99639:function(t,e,i){i.d(e,{g:function(){return a}});var o=i(91841),n=i(25917),s=i(5304),r=(i(49103),i(73844)),l=i(37716);let a=(()=>{class t{constructor(t){this.http=t,this.headers=new o.WM({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="",this.baseUrl="",this.requestUrl="/admin/settings",this.baseUrl=r.d.getBaseUrl()}setRequestUrl(t){this.requestUrl=t}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe((0,s.K)(this.handleError()))}clearSystemCache(){const t=this.getRequestUrl()+"/clear_system_cache";return this.http.post(t,{},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}runActionPost(t){const e=this.getRequestUrl()+`/${t}`;return this.http.post(e,{},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}updateGroup(t,e){const i=this.getRequestUrl()+`/${t}`;return this.http.put(i,e,{headers:this.headers}).pipe((0,s.K)(this.handleError()))}getComposerPackagesList(){return this.http.get(this.getRequestUrl()+"_composer_installed_packages").pipe((0,s.K)(this.handleError()))}composerRequirePackage(t,e){const i=this.getRequestUrl()+"_composer_require_package";return this.http.post(i,{packageName:t,packageVersion:e},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}postFormData(t,e){const i=new o.WM({enctype:"multipart/form-data",Accept:"application/json","X-Requested-With":"XMLHttpRequest"});return this.http.post(this.baseUrl+e,t,{headers:i}).pipe((0,s.K)(this.handleError()))}runAction(t){return this.http.post(this.baseUrl+t,{},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}handleError(t="operation",e){return t=>{if(!(t.status&&[401,403].indexOf(t.status)>-1)){if(t.error)throw t.error;return(0,n.of)(e)}window.location.href=this.baseUrl+"/login"}}}return t.\u0275fac=function(e){return new(e||t)(l.LFG(o.eN))},t.\u0275prov=l.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);