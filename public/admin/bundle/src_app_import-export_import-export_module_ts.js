"use strict";(self.webpackChunkshk_app=self.webpackChunkshk_app||[]).push([["src_app_import-export_import-export_module_ts"],{1504:(L,E,d)=>{d.d(E,{s:()=>b});var u=d(2047),S=d(1599),M=d(3668),q=d(4522);let b=(()=>{class m extends S.D{constructor(f){super(f),this.setRequestUrl("/admin/content_types")}getItemByName(f){const I=this.getRequestUrl()+`/by_name/${f}`;return this.http.get(I).pipe((0,u.K)(this.handleError()))}getItemByCategory(f){const I=this.getRequestUrl()+`/by_category/${f}`;return this.http.get(I).pipe((0,u.K)(this.handleError()))}}return m.\u0275fac=function(f){return new(f||m)(M.LFG(q.eN))},m.\u0275prov=M.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},1998:(L,E,d)=>{d.r(E),d.d(E,{ImportExportModule:()=>Gt});var u=d(6019),S=d(7367),M=d(3196),q=d(1562),b=d(103),m=d(8922),Z=d(3132),f=d(481),I=d(5243),T=d(417),g=d(4522),A=d(2047),r=d(1599),t=d(3668);let p=(()=>{class o extends r.D{constructor(e){super(e),this.setRequestUrl("import")}getSheetProperties(e){const n=this.getRequestUrl()+`/${e.id}/properties`;return this.http.post(n,e,{headers:this.headers}).pipe((0,A.K)(this.handleError()))}getFieldsOptions(e,n){const s=this.getRequestUrl()+`/${e}/fields_options`;let i=this.createHttpParams(n);return this.http.get(s,{params:i,headers:this.headers}).pipe((0,A.K)(this.handleError()))}splitFileAction(e){const n=this.getRequestUrl()+`/${e}/split_file`;return this.http.post(n,{},{headers:this.headers}).pipe((0,A.K)(this.handleError()))}testData(e){const n=this.getRequestUrl()+`/${e.id}/do_import_test`;return this.http.post(n,e,{headers:this.headers}).pipe((0,A.K)(this.handleError()))}importData(e){const n=this.getRequestUrl()+`/${e.id}/do_import`;return this.http.post(n,e,{headers:this.headers}).pipe((0,A.K)(this.handleError()))}importDataProgress(e){const n=this.getRequestUrl()+`/${e.id}/do_import`;return this.http.request(new g.aW("POST",n,e,{reportProgress:!0,responseType:"text",headers:this.headers}))}getPercent(e){const n=this.getRequestUrl()+`/${e.id}/percent`;return this.http.get(n,{headers:this.headers}).pipe((0,A.K)(this.handleError()))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(g.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();var c=d(9133),_=d(8053),x=d(6726);class O{constructor(a,e,n,s,i,l,C,v,y,w){this.id=a,this.title=e,this.fileData=n,this.type=s,this.fileSize=i,this.rowsQuantity=l,this.sheetsQuantity=C,this.sheetsNames=v,this.options=y,this.fieldsOptions=w,void 0===this.options&&O.setOptiontDefaults(this)}static setOptiontDefaults(a){a.options||(a.options={}),a.options=Object.assign({parentId:0,rowNumberHeaders:1,rowNumberFirst:2,rowNumberLast:0,stepsNumber:1,step:1,categoriesSeparator:"",sheetName:"",contentType:"",articulFieldName:"",aliasAdditionalFieldName:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"',skipFound:!1,filesDownload:!1},a.options)}}var J=d(6721),j=d(3029),Q=d(1504),$=d(9985),h=d(7283),N=d(8319),H=d(3961),P=d(60);function K(o,a){if(1&o&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.title," ")}}function z(o,a){if(1&o&&(t.TgZ(0,"div",48),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.fileData," ")}}function W(o,a){if(1&o&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.rowNumberHeaders," ")}}function V(o,a){if(1&o&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.rowNumberFirst," ")}}function G(o,a){if(1&o&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.rowNumberLast," ")}}function X(o,a){if(1&o&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.categoriesSeparator," ")}}function tt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16),t.TgZ(2,"div",17),t.TgZ(3,"div",16),t.TgZ(4,"div",27),t.TgZ(5,"div",22),t.TgZ(6,"label",49),t.TgZ(7,"span",29),t.ALo(8,"translate"),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.qZA(),t.TgZ(11,"input",50),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.csvSeparator=s}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",27),t.TgZ(13,"div",22),t.TgZ(14,"label",51),t.TgZ(15,"span",29),t.ALo(16,"translate"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.qZA(),t.TgZ(19,"input",52),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.csvEnclosure=s}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",17),t.TgZ(21,"div",22),t.TgZ(22,"label",53),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"input",54),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.csvEncoding=s}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(7),t.Q6J("title",t.lcZ(8,8,"CSV_SEPARATOR")),t.xp6(2),t.Oqu(t.lcZ(10,10,"CSV_SEPARATOR")),t.xp6(2),t.Q6J("ngModel",e.model.options.csvSeparator),t.xp6(4),t.Q6J("title",t.lcZ(16,12,"CSV_ENCLOSURE")),t.xp6(2),t.Oqu(t.lcZ(18,14,"CSV_ENCLOSURE")),t.xp6(2),t.Q6J("ngModel",e.model.options.csvEnclosure),t.xp6(4),t.Oqu(t.lcZ(24,16,"CSV_ENCODING")),t.xp6(2),t.Q6J("ngModel",e.model.options.csvEncoding)}}function et(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function nt(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.Oqu(e.title)}}function ot(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.hij(" ",e.title," ")}}function it(o,a){if(1&o&&(t.ynx(0),t.YNc(1,ot,2,2,"option",58),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.contentType.fields)}}function st(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.hij(" ",e.title," ")}}function rt(o,a){if(1&o&&(t.ynx(0),t.YNc(1,st,2,2,"option",58),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.contentType.fields)}}function at(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const k=function(){return{standalone:!0}};function lt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",83),t.TgZ(1,"div",84),t.TgZ(2,"div",85),t.TgZ(3,"span",86),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.qZA(),t.TgZ(6,"select",87),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(3).model.options.step=s}),t.YNc(7,at,2,2,"option",58),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(3);t.xp6(4),t.hij(" ",t.lcZ(5,4,"STEP")," "),t.xp6(2),t.Q6J("ngModel",e.model.options.step)("ngModelOptions",t.DdM(6,k)),t.xp6(1),t.Q6J("ngForOf",e.steps)}}function dt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",99),t.TgZ(2,"input",100),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().$implicit.targetName=s}),t.ALo(3,"translate"),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngbTooltip",t.lcZ(3,2,"SYSTEM_NAME"))("ngModel",e.targetName)}}function pt(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.hij(" ",e.title," ")}}function ct(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"select",61),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(2).$implicit.targetName=s}),t.YNc(2,pt,2,2,"option",58),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2).$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.targetName),t.xp6(1),t.Q6J("ngForOf",n.contentType.fields)}}function gt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",99),t.YNc(2,ct,3,2,"ng-container",37),t.qZA(),t.BQk()),2&o){const e=t.oxw(4);t.xp6(2),t.Q6J("ngIf",e.contentType)}}function _t(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",99),t.TgZ(2,"input",100),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().$implicit.separator=s}),t.ALo(3,"translate"),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngbTooltip",t.lcZ(3,2,"SEPARATOR"))("ngModel",e.separator)}}function mt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",107),t.TgZ(2,"input",100),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().$implicit.targetTitle=s}),t.ALo(3,"translate"),t.qZA(),t.qZA(),t.TgZ(4,"div",108),t.TgZ(5,"input",100),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().$implicit.targetName=s}),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngbTooltip",t.lcZ(3,4,"FIELD_NAME"))("ngModel",e.targetTitle),t.xp6(3),t.Q6J("ngbTooltip",t.lcZ(6,6,"SYSTEM_NAME"))("ngModel",e.targetName)}}function ut(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",107),t.TgZ(1,"input",100),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(2).$implicit.targetTitle=s}),t.ALo(2,"translate"),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngbTooltip",t.lcZ(2,2,"FIELD_NAME"))("ngModel",e.targetTitle)}}function ht(o,a){if(1&o&&(t.TgZ(0,"option",70),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.hij(" ",e.title," ")}}function ft(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"select",61),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(2).$implicit.targetName=s}),t.YNc(2,ht,2,2,"option",58),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2).$implicit,n=t.oxw(5);t.xp6(1),t.Q6J("ngModel",e.targetName),t.xp6(1),t.Q6J("ngForOf",n.contentType.fields)}}const Zt=function(o,a){return{"col-4":o,"col-6":a}};function Tt(o,a){if(1&o&&(t.ynx(0),t.YNc(1,ut,3,4,"div",109),t.TgZ(2,"div",110),t.YNc(3,ft,3,2,"ng-container",37),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit,n=t.oxw(5);t.xp6(1),t.Q6J("ngIf",n.getIsParametersField(e.targetName)),t.xp6(1),t.Q6J("ngClass",t.WLB(3,Zt,n.getIsParametersField(e.targetName),!n.getIsParametersField(e.targetName))),t.xp6(1),t.Q6J("ngIf",n.contentType)}}function Ct(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",105),t.TgZ(1,"div",91),t.TgZ(2,"select",61),t.NdJ("ngModelChange",function(s){return t.CHM(e).$implicit.targetAction=s})("ngModelChange",function(s){const l=t.CHM(e).$implicit,C=t.oxw(2).$implicit;return t.oxw(3).onChangeFieldAction(l,s,C)}),t.TgZ(3,"option",57),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"option",93),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"option",95),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"option",106),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.qZA(),t.qZA(),t.ynx(15,97),t.YNc(16,mt,7,8,"ng-container",98),t.YNc(17,Tt,4,6,"ng-container",98),t.BQk(),t.qZA()}if(2&o){const e=a.$implicit,n=t.oxw(5);t.xp6(1),t.Q6J("ngClass",n.getFieldsColumnClass(e,"field_sub")),t.xp6(1),t.Q6J("ngModel",e.targetAction),t.xp6(2),t.Oqu(t.lcZ(5,9,"NO_IMPORT")),t.xp6(3),t.Oqu(t.lcZ(8,11,"SELECT_FIELD")),t.xp6(3),t.Oqu(t.lcZ(11,13,"CREATE_FIELD")),t.xp6(3),t.hij("\xd7 ",t.lcZ(14,15,"DELETE"),""),t.xp6(2),t.Q6J("ngSwitch",e.targetAction),t.xp6(1),t.Q6J("ngSwitchCase","new"),t.xp6(1),t.Q6J("ngSwitchCase","field")}}function At(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16),t.TgZ(2,"div",101),t._UZ(3,"hr"),t.YNc(4,Ct,18,17,"div",102),t.TgZ(5,"div",103),t.TgZ(6,"button",104),t.NdJ("click",function(s){t.CHM(e);const i=t.oxw().$implicit;return t.oxw(3).fieldAddOptions(i,s)}),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.xp6(4),t.Q6J("ngForOf",e.options),t.xp6(3),t.hij(" ",t.lcZ(8,2,"ADD")," ")}}function Mt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td"),t.TgZ(3,"div",16),t.TgZ(4,"div",88),t._uU(5),t.qZA(),t.TgZ(6,"div",89),t.TgZ(7,"div",90),t.TgZ(8,"div",91),t.TgZ(9,"select",61),t.NdJ("ngModelChange",function(s){return t.CHM(e).$implicit.targetAction=s})("ngModelChange",function(s){const l=t.CHM(e).$implicit;return t.oxw(3).onChangeFieldAction(l,"field",s)}),t.TgZ(10,"option",57),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"option",92),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"option",93),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"option",94),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"option",95),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"option",96),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.qZA(),t.qZA(),t.ynx(28,97),t.YNc(29,dt,4,4,"ng-container",98),t.YNc(30,gt,3,1,"ng-container",98),t.YNc(31,_t,4,4,"ng-container",98),t.BQk(),t.qZA(),t.qZA(),t.qZA(),t.YNc(32,At,9,4,"ng-container",37),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=a.$implicit,n=t.oxw(3);t.xp6(5),t.hij(" ",e.sourceTitle," "),t.xp6(3),t.Q6J("ngClass",n.getFieldsColumnClass(e,"field")),t.xp6(1),t.Q6J("ngModel",e.targetAction),t.xp6(2),t.Oqu(t.lcZ(12,14,"NO_IMPORT")),t.xp6(3),t.Oqu(t.lcZ(15,16,"CATEGORY")),t.xp6(3),t.Oqu(t.lcZ(18,18,"SELECT_FIELD")),t.xp6(3),t.Oqu(t.lcZ(21,20,"TRANSLATIONS")),t.xp6(3),t.Oqu(t.lcZ(24,22,"CREATE_FIELD")),t.xp6(3),t.Oqu(t.lcZ(27,24,"SPLIT")),t.xp6(2),t.Q6J("ngSwitch",e.targetAction),t.xp6(1),t.Q6J("ngSwitchCase","new"),t.xp6(1),t.Q6J("ngSwitchCase","field"),t.xp6(1),t.Q6J("ngSwitchCase","split"),t.xp6(1),t.Q6J("ngIf","split"==e.targetAction)}}function xt(o,a){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.qZA()),2&o){const e=a.$implicit;t.xp6(2),t.hij(" ",e," ")}}function bt(o,a){if(1&o&&(t.TgZ(0,"table",124),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"tbody"),t.YNc(7,xt,3,1,"tr",82),t.qZA(),t.qZA()),2&o){const e=t.oxw(4);t.xp6(4),t.Oqu(t.lcZ(5,2,"CATEGORIES")),t.xp6(3),t.Q6J("ngForOf",e.testData.categories)}}function vt(o,a){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"json"),t.qZA(),t.qZA()),2&o){const e=a.$implicit;t.xp6(2),t.hij(" ",e.key," "),t.xp6(2),t.hij(" ",t.lcZ(5,2,e.value)," ")}}function Et(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",111),t.TgZ(2,"div",112),t.TgZ(3,"div",113),t.TgZ(4,"button",114),t.NdJ("click",function(s){return t.CHM(e),t.oxw(3).clearTestData(s)}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",16),t.TgZ(8,"div",115),t.YNc(9,bt,8,4,"table",116),t.TgZ(10,"table",117),t.TgZ(11,"colgroup"),t._UZ(12,"col",118),t.qZA(),t.TgZ(13,"tr"),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"td"),t._uU(18),t.qZA(),t.qZA(),t.TgZ(19,"tr"),t.TgZ(20,"td"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"td"),t._uU(24),t.qZA(),t.qZA(),t.TgZ(25,"tr"),t.TgZ(26,"td"),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"td"),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(32,"div",119),t.TgZ(33,"div",120),t.TgZ(34,"table",117),t.TgZ(35,"colgroup"),t._UZ(36,"col",121),t._UZ(37,"col",122),t.qZA(),t.TgZ(38,"thead"),t.TgZ(39,"tr"),t.TgZ(40,"th",123),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(43,"tbody"),t.YNc(44,vt,6,4,"tr",82),t.ALo(45,"keyvalue"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(3);t.xp6(5),t.hij(" ",t.lcZ(6,11,"CLOSE")," "),t.xp6(4),t.Q6J("ngIf",e.testData.categories.length),t.xp6(6),t.hij(" ",t.lcZ(16,13,"ROW_NUMBER")," "),t.xp6(3),t.hij(" ",e.testData.row_number_first," "),t.xp6(3),t.hij(" ",t.lcZ(22,15,"MEMORY_USED")," "),t.xp6(3),t.hij(" ",e.testData.memory_peak_usage," "),t.xp6(3),t.hij(" ",t.lcZ(28,17,"TIME_EXECUTION")," "),t.xp6(3),t.AsE(" ",e.testData.time_execution," ",t.lcZ(31,19,"TIME_EXECUTION_SEC")," "),t.xp6(11),t.Oqu(t.lcZ(42,21,"PRODUCT_DATA")),t.xp6(3),t.Q6J("ngForOf",t.lcZ(45,23,e.testData.data))}}function qt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",71),t.TgZ(1,"div",72),t.TgZ(2,"div",73),t.YNc(3,lt,8,7,"div",74),t.TgZ(4,"button",75),t.NdJ("click",function(s){return t.CHM(e),t.oxw(2).startImport(s)}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.TgZ(7,"button",76),t.NdJ("click",function(s){return t.CHM(e),t.oxw(2).updateData(s)}),t.ALo(8,"translate"),t._UZ(9,"i",77),t.qZA(),t.TgZ(10,"button",78),t.NdJ("click",function(s){return t.CHM(e),t.oxw(2).getTestData(s)}),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.qZA(),t.TgZ(13,"div",79),t.TgZ(14,"div",80),t.TgZ(15,"table",81),t.YNc(16,Mt,33,26,"ng-container",82),t.qZA(),t.qZA(),t.YNc(17,Et,46,25,"ng-container",37),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngIf",e.model.options.stepsNumber>1),t.xp6(2),t.hij(" ",t.lcZ(6,7,"START_IMPORT")," "),t.xp6(2),t.Q6J("ngbTooltip",t.lcZ(8,9,"REFRESH")),t.xp6(3),t.Q6J("disabled",e.testData),t.xp6(1),t.hij(" ",t.lcZ(12,11,"TEST")," "),t.xp6(5),t.Q6J("ngForOf",e.model.fieldsOptions),t.xp6(1),t.Q6J("ngIf",e.testData)}}function It(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div"),t._UZ(2,"hr"),t.TgZ(3,"div",16),t.TgZ(4,"div",17),t.TgZ(5,"div",22),t.TgZ(6,"label",55),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"select",56),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.sheetName=s})("ngModelChange",function(){return t.CHM(e),t.oxw().getSheetProperties()}),t._UZ(10,"option",57),t.YNc(11,et,2,2,"option",58),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",17),t.TgZ(13,"div",22),t.TgZ(14,"label",59),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"app-select-parent-dropdown",60),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.parentId=s}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",16),t.TgZ(19,"div",17),t.TgZ(20,"div",22),t.TgZ(21,"label",55),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"select",61),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.contentType=s})("ngModelChange",function(s){return t.CHM(e),t.oxw().getContentType(s)}),t._UZ(25,"option",57),t.YNc(26,nt,2,2,"option",58),t.ALo(27,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"div",17),t.TgZ(29,"div",22),t.TgZ(30,"label",62),t._uU(31),t.ALo(32,"translate"),t.qZA(),t.TgZ(33,"select",63),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.articulFieldName=s}),t._UZ(34,"option",57),t.YNc(35,it,2,1,"ng-container",37),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(36,"div",16),t.TgZ(37,"div",17),t.TgZ(38,"label",64),t.TgZ(39,"span",29),t.ALo(40,"translate"),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.qZA(),t.TgZ(43,"select",65),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.aliasAdditionalFieldName=s}),t._UZ(44,"option",57),t.YNc(45,rt,2,1,"ng-container",37),t.qZA(),t.qZA(),t.TgZ(46,"div",17),t.TgZ(47,"div",22),t.TgZ(48,"div",66),t.TgZ(49,"input",67),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.filesDownload=s}),t.qZA(),t.TgZ(50,"label",68),t._uU(51),t.ALo(52,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(53,"div",22),t.TgZ(54,"div",66),t.TgZ(55,"input",67),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.skipFound=s}),t.qZA(),t.TgZ(56,"label",68),t._uU(57),t.ALo(58,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(59,qt,18,13,"div",69),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(1),t.ekj("loading",e.loadingConfiguration),t.xp6(6),t.Oqu(t.lcZ(8,26,"SHEET")),t.xp6(2),t.Q6J("ngModel",e.model.options.sheetName),t.xp6(2),t.Q6J("ngForOf",e.model.sheetsNames),t.xp6(4),t.Oqu(t.lcZ(16,28,"PARENT_FOLDER")),t.xp6(2),t.Q6J("ngModel",e.model.options.parentId),t.xp6(5),t.Oqu(t.lcZ(23,30,"CONTENT_TYPE")),t.xp6(2),t.Q6J("ngModel",e.model.options.contentType),t.xp6(2),t.Q6J("ngForOf",t.lcZ(27,32,e.contentTypes$)),t.xp6(5),t.Oqu(t.lcZ(32,34,"SEARCH_FIELD")),t.xp6(2),t.Q6J("ngModel",e.model.options.articulFieldName),t.xp6(2),t.Q6J("ngIf",e.contentType),t.xp6(4),t.Q6J("title",t.lcZ(40,36,"ALIAS_ADDITIONAL_FIELD")),t.xp6(2),t.Oqu(t.lcZ(42,38,"ALIAS_ADDITIONAL_FIELD")),t.xp6(2),t.Q6J("ngModel",e.model.options.aliasAdditionalFieldName),t.xp6(2),t.Q6J("ngIf",e.contentType),t.xp6(4),t.MGl("id","fieldFilesDownload",e.uniqueId,""),t.Q6J("ngModel",e.model.options.filesDownload),t.xp6(1),t.MGl("for","fieldFilesDownload",e.uniqueId,""),t.xp6(1),t.Oqu(t.lcZ(52,40,"FILES_DOWNLOAD")),t.xp6(4),t.MGl("id","fieldSkipFound",e.uniqueId,""),t.Q6J("ngModel",e.model.options.skipFound),t.xp6(1),t.MGl("for","fieldSkipFound",e.uniqueId,""),t.xp6(1),t.Oqu(t.lcZ(58,42,"SKIP_FOUND")),t.xp6(2),t.Q6J("ngIf",e.model.options.sheetName)}}function Ot(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",125),t._uU(1),t.TgZ(2,"button",126),t.NdJ("click",function(){return t.CHM(e),t.oxw().errorMessage=""}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function yt(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij("",e.percent,"%")}}function St(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",127),t.TgZ(2,"ngb-progressbar",128),t.YNc(3,yt,2,1,"span",37),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("value",e.percent)("animated",!0)("striped",!0),t.xp6(1),t.Q6J("ngIf",e.percent>10)}}let Nt=(()=>{class o extends x.D{constructor(e,n,s,i,l,C,v,y,w,D,F,Xt){super(e,n,s,i,l,C,v),this.fb=e,this.dataService=n,this.systemNameService=s,this.activeModal=i,this.tooltipConfig=l,this.translateService=C,this.elRef=v,this.modalService=y,this.settingsService=w,this.contentTypeService=D,this.appSettings=F,this.messageService=Xt,this.model=new O(0,""),this.modalTitle="Import",this.loadingConfiguration=!1,this.isInitialised=!1,this.sheetHeaders=[],this.contentTypes=[],this.percent=0,this.showProgressBar=!1,this.steps=[1],this.formFields={title:{fieldLabel:"TITLE",value:"",validators:[c.kI.required],messages:{}},fileData:{fieldLabel:"FILE",value:"",validators:[c.kI.required],messages:{}},rowNumberHeaders:{fieldLabel:"ROW_NUMBER_HEADERS",value:1,dataKey:"options",validators:[],messages:{}},rowNumberFirst:{fieldLabel:"ROW_NUMBER_FIRST",value:2,dataKey:"options",validators:[],messages:{}},rowNumberLast:{fieldLabel:"ROW_NUMBER_LAST",value:3,dataKey:"options",validators:[],messages:{}},categoriesSeparator:{fieldLabel:"SEPARATOR_CATEGORIES",value:"",dataKey:"options",validators:[],messages:{}}},this.files={}}onBeforeInit(){this.model&&!this.model.options&&(this.model.options={})}onAfterInit(){this.itemId&&this.getContentTypesList()}onAfterGetData(){setTimeout(()=>{this.isInitialised=!0},1),this.model.options.contentType&&this.getContentType(),(!this.model.fieldsOptions||0===this.model.fieldsOptions.length)&&this.getSheetProperties(),this.updateStepsArr()}getFileName(e){return"string"==typeof e?e:j.q.getFileName(e)}onOptionChanged(){!this.isInitialised||(clearTimeout(this.timerConfiguration),this.timerConfiguration=setTimeout(this.getSheetProperties.bind(this),700))}getContentTypesList(){this.contentTypes$=this.contentTypeService.getListPage().pipe((0,_.U)(({items:e})=>e))}getContentType(e){e||(e=this.model.options.contentType),e?(this.loadingConfiguration=!0,this.contentTypeService.getItemByName(e).subscribe({next:n=>{this.contentType=n,this.loadingConfiguration=!1},error:n=>{n.error&&(this.errorMessage=n.error),this.contentType=null,this.loadingConfiguration=!1}})):this.contentType=null}onChangeFieldAction(e,n,s){if(e.targetName="",e.targetTitle="",e.separator="",e.options=[],"delete"===n&&s){const i=(0,Z.findIndex)(s.options,{targetAction:"delete"});i>-1&&s.options.splice(i,1)}}getSheetProperties(e){e&&e.preventDefault(),this.model.options.sheetName?(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.getSheetProperties(this.model).subscribe({next:n=>{this.model.fieldsOptions=n.fieldsOptions,this.model.options.rowNumberLast=n.rowsQuantity,this.loadingConfiguration=!1},error:n=>{this.errorMessage=n.error||this.getLangString("ERROR"),this.loadingConfiguration=!1}})):this.sheetHeaders=[]}getTestData(e){e&&e.preventDefault(),!this.loading&&!this.loadingConfiguration&&(this.errorMessage="",this.loadingConfiguration=!0,this.dataService.testData(this.model).subscribe({next:n=>{n?this.testData=n:this.errorMessage=this.getLangString("ERROR"),this.loadingConfiguration=!1},error:n=>{this.errorMessage=n.error||this.getLangString("ERROR"),this.loadingConfiguration=!1}}))}updateData(e){e&&e.preventDefault(),this.testData?this.getTestData():this.getSheetProperties()}fieldAddOptions(e,n){n&&n.preventDefault(),e.options.push({targetAction:""})}getIsFieldsCount(e,n){switch(n){case 1:return!e.targetAction||["category"].indexOf(e.targetAction)>-1;case 2:return["field","split"].indexOf(e.targetAction)>-1;case 3:return["new"].indexOf(e.targetAction)>-1}return!0}getIsParametersField(e){return!!this.contentType&&this.contentType.fields.filter(l=>"parameters"===l.inputType).map(l=>l.name).indexOf(e)>-1}getFieldsColumnClass(e,n){let s=[["split","field","new"],[]],i=["col-6 pe-2","col-4 pe-2"];const l=this.getIsParametersField(e.targetName);"field_sub"==n&&(s=[["split"],["new"]],l?s[1].push("field"):s[0].push("field"),i=["col-6 pe-2","col-4 pe-2"]);let C="col-12";return s.forEach((v,y)=>{v.indexOf(e.targetAction)>-1&&(C=i[y])}),C}onStepNumberChange(){this.updateStepsArr()}onImportCompleted(){this.showProgressBar=!1,this.loading=!1,this.activeModal.close({reason:"import_completed"})}updateStepsArr(){this.steps=(0,Z.range)(1,Math.max(1,parseInt(String(this.model.options.stepsNumber))+1)),this.model.options.step=1}startImport(e){if(e&&e.preventDefault(),this.loading||this.loadingConfiguration)return;this.errorMessage="",this.testData=null,this.loading=!0,this.percent=0;let n=0,s="",i={};this.dataService.importDataProgress(this.model).subscribe({next:l=>{if(l instanceof g.Zn)this.updatePercent(100);else if(l instanceof g.ZM)200!==l.status&&400!==l.status&&this.onImportCompleted();else if(l.type===g.dt.DownloadProgress){s=l.partialText.substr(n).trim();const C=s.split("\n");s=C[C.length-1],n=l.partialText.length,"{"===s.substr(0,1)&&"}"===s.substr(s.length-1,1)&&(i=JSON.parse(s),this.updatePercent((i.currentIndex-i.rowNumberFirst)/(i.rowNumberLast-i.rowNumberFirst)*100))}},error:l=>{l.error&&l.error.indexOf("{")>-1&&(l.error=JSON.parse(l.error),l.error=l.error.error||this.getLangString("ERROR")),this.errorMessage=l.error||this.getLangString("ERROR"),this.showProgressBar=!1,this.loading=!1}})}updatePercent(e){this.percent=Math.min(100,Math.floor(e)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout(()=>{this.onImportCompleted()},1e3)}confirmAction(e){return this.modalRef=this.modalService.open($.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}clearTestData(e){e&&e.preventDefault(),this.testData=null}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(c.qu),t.Y36(p),t.Y36(b.U),t.Y36(h.Kz),t.Y36(h.xI),t.Y36(N.sK),t.Y36(t.SBq),t.Y36(h.FF),t.Y36(q.g),t.Y36(Q.s),t.Y36(J.d),t.Y36(f.ez))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-modal-import"]],inputs:{model:"model"},features:[t._Bn([p,f.ez]),t.qOj],decls:100,vars:88,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5",3,"title"],[1,"modal-body","py-0"],[3,"formGroup"],["formElement","ngForm"],[1,"row"],[1,"col-md-6"],[1,"mb-2","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","id","fieldTitle","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"mb-2"],["formControlName","fileData",3,"allowedExtensions","fieldName","largeFieldMode","files","ngModel","filesChange","ngModelChange"],["class","alert alert-danger d-block px-2 py-0 mt-2",4,"ngIf"],["for","fieldRowNumberHeaders",1,"label-filled"],["type","number","id","fieldRowNumberHeaders","step","1","min","1","name","rowNumberHeaders","formControlName","rowNumberHeaders",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-12","col-lg-6"],["for","fieldRowNumberFirst",1,"label-filled","max-width95"],[1,"text-overflow",3,"title"],["type","number","id","fieldRowNumberFirst","step","1","min","1","name","rowNumberFirst","formControlName","rowNumberFirst",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldRowNumberLast",1,"label-filled","max-width95"],["type","number","id","fieldRowNumberLast","step","1","min","1","name","rowNumberLast","formControlName","rowNumberLast",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCategoriesSeparator",1,"label-filled"],["type","text","id","fieldCategoriesSeparator","name","categoriesSeparator","formControlName","categoriesSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldStepsNumber",1,"label-filled"],["type","number","id","fieldStepsNumber","step","1","min","1","max","100",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[4,"ngIf"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"disabled","click"],[1,"alert","alert-danger"],[1,"alert","alert-danger","d-block","px-2","py-0","mt-2"],["for","fieldCSVSeparator",1,"label-filled","max-width95"],["type","text","id","fieldCSVSeparator","name","csvSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEnclosure",1,"label-filled","max-width95"],["type","text","id","fieldCSVEnclosure","name","csvEnclosure",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEncoding",1,"label-filled"],["type","text","id","fieldCSVEncoding","name","csvEncoding",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldSheetsNames",1,"label-filled"],["id","fieldSheetsNames",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"label-filled"],[3,"ngModel","ngModelChange"],[1,"form-select",3,"ngModel","ngModelChange"],["for","fieldArticulFieldName",1,"label-filled"],["id","fieldArticulFieldName",1,"form-select",3,"ngModel","ngModelChange"],["for","fieldAliasAdditionalFieldName",1,"label-filled","max-width95"],["id","fieldAliasAdditionalFieldName",1,"form-select",3,"ngModel","ngModelChange"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"form-check-label",3,"for"],["class","card",4,"ngIf"],[3,"value"],[1,"card"],[1,"card-header"],[1,"float-none","float-lg-end","mb-2","mb-lg-0"],["class","d-inline-block me-2","style","width: 150px;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-wide",3,"click"],["type","button",1,"btn","btn-secondary","me-2",3,"ngbTooltip","click"],[1,"icon-repeat"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],[1,"p-0"],[1,"max-height400"],[1,"table","border-top-0","my-0","bg-light"],[4,"ngFor","ngForOf"],[1,"d-inline-block","me-2",2,"width","150px"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["id","fieldStep",1,"form-select",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","no-gutters"],[3,"ngClass"],["value","category"],["value","field"],["value","translations"],["value","new"],["value","split"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-6","ps-2"],["type","text",1,"form-control",3,"ngbTooltip","ngModel","ngModelChange"],[1,"col-12","col-lg-8","offset-lg-4"],["class","row no-gutters mb-3",4,"ngFor","ngForOf"],[1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm","btn-wide",3,"click"],[1,"row","no-gutters","mb-3"],["value","delete"],[1,"col-4","px-1"],[1,"col-4","ps-2"],["class","col-4 px-1",4,"ngIf"],[1,"ps-2",3,"ngClass"],[1,"p-2","border-top"],[1,"position-relative"],[1,"position-absolute","pos-absolute-right2",2,"z-index","10"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"col-lg-5"],["class","table table-striped table-bordered bg-light table-sm mt-0",4,"ngIf"],[1,"table","table-striped","table-bordered","bg-light","table-sm","my-0"],["width","50%","span","2"],[1,"col-lg-7"],[1,"table-responsive"],["width","40%"],["width","60%"],["colspan","2"],[1,"table","table-striped","table-bordered","bg-light","table-sm","mt-0"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"app-progress",2,"width","400px","position","absolute","left","50%","top","50%","margin-left","-200px","margin-top","50px","z-index","2222"],["type","success","height","1.4rem",3,"value","animated","striped"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"button",2),t.NdJ("click",function(i){return n.closeModal(i)}),t._UZ(3,"i",3),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.TgZ(7,"button",2),t.NdJ("click",function(i){return n.minimize(i)}),t._UZ(8,"i",4),t.TgZ(9,"span"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",5),t.TgZ(13,"div",6),t.TgZ(14,"div",7),t.TgZ(15,"button",8),t.NdJ("click",function(i){return n.maximize(i)}),t.ALo(16,"translate"),t._UZ(17,"i",9),t.qZA(),t.TgZ(18,"button",10),t.NdJ("click",function(i){return n.closeModal(i)}),t.ALo(19,"translate"),t._UZ(20,"i",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"h4",12),t._uU(22),t.qZA(),t.qZA(),t.TgZ(23,"div",13),t.TgZ(24,"form",14,15),t.TgZ(26,"div",16),t.TgZ(27,"div",17),t.TgZ(28,"div",18),t.TgZ(29,"label",19),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"input",20),t.NdJ("ngModelChange",function(i){return n.model.title=i}),t.qZA(),t.YNc(33,K,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(34,"div",17),t.TgZ(35,"div",22),t.TgZ(36,"app-file-widget",23),t.NdJ("filesChange",function(i){return n.files=i})("ngModelChange",function(i){return n.model.fileData=i}),t.qZA(),t.YNc(37,z,2,1,"div",24),t.qZA(),t.qZA(),t.qZA(),t.TgZ(38,"div",16),t.TgZ(39,"div",17),t.TgZ(40,"div",18),t.TgZ(41,"label",25),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"input",26),t.NdJ("ngModelChange",function(i){return n.model.options.rowNumberHeaders=i})("ngModelChange",function(){return n.onOptionChanged()}),t.qZA(),t.YNc(45,W,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(46,"div",17),t.TgZ(47,"div",16),t.TgZ(48,"div",27),t.TgZ(49,"div",18),t.TgZ(50,"label",28),t.TgZ(51,"span",29),t.ALo(52,"translate"),t._uU(53),t.ALo(54,"translate"),t.qZA(),t.qZA(),t.TgZ(55,"input",30),t.NdJ("ngModelChange",function(i){return n.model.options.rowNumberFirst=i}),t.qZA(),t.YNc(56,V,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(57,"div",27),t.TgZ(58,"div",18),t.TgZ(59,"label",31),t.TgZ(60,"span",29),t.ALo(61,"translate"),t._uU(62),t.ALo(63,"translate"),t.qZA(),t.qZA(),t.TgZ(64,"input",32),t.NdJ("ngModelChange",function(i){return n.model.options.rowNumberLast=i}),t.qZA(),t.YNc(65,G,2,1,"div",21),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(66,"div",16),t.TgZ(67,"div",17),t.TgZ(68,"div",18),t.TgZ(69,"label",33),t._uU(70),t.ALo(71,"translate"),t.qZA(),t.TgZ(72,"input",34),t.NdJ("ngModelChange",function(i){return n.model.options.categoriesSeparator=i}),t.qZA(),t.YNc(73,X,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(74,"div",17),t.TgZ(75,"div",22),t.TgZ(76,"label",35),t._uU(77),t.ALo(78,"translate"),t.qZA(),t.TgZ(79,"input",36),t.NdJ("ngModelChange",function(i){return n.model.options.stepsNumber=i})("ngModelChange",function(){return n.onStepNumberChange()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(80,tt,26,18,"ng-container",37),t.YNc(81,It,60,44,"ng-container",37),t.YNc(82,Ot,3,1,"div",38),t.YNc(83,St,4,4,"ng-container",37),t.qZA(),t.TgZ(84,"div",39),t.TgZ(85,"div",40),t.TgZ(86,"button",41),t.NdJ("click",function(i){return n.save(!0,i)}),t.TgZ(87,"span"),t._uU(88),t.ALo(89,"translate"),t.qZA(),t.qZA(),t.TgZ(90,"div",42),t._UZ(91,"button",43),t.TgZ(92,"div",44),t.TgZ(93,"button",45),t.NdJ("click",function(i){return n.save(!1,i)}),t._uU(94),t.ALo(95,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(96,"button",46),t.NdJ("click",function(i){return n.closeModal(i)}),t.TgZ(97,"span"),t._uU(98),t.ALo(99,"translate"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(6,57,"CLOSE")),t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(11,59,"MINIMIZE")),t.xp6(5),t.Q6J("title",t.lcZ(16,61,"EXPAND")),t.xp6(3),t.Q6J("title",t.lcZ(19,63,"CLOSE")),t.xp6(3),t.Q6J("title",n.modalTitle),t.xp6(1),t.Oqu(n.modalTitle),t.xp6(1),t.ekj("loading",n.loading),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(6),t.Oqu(t.lcZ(31,65,"TITLE")),t.xp6(2),t.ekj("is-invalid",n.formErrors.title),t.Q6J("ngModel",n.model.title),t.xp6(1),t.Q6J("ngIf",n.formErrors.title),t.xp6(3),t.Q6J("allowedExtensions",".xls,.xlsx,.csv")("fieldName","fileData")("largeFieldMode",!1)("files",n.files)("ngModel",n.model.fileData),t.xp6(1),t.Q6J("ngIf",n.formErrors.fileData),t.xp6(5),t.Oqu(t.lcZ(43,67,"ROW_NUMBER_HEADERS")),t.xp6(2),t.ekj("is-invalid",n.formErrors.rowNumberHeaders),t.Q6J("ngModel",n.model.options.rowNumberHeaders),t.xp6(1),t.Q6J("ngIf",n.formErrors.rowNumberHeaders),t.xp6(6),t.Q6J("title",t.lcZ(52,69,"ROW_NUMBER_FIRST")),t.xp6(2),t.Oqu(t.lcZ(54,71,"ROW_NUMBER_FIRST")),t.xp6(2),t.ekj("is-invalid",n.formErrors.rowNumberFirst),t.Q6J("ngModel",n.model.options.rowNumberFirst),t.xp6(1),t.Q6J("ngIf",n.formErrors.rowNumberFirst),t.xp6(4),t.Q6J("title",t.lcZ(61,73,"ROW_NUMBER_LAST")),t.xp6(2),t.Oqu(t.lcZ(63,75,"ROW_NUMBER_LAST")),t.xp6(2),t.ekj("is-invalid",n.formErrors.rowNumberLast),t.Q6J("ngModel",n.model.options.rowNumberLast),t.xp6(1),t.Q6J("ngIf",n.formErrors.rowNumberLast),t.xp6(5),t.Oqu(t.lcZ(71,77,"SEPARATOR_CATEGORIES")),t.xp6(2),t.ekj("is-invalid",n.formErrors.categoriesSeparator),t.Q6J("ngModel",n.model.options.categoriesSeparator),t.xp6(1),t.Q6J("ngIf",n.formErrors.categoriesSeparator),t.xp6(4),t.Oqu(t.lcZ(78,79,"STEPS_NUMBER")),t.xp6(2),t.Q6J("ngModel",n.model.options.stepsNumber)("ngModelOptions",t.DdM(87,k)),t.xp6(1),t.Q6J("ngIf","csv"==n.model.type),t.xp6(1),t.Q6J("ngIf",n.model.id),t.xp6(1),t.Q6J("ngIf",n.errorMessage),t.xp6(1),t.Q6J("ngIf",n.showProgressBar),t.xp6(3),t.Q6J("disabled",n.submitted&&n.form.valid),t.xp6(2),t.Oqu(t.lcZ(89,81,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("disabled",n.submitted&&n.form.valid),t.xp6(3),t.Oqu(t.lcZ(95,83,"SAVE")),t.xp6(2),t.Q6J("disabled",n.submitted||n.loading),t.xp6(2),t.Oqu(t.lcZ(99,85,"CLOSE")))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.O5,H.E,c.qQ,c.wV,c.Fd,c.On,h.jt,h.iD,h.Vi,h.TH,c.EJ,c.YN,c.Kr,u.sg,P.F,c.Wl,h._L,u.mk,u.RF,u.n9,h.Ly],pipes:[N.X$,u.Ov,u.Nd,u.Ts],encapsulation:2}),o})();var Y=d(9518),B=d(397);let Lt=(()=>{class o extends I.U{constructor(e,n,s,i,l){super(e,n,s,i),this.dataService=e,this.activeModal=n,this.modalService=s,this.translateService=i,this.messageService=l,this.queryOptions=new T.J("id","desc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"fileSize",sortName:"fileSize",title:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{name:"type",sortName:"type",title:"FILE_TYPE",outputType:"text",outputProperties:{}},{name:"sheetsQuantity",sortName:"sheetsQuantity",title:"SHEETS_QUANTITY",outputType:"text",outputProperties:{}},{name:"rowsQuantity",sortName:"rowsQuantity",title:"ROWS_QUANTITY",outputType:"text",outputProperties:{}}]}onModalClose(e){"import_completed"===(e&&e.reason?e.reason:"")&&this.messageService.add({key:"message",severity:"success",summary:this.getLangString("MESSAGE"),detail:this.getLangString("IMPORT_COMPLETED")})}getModalContent(){return Nt}appendFormData(e){e.append("ownerType","import_export")}getModalElementId(e){return["modal","export-config",e||0].join("-")}setModalInputs(e,n=!1,s=""){super.setModalInputs(e,n,s),this.modalRef.componentInstance.modalTitle=void 0===e||n?this.getLangString("ADD_IMPORT_CONFIGURATION"):`${this.getLangString("EDIT_IMPORT_CONFIGURATION")} #${e}`;const l=(0,Z.findIndex)(this.items,{id:e});l>-1&&(this.modalRef.componentInstance.model=this.items[l])}}return o.title="IMPORT_EXPORT",o.\u0275fac=function(e){return new(e||o)(t.Y36(p),t.Y36(h.Kz),t.Y36(h.FF),t.Y36(N.sK),t.Y36(f.ez))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-import"]],features:[t._Bn([p,f.ez]),t.qOj],decls:22,vars:15,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""],["key","message","position","bottom-right"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"button",4),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"div",5),t.TgZ(9,"button",6),t.NdJ("click",function(){return n.deleteSelected()}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"button",7),t.NdJ("click",function(){return n.modalOpen()}),t._UZ(13,"i",8),t._uU(14," \xa0 "),t.TgZ(15,"span"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.qZA(),t.qZA(),t._UZ(18,"div",9),t.qZA(),t.TgZ(19,"app-table",10,11),t.NdJ("selectedIdsChange",function(i){return n.selectedIds=i})("loadingChange",function(i){return n.loading=i})("actionRequest",function(i){return n.actionRequest(i)}),t.qZA(),t._UZ(21,"p-toast",12)),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,9,"BATCH_ACTIONS")),t.xp6(4),t.Oqu(t.lcZ(11,11,"DELETE")),t.xp6(6),t.Oqu(t.lcZ(17,13,"ADD")),t.xp6(3),t.Q6J("items",n.items)("selectedIds",n.selectedIds)("collectionSize",n.collectionSize)("queryOptions",n.queryOptions)("tableFields",n.tableFields)("loading",n.loading))},directives:[h.jt,h.iD,h.Vi,Y.a,B.FN],pipes:[N.X$],styles:[""]}),o})();class U{constructor(a,e,n,s,i,l,C){this.id=a,this.title=e,this.fileData=n,this.type=s,this.fileSize=i,this.options=l,this.fieldsOptions=C,void 0===this.options&&U.setOptiontDefaults(this)}static setOptiontDefaults(a){a.options||(a.options={}),a.options=Object.assign({parentId:0,contentType:"",categoryType:"column",categoriesSeparator:"",csvSeparator:";",csvEncoding:"UTF-8",csvEnclosure:'"'},a.options)}}let R=(()=>{class o extends r.D{constructor(e){super(e),this.setRequestUrl("export")}exportDataProgress(e){const n=this.getRequestUrl()+`/${e.id}/do_export`;return this.http.request(new g.aW("POST",n,e,{reportProgress:!0,responseType:"text",headers:this.headers}))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(g.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();function Rt(o,a){if(1&o&&(t.TgZ(0,"div",61),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.title," ")}}function wt(o,a){if(1&o&&(t.TgZ(0,"option",62),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.Oqu(e.title)}}function Ut(o,a){if(1&o&&(t.TgZ(0,"div",61),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.formErrors.contentType," ")}}function Dt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16),t.TgZ(2,"div",17),t.TgZ(3,"div",22),t.TgZ(4,"label",63),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"input",64),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.csvSeparator=s}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"div",17),t.TgZ(9,"div",22),t.TgZ(10,"label",65),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"input",66),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.csvEncoding=s}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",16),t.TgZ(15,"div",17),t.TgZ(16,"div",22),t.TgZ(17,"label",67),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"input",68),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw().model.options.csvEnclosure=s}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,6,"CSV_SEPARATOR")),t.xp6(2),t.Q6J("ngModel",e.model.options.csvSeparator),t.xp6(4),t.Oqu(t.lcZ(12,8,"CSV_ENCODING")),t.xp6(2),t.Q6J("ngModel",e.model.options.csvEncoding),t.xp6(5),t.Oqu(t.lcZ(19,10,"CSV_ENCLOSURE")),t.xp6(2),t.Q6J("ngModel",e.model.options.csvEnclosure)}}function Ft(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"a",69),t._UZ(2,"i",70),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.hYB("href","",e.baseUrl,"/admin/files/download/",e.model.fileData.fileId,"",t.LSH),t.xp6(2),t.hij(" ",t.lcZ(4,3,"DOWNLOAD")," ")}}function Jt(o,a){if(1&o&&(t.TgZ(0,"option",62),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e.name),t.xp6(1),t.hij(" ",e.title," ")}}function Qt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"select",75),t.NdJ("ngModelChange",function(s){return t.CHM(e),t.oxw(2).$implicit.targetName=s})("ngModelChange",function(s){t.CHM(e);const i=t.oxw(2).$implicit;return t.oxw().onChangeFieldName(i,s)}),t.TgZ(2,"option",84),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,Jt,2,2,"option",34),t.qZA(),t.BQk()}if(2&o){const e=t.oxw(2).$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngModel",e.targetName),t.xp6(2),t.Oqu(t.lcZ(4,3,"ID")),t.xp6(2),t.Q6J("ngForOf",n.contentType.fields)}}function Pt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",83),t.YNc(2,Qt,6,5,"ng-container",41),t.qZA(),t.BQk()),2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",e.contentType)}}function kt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td"),t.TgZ(3,"div",16),t.TgZ(4,"div",71),t._uU(5),t.qZA(),t.TgZ(6,"div",72),t.TgZ(7,"div",73),t.TgZ(8,"div",74),t.TgZ(9,"select",75),t.NdJ("ngModelChange",function(s){return t.CHM(e).$implicit.targetAction=s})("ngModelChange",function(s){const i=t.CHM(e),l=i.$implicit,C=i.index;return t.oxw().onChangeFieldAction(l,C,s)}),t.TgZ(10,"option",76),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"option",77),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"option",78),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"option",79),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"option",80),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.qZA(),t.qZA(),t.ynx(25,81),t.YNc(26,Pt,3,1,"ng-container",82),t.BQk(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&o){const e=a.$implicit,n=a.index,s=t.oxw();t.xp6(5),t.hij(" \u041a\u043e\u043b\u043e\u043d\u043a\u0430 #",n+1," "),t.xp6(3),t.Q6J("ngClass",s.getFieldsColumnClass(e)),t.xp6(1),t.Q6J("ngModel",e.targetAction),t.xp6(2),t.Oqu(t.lcZ(12,10,"CATEGORY")),t.xp6(3),t.Oqu(t.lcZ(15,12,"CATEGORIES_WITH_SEPARATOR")),t.xp6(3),t.Oqu(t.lcZ(18,14,"SELECT_FIELD")),t.xp6(3),t.Oqu(t.lcZ(21,16,"TRANSLATIONS")),t.xp6(3),t.hij("\xd7 ",t.lcZ(24,18,"DELETE"),""),t.xp6(2),t.Q6J("ngSwitch",e.targetAction),t.xp6(1),t.Q6J("ngSwitchCase","field")}}function Yt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",85),t._uU(1),t.TgZ(2,"button",86),t.NdJ("click",function(){return t.CHM(e),t.oxw().errorMessage=""}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}function Bt(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij("",e.percent,"%")}}function jt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",87),t.TgZ(2,"ngb-progressbar",88),t.YNc(3,Bt,2,1,"span",41),t.qZA(),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("value",e.percent)("animated",!0)("striped",!0),t.xp6(1),t.Q6J("ngIf",e.percent>10)}}let $t=(()=>{class o extends x.D{constructor(e,n,s,i,l,C,v,y,w,D,F){super(e,n,s,i,l,C,v),this.fb=e,this.dataService=n,this.systemNameService=s,this.activeModal=i,this.tooltipConfig=l,this.translateService=C,this.elRef=v,this.modalService=y,this.settingsService=w,this.contentTypeService=D,this.appSettings=F,this.model=new U(0,""),this.modalTitle="Export",this.loadingConfiguration=!1,this.isInitialised=!1,this.sheetHeaders=[],this.contentTypes=[],this.percent=0,this.showProgressBar=!1,this.baseUrl="",this.formFields={title:{fieldLabel:"TITLE",value:"",validators:[c.kI.required],messages:{}},parentId:{fieldLabel:"PARENT_FOLDER",value:"",dataKey:"options",validators:[],messages:{}},type:{fieldLabel:"FORMAT",value:"xls",validators:[],messages:{}},contentType:{fieldLabel:"CONTENT_TYPE",value:"",dataKey:"options",validators:[c.kI.required],messages:{}}}}onBeforeInit(){this.model&&!this.model.options&&(this.model.options={}),this.model&&!this.model.fieldsOptions&&(this.model.fieldsOptions=[]),this.baseUrl=this.appSettings.settings.webApiUrl}onAfterInit(){this.getContentTypesList()}getContentTypesList(){this.contentTypes$=this.contentTypeService.getListPage().pipe((0,_.U)(({items:e})=>e))}getContentType(e){e||(e=this.model.options.contentType),e?(this.loading=!0,this.contentTypeService.getItemByName(e).subscribe(n=>{this.contentType=n,this.loading=!1},n=>{n.error&&(this.errorMessage=n.error),this.contentType=null,this.loading=!1})):this.contentType=null}updateFieldOptions(){if(!this.contentType)return;const e=(0,Z.cloneDeep)(this.model.fieldsOptions);this.model.fieldsOptions=[],this.contentType.fields.forEach(n=>{const s=(0,Z.findIndex)(e,{sourceName:n.name}),i=s>-1?e[s]:{};this.model.fieldsOptions.push({sourceTitle:i.sourceTitle||n.title,sourceName:i.sourceName||n.name,targetName:i.targetName||"",targetTitle:i.targetTitle||"",targetAction:i.targetAction||""})})}getFieldsColumnClass(e){let s=["col-6 pe-2","col-4 pe-2"],i="col-12";return[["field"],[]].forEach((l,C)=>{l.indexOf(e.targetAction)>-1&&(i=s[C])}),i}onChangeFieldAction(e,n,s){switch(e.targetName="",e.targetTitle="",e.separator="",e.options=[],s){case"delete":this.model.fieldsOptions.splice(n,1);break;case"category":e.targetTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f";break;case"categories_splitted":e.targetTitle="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"}}onChangeFieldName(e,n){if("_id"===n)e.targetTitle="ID";else{const s=(0,Z.findIndex)(this.contentType.fields,{name:n});e.targetTitle=this.contentType.fields[s].title}}fieldOptionsAdd(e){e&&e.preventDefault(),this.model.fieldsOptions.push({targetAction:"category",targetTitle:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"})}startExport(e){if(e&&e.preventDefault(),this.loading)return;this.errorMessage="",this.loading=!0,this.percent=0;let n=0,s="",i={};this.dataService.exportDataProgress(this.model).subscribe({next:l=>{if(l instanceof g.Zn)this.updatePercent(100);else if(!(l instanceof g.ZM)&&l.type===g.dt.DownloadProgress){s=l.partialText.substr(n).trim();const C=s.split("\n");s=C[C.length-1],n=l.partialText.length,"{"===s.substr(0,1)&&"}"===s.substr(s.length-1,1)&&(i=JSON.parse(s),this.updatePercent((i.currentIndex-i.rowNumberFirst)/(i.rowNumberLast-i.rowNumberFirst)*100))}},error:l=>{l.error&&l.error.indexOf("{")>-1&&(l.error=JSON.parse(l.error),l.error=l.error.error||this.getLangString("ERROR")),l.error&&(this.errorMessage=l.error),this.loading=!1,this.showProgressBar=!1}})}updatePercent(e){this.percent=Math.min(100,Math.floor(e)),this.percent>0&&!this.showProgressBar&&(this.showProgressBar=!0),100===this.percent&&setTimeout(()=>{this.showProgressBar=!1,this.loading=!1,this.getModelData()},1e3)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(c.qu),t.Y36(R),t.Y36(b.U),t.Y36(h.Kz),t.Y36(h.xI),t.Y36(N.sK),t.Y36(t.SBq),t.Y36(h.FF),t.Y36(q.g),t.Y36(Q.s),t.Y36(J.d))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-modal-export"]],inputs:{model:"model"},features:[t._Bn([R]),t.qOj],decls:117,vars:82,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5",3,"title"],[1,"modal-body","py-0"],[3,"formGroup"],["formElement","ngForm"],[1,"row"],[1,"col-md-6"],[1,"mb-2","mb-2-message","form-group-message"],["for","fieldTitle",1,"label-filled"],["type","text","id","fieldTitle","name","title","formControlName","title",1,"form-control",3,"ngModel","ngModelChange"],["class","alert alert-danger",4,"ngIf"],[1,"mb-2"],[1,"label-filled"],["name","parentId","formControlName","parentId",3,"ngModel","ngModelChange"],["for","fieldType",1,"label-filled"],["id","fieldType","name","type","formControlName","type",1,"form-select",3,"ngModel","ngModelChange"],["value","xls"],["value","xlsx"],["value","csv"],[1,"mb-2","form-group-message"],["for","fieldContentType",1,"label-filled"],["id","fieldContentType","name","contentType","formControlName","contentType",1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","fieldCategoryType",1,"label-filled"],["id","fieldCategoryType",1,"form-select",3,"ngModel","ngModelChange"],["value","column"],["value","row"],["for","fieldCategoriesSeparator",1,"label-filled"],["type","text","id","fieldCategoriesSeparator",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"float-end"],["type","button",1,"btn","btn-primary","btn-wide",3,"disabled","click"],[1,"p-0"],[1,"max-height400"],[1,"table","border-top-0","my-0","bg-light"],[4,"ngFor","ngForOf"],[1,"text-center","py-2"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"disabled","click"],[1,"alert","alert-danger"],[3,"value"],["for","fieldCSVSeparator",1,"label-filled"],["type","text","id","fieldCSVSeparator","name","csvSeparator",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEncoding",1,"label-filled"],["type","text","id","fieldCSVEncoding","name","csvEncoding",1,"form-control",3,"ngModel","ngModelChange"],["for","fieldCSVEnclosure",1,"label-filled"],["type","text","id","fieldCSVEnclosure","name","csvEnclosure",1,"form-control",3,"ngModel","ngModelChange"],["target","_blank",1,"btn","btn-success",3,"href"],[1,"icon-download"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","no-gutters"],[3,"ngClass"],[1,"form-select",3,"ngModel","ngModelChange"],["value","category"],["value","categories_splitted"],["value","field"],["value","translations"],["value","delete"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"col-6","ps-2"],["value","_id"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"app-progress",2,"width","400px","position","absolute","left","50%","top","50%","margin-left","-200px","margin-top","50px","z-index","2222"],["type","success","height","1.4rem",3,"value","animated","striped"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"button",2),t.NdJ("click",function(i){return n.closeModal(i)}),t._UZ(3,"i",3),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.TgZ(7,"button",2),t.NdJ("click",function(i){return n.minimize(i)}),t._UZ(8,"i",4),t.TgZ(9,"span"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",5),t.TgZ(13,"div",6),t.TgZ(14,"div",7),t.TgZ(15,"button",8),t.NdJ("click",function(i){return n.maximize(i)}),t.ALo(16,"translate"),t._UZ(17,"i",9),t.qZA(),t.TgZ(18,"button",10),t.NdJ("click",function(i){return n.closeModal(i)}),t.ALo(19,"translate"),t._UZ(20,"i",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"h4",12),t._uU(22),t.qZA(),t.qZA(),t.TgZ(23,"div",13),t.TgZ(24,"form",14,15),t.TgZ(26,"div",16),t.TgZ(27,"div",17),t.TgZ(28,"div",18),t.TgZ(29,"label",19),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.TgZ(32,"input",20),t.NdJ("ngModelChange",function(i){return n.model.title=i}),t.qZA(),t.YNc(33,Rt,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(34,"div",17),t.TgZ(35,"div",22),t.TgZ(36,"label",23),t._uU(37),t.ALo(38,"translate"),t.qZA(),t.TgZ(39,"app-select-parent-dropdown",24),t.NdJ("ngModelChange",function(i){return n.model.options.parentId=i}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(40,"div",16),t.TgZ(41,"div",17),t.TgZ(42,"div",22),t.TgZ(43,"label",25),t._uU(44),t.ALo(45,"translate"),t.qZA(),t.TgZ(46,"select",26),t.NdJ("ngModelChange",function(i){return n.model.type=i}),t.TgZ(47,"option",27),t._uU(48,"XLS"),t.qZA(),t.TgZ(49,"option",28),t._uU(50,"XLSX"),t.qZA(),t.TgZ(51,"option",29),t._uU(52,"CSV"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(53,"div",17),t.TgZ(54,"div",30),t.TgZ(55,"label",31),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"select",32),t.NdJ("ngModelChange",function(i){return n.model.options.contentType=i})("ngModelChange",function(i){return n.getContentType(i)}),t._UZ(59,"option",33),t.YNc(60,wt,2,2,"option",34),t.ALo(61,"async"),t.qZA(),t.YNc(62,Ut,2,1,"div",21),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(63,"div",16),t.TgZ(64,"div",17),t.TgZ(65,"div",22),t.TgZ(66,"label",35),t._uU(67),t.ALo(68,"translate"),t.qZA(),t.TgZ(69,"select",36),t.NdJ("ngModelChange",function(i){return n.model.options.categoryType=i}),t.TgZ(70,"option",37),t._uU(71),t.ALo(72,"translate"),t.qZA(),t.TgZ(73,"option",38),t._uU(74),t.ALo(75,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(76,"div",17),t.TgZ(77,"div",22),t.TgZ(78,"label",39),t._uU(79),t.ALo(80,"translate"),t.qZA(),t.TgZ(81,"input",40),t.NdJ("ngModelChange",function(i){return n.model.options.categoriesSeparator=i}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(82,Dt,21,12,"ng-container",41),t.TgZ(83,"div",42),t.TgZ(84,"div",43),t.TgZ(85,"div",44),t.TgZ(86,"button",45),t.NdJ("click",function(i){return n.startExport(i)}),t._uU(87),t.ALo(88,"translate"),t.qZA(),t.qZA(),t.YNc(89,Ft,5,5,"ng-container",41),t.qZA(),t.TgZ(90,"div",46),t.TgZ(91,"div",47),t.TgZ(92,"table",48),t.YNc(93,kt,27,20,"ng-container",49),t.TgZ(94,"tr"),t.TgZ(95,"td",50),t.TgZ(96,"button",51),t.NdJ("click",function(i){return n.fieldOptionsAdd(i)}),t._uU(97),t.ALo(98,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(99,Yt,3,1,"div",52),t.YNc(100,jt,4,4,"ng-container",41),t.qZA(),t.TgZ(101,"div",53),t.TgZ(102,"div",54),t.TgZ(103,"button",55),t.NdJ("click",function(i){return n.save(!0,i)}),t.TgZ(104,"span"),t._uU(105),t.ALo(106,"translate"),t.qZA(),t.qZA(),t.TgZ(107,"div",56),t._UZ(108,"button",57),t.TgZ(109,"div",58),t.TgZ(110,"button",59),t.NdJ("click",function(i){return n.save(!1,i)}),t._uU(111),t.ALo(112,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(113,"button",60),t.NdJ("click",function(i){return n.closeModal(i)}),t.TgZ(114,"span"),t._uU(115),t.ALo(116,"translate"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(6,46,"CLOSE")),t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(11,48,"MINIMIZE")),t.xp6(5),t.Q6J("title",t.lcZ(16,50,"EXPAND")),t.xp6(3),t.Q6J("title",t.lcZ(19,52,"CLOSE")),t.xp6(3),t.Q6J("title",n.modalTitle),t.xp6(1),t.Oqu(n.modalTitle),t.xp6(1),t.ekj("loading",n.loading),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(6),t.Oqu(t.lcZ(31,54,"TITLE")),t.xp6(2),t.ekj("is-invalid",n.formErrors.title),t.Q6J("ngModel",n.model.title),t.xp6(1),t.Q6J("ngIf",n.formErrors.title),t.xp6(4),t.Oqu(t.lcZ(38,56,"PARENT_FOLDER")),t.xp6(2),t.Q6J("ngModel",n.model.options.parentId),t.xp6(5),t.Oqu(t.lcZ(45,58,"FORMAT")),t.xp6(2),t.Q6J("ngModel",n.model.type),t.xp6(10),t.Oqu(t.lcZ(57,60,"CONTENT_TYPE")),t.xp6(2),t.ekj("is-invalid",n.formErrors.contentType),t.Q6J("ngModel",n.model.options.contentType),t.xp6(2),t.Q6J("ngForOf",t.lcZ(61,62,n.contentTypes$)),t.xp6(2),t.Q6J("ngIf",n.formErrors.contentType),t.xp6(5),t.Oqu(t.lcZ(68,64,"SAVE_CATEGORIES_TYPE")),t.xp6(2),t.Q6J("ngModel",n.model.options.categoryType),t.xp6(2),t.Oqu(t.lcZ(72,66,"COLUMNS")),t.xp6(3),t.Oqu(t.lcZ(75,68,"ROWS")),t.xp6(5),t.Oqu(t.lcZ(80,70,"SEPARATOR_CATEGORIES")),t.xp6(2),t.Q6J("ngModel",n.model.options.categoriesSeparator),t.xp6(1),t.Q6J("ngIf","csv"==n.model.type),t.xp6(4),t.Q6J("disabled",0==n.model.fieldsOptions.length),t.xp6(1),t.hij(" ",t.lcZ(88,72,"EXPORT")," "),t.xp6(2),t.Q6J("ngIf",n.model.fileData),t.xp6(4),t.Q6J("ngForOf",n.model.fieldsOptions),t.xp6(4),t.hij(" ",t.lcZ(98,74,"ADD")," "),t.xp6(2),t.Q6J("ngIf",n.errorMessage),t.xp6(1),t.Q6J("ngIf",n.showProgressBar),t.xp6(3),t.Q6J("disabled",n.submitted&&n.form.valid),t.xp6(2),t.Oqu(t.lcZ(106,76,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("disabled",n.submitted&&n.form.valid),t.xp6(3),t.Oqu(t.lcZ(112,78,"SAVE")),t.xp6(2),t.Q6J("disabled",n.submitted||n.loading),t.xp6(2),t.Oqu(t.lcZ(116,80,"CLOSE")))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.O5,P.F,c.EJ,c.YN,c.Kr,u.sg,c.On,h.jt,h.iD,h.Vi,h.TH,u.mk,u.RF,u.n9,h.Ly],pipes:[N.X$,u.Ov],encapsulation:2}),o})(),Ht=(()=>{class o extends I.U{constructor(e,n,s,i,l){super(e,n,s,i),this.dataService=e,this.activeModal=n,this.modalService=s,this.translateService=i,this.messageService=l,this.queryOptions=new T.J("id","desc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"title",sortName:"title",title:"TITLE",outputType:"text",outputProperties:{}},{name:"fileSize",sortName:"fileSize",title:"FILE_SIZE_MB",outputType:"number",outputProperties:{}},{name:"type",sortName:"type",title:"FILE_TYPE",outputType:"text",outputProperties:{}}]}getModalContent(){return $t}getModalElementId(e){return["modal","import-config",e||0].join("-")}setModalInputs(e,n=!1,s=""){super.setModalInputs(e,n,s),this.modalRef.componentInstance.modalTitle=void 0===e||n?this.getLangString("ADD_EXPORT_CONFIGURATION"):`${this.getLangString("EDIT_EXPORT_CONFIGURATION")} #${e}`}}return o.title="IMPORT_EXPORT",o.\u0275fac=function(e){return new(e||o)(t.Y36(R),t.Y36(h.Kz),t.Y36(h.FF),t.Y36(N.sK),t.Y36(f.ez))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-export"]],features:[t._Bn([R,f.ez]),t.qOj],decls:22,vars:15,consts:[[1,"mb-3"],[1,"float-md-start"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto","mb-2","mb-md-0"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"click"],[1,"icon-plus"],[1,"clearfix"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","selectedIdsChange","loadingChange","actionRequest"],["table",""],["key","message","position","bottom-right"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"button",4),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"div",5),t.TgZ(9,"button",6),t.NdJ("click",function(){return n.deleteSelected()}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"button",7),t.NdJ("click",function(){return n.modalOpen()}),t._UZ(13,"i",8),t._uU(14," \xa0 "),t.TgZ(15,"span"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.qZA(),t.qZA(),t._UZ(18,"div",9),t.qZA(),t.TgZ(19,"app-table",10,11),t.NdJ("selectedIdsChange",function(i){return n.selectedIds=i})("loadingChange",function(i){return n.loading=i})("actionRequest",function(i){return n.actionRequest(i)}),t.qZA(),t._UZ(21,"p-toast",12)),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,9,"BATCH_ACTIONS")),t.xp6(4),t.Oqu(t.lcZ(11,11,"DELETE")),t.xp6(6),t.Oqu(t.lcZ(17,13,"ADD")),t.xp6(3),t.Q6J("items",n.items)("selectedIds",n.selectedIds)("collectionSize",n.collectionSize)("queryOptions",n.queryOptions)("tableFields",n.tableFields)("loading",n.loading))},directives:[h.jt,h.iD,h.Vi,Y.a,B.FN],pipes:[N.X$],styles:[""]}),o})();const Kt=function(){return["/import-export/export"]},zt=function(){return["/import-export/import"]},Wt=[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.title="IMPORT_EXPORT",o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-import-export"]],decls:27,vars:13,consts:[[1,"position-relative"],[1,"tabs-top"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","ms-md-2",3,"routerLink"],[1,"icon-outbox"],["href","","routerLinkActive","active",1,"btn","btn-outline-primary","d-block","d-md-inline-block","mb-2","mb-md-0",3,"routerLink"],[1,"icon-inbox"],[1,"card"],[1,"card-body"],[1,"float-md-start","mt-4","mt-md-0"],[1,"clearfix"],[1,"min-height400"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"a",2),t._UZ(3,"i",3),t._uU(4," \xa0 "),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"a",4),t._UZ(9,"i",5),t._uU(10," \xa0 "),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",6),t.TgZ(15,"div",7),t.TgZ(16,"div",8),t.TgZ(17,"h3"),t._UZ(18,"i",3),t._uU(19," \xa0 "),t.TgZ(20,"span"),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.qZA(),t.qZA(),t._UZ(23,"div",9),t._UZ(24,"hr"),t.TgZ(25,"div",10),t._UZ(26,"router-outlet"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("routerLink",t.DdM(11,Kt)),t.xp6(4),t.Oqu(t.lcZ(7,5,"EXPORT")),t.xp6(2),t.Q6J("routerLink",t.DdM(12,zt)),t.xp6(4),t.Oqu(t.lcZ(13,7,"IMPORT")),t.xp6(9),t.Oqu(t.lcZ(22,9,"IMPORT_EXPORT")))},directives:[m.yS,m.Od,m.lC],pipes:[N.X$],encapsulation:2}),o})(),children:[{path:"",redirectTo:"import"},{path:"import",component:Lt},{path:"export",component:Ht}]}];let Vt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[m.Bz.forChild(Wt)],m.Bz]}),o})(),Gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[q.g,b.U,p,R,M.G],imports:[[u.ez,S.m,Vt]]}),o})()},6726:(L,E,d)=>{d.d(E,{D:()=>T});var u=d(9133),S=d(3405),M=d(8805),q=d(103),b=d(1599),m=d(701),Z=d(3668),f=d(7283),I=d(8319);let T=(()=>{class g{constructor(r,t,p,c,_,x,O){this.fb=r,this.dataService=t,this.systemNameService=p,this.activeModal=c,this.tooltipConfig=_,this.translateService=x,this.elRef=O,this.modalId="",this.submitted=!1,this.loading=!1,this.formErrors={},this.validationMessages={},this.formFields={},this.files={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.closeReason="canceled",this.uniqueId="",this.destroyed$=new S.xQ,_.placement="bottom",_.container="body",_.triggers="hover click"}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){}getSystemFieldName(){return"name"}getLangString(r){return this.translateService.store.translations[this.translateService.currentLang][r]||r}getModelData(){return this.loading=!0,new Promise((r,t)=>{this.dataService.getItem(this.itemId).pipe((0,M.R)(this.destroyed$)).subscribe({next:p=>{this.isItemCopy&&(p.id=null,p[this.getSystemFieldName()]=""),this.model=p,this.loading=!1,r(p)},error:p=>{this.errorMessage=p.error||this.getLangString("ERROR"),this.loading=!1,t(p)}})})}buildForm(){const r=this.buildControls(this.formFields);this.form=this.fb.group(r),this.form.valueChanges.pipe((0,M.R)(this.destroyed$)).subscribe({next:t=>this.onValueChanged("form","",t)})}buildControls(r,t="model",p=""){const c={};for(const _ in r){if(!r.hasOwnProperty(_))continue;const x=r[_],O=x.dataKey?this[t][x.dataKey]:this[t];O[_]||(O[_]=x.value),c[_]=new u.NI({value:O[_]||"",disabled:x.disabled||!1},x.validators),this.formErrors[p+_]="",this.translateValidationMessages(p,_,x)}return c}translateValidationMessages(r,t,p){const c={};!p.fieldLabel||(Object.keys(p.messages).forEach(_=>{"required"!==_&&this.translateService.get(String(p.messages[_])).subscribe(x=>{c[_]=x})}),p.validators.indexOf(u.kI.required)>-1&&this.translateService.get(p.fieldLabel).subscribe(_=>{this.translateService.get("FIELD_REQUIRED",{name:_}).subscribe(x=>{c.required=x})}),this.validationMessages[r+t]=c)}getControl(r){return this.form.controls.name}onValueChanged(r,t="",p){if(!this[r])return;const c=this[r].value;for(const _ in c){if(!c.hasOwnProperty(_))continue;this.formErrors[t+_]="";const x=this[r].get(_);if(x&&(x.dirty||this[t+"submitted"])&&!x.valid)for(const O in x.errors)this.formErrors[t+_]+=this.validationMessages[t+_][O]?this.validationMessages[t+_][O]+" ":this.getLangString("ERROR")+" "}}displayToggle(r,t){r.style.display=(t=t||"none"===r.style.display)?"block":"none"}toggleAccordion(r,t,p){r.activeIds.indexOf(t)>-1&&p||r.toggle(t)}generateName(r){r.name=this.systemNameService.generateName(r.title||"")}closeModal(r){r&&r.preventDefault(),this.activeModal.close({reason:this.itemId?"edit":"create",data:this.model})}close(r){r&&r.preventDefault(),this.activeModal.dismiss(this.closeReason)}minimize(r){r&&r.preventDefault(),window.document.body.classList.remove("modal-open");const t=this.getRootElement(),p=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),p.classList.add("d-none")}maximize(r){r&&r.preventDefault(),window.document.body.classList.add("modal-open");const t=this.getRootElement(),p=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),p.classList.remove("d-none")}getFormData(){const r={};return Object.keys(this.model).forEach(t=>{r[t]=this.files[t]?Array.isArray(this.model[t])?[m.O.getFileData(this.files[t])]:m.O.getFileData(this.files[t]):this.model[t]}),r}fileChange(r,t,p=!1){const c=r.target.files;c.length>0&&(this.model[t]=p?[m.O.getFileData(c[0])]:m.O.getFileData(c[0]),this.files[t]=c[0],this.form.controls[t].setValue(this.files[t].name))}fileClear(r,t){this.model[r]=null,this.form.controls[r].reset(null),t.files=null,t.value="",delete this.files[r]}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(r=>{this.model[r]=this.localePreviousValues[r]}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(r=>{this.localePreviousValues[r]=this.model[r]||"",this.model[r]=this.model.translations[r]&&this.model.translations[r][this.localeCurrent]||""})}saveTranslations(r){r&&r.preventDefault(),this.localeFieldsAllowed.forEach(t=>{this.model[t]?(this.model.translations[t]||(this.model.translations[t]={}),this.model.translations[t][this.localeCurrent]=this.model[t]):this.model.translations[t]&&(this.model.translations[t][this.localeCurrent]&&delete this.model.translations[t][this.localeCurrent],0===Object.keys(this.model.translations[t]).length&&delete this.model.translations[t])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}saveRequest(){return this.isEditMode?this.dataService.update(this.getFormData()):this.dataService.create(this.getFormData())}onSubmit(){this.submitted=!0,this.closeModal()}appendFormData(r){}saveFiles(r){if(0===Object.keys(this.files).length)return void this.closeModal();const t=new FormData;for(const p in this.files)this.files.hasOwnProperty(p)&&this.files[p]instanceof File&&t.append(p,this.files[p],this.files[p].name);t.append("itemId",String(r)),this.appendFormData(t),this.dataService.postFormData(t).pipe((0,M.R)(this.destroyed$)).subscribe({next:()=>{this.closeModal()},error:p=>{this.errorMessage=p.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}save(r=!1,t){if(t&&t.preventDefault(),this.submitted=!0,this.errorMessage="",!this.form.valid)return this.onValueChanged("form"),void(this.submitted=!1);this.loading=!0,this.saveRequest().pipe((0,M.R)(this.destroyed$)).subscribe({next:p=>{Object.keys(this.files).length>0?this.saveFiles(p._id||p.id):(r?this.closeModal():p&&p.id&&(this.model=p,this.onAfterGetData(),this.isEditMode=!0),this.closeReason="updated",this.loading=!1,this.submitted=!1)},error:p=>{this.errorMessage=p.error||this.getLangString("ERROR"),this.loading=!1,this.submitted=!1}})}emailValidator(r){return r.value?/\S+@\S+\.\S+/.test(r.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return g.\u0275fac=function(r){return new(r||g)(Z.Y36(u.qu),Z.Y36(b.D),Z.Y36(q.U),Z.Y36(f.Kz),Z.Y36(f.xI),Z.Y36(I.sK),Z.Y36(Z.SBq))},g.\u0275cmp=Z.Xpm({type:g,selectors:[["ng-component"]],inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(r,t){},encapsulation:2}),g})()},5243:(L,E,d)=>{d.d(E,{U:()=>T});var u=d(3405),S=d(8805),M=d(417),q=d(1599),b=d(9985),m=d(3668),Z=d(7283),f=d(8319);const I=["table"];let T=(()=>{class g{constructor(r,t,p,c){this.dataService=r,this.activeModal=t,this.modalService=p,this.translateService=c,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new M.J("name","asc",1,10,0,0),this.destroyed$=new u.xQ}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(r){}onSearchWordUpdate(r){if(void 0!==r)return this.queryOptions.search_word=r,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(r){return["modal",r||0].join("-")}setModalInputs(r,t=!1,p=""){const c=void 0!==r&&!t;this.modalRef.componentInstance.modalTitle=this.getLangString(c?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=p,this.modalRef.componentInstance.itemId=r||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=c}modalOpen(r,t=!1){const p=this.getModalElementId(r);if(window.document.body.classList.add("modal-open"),window.document.getElementById(p)){const c=window.document.getElementById(p),_=c.previousElementSibling;return c.classList.add("d-block"),c.classList.remove("modal-minimized"),void _.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(r,t,p),this.modalRef.result.then(c=>{this.destroyed$.isStopped||(this.onModalClose(c),this.getList())},c=>{this.destroyed$.isStopped||(this.onModalClose(c),c&&["submit","updated"].indexOf(c)>-1&&this.getList())})}deleteItemConfirm(r){this.modalRef=this.modalService.open(b.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(t=>{"accept"===t&&this.deleteItem(r)})}getLangString(r){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][r]||r}confirmAction(r){return this.modalRef=this.modalService.open(b.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=r,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(r=>{this.clearSelected(),this.getList()},r=>this.showAlert(r.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(r=>{"accept"===r&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(r){this.modalRef=this.modalService.open(b.$N),this.modalRef.componentInstance.modalContent=r,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(r){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(t=>{"accept"===t&&this.dataService.deleteItem(r).subscribe(p=>{this.getList()},p=>{p.error&&this.showAlert(p.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(r){switch(r[0]){case"edit":this.modalOpen(r[1]);break;case"copy":this.modalOpen(r[1],!0);break;case"delete":this.deleteItem(r[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe((0,S.R)(this.destroyed$)).subscribe({next:r=>{this.items=r.items,this.collectionSize=r.total,this.loading=!1},error:r=>{this.items=[],this.collectionSize=0,r.error&&this.showAlert(r.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return g.title="",g.\u0275fac=function(r){return new(r||g)(m.Y36(q.D),m.Y36(Z.Kz),m.Y36(Z.FF),m.Y36(f.sK))},g.\u0275dir=m.lG2({type:g,viewQuery:function(r,t){if(1&r&&m.Gf(I,7),2&r){let p;m.iGM(p=m.CRH())&&(t.table=p.first)}}}),g})()},843:(L,E,d)=>{d.d(E,{e:()=>u});class u{constructor(M,q,b,m,Z){this.changed=M,this.loading=q,this.values=b,this.defaultOptions=m,this.defaultValues=Z}}},1562:(L,E,d)=>{d.d(E,{g:()=>Z});var u=d(4522),S=d(2411),M=d(2047),b=(d(843),d(6721)),m=d(3668);let Z=(()=>{class f{constructor(T){this.http=T,this.headers=new u.WM({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="",this.baseUrl="",this.requestUrl="/admin/settings",this.baseUrl=b.d.getBaseUrl()}setRequestUrl(T){this.requestUrl=T}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe((0,M.K)(this.handleError()))}clearSystemCache(){const T=this.getRequestUrl()+"/clear_system_cache";return this.http.post(T,{},{headers:this.headers}).pipe((0,M.K)(this.handleError()))}runActionPost(T){const g=this.getRequestUrl()+`/${T}`;return this.http.post(g,{},{headers:this.headers}).pipe((0,M.K)(this.handleError()))}updateGroup(T,g){const A=this.getRequestUrl()+`/${T}`;return this.http.put(A,g,{headers:this.headers}).pipe((0,M.K)(this.handleError()))}getComposerPackagesList(){return this.http.get(this.getRequestUrl()+"_composer_installed_packages").pipe((0,M.K)(this.handleError()))}composerRequirePackage(T,g){const A=this.getRequestUrl()+"_composer_require_package";return this.http.post(A,{packageName:T,packageVersion:g},{headers:this.headers}).pipe((0,M.K)(this.handleError()))}postFormData(T,g){const A=new u.WM({enctype:"multipart/form-data",Accept:"application/json","X-Requested-With":"XMLHttpRequest"});return this.http.post(this.baseUrl+g,T,{headers:A}).pipe((0,M.K)(this.handleError()))}runAction(T){return this.http.post(this.baseUrl+T,{},{headers:this.headers}).pipe((0,M.K)(this.handleError()))}handleError(T="operation",g){return A=>{if(!(A.status&&[401,403].indexOf(A.status)>-1)){if(A.error)throw A.error;return(0,S.of)(g)}window.location.href=this.baseUrl+"/login"}}}return f.\u0275fac=function(T){return new(T||f)(m.LFG(u.eN))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()}}]);