(self.webpackChunkshk_app=self.webpackChunkshk_app||[]).push([["src_app_orders_orders_module_ts"],{93256:function(t,e,n){"use strict";n.d(e,{B:function(){return u}});var i=n(31041),o=n(55959),s=n(25416),r=n(88857),l=n(52506),a=n(35366),d=n(72431),c=n(60649);const h=["formEl"];let u=(()=>{class t{constructor(t,e,n,i,s,r){this.fb=t,this.activeModal=e,this.translateService=n,this.systemNameService=i,this.dataService=s,this.elRef=r,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.dataLoaded=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new o.xQ}set formErrors(t){for(const e in t)if(t.hasOwnProperty(e)){const t=this.getControl(this.form,null,e);t&&t.setErrors({incorrect:!0})}this._formFieldsErrors=t}get formErrors(){return this._formFieldsErrors}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){this.dataLoaded=!0,this.buildControls(this.form,this.formFields)}getSystemFieldName(){return""}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang][t]||t}getModelData(){return this.loading=!0,new Promise((t,e)=>{this.dataService.getItem(this.itemId).pipe((0,s.R)(this.destroyed$)).subscribe({next:e=>{if(this.isItemCopy){e.id=null;const t=this.getSystemFieldName();t&&(e[t]="")}Object.assign(this.model,e),this.loading=!1,t(e)},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.loading=!1,e(t)}})})}buildForm(t="form",e=null,n=null,i="model"){e||(e=this.formFields),this[t]=this.fb.group(this.buildControls(null,e,i)),this[t].valueChanges.pipe((0,s.R)(this.destroyed$)).subscribe(()=>this.onValueChanged(t,n))}buildControls(t=null,e=[],n="model"){const i={};return e.forEach(e=>{const o=t?this.getControl(t,e):null;let s=null;if(n&&this[n]?(this[n].options||(this[n].options={}),s=0===e.name.indexOf("options_")?this[n].options[e.name.substr(8)]||null:this[n][e.name]||null):s=null,o)if(e.disabled&&o.disable(),e.children){const t=s,n=o;n.clear(),t.forEach((t,i)=>{const o=this.getFormFieldByName(e.name),s=this.buildControls(null,o.children,null);n.push(this.fb.group(s))}),n.patchValue(t)}else o.setValue(s);else e.children?(i[e.name]=this.fb.array([]),this.createArrayFieldsProperty(e.name)):i[e.name]=this.fb.control({value:s,disabled:e.disabled||!1},e.validators)}),i}onValueChanged(t="form",e=null){this[t]&&(e||(e=this.formErrors),this[t].valid&&(this.errorMessage=""),Object.keys(this[t].value).forEach(n=>{e[n]="";const i=this.getControl(this[t],null,n);if(i&&!i.valid&&i.errors){let t="";Object.keys(i.errors).forEach(e=>{t+=(t?" ":"")+this.getLangString("INVALID_"+e.toUpperCase())}),e[n]=t}}))}getFormFieldByName(t){const e=this.formFields.filter(e=>e.name===t);return e.length>0?e[0]:null}createArrayFieldsProperty(t){Object.defineProperty(this.arrayFields,t,{get:()=>this.form?this.form.get(t):null})}getControl(t,e,n){return t?t.get(n||e.name):null}focusFormError(){setTimeout(()=>{this.formEl.nativeElement.querySelector(".form-control.is-invalid")&&this.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()},1)}formGroupMarkTouched(t){Object.keys(t.controls).forEach(e=>{t.controls[e].markAsTouched(),t.controls[e]instanceof i.Oe&&Array.from(this.form.controls[e].controls).forEach(t=>{this.formGroupMarkTouched(t)})})}getSaveRequest(t){return t.id||"root"===t.name?this.dataService.update(t):this.dataService.create(t)}getFormData(){const t=this.form.value;return t.id=this.model.id||0,void 0!==this.model.translations&&(t.translations=this.model.translations||null),t}arrayFieldDelete(t,e,n){n&&n.preventDefault(),this.arrayFields[t].removeAt(e)}arrayFieldAdd(t,e){e&&e.preventDefault();const n=this.getFormFieldByName(t);if(!n)return;const i=this.buildControls(null,n.children,null);this.arrayFields[t].push(this.fb.group(i))}generateName(t,e,n=null){e&&e.preventDefault(),n||(n=this.form);const i=this.getControl(n,null,"title").value||"";t.name=this.systemNameService.generateName(i),this.getControl(n,null,"name").setValue(t.name)}closeModal(t){t&&t.preventDefault(),this.close(this.closeReason)}close(t,e){e&&e.preventDefault(),"submit"===t?this.activeModal.close(t):this.activeModal.dismiss(t)}minimize(t){t&&t.preventDefault(),window.document.body.classList.remove("modal-open");const e=this.getRootElement(),n=e.previousElementSibling;e.classList.remove("d-block"),e.classList.add("modal-minimized"),n.classList.add("d-none")}maximize(t){t&&t.preventDefault(),window.document.body.classList.add("modal-open");const e=this.getRootElement(),n=e.previousElementSibling;e.classList.add("d-block"),e.classList.remove("modal-minimized"),n.classList.remove("d-none")}save(t=!1,e){e&&e.preventDefault(),this.onSubmit(t)}saveFiles(t){if(0===Object.keys(this.files).length)return void this.close("submit");const e=new FormData;for(const n in this.files)this.files.hasOwnProperty(n)&&this.files[n]instanceof File&&e.append(n,this.files[n],this.files[n].name);e.append("itemId",String(t)),this.dataService.postFormData(e).pipe((0,s.R)(this.destroyed$)).subscribe({next:()=>{this.close("submit")},error:t=>{this.errorMessage=t.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}onSubmit(t=!1){if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;const e=this.getFormData();this.getSaveRequest(e).pipe((0,s.R)(this.destroyed$)).subscribe({next:e=>{Object.keys(this.files).length>0?this.saveFiles(e._id||e.id):t&&this.close("submit"),e&&e.id&&(this.model.id=e.id),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:t=>{t.error&&(this.errorMessage=t.error),t.errors&&(this.formErrors=t.errors,this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS")),this.loading=!1,this.submitted=!1}})}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(t=>{this.model[t]=this.localePreviousValues[t],this.getControl(this.form,null,t).setValue(this.localePreviousValues[t])}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(t=>{this.localePreviousValues[t]=this.getControl(this.form,null,t).value,this.model.translations[t]?(this.model[t]=this.model.translations[t][this.localeCurrent]||"",this.getControl(this.form,null,t).setValue(this.model[t])):(this.model[t]="",this.getControl(this.form,null,t).setValue(""))})}saveTranslations(t){t&&t.preventDefault(),this.localeFieldsAllowed.forEach(t=>{this.getControl(this.form,null,t)&&this.getControl(this.form,null,t).value?(this.model.translations[t]||(this.model.translations[t]={}),this.model.translations[t][this.localeCurrent]=this.getControl(this.form,null,t).value):this.model.translations[t]&&(this.model.translations[t][this.localeCurrent]&&delete this.model.translations[t][this.localeCurrent],0===Object.keys(this.model.translations[t]).length&&delete this.model.translations[t])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}emailValidator(t){return t.value?/\S+@\S+\.\S+/.test(t.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}displayToggle(t,e,n){n&&n.preventDefault(),t.style.display=(e=e||"none"===t.style.display)?"block":"none"}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(i.qu),a.Y36(d.Kz),a.Y36(c.sK),a.Y36(l.U),a.Y36(r.D),a.Y36(a.SBq))},t.\u0275cmp=a.Xpm({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&a.Gf(h,5),2&t){let t;a.iGM(t=a.CRH())&&(e.formEl=t.first)}},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})()},27476:function(t,e,n){"use strict";n.r(e),n.d(e,{OrdersModule:function(){return X}});var i=n(61116),o=n(49684),s=n(9883),r=n(31041),l=n(78194),a=n(93724);class d{constructor(t,e,n,i,o,s,r,l,a,d,c,h,u){this.id=t,this.title=e,this.count=n,this.price=i,this.uniqId=o,this.priceTotal=s,this.contentTypeName=r,this.uri=l,this.image=a,this.parameters=d,this.files=c,this.currency=h,this.deleted=u,this.createParametersString(),this.createFilesString(),void 0===this.deleted&&(this.deleted=!1)}get parametersString(){return this._parametersString}set parametersString(t){this._parametersString=t}get filesString(){return this._filesString}set filesString(t){this._filesString=t}priceUpdate(){this.priceTotal=this.price*this.count;let t=0;void 0!==this.parameters&&this.parameters.forEach(e=>{t+=e.price*this.count}),this.priceTotal+=t}createParametersString(){if(!this.parameters)return;const t=[];this.parameters.forEach(e=>{let n="";e.name&&(n+=`${e.name}: `),n+=e.value+(e.price?` (${e.price})`:""),t.push(n)}),this.parametersString=t.join(", ")}createFilesString(){if(!this.files)return;const t=[],e=a.d.getBaseUrl();this.files.forEach(n=>{let i=`<a href="${e}admin/files/download/${n.fileId}" target="_blank">`;i+=`${n.title}.${n.extension}</a>`,t.push(i)}),this.filesString=t.join(", ")}}class c{constructor(t,e,n,i,o,s,r,l,a,d,c,h,u,m,p,g,f,Z,T,b){this.id=t,this.userId=e,this.status=n,this.email=i,this.phone=o,this.fullName=s,this.createdDate=r,this.deliveryName=l,this.deliveryPrice=a,this.paymentName=d,this.paymentValue=c,this.comment=h,this.contentCount=u,this.price=m,this.currency=p,this.options=g,this.currencyRate=f,this.discount=Z,this.discountPercent=T,this.promoCode=b}get content(){return this._content}set content(t){this._content=[],t.forEach(t=>{this._content.push(new d(t.id,t.title,t.count,t.price,t.uniqId,t.priceTotal,t.contentTypeName,t.uri,t.image,t.parameters,t.files||[],"",t.deleted||!1))})}}var h=n(85697),u=n(88857),m=n(35366),p=n(42693);let g=(()=>{class t extends u.D{constructor(t){super(t),this.setRequestUrl("/admin/orders")}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(p.eN))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac}),t})();var f=n(93256),Z=n(89223),T=(n(11026),n(19947)),b=n(52506),A=n(72431),q=n(60649),v=n(59329);function x(t,e){if(1&t&&(m.TgZ(0,"div",44),m._uU(1),m.qZA()),2&t){const t=m.oxw();m.xp6(1),m.hij(" ",t.formErrors.email," ")}}function E(t,e){if(1&t&&(m.TgZ(0,"div",44),m._uU(1),m.qZA()),2&t){const t=m.oxw();m.xp6(1),m.hij(" ",t.formErrors.fullName," ")}}function y(t,e){if(1&t&&(m.TgZ(0,"div",44),m._uU(1),m.qZA()),2&t){const t=m.oxw();m.xp6(1),m.hij(" ",t.formErrors.phone," ")}}function C(t,e){if(1&t&&(m.TgZ(0,"option",46),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.Q6J("value",t.name),m.xp6(1),m.Oqu(t.name)}}function _(t,e){if(1&t&&(m.ynx(0),m.YNc(1,C,2,2,"option",45),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("ngForOf",t.settings.SETTINGS_DELIVERY)}}function I(t,e){if(1&t&&(m.TgZ(0,"option",46),m._uU(1),m.qZA()),2&t){const t=e.$implicit;m.Q6J("value",t.name),m.xp6(1),m.Oqu(t.name)}}function S(t,e){if(1&t&&(m.ynx(0),m.YNc(1,I,2,2,"option",45),m.BQk()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("ngForOf",t.settings.SETTINGS_PAYMENT)}}const N=function(t){return{"is-invalid":t}};function U(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"tr",62),m.TgZ(1,"td"),m._UZ(2,"input",63),m.qZA(),m.TgZ(3,"td"),m._UZ(4,"input",64),m.qZA(),m.TgZ(5,"td",65),m._UZ(6,"input",66),m.qZA(),m.TgZ(7,"td",65),m.TgZ(8,"button",67),m.NdJ("click",function(e){const n=m.CHM(t).index;return m.oxw(4).arrayFieldDelete("options",n,e)}),m.ALo(9,"translate"),m._UZ(10,"i",11),m.qZA(),m.qZA(),m.qZA()}if(2&t){const t=e.$implicit;m.Q6J("formGroupName",e.index+""),m.xp6(2),m.Q6J("ngClass",m.VKq(7,N,t.controls.name.touched&&!t.controls.name.valid)),m.xp6(2),m.Q6J("ngClass",m.VKq(9,N,t.controls.title.touched&&!t.controls.title.valid)),m.xp6(2),m.Q6J("ngClass",m.VKq(11,N,t.controls.value.touched&&!t.controls.value.valid)),m.xp6(2),m.s9C("ngbTooltip",m.lcZ(9,5,"DELETE"))}}function M(t,e){if(1&t&&(m.TgZ(0,"tbody"),m.YNc(1,U,11,13,"tr",61),m.qZA()),2&t){const t=m.oxw(3);m.xp6(1),m.Q6J("ngForOf",t.arrayFields.options.controls)}}function L(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",52),m.TgZ(1,"table",53),m.TgZ(2,"colgroup"),m._UZ(3,"col",54),m._UZ(4,"col",54),m._UZ(5,"col",55),m._UZ(6,"col",56),m.qZA(),m.TgZ(7,"thead"),m.TgZ(8,"tr"),m.TgZ(9,"th"),m._uU(10),m.ALo(11,"translate"),m.qZA(),m.TgZ(12,"th"),m._uU(13),m.ALo(14,"translate"),m.qZA(),m.TgZ(15,"th"),m._uU(16),m.ALo(17,"translate"),m.qZA(),m._UZ(18,"th"),m.qZA(),m.qZA(),m.YNc(19,M,2,1,"tbody",34),m.TgZ(20,"tfoot"),m.TgZ(21,"tr",57),m.TgZ(22,"td",58),m.TgZ(23,"button",59),m.NdJ("click",function(e){return m.CHM(t),m.oxw(2).arrayFieldAdd("options",e)}),m._UZ(24,"i",60),m._uU(25," \xa0 "),m.TgZ(26,"span"),m._uU(27),m.ALo(28,"translate"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()}if(2&t){const t=m.oxw(2);m.xp6(10),m.Oqu(m.lcZ(11,5,"SYSTEM_NAME")),m.xp6(3),m.Oqu(m.lcZ(14,7,"NAME")),m.xp6(3),m.Oqu(m.lcZ(17,9,"VALUE")),m.xp6(3),m.Q6J("ngIf",t.arrayFields.options),m.xp6(8),m.Oqu(m.lcZ(28,11,"ADD"))}}function w(t,e){if(1&t&&(m.ynx(0),m._uU(1),m.BQk()),2&t){const t=m.oxw(2).$implicit;m.xp6(1),m.hij(" ",t.title," ")}}function O(t,e){if(1&t&&(m.TgZ(0,"a",87),m._uU(1),m.qZA()),2&t){const t=m.oxw(2).$implicit,e=m.oxw(3);m.hYB("href","",e.baseUrl,"",t.uri,"",m.LSH),m.xp6(1),m.hij(" ",t.title," ")}}function R(t,e){if(1&t&&(m.TgZ(0,"div"),m._UZ(1,"i",88),m._uU(2,"\xa0 "),m._UZ(3,"span",89),m.qZA()),2&t){const t=m.oxw(2).$implicit;m.xp6(3),m.Q6J("innerHTML",t.filesString,m.oJD)}}function k(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"tr",78),m.TgZ(2,"td"),m._uU(3),m.qZA(),m.TgZ(4,"td"),m.YNc(5,w,2,1,"ng-container",79),m.YNc(6,O,2,3,"ng-template",null,80,m.W1O),m.TgZ(8,"div",81),m._uU(9),m.YNc(10,R,4,1,"div",34),m.qZA(),m.qZA(),m.TgZ(11,"td",82),m._uU(12),m.ALo(13,"number"),m.qZA(),m.TgZ(14,"td",65),m._uU(15),m.qZA(),m.TgZ(16,"td",82),m.TgZ(17,"div",83),m.TgZ(18,"div",84),m.TgZ(19,"button",85),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(3).editContentToggle(e)}),m.ALo(20,"translate"),m._UZ(21,"i",86),m.qZA(),m.TgZ(22,"button",85),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(3).deleteContent(e)}),m.ALo(23,"translate"),m._UZ(24,"i",11),m.qZA(),m.qZA(),m.qZA(),m._uU(25),m.ALo(26,"number"),m.qZA(),m.qZA(),m.BQk()}if(2&t){const t=m.MAs(7),e=m.oxw().$implicit;m.xp6(1),m.Udp("text-decoration",e.deleted?"line-through":"none"),m.xp6(2),m.Oqu(e.id),m.xp6(2),m.Q6J("ngIf",!e.uri)("ngIfElse",t),m.xp6(4),m.hij(" ",e.parametersString," "),m.xp6(1),m.Q6J("ngIf",e.filesString),m.xp6(2),m.hij(" ",m.Dn7(13,12,e.price,"1.2-2","ru-RU")," "),m.xp6(3),m.hij(" ",e.count," "),m.xp6(4),m.s9C("ngbTooltip",m.lcZ(20,16,"EDIT")),m.xp6(3),m.s9C("ngbTooltip",m.lcZ(23,18,"DELETE")),m.xp6(3),m.hij(" ",m.Dn7(26,20,e.priceTotal,"1.2-2","ru-RU")," ")}}const D=function(){return{standalone:!0}};function J(t,e){if(1&t){const t=m.EpF();m.ynx(0),m.TgZ(1,"tr",90),m.TgZ(2,"td"),m._uU(3),m.qZA(),m.TgZ(4,"td"),m._uU(5),m.qZA(),m.TgZ(6,"td",82),m.TgZ(7,"input",91),m.NdJ("ngModelChange",function(e){return m.CHM(t),m.oxw().$implicit.price=e})("ngModelChange",function(){return m.CHM(t),m.oxw(4).priceTotalUpdate()}),m.qZA(),m.qZA(),m.TgZ(8,"td",92),m.TgZ(9,"input",93),m.NdJ("ngModelChange",function(e){return m.CHM(t),m.oxw().$implicit.count=e})("ngModelChange",function(){return m.CHM(t),m.oxw(4).priceTotalUpdate()}),m.qZA(),m.TgZ(10,"button",85),m.NdJ("click",function(){m.CHM(t);const e=m.oxw().$implicit;return m.oxw(3).editContentToggle(e)}),m.ALo(11,"translate"),m._UZ(12,"i",94),m.qZA(),m.TgZ(13,"button",85),m.NdJ("click",function(){return m.CHM(t),m.oxw(4).editContentCancel()}),m.ALo(14,"translate"),m._UZ(15,"i",95),m.qZA(),m.qZA(),m.qZA(),m.BQk()}if(2&t){const t=m.oxw().$implicit;m.xp6(3),m.Oqu(t.id),m.xp6(2),m.hij(" ",t.title," "),m.xp6(2),m.Q6J("ngModel",t.price)("ngModelOptions",m.DdM(12,D)),m.xp6(2),m.Q6J("ngModel",t.count)("ngModelOptions",m.DdM(13,D)),m.xp6(1),m.s9C("ngbTooltip",m.lcZ(11,8,"ACCEPT")),m.xp6(3),m.s9C("ngbTooltip",m.lcZ(14,10,"CANCEL"))}}function F(t,e){if(1&t&&(m.ynx(0),m.YNc(1,k,27,24,"ng-container",34),m.YNc(2,J,16,14,"ng-container",34),m.BQk()),2&t){const t=e.$implicit,n=m.oxw(3);m.xp6(1),m.Q6J("ngIf",!n.getIsContentEdit(t)),m.xp6(1),m.Q6J("ngIf",n.getIsContentEdit(t))}}function Y(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1),m.ALo(2,"number"),m.qZA()),2&t){const t=m.oxw(4);m.xp6(1),m.Oqu(m.Dn7(2,1,t.model.discount,"1.2-2","ru-RU"))}}function Q(t,e){if(1&t&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&t){const t=m.oxw(4);m.xp6(1),m.hij("",t.model.discountPercent,"%")}}function j(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"tr"),m._UZ(2,"td"),m.TgZ(3,"td",74),m._uU(4),m.ALo(5,"translate"),m.qZA(),m.TgZ(6,"td",65),m.YNc(7,Y,3,5,"span",34),m.YNc(8,Q,2,1,"span",34),m.qZA(),m.qZA(),m.BQk()),2&t){const t=m.oxw(3);m.xp6(4),m.Oqu(m.lcZ(5,3,"DISCOUNT")),m.xp6(3),m.Q6J("ngIf",t.model.discount),m.xp6(1),m.Q6J("ngIf",t.model.discountPercent)}}function P(t,e){if(1&t&&(m.ynx(0),m.TgZ(1,"div",96),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.BQk()),2&t){const t=m.oxw(3);m.xp6(2),m.AsE(" ",m.lcZ(3,2,"PROMO_CODE"),": ",t.model.promoCode," ")}}function $(t,e){if(1&t&&(m.TgZ(0,"table",53),m.TgZ(1,"colgroup"),m._UZ(2,"col",68),m._UZ(3,"col",69),m._UZ(4,"col",70),m._UZ(5,"col",71),m._UZ(6,"col",72),m.qZA(),m.TgZ(7,"thead"),m.TgZ(8,"tr"),m.TgZ(9,"th"),m._uU(10,"ID"),m.qZA(),m.TgZ(11,"th"),m._uU(12),m.ALo(13,"translate"),m.qZA(),m.TgZ(14,"th",65),m._uU(15),m.ALo(16,"translate"),m.qZA(),m.TgZ(17,"th",65),m._uU(18),m.ALo(19,"translate"),m.qZA(),m.TgZ(20,"th",65),m._uU(21),m.ALo(22,"translate"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(23,"tbody"),m.YNc(24,F,3,2,"ng-container",73),m.YNc(25,j,9,5,"ng-container",34),m.TgZ(26,"tr"),m._UZ(27,"td"),m.TgZ(28,"td",74),m._uU(29),m.ALo(30,"translate"),m.qZA(),m.TgZ(31,"td",65),m._uU(32),m.ALo(33,"number"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(34,"tfoot"),m.TgZ(35,"tr"),m.TgZ(36,"td",75),m._uU(37),m.ALo(38,"translate"),m.qZA(),m.TgZ(39,"td",76),m.TgZ(40,"b"),m._uU(41),m.ALo(42,"number"),m.qZA(),m._uU(43," \xa0 "),m.TgZ(44,"span",77),m._uU(45),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(46,P,4,4,"ng-container",34)),2&t){const t=m.oxw(2);m.xp6(12),m.Oqu(m.lcZ(13,12,"NAME")),m.xp6(3),m.Oqu(m.lcZ(16,14,"PRICE")),m.xp6(3),m.Oqu(m.lcZ(19,16,"QUANTITY")),m.xp6(3),m.Oqu(m.lcZ(22,18,"PRICE_TOTAL")),m.xp6(3),m.Q6J("ngForOf",t.model.content),m.xp6(1),m.Q6J("ngIf",t.model.discount||t.model.discountPercent),m.xp6(4),m.Oqu(m.lcZ(30,20,"DELIVERY")),m.xp6(3),m.hij(" ",m.Dn7(33,22,t.model.deliveryPrice,"1.2-2","ru-RU")," "),m.xp6(5),m.hij(" ",m.lcZ(38,26,"PRICE_TOTAL"),": "),m.xp6(4),m.Oqu(m.Dn7(42,28,t.model.price,"1.2-2","ru-RU")),m.xp6(4),m.Oqu(t.model.currency),m.xp6(1),m.Q6J("ngIf",t.model.promoCode)}}function V(t,e){if(1&t){const t=m.EpF();m.TgZ(0,"div",97),m._uU(1),m.TgZ(2,"button",98),m.NdJ("click",function(){return m.CHM(t),m.oxw(2).errorMessage=""}),m.qZA(),m.qZA()}if(2&t){const t=m.oxw(2);m.xp6(1),m.hij(" ",t.errorMessage," ")}}function B(t,e){if(1&t&&(m.TgZ(0,"div"),m.TgZ(1,"ngb-accordion",47),m.TgZ(2,"ngb-panel",48),m.ALo(3,"translate"),m.YNc(4,L,29,13,"ng-template",49),m.qZA(),m.TgZ(5,"ngb-panel",50),m.ALo(6,"translate"),m.YNc(7,$,47,32,"ng-template",49),m.qZA(),m.qZA(),m.YNc(8,V,3,1,"div",51),m.qZA()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("closeOthers",!0),m.xp6(1),m.Q6J("title",m.lcZ(3,4,"OPTIONS")),m.xp6(3),m.Q6J("title",m.lcZ(6,6,"ORDER_CONTENT")),m.xp6(3),m.Q6J("ngIf",t.errorMessage)}}const H=function(t){return{"no-events":t}},G=function(t){return{"form-control-search-clear":t}};let z=(()=>{class t extends f.B{constructor(t,e,n,i,o,s,l,a){super(t,e,n,i,o,s),this.fb=t,this.activeModal=e,this.translateService=n,this.systemNameService=i,this.dataService=o,this.elRef=s,this.settingsService=l,this.appSettings=a,this.model=new c(0,0,"","",""),this.modalTitle="Order",this.formFields=[{name:"id",validators:[r.kI.required]},{name:"email",validators:[r.kI.required,this.emailValidator]},{name:"phone",validators:[]},{name:"fullName",validators:[r.kI.required]},{name:"comment",validators:[]},{name:"deliveryName",validators:[]},{name:"paymentName",validators:[]},{name:"options",validators:[],children:[{name:"name",validators:[r.kI.required]},{name:"title",validators:[r.kI.required]},{name:"value",validators:[]}]},{name:"content",validators:[],children:[{name:"uniqId",validators:[]},{name:"id",validators:[]},{name:"price",validators:[]},{name:"count",validators:[]},{name:"deleted",validators:[]}]}],this.contentEdit=new d(0,"",0,0)}onBeforeInit(){this.baseUrl=this.appSettings.settings.webApiUrl+"/",this.settings=this.appSettings.settings.systemSettings}editContentToggle(t){if(this.getIsContentEdit(t)){const t=(0,l.findIndex)(this.model.content,{uniqId:this.contentEdit.uniqId,contentTypeName:this.contentEdit.contentTypeName});t>-1&&this.arrayFields.content.at(t).patchValue({price:this.model.content[t].price,count:this.model.content[t].count}),this.contentEdit=new d(0,"",0,0),this.priceTotalUpdate()}else this.contentEdit=(0,l.cloneDeep)(t)}editContentCancel(){if(!this.contentEdit.uniqId)return;const t=(0,l.findIndex)(this.model.content,{uniqId:this.contentEdit.uniqId,contentTypeName:this.contentEdit.contentTypeName});t>-1&&(this.model.content[t]=(0,l.cloneDeep)(this.contentEdit),this.contentEdit=new d(0,"",0,0,""),this.priceTotalUpdate())}getIsContentEdit(t){return this.contentEdit.uniqId===t.uniqId&&this.contentEdit.contentTypeName===t.contentTypeName}deleteContent(t){const e=(0,l.findIndex)(this.model.content,{uniqId:t.uniqId,contentTypeName:t.contentTypeName});e>-1&&(this.arrayFields.content.at(e).get("deleted").setValue(!this.model.content[e].deleted),this.model.content[e].deleted=!this.model.content[e].deleted,this.priceTotalUpdate())}onDeliveryUpdate(){if(!this.settings||!this.settings.SETTINGS_DELIVERY)return;const t=(0,l.findIndex)(this.settings.SETTINGS_DELIVERY,{name:this.model.deliveryName});if(t>-1){const e=parseFloat(String(this.settings.SETTINGS_DELIVERY[t].options.price));this.model.deliveryPrice=e/(this.model.currencyRate||1),this.priceTotalUpdate()}}priceTotalUpdate(){let t=0;this.model.content.forEach(e=>{e instanceof d&&e.priceUpdate(),e.deleted||(t+=e.priceTotal)}),this.model.discount&&(t-=this.model.discount),this.model.discountPercent&&(t*=this.model.discountPercent/100),t+=this.model.deliveryPrice||0,this.model.price=Math.max(t,0)}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(r.qu),m.Y36(A.Kz),m.Y36(q.sK),m.Y36(b.U),m.Y36(g),m.Y36(m.SBq),m.Y36(Z.g),m.Y36(a.d))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-modal-order"]],features:[m._Bn([]),m.qOj],decls:103,vars:83,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"card","bg-light","mb-3"],[1,"card-body","p-2"],[1,"float-end"],["target","_blank",1,"btn","btn-info","btn-sm","btn-wide",3,"href"],[1,"icon-printer"],[1,"d-inline-block","p-1"],[1,"clearfix"],[1,"row"],[1,"col-lg-6"],[1,"mb-2","form-group-message"],[1,"label-filled"],["type","text","name","id","formControlName","id","readonly","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","title","formControlName","email",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["class","alert alert-danger",4,"ngIf"],["type","text","name","title","formControlName","fullName",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["type","text","name","phone","formControlName","phone",1,"form-control",3,"ngModel","ngModelChange"],["name","comment","formControlName","comment","rows","5",1,"form-control",3,"ngModel","ngModelChange"],["name","deliveryName","formControlName","deliveryName",1,"form-select",3,"ngModel","ngModelChange"],[4,"ngIf"],["name","paymentName","formControlName","paymentName",1,"form-select",3,"ngModel","ngModelChange"],[1,"modal-footer","d-block"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["activeIds","accordion-order-content",1,"ngb-accordion",3,"closeOthers"],["id","accordion-order-options",3,"title"],["ngbPanelContent",""],["id","accordion-order-content",3,"title"],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],["formArrayName","options"],[1,"table","table-bordered","mb-0"],["width","27%"],["width","39%"],["width","7%"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control","form-control-sm",3,"ngClass"],["type","text","formControlName","title",1,"form-control","form-control-sm",3,"ngClass"],[1,"text-center"],["type","text","formControlName","value",1,"form-control","form-control-sm",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],["width","10%"],["width","30%"],["width","20%"],["width","15%"],["width","25%"],[4,"ngFor","ngForOf"],["colspan","3"],["colspan","4",1,"text-end"],[1,"text-center","big"],[1,"small"],[1,"show-on-hover-parent"],[4,"ngIf","ngIfElse"],["productLink",""],[1,"text-muted","small"],[1,"text-center","pr-2"],[1,"relative"],[1,"show-on-hover-right","no-wrap"],["type","button",1,"btn","btn-secondary","btn-sm","ms-2",3,"ngbTooltip","click"],[1,"icon-pencil"],["target","_blank",3,"href"],[1,"icon-file"],[3,"innerHTML"],[1,"table-warning"],["type","number","name","price[]","min","0","step","0.01",1,"d-inline-block","form-control","form-control-sm",2,"width","100px",3,"ngModel","ngModelOptions","ngModelChange"],["colspan","2",1,"no-wrap"],["type","number","name","count[]","min","1","step","1",1,"d-inline-block","form-control","form-control-sm",2,"width","60px",3,"ngModel","ngModelOptions","ngModelChange"],[1,"icon-check"],[1,"icon-ban"],[1,"pt-3"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"close",3,"click"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"button",2),m.NdJ("click",function(t){return e.closeModal(t)}),m._UZ(3,"i",3),m.TgZ(4,"span"),m._uU(5),m.ALo(6,"translate"),m.qZA(),m.qZA(),m.TgZ(7,"button",2),m.NdJ("click",function(t){return e.minimize(t)}),m._UZ(8,"i",4),m.TgZ(9,"span"),m._uU(10),m.ALo(11,"translate"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(12,"div",5),m.TgZ(13,"div",6),m.TgZ(14,"div",7),m.TgZ(15,"button",8),m.NdJ("click",function(t){return e.maximize(t)}),m.ALo(16,"translate"),m._UZ(17,"i",9),m.qZA(),m.TgZ(18,"button",10),m.NdJ("click",function(t){return e.closeModal(t)}),m.ALo(19,"translate"),m._UZ(20,"i",11),m.qZA(),m.qZA(),m.qZA(),m.TgZ(21,"h4",12),m._uU(22),m.qZA(),m.qZA(),m.TgZ(23,"form",13,14),m.NdJ("ngSubmit",function(){return e.onSubmit()}),m.TgZ(25,"div",15),m.TgZ(26,"div",16),m.TgZ(27,"div",17),m.TgZ(28,"div",18),m.TgZ(29,"a",19),m._UZ(30,"i",20),m._uU(31),m.ALo(32,"translate"),m.qZA(),m.qZA(),m.TgZ(33,"div",21),m._uU(34),m.ALo(35,"date"),m.qZA(),m._UZ(36,"div",22),m.qZA(),m.qZA(),m.TgZ(37,"div",23),m.TgZ(38,"div",24),m.TgZ(39,"div",25),m.TgZ(40,"label",26),m._uU(41),m.ALo(42,"translate"),m.qZA(),m.TgZ(43,"input",27),m.NdJ("ngModelChange",function(t){return e.model.id=t}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(44,"div",24),m.TgZ(45,"div",25),m.TgZ(46,"label",26),m._uU(47),m.ALo(48,"translate"),m.qZA(),m.TgZ(49,"input",28),m.NdJ("ngModelChange",function(t){return e.model.email=t}),m.qZA(),m.YNc(50,x,2,1,"div",29),m.qZA(),m.qZA(),m.qZA(),m.TgZ(51,"div",23),m.TgZ(52,"div",24),m.TgZ(53,"div",25),m.TgZ(54,"label",26),m._uU(55),m.ALo(56,"translate"),m.qZA(),m.TgZ(57,"input",30),m.NdJ("ngModelChange",function(t){return e.model.fullName=t}),m.qZA(),m.YNc(58,E,2,1,"div",29),m.qZA(),m.TgZ(59,"div",25),m.TgZ(60,"label",26),m._uU(61),m.ALo(62,"translate"),m.qZA(),m.TgZ(63,"input",31),m.NdJ("ngModelChange",function(t){return e.model.phone=t}),m.qZA(),m.YNc(64,y,2,1,"div",29),m.qZA(),m.qZA(),m.TgZ(65,"div",24),m.TgZ(66,"div",25),m.TgZ(67,"label",26),m._uU(68),m.ALo(69,"translate"),m.qZA(),m.TgZ(70,"textarea",32),m.NdJ("ngModelChange",function(t){return e.model.comment=t}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(71,"div",23),m.TgZ(72,"div",24),m.TgZ(73,"div",25),m.TgZ(74,"label",26),m._uU(75),m.ALo(76,"translate"),m.qZA(),m.TgZ(77,"select",33),m.NdJ("ngModelChange",function(t){return e.model.deliveryName=t})("ngModelChange",function(){return e.onDeliveryUpdate()}),m.YNc(78,_,2,1,"ng-container",34),m.qZA(),m.qZA(),m.qZA(),m.TgZ(79,"div",24),m.TgZ(80,"div",25),m.TgZ(81,"label",26),m._uU(82),m.ALo(83,"translate"),m.qZA(),m.TgZ(84,"select",35),m.NdJ("ngModelChange",function(t){return e.model.paymentName=t}),m.YNc(85,S,2,1,"ng-container",34),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(86,B,9,8,"div",34),m.qZA(),m.TgZ(87,"div",36),m.TgZ(88,"div",37),m.TgZ(89,"button",38),m.NdJ("click",function(t){return e.save(!0,t)}),m.TgZ(90,"span"),m._uU(91),m.ALo(92,"translate"),m.qZA(),m.qZA(),m.TgZ(93,"div",39),m._UZ(94,"button",40),m.TgZ(95,"div",41),m.TgZ(96,"button",42),m.NdJ("click",function(t){return e.save(!1,t)}),m._uU(97),m.ALo(98,"translate"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(99,"button",43),m.NdJ("click",function(t){return e.closeModal(t)}),m.TgZ(100,"span"),m._uU(101),m.ALo(102,"translate"),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(2),m.Q6J("disabled",e.submitted),m.xp6(3),m.Oqu(m.lcZ(6,44,"CLOSE")),m.xp6(2),m.Q6J("disabled",e.submitted),m.xp6(3),m.Oqu(m.lcZ(11,46,"MINIMIZE")),m.xp6(5),m.Q6J("title",m.lcZ(16,48,"EXPAND")),m.xp6(3),m.Q6J("title",m.lcZ(19,50,"CLOSE")),m.xp6(4),m.Oqu(e.modalTitle),m.xp6(1),m.Q6J("formGroup",e.form)("ngClass",m.VKq(77,H,e.submitted)),m.xp6(2),m.ekj("loading",e.loading),m.xp6(4),m.hYB("href","",e.baseUrl,"admin/orders/print/",e.model.id,"",m.LSH),m.xp6(2),m.hij(" ",m.lcZ(32,52,"PRINT")," "),m.xp6(3),m.hij(" ",m.xi3(35,54,e.model.createdDate,"dd/MM/y H:mm:s")," "),m.xp6(7),m.hij(" ",m.lcZ(42,57,"ID")," "),m.xp6(2),m.ekj("is-invalid",e.formErrors.id),m.Q6J("ngModel",e.model.id),m.xp6(4),m.hij(" ",m.lcZ(48,59,"EMAIL")," "),m.xp6(2),m.Q6J("ngModel",e.model.email)("ngClass",m.VKq(79,N,e.form.controls.email.touched&&!e.form.controls.email.valid)),m.xp6(1),m.Q6J("ngIf",e.formErrors.email),m.xp6(5),m.hij(" ",m.lcZ(56,61,"FULL_NAME")," "),m.xp6(2),m.Q6J("ngModel",e.model.fullName)("ngClass",m.VKq(81,N,e.form.controls.fullName.touched&&!e.form.controls.fullName.valid)),m.xp6(1),m.Q6J("ngIf",e.formErrors.fullName),m.xp6(3),m.hij(" ",m.lcZ(62,63,"PHONE")," "),m.xp6(2),m.Q6J("ngModel",e.model.phone),m.xp6(1),m.Q6J("ngIf",e.formErrors.phone),m.xp6(4),m.hij(" ",m.lcZ(69,65,"COMMENT")," "),m.xp6(2),m.Q6J("ngModel",e.model.comment),m.xp6(5),m.hij(" ",m.lcZ(76,67,"DELIVERY_METHOD")," "),m.xp6(2),m.Q6J("ngModel",e.model.deliveryName),m.xp6(1),m.Q6J("ngIf",e.settings),m.xp6(4),m.hij(" ",m.lcZ(83,69,"PAYMENT_METHOD")," "),m.xp6(2),m.Q6J("ngModel",e.model.paymentName),m.xp6(1),m.Q6J("ngIf",e.settings),m.xp6(1),m.Q6J("ngIf",e.model.content),m.xp6(3),m.Q6J("disabled",e.submitted),m.xp6(2),m.Oqu(m.lcZ(92,71,"SAVE_AND_CLOSE")),m.xp6(3),m.Q6J("disabled",e.submitted),m.xp6(3),m.Oqu(m.lcZ(98,73,"SAVE")),m.xp6(4),m.Oqu(m.lcZ(102,75,"CLOSE")))},directives:[r._Y,r.JL,r.sg,i.mk,r.Fj,r.JJ,r.u,i.O5,r.EJ,A.jt,A.iD,A.Vi,A.TH,i.sg,r.YN,r.Kr,A.gY,A.Gk,A.gW,r.CE,r.x0,A._L,r.qQ,r.wV,r.On],pipes:[q.X$,i.uU,i.JJ],encapsulation:2}),t})();const K=[{path:"",component:(()=>{class t extends h.U{constructor(t,e,n,i){super(t,e,n,i),this.dataService=t,this.activeModal=e,this.modalService=n,this.translateService=i,this.queryOptions=new T.J("createdDate","desc",1,10,0,0),this.items=[],this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"status",sortName:"status",title:"STATUS",outputType:"status",outputProperties:{}},{name:"price",sortName:"price",title:"PRICE",outputType:"number",outputProperties:{}},{name:"contentCount",sortName:"contentCount",title:"CONTENT_COUNT",outputType:"text",outputProperties:{}},{name:"email",sortName:"email",title:"EMAIL",outputType:"userEmail",outputProperties:{}},{name:"createdDate",sortName:"createdDate",title:"DATE_TIME",outputType:"date",outputProperties:{format:"dd/MM/y H:mm:s"}}]}setModalInputs(t,e=!1,n=""){this.modalRef.componentInstance.modalTitle=`${this.getLangString("ORDER")} #${t}`,this.modalRef.componentInstance.modalId=n,this.modalRef.componentInstance.itemId=t||0,this.modalRef.componentInstance.isItemCopy=e||!1,this.modalRef.componentInstance.isEditMode=!0}getModalElementId(t){return["modal","order",t||0].join("-")}getModalContent(){return z}changeRequest(t){const[e,n,i]=t;e.id&&this.dataService.updateProperty(e.id,n,i).subscribe(()=>{this.getList()})}}return t.title="ORDERS",t.\u0275fac=function(e){return new(e||t)(m.Y36(g),m.Y36(A.Kz),m.Y36(A.FF),m.Y36(q.sK))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-shk-orders"]],features:[m._Bn([g]),m.qOj],decls:31,vars:26,consts:[[1,"card"],[1,"card-body"],[1,"icon-bag"],[1,"mb-3"],[1,"float-md-start"],[1,"form-control-search","mb-2","mb-md-0",3,"ngClass"],["type","text",1,"form-control","min-width250",3,"placeholder","ngModel","ngModelChange"],[3,"click"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu",""],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-secondary","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"float-start"],[1,"clearfix"],[1,"min-height400"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","isCloneAllowed","selectedIdsChange","loadingChange","actionRequest","changeRequest"],["table",""]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"h3"),m._UZ(3,"i",2),m._uU(4),m.ALo(5,"translate"),m.qZA(),m._UZ(6,"hr"),m.TgZ(7,"div",3),m.TgZ(8,"div",4),m.TgZ(9,"div",5),m.TgZ(10,"input",6),m.NdJ("ngModelChange",function(t){return e.queryOptions.search_word=t})("ngModelChange",function(){return e.onSearchWordUpdate()}),m.ALo(11,"translate"),m.qZA(),m.TgZ(12,"span",7),m.NdJ("click",function(){return e.onSearchWordUpdate("")}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(13,"div",8),m.TgZ(14,"div",9),m.TgZ(15,"button",10),m.TgZ(16,"span"),m._uU(17),m.ALo(18,"translate"),m.qZA(),m.qZA(),m.TgZ(19,"div",11),m.TgZ(20,"button",12),m.NdJ("click",function(){return e.deleteSelected()}),m._uU(21),m.ALo(22,"translate"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(23,"button",13),m.NdJ("click",function(){return e.getList()}),m.ALo(24,"translate"),m._UZ(25,"i",14),m.qZA(),m.qZA(),m._UZ(26,"div",15),m._UZ(27,"div",16),m.qZA(),m.TgZ(28,"div",17),m.TgZ(29,"app-table",18,19),m.NdJ("selectedIdsChange",function(t){return e.selectedIds=t})("loadingChange",function(t){return e.loading=t})("actionRequest",function(t){return e.actionRequest(t)})("changeRequest",function(t){return e.changeRequest(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(4),m.hij(" ",m.lcZ(5,14,"ORDERS")," "),m.xp6(5),m.Q6J("ngClass",m.VKq(24,G,!!e.queryOptions.search_word)),m.xp6(1),m.MGl("placeholder","",m.lcZ(11,16,"SEARCH"),"..."),m.Q6J("ngModel",e.queryOptions.search_word),m.xp6(7),m.Oqu(m.lcZ(18,18,"BATCH_ACTIONS")),m.xp6(4),m.Oqu(m.lcZ(22,20,"DELETE")),m.xp6(2),m.s9C("ngbTooltip",m.lcZ(24,22,"REFRESH")),m.xp6(6),m.Q6J("items",e.items)("selectedIds",e.selectedIds)("collectionSize",e.collectionSize)("queryOptions",e.queryOptions)("tableFields",e.tableFields)("loading",e.loading)("isCloneAllowed",!1))},directives:[i.mk,r.Fj,r.JJ,r.On,A.jt,A.iD,A.Vi,A._L,v.a],pipes:[q.X$],encapsulation:2}),t})()}];let W=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[s.Bz.forChild(K)],s.Bz]}),t})(),X=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({providers:[g],imports:[[i.ez,o.m,W]]}),t})()},85697:function(t,e,n){"use strict";n.d(e,{U:function(){return u}});var i=n(55959),o=n(25416),s=n(19947),r=n(88857),l=n(84565),a=n(35366),d=n(72431),c=n(60649);const h=["table"];let u=(()=>{class t{constructor(t,e,n,o){this.dataService=t,this.activeModal=e,this.modalService=n,this.translateService=o,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new s.J("name","asc",1,10,0,0),this.destroyed$=new i.xQ}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(t){}onSearchWordUpdate(t){if(void 0!==t)return this.queryOptions.search_word=t,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(t){return["modal",t||0].join("-")}setModalInputs(t,e=!1,n=""){const i=void 0!==t&&!e;this.modalRef.componentInstance.modalTitle=this.getLangString(i?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=n,this.modalRef.componentInstance.itemId=t||0,this.modalRef.componentInstance.isItemCopy=e||!1,this.modalRef.componentInstance.isEditMode=i}modalOpen(t,e=!1){const n=this.getModalElementId(t);if(window.document.body.classList.add("modal-open"),window.document.getElementById(n)){const t=window.document.getElementById(n),e=t.previousElementSibling;return t.classList.add("d-block"),t.classList.remove("modal-minimized"),void e.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(t,e,n),this.modalRef.result.then(t=>{this.destroyed$.isStopped||(this.onModalClose(t),this.getList())},t=>{this.destroyed$.isStopped||(this.onModalClose(t),t&&["submit","updated"].indexOf(t)>-1&&this.getList())})}deleteItemConfirm(t){this.modalRef=this.modalService.open(l.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(e=>{"accept"===e&&this.deleteItem(t)})}getLangString(t){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][t]||t}confirmAction(t){return this.modalRef=this.modalService.open(l.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=t,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(t=>{"accept"===t&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(t){this.modalRef=this.modalService.open(l.$N),this.modalRef.componentInstance.modalContent=t,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(t){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(e=>{"accept"===e&&this.dataService.deleteItem(t).subscribe(t=>{this.getList()},t=>{t.error&&this.showAlert(t.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(t){switch(t[0]){case"edit":this.modalOpen(t[1]);break;case"copy":this.modalOpen(t[1],!0);break;case"delete":this.deleteItem(t[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe((0,o.R)(this.destroyed$)).subscribe({next:t=>{this.items=t.items,this.collectionSize=t.total,this.loading=!1},error:t=>{this.items=[],this.collectionSize=0,t.error&&this.showAlert(t.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return t.title="",t.\u0275fac=function(e){return new(e||t)(a.Y36(r.D),a.Y36(d.Kz),a.Y36(d.FF),a.Y36(c.sK))},t.\u0275dir=a.lG2({type:t,viewQuery:function(t,e){if(1&t&&a.Gf(h,7),2&t){let t;a.iGM(t=a.CRH())&&(e.table=t.first)}}}),t})()},11026:function(t,e,n){"use strict";n.d(e,{e:function(){return i}});class i{constructor(t,e,n,i,o){this.changed=t,this.loading=e,this.values=n,this.defaultOptions=i,this.defaultValues=o}}},89223:function(t,e,n){"use strict";n.d(e,{g:function(){return a}});var i=n(42693),o=n(40878),s=n(47727),r=(n(11026),n(93724)),l=n(35366);let a=(()=>{class t{constructor(t){this.http=t,this.headers=new i.WM({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),this.requestUrl="",this.baseUrl="",this.requestUrl="/admin/settings",this.baseUrl=r.d.getBaseUrl()}setRequestUrl(t){this.requestUrl=t}getRequestUrl(){return this.requestUrl}getList(){return this.http.get(this.getRequestUrl()).pipe((0,s.K)(this.handleError()))}clearSystemCache(){const t=this.getRequestUrl()+"/clear_system_cache";return this.http.post(t,{},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}runActionPost(t){const e=this.getRequestUrl()+`/${t}`;return this.http.post(e,{},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}updateGroup(t,e){const n=this.getRequestUrl()+`/${t}`;return this.http.put(n,e,{headers:this.headers}).pipe((0,s.K)(this.handleError()))}getComposerPackagesList(){return this.http.get(this.getRequestUrl()+"_composer_installed_packages").pipe((0,s.K)(this.handleError()))}composerRequirePackage(t,e){const n=this.getRequestUrl()+"_composer_require_package";return this.http.post(n,{packageName:t,packageVersion:e},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}postFormData(t,e){const n=new i.WM({enctype:"multipart/form-data",Accept:"application/json","X-Requested-With":"XMLHttpRequest"});return this.http.post(this.baseUrl+e,t,{headers:n}).pipe((0,s.K)(this.handleError()))}runAction(t){return this.http.post(this.baseUrl+t,{},{headers:this.headers}).pipe((0,s.K)(this.handleError()))}handleError(t="operation",e){return t=>{if(!(t.status&&[401,403].indexOf(t.status)>-1)){if(t.error)throw t.error;return(0,o.of)(e)}window.location.href=this.baseUrl+"/login"}}}return t.\u0275fac=function(e){return new(e||t)(l.LFG(i.eN))},t.\u0275prov=l.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);