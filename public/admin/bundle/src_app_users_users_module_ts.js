"use strict";(self.webpackChunkshk_app=self.webpackChunkshk_app||[]).push([["src_app_users_users_module_ts"],{3240:(x,y,r)=>{r.d(y,{B:()=>S});var _=r(9133),q=r(3405),Z=r(8805),m=r(1599),v=r(103),h=r(3668),M=r(7283),L=r(8319);const I=["formEl"];let S=(()=>{class g{constructor(e,t,s,a,u,f){this.fb=e,this.activeModal=t,this.translateService=s,this.systemNameService=a,this.dataService=u,this.elRef=f,this.modalId="",this._formFieldsErrors={},this.submitted=!1,this.loading=!1,this.dataLoaded=!1,this.closeReason="canceled",this.files={},this.formFields=[],this.arrayFields={},this.isSaveButtonDisabled=!1,this.localeDefault="",this.localeCurrent="",this.localeFieldsAllowed=[],this.localePreviousValues={},this.uniqueId="",this.destroyed$=new q.xQ}set formErrors(e){for(const t in e)if(e.hasOwnProperty(t)){const s=this.getControl(this.form,null,t);s&&s.setErrors({incorrect:!0})}this._formFieldsErrors=e}get formErrors(){return this._formFieldsErrors}ngOnInit(){this.uniqueId=this.createUniqueId(),this.elRef&&this.getRootElement().setAttribute("id",this.modalId),this.onBeforeInit(),this.buildForm(),this.isEditMode||this.isItemCopy?this.getModelData().then(()=>{this.onAfterGetData()}):this.onAfterGetData(),this.onAfterInit()}onBeforeInit(){}onAfterInit(){}onAfterGetData(){this.dataLoaded=!0,this.buildControls(this.form,this.formFields)}getSystemFieldName(){return""}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang][e]||e}getModelData(){return this.loading=!0,new Promise((e,t)=>{this.dataService.getItem(this.itemId).pipe((0,Z.R)(this.destroyed$)).subscribe({next:s=>{if(this.isItemCopy){s.id=null;const a=this.getSystemFieldName();a&&(s[a]="")}Object.assign(this.model,s),this.loading=!1,e(s)},error:s=>{this.errorMessage=s.error||this.getLangString("ERROR"),this.loading=!1,t(s)}})})}buildForm(e="form",t=null,s=null,a="model"){t||(t=this.formFields),this[e]=this.fb.group(this.buildControls(null,t,a)),this[e].valueChanges.pipe((0,Z.R)(this.destroyed$)).subscribe(()=>this.onValueChanged(e,s))}buildControls(e=null,t=[],s="model"){const a={};return t.forEach(u=>{const f=e?this.getControl(e,u):null;let A=null;if(s&&this[s]?(this[s].options||(this[s].options={}),A=0===u.name.indexOf("options_")?this[s].options[u.name.substr(8)]||null:this[s][u.name]||null):A=null,f)if(u.disabled&&f.disable(),u.children){const p=A,T=f;T.clear(),p.forEach((k,F)=>{const O=this.getFormFieldByName(u.name),R=this.buildControls(null,O.children,null);T.push(this.fb.group(R))}),T.patchValue(p)}else f.setValue(A);else u.children?(a[u.name]=this.fb.array([]),this.createArrayFieldsProperty(u.name)):a[u.name]=this.fb.control({value:A,disabled:u.disabled||!1},u.validators)}),a}onValueChanged(e="form",t=null){this[e]&&(t||(t=this.formErrors),this[e].valid&&(this.errorMessage=""),Object.keys(this[e].value).forEach(a=>{t[a]="";const u=this.getControl(this[e],null,a);if(u&&!u.valid&&u.errors){let f="";Object.keys(u.errors).forEach(A=>{f+=(f?" ":"")+this.getLangString("INVALID_"+A.toUpperCase())}),t[a]=f}}))}getFormFieldByName(e){const t=this.formFields.filter(s=>s.name===e);return t.length>0?t[0]:null}createArrayFieldsProperty(e){Object.defineProperty(this.arrayFields,e,{get:()=>this.form?this.form.get(e):null})}getControl(e,t,s){return e?e.get(s||t.name):null}focusFormError(){setTimeout(()=>{this.formEl.nativeElement.querySelector(".form-control.is-invalid")&&this.formEl.nativeElement.querySelector(".form-control.is-invalid").focus()},1)}formGroupMarkTouched(e){Object.keys(e.controls).forEach(t=>{e.controls[t].markAsTouched(),e.controls[t]instanceof _.Oe&&Array.from(this.form.controls[t].controls).forEach(s=>{this.formGroupMarkTouched(s)})})}getSaveRequest(e){return e.id||"root"===e.name?this.dataService.update(e):this.dataService.create(e)}getFormData(){const e=this.form.value;return e.id=this.model.id||0,void 0!==this.model.translations&&(e.translations=this.model.translations||null),e}arrayFieldDelete(e,t,s){s&&s.preventDefault(),this.arrayFields[e].removeAt(t)}arrayFieldAdd(e,t){t&&t.preventDefault();const s=this.getFormFieldByName(e);if(!s)return;const a=this.buildControls(null,s.children,null);this.arrayFields[e].push(this.fb.group(a))}generateName(e,t,s=null){t&&t.preventDefault(),s||(s=this.form);const a=this.getControl(s,null,"title").value||"";e.name=this.systemNameService.generateName(a),this.getControl(s,null,"name").setValue(e.name)}closeModal(e){e&&e.preventDefault(),this.close(this.closeReason)}close(e,t){t&&t.preventDefault(),"submit"===e?this.activeModal.close(e):this.activeModal.dismiss(e)}minimize(e){e&&e.preventDefault(),window.document.body.classList.remove("modal-open");const t=this.getRootElement(),s=t.previousElementSibling;t.classList.remove("d-block"),t.classList.add("modal-minimized"),s.classList.add("d-none")}maximize(e){e&&e.preventDefault(),window.document.body.classList.add("modal-open");const t=this.getRootElement(),s=t.previousElementSibling;t.classList.add("d-block"),t.classList.remove("modal-minimized"),s.classList.remove("d-none")}save(e=!1,t){t&&t.preventDefault(),this.onSubmit(e)}saveFiles(e){if(0===Object.keys(this.files).length)return void this.close("submit");const t=new FormData;for(const s in this.files)this.files.hasOwnProperty(s)&&this.files[s]instanceof File&&t.append(s,this.files[s],this.files[s].name);t.append("itemId",String(e)),this.dataService.postFormData(t).pipe((0,Z.R)(this.destroyed$)).subscribe({next:()=>{this.close("submit")},error:s=>{this.errorMessage=s.error||this.getLangString("ERROR"),this.submitted=!1,this.loading=!1}})}onSubmit(e=!1){if(this.formGroupMarkTouched(this.form),!this.form.valid)return this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS"),void this.focusFormError();this.errorMessage="",this.loading=!0,this.submitted=!0;const t=this.getFormData();this.getSaveRequest(t).pipe((0,Z.R)(this.destroyed$)).subscribe({next:s=>{Object.keys(this.files).length>0?this.saveFiles(s._id||s.id):e&&this.close("submit"),s&&s.id&&(this.model.id=s.id),this.closeReason="updated",this.loading=!1,this.submitted=!1},error:s=>{s.error&&(this.errorMessage=s.error),s.errors&&(this.formErrors=s.errors,this.errorMessage=this.getLangString("PLEASE_FIX_FORM_ERRORS")),this.loading=!1,this.submitted=!1}})}onLocaleSwitch(){if(this.localeCurrent===this.localeDefault)return this.localeFieldsAllowed.forEach(e=>{this.model[e]=this.localePreviousValues[e],this.getControl(this.form,null,e).setValue(this.localePreviousValues[e])}),void(this.isSaveButtonDisabled=!1);this.model.translations||(this.model.translations={}),this.isSaveButtonDisabled=!0,this.localeFieldsAllowed.forEach(e=>{this.localePreviousValues[e]=this.getControl(this.form,null,e).value,this.model.translations[e]?(this.model[e]=this.model.translations[e][this.localeCurrent]||"",this.getControl(this.form,null,e).setValue(this.model[e])):(this.model[e]="",this.getControl(this.form,null,e).setValue(""))})}saveTranslations(e){e&&e.preventDefault(),this.localeFieldsAllowed.forEach(t=>{this.getControl(this.form,null,t)&&this.getControl(this.form,null,t).value?(this.model.translations[t]||(this.model.translations[t]={}),this.model.translations[t][this.localeCurrent]=this.getControl(this.form,null,t).value):this.model.translations[t]&&(this.model.translations[t][this.localeCurrent]&&delete this.model.translations[t][this.localeCurrent],0===Object.keys(this.model.translations[t]).length&&delete this.model.translations[t])}),this.localeCurrent=this.localeDefault,this.onLocaleSwitch()}emailValidator(e){return e.value?/\S+@\S+\.\S+/.test(e.value)?void 0:{email:!0}:{required:!0}}getRootElement(){return this.elRef.nativeElement.parentNode.parentNode.parentNode}createUniqueId(){return Math.random().toString(36).substr(2,9)}displayToggle(e,t,s){s&&s.preventDefault(),e.style.display=(t=t||"none"===e.style.display)?"block":"none"}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return g.\u0275fac=function(e){return new(e||g)(h.Y36(_.qu),h.Y36(M.Kz),h.Y36(L.sK),h.Y36(v.U),h.Y36(m.D),h.Y36(h.SBq))},g.\u0275cmp=h.Xpm({type:g,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&h.Gf(I,5),2&e){let s;h.iGM(s=h.CRH())&&(t.formEl=s.first)}},inputs:{modalTitle:"modalTitle",itemId:"itemId",modalId:"modalId",isItemCopy:"isItemCopy",isEditMode:"isEditMode"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),g})()},5243:(x,y,r)=>{r.d(y,{U:()=>S});var _=r(3405),q=r(8805),Z=r(417),m=r(1599),v=r(9985),h=r(3668),M=r(7283),L=r(8319);const I=["table"];let S=(()=>{class g{constructor(e,t,s,a){this.dataService=e,this.activeModal=t,this.modalService=s,this.translateService=a,this.items=[],this.loading=!1,this.selectedIds=[],this.collectionSize=0,this.queryOptions=new Z.J("name","asc",1,10,0,0),this.destroyed$=new _.xQ}ngOnInit(){this.getList(),this.afterInit()}afterInit(){}onSearchClear(){this.getList()}onModalClose(e){}onSearchWordUpdate(e){if(void 0!==e)return this.queryOptions.search_word=e,this.queryOptions.page=1,void(this.queryOptions.search_word?this.getList():this.onSearchClear());clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.queryOptions.page=1,this.getList()},700)}getModalElementId(e){return["modal",e||0].join("-")}setModalInputs(e,t=!1,s=""){const a=void 0!==e&&!t;this.modalRef.componentInstance.modalTitle=this.getLangString(a?"EDITING":"ADD"),this.modalRef.componentInstance.modalId=s,this.modalRef.componentInstance.itemId=e||0,this.modalRef.componentInstance.isItemCopy=t||!1,this.modalRef.componentInstance.isEditMode=a}modalOpen(e,t=!1){const s=this.getModalElementId(e);if(window.document.body.classList.add("modal-open"),window.document.getElementById(s)){const a=window.document.getElementById(s),u=a.previousElementSibling;return a.classList.add("d-block"),a.classList.remove("modal-minimized"),void u.classList.remove("d-none")}this.modalRef=this.modalService.open(this.getModalContent(),{size:"lg",backdrop:"static",keyboard:!1,backdropClass:"modal-backdrop-left45",windowClass:"modal-left45",container:"#modals-container"}),this.setModalInputs(e,t,s),this.modalRef.result.then(a=>{this.destroyed$.isStopped||(this.onModalClose(a),this.getList())},a=>{this.destroyed$.isStopped||(this.onModalClose(a),a&&["submit","updated"].indexOf(a)>-1&&this.getList())})}deleteItemConfirm(e){this.modalRef=this.modalService.open(v.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=this.getLangString("YOU_SURE_YOU_WANT_DELETE"),this.modalRef.result.then(t=>{"accept"===t&&this.deleteItem(e)})}getLangString(e){return this.translateService.store.translations[this.translateService.currentLang]&&this.translateService.store.translations[this.translateService.currentLang][e]||e}confirmAction(e){return this.modalRef=this.modalService.open(v.q0),this.modalRef.componentInstance.modalTitle=this.getLangString("CONFIRM"),this.modalRef.componentInstance.modalContent=e,this.modalRef.result}blockSelected(){0!==this.selectedIds.length?this.dataService.actionBatch(this.selectedIds,"block").subscribe(e=>{this.clearSelected(),this.getList()},e=>this.showAlert(e.error||this.getLangString("ERROR"))):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}deleteSelected(){0!==this.selectedIds.length?this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE_SELECTED")).then(e=>{"accept"===e&&this.dataService.actionBatch(this.selectedIds,"delete").subscribe(t=>{this.clearSelected(),this.getList()},t=>this.showAlert(t.error||this.getLangString("ERROR")))}):this.showAlert(this.getLangString("NOTHING_IS_SELECTED"))}showAlert(e){this.modalRef=this.modalService.open(v.$N),this.modalRef.componentInstance.modalContent=e,this.modalRef.componentInstance.modalTitle=this.getLangString("ERROR"),this.modalRef.componentInstance.messageType="error"}deleteItem(e){this.confirmAction(this.getLangString("YOU_SURE_YOU_WANT_DELETE")).then(t=>{"accept"===t&&this.dataService.deleteItem(e).subscribe(s=>{this.getList()},s=>{s.error&&this.showAlert(s.error)})})}clearSelected(){this.table&&this.table.clearSelected()}actionRequest(e){switch(e[0]){case"edit":this.modalOpen(e[1]);break;case"copy":this.modalOpen(e[1],!0);break;case"delete":this.deleteItem(e[1]);break;case"changeQuery":this.getList()}}getList(){this.loading=!0,this.dataService.getListPage(this.queryOptions).pipe((0,q.R)(this.destroyed$)).subscribe({next:e=>{this.items=e.items,this.collectionSize=e.total,this.loading=!1},error:e=>{this.items=[],this.collectionSize=0,e.error&&this.showAlert(e.error),this.loading=!1}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}}return g.title="",g.\u0275fac=function(e){return new(e||g)(h.Y36(m.D),h.Y36(M.Kz),h.Y36(M.FF),h.Y36(L.sK))},g.\u0275dir=h.lG2({type:g,viewQuery:function(e,t){if(1&e&&h.Gf(I,7),2&e){let s;h.iGM(s=h.CRH())&&(t.table=s.first)}}}),g})()},808:(x,y,r)=>{r.r(y),r.d(y,{UsersModule:()=>H});var _=r(6019),q=r(7367),Z=r(8922),m=r(9133),v=r(8805),h=r(8053),M=r(3132);class I{constructor(c,o,n,d,l,E,U,D,X,tt,et){this.id=c,this.email=o,this.fullName=n,this.roles=d,this.isActive=l,this.options=E,this.role=U,this.phone=D,this.password=X,this.confirmPassword=tt,this.apiToken=et}}var S=r(5243),g=r(103),b=r(2047),e=r(1599),t=r(3668),s=r(4522);let a=(()=>{class i extends e.D{constructor(o){super(o),this.setRequestUrl("/admin/users")}getRolesList(){const o=this.getRequestUrl()+"/roles";return this.http.get(o,{headers:this.headers}).pipe((0,b.K)(this.handleError()))}createApiToken(){const o=this.getRequestUrl()+"/create_api_token";return this.http.post(o,{},{headers:this.headers}).pipe((0,b.K)(this.handleError()))}}return i.\u0275fac=function(o){return new(o||i)(t.LFG(s.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var u=r(6721),f=r(417),A=r(3240),p=r(7283),T=r(8319),k=r(9518);function F(i,c){if(1&i&&(t.TgZ(0,"div",51),t._uU(1),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.formErrors.email," ")}}function O(i,c){if(1&i&&(t.TgZ(0,"div",51),t._uU(1),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.formErrors.fullName," ")}}function R(i,c){if(1&i&&(t.TgZ(0,"div",51),t._uU(1),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.formErrors.phone," ")}}function w(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"option",52),t._uU(2),t.qZA(),t.BQk()),2&i){const o=c.$implicit;t.xp6(1),t.Q6J("value",o.name),t.xp6(1),t.Oqu(o.title)}}function P(i,c){if(1&i&&(t.TgZ(0,"div",51),t._uU(1),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.formErrors.password," ")}}function N(i,c){if(1&i&&(t.TgZ(0,"div",51),t._uU(1),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.formErrors.password," ")}}function J(i,c){if(1&i&&(t.TgZ(0,"div",51),t._uU(1),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.formErrors.confirmPassword," ")}}const C=function(i){return{"is-invalid":i}};function Y(i,c){if(1&i){const o=t.EpF();t.TgZ(0,"tr",64),t.TgZ(1,"td"),t._UZ(2,"input",65),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"input",66),t.qZA(),t.TgZ(5,"td",67),t._UZ(6,"input",68),t.qZA(),t.TgZ(7,"td",67),t.TgZ(8,"button",69),t.NdJ("click",function(d){const E=t.CHM(o).index;return t.oxw(3).arrayFieldDelete("options",E,d)}),t.ALo(9,"translate"),t._UZ(10,"i",11),t.qZA(),t.qZA(),t.qZA()}if(2&i){const o=c.$implicit;t.Q6J("formGroupName",c.index+""),t.xp6(2),t.Q6J("ngClass",t.VKq(7,C,o.controls.name.touched&&!o.controls.name.valid)),t.xp6(2),t.Q6J("ngClass",t.VKq(9,C,o.controls.title.touched&&!o.controls.title.valid)),t.xp6(2),t.Q6J("ngClass",t.VKq(11,C,o.controls.value.touched&&!o.controls.value.valid)),t.xp6(2),t.s9C("ngbTooltip",t.lcZ(9,5,"DELETE"))}}function B(i,c){if(1&i&&(t.TgZ(0,"tbody"),t.YNc(1,Y,11,13,"tr",63),t.qZA()),2&i){const o=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",o.arrayFields.options.controls)}}function Q(i,c){if(1&i){const o=t.EpF();t.TgZ(0,"div",53),t.TgZ(1,"table",54),t.TgZ(2,"colgroup"),t._UZ(3,"col",55),t._UZ(4,"col",55),t._UZ(5,"col",56),t._UZ(6,"col",57),t.qZA(),t.TgZ(7,"thead"),t.TgZ(8,"tr"),t.TgZ(9,"th"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"th"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"th"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t._UZ(18,"th"),t.qZA(),t.qZA(),t.YNc(19,B,2,1,"tbody",58),t.TgZ(20,"tfoot"),t.TgZ(21,"tr",59),t.TgZ(22,"td",60),t.TgZ(23,"button",61),t.NdJ("click",function(d){return t.CHM(o),t.oxw().arrayFieldAdd("options",d)}),t._UZ(24,"i",62),t._uU(25," \xa0 "),t.TgZ(26,"span"),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&i){const o=t.oxw();t.xp6(10),t.Oqu(t.lcZ(11,5,"SYSTEM_NAME")),t.xp6(3),t.Oqu(t.lcZ(14,7,"NAME")),t.xp6(3),t.Oqu(t.lcZ(17,9,"VALUE")),t.xp6(3),t.Q6J("ngIf",o.arrayFields.options),t.xp6(8),t.Oqu(t.lcZ(28,11,"ADD"))}}function K(i,c){if(1&i){const o=t.EpF();t.TgZ(0,"div",70),t._uU(1),t.TgZ(2,"button",71),t.NdJ("click",function(){return t.CHM(o),t.oxw().errorMessage=""}),t.qZA(),t.qZA()}if(2&i){const o=t.oxw();t.xp6(1),t.hij(" ",o.errorMessage," ")}}function j(i,c){if(1&i&&(t.TgZ(0,"div",72),t.TgZ(1,"a",73),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA(),t.qZA()),2&i){const o=t.oxw();t.xp6(1),t.hYB("href","",o.baseUrl,"?_switch_user=",o.model.email,"",t.LSH),t.xp6(2),t.Oqu(t.lcZ(4,3,"IMPERSONATION"))}}const V=function(i){return{"no-events":i}},z=function(i){return{"form-control-search-clear":i}};let W=(()=>{class i extends A.B{constructor(o,n,d,l,E,U,D){super(o,n,d,l,E,U),this.fb=o,this.activeModal=n,this.translateService=d,this.systemNameService=l,this.dataService=E,this.elRef=U,this.appSettings=D,this.allowImpersonation=!1,this.model=new I(0,"","",[],!0,[]),this.formFields=[{name:"email",validators:[m.kI.required,this.emailValidator]},{name:"fullName",validators:[m.kI.required]},{name:"phone",validators:[]},{name:"role",validators:[m.kI.required]},{name:"isActive",validators:[]},{name:"password",validators:[]},{name:"confirmPassword",validators:[]},{name:"apiToken",validators:[]},{name:"options",validators:[],children:[{name:"name",validators:[m.kI.required]},{name:"title",validators:[m.kI.required]},{name:"value",validators:[m.kI.required]}]}]}onBeforeInit(){if(!this.isEditMode){const o=(0,M.findIndex)(this.formFields,{name:"password"});o>-1&&(this.formFields[o].validators.push(m.kI.required),this.formFields[o+1].validators.push(m.kI.required))}this.baseUrl=u.d.getBaseUrl(),this.getUserRoles()}onAfterGetData(){this.buildControls(this.form,this.formFields),this.isEditMode&&this.appSettings.isSuperAdmin&&this.appSettings.settings.userEmail!==this.model.email&&(this.allowImpersonation=!0)}getUserRoles(){this.userRoles$=this.dataService.getRolesList().pipe((0,v.R)(this.destroyed$),(0,h.U)(o=>o.roles))}clearApiToken(o){o&&o.preventDefault(),this.getControl(this.form,null,"apiToken").setValue("")}generateApiToken(o){o&&o.preventDefault(),this.loading=!0,this.dataService.createApiToken().pipe((0,v.R)(this.destroyed$)).subscribe({next:n=>{this.getControl(this.form,null,"apiToken").setValue(n.token),this.loading=!1},error:n=>{this.errorMessage=n.error||this.getLangString("ERROR"),this.loading=!1}})}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(m.qu),t.Y36(p.Kz),t.Y36(T.sK),t.Y36(g.U),t.Y36(a),t.Y36(t.SBq),t.Y36(u.d))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-user"]],features:[t._Bn([]),t.qOj],decls:118,vars:96,consts:[[1,"position-relative","modal-on-maximized"],[1,"tabs-top"],["type","button",1,"btn","btn-outline-primary","btn-sm","d-block",3,"disabled","click"],[1,"icon-cross","me-1"],[1,"icon-minimize","me-1"],[1,"modal-header","d-block"],[1,"position-relative","modal-on-minimized"],[1,"pos-absolute-right"],["type","button",1,"btn","btn-no-border","btn-sm-sm",3,"title","click"],[1,"icon-maximize"],["type","button",1,"btn","btn-no-border","btn-sm-sm","ms-1",3,"title","click"],[1,"icon-cross"],[1,"modal-title","text-overflow","me-5"],["method","post",3,"formGroup","ngClass","ngSubmit"],["formEl",""],[1,"modal-body","py-0"],[1,"row"],[1,"col-lg-6"],[1,"mb-2","form-group-message"],[1,"label-filled"],["type","text","autocomplete","off","formControlName","email",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["type","text","autocomplete","off","formControlName","fullName",1,"form-control",3,"ngClass"],["type","text","formControlName","phone","autocomplete","off",1,"form-control"],["formControlName","role",1,"form-select",3,"ngClass"],[4,"ngFor","ngForOf"],["type","password","autocomplete","off","formControlName","password",1,"form-control",3,"ngClass"],["type","password","autocomplete","off","formControlName","confirmPassword",1,"form-control",3,"ngClass"],[1,"mb-2"],[1,"input-group"],["type","text","name","apiToken","autocomplete","off","formControlName","apiToken",1,"form-control"],["type","button","container","body",1,"btn","btn-secondary",3,"ngbTooltip","click"],[1,"icon-reload"],[1,"mb-2","mt-0","mt-lg-4"],[1,"card","card-body","p-2","ps-3"],[1,"form-check","m-0"],["type","checkbox","value","1","formControlName","isActive",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],["activeIds","accordion-user-options",1,"ngb-accordion",3,"closeOthers"],["id","accordion-user-options",3,"title"],["ngbPanelContent",""],["class","alert alert-dismissible alert-danger mt-3 mb-0",4,"ngIf"],[1,"modal-footer","display-block"],["class","float-end",4,"ngIf"],[1,"btn-group","me-1"],["type","button",1,"btn","btn-success","btn-wide",3,"disabled","click"],["ngbDropdown","","role","group","placement","top-right",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-success","dropdown-toggle-split",3,"disabled"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["type","button","ngbDropdownItem","",3,"click"],["type","button",1,"btn","btn-secondary","btn-wide",3,"click"],[1,"alert","alert-danger"],[3,"value"],["formArrayName","options"],[1,"table","table-bordered","mb-0"],["width","27%"],["width","39%"],["width","7%"],[4,"ngIf"],[1,"bg-faded"],["colspan","4",1,"text-center"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],[1,"icon-plus"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["type","text","formControlName","name",1,"form-control","form-control-sm",3,"ngClass"],["type","text","formControlName","title",1,"form-control","form-control-sm",3,"ngClass"],[1,"text-center"],["type","text","formControlName","value",1,"form-control","form-control-sm",3,"ngClass"],["type","button",1,"btn","btn-secondary","btn-sm",3,"ngbTooltip","click"],[1,"alert","alert-dismissible","alert-danger","mt-3","mb-0"],["type","button",1,"btn-close",3,"click"],[1,"float-end"],[1,"btn","btn-primary",3,"href"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"button",2),t.NdJ("click",function(l){return n.closeModal(l)}),t._UZ(3,"i",3),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.TgZ(7,"button",2),t.NdJ("click",function(l){return n.minimize(l)}),t._UZ(8,"i",4),t.TgZ(9,"span"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",5),t.TgZ(13,"div",6),t.TgZ(14,"div",7),t.TgZ(15,"button",8),t.NdJ("click",function(l){return n.maximize(l)}),t.ALo(16,"translate"),t._UZ(17,"i",9),t.qZA(),t.TgZ(18,"button",10),t.NdJ("click",function(l){return n.closeModal(l)}),t.ALo(19,"translate"),t._UZ(20,"i",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"h4",12),t._uU(22),t.qZA(),t.qZA(),t.TgZ(23,"form",13,14),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(25,"div",15),t.TgZ(26,"div",16),t.TgZ(27,"div",17),t.TgZ(28,"div",18),t.TgZ(29,"label",19),t._uU(30),t.ALo(31,"translate"),t.qZA(),t._UZ(32,"input",20),t.YNc(33,F,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(34,"div",17),t.TgZ(35,"div",18),t.TgZ(36,"label",19),t._uU(37),t.ALo(38,"translate"),t.qZA(),t._UZ(39,"input",22),t.YNc(40,O,2,1,"div",21),t.qZA(),t.qZA(),t.qZA(),t.TgZ(41,"div",16),t.TgZ(42,"div",17),t.TgZ(43,"div",18),t.TgZ(44,"label",19),t._uU(45),t.ALo(46,"translate"),t.qZA(),t._UZ(47,"input",23),t.YNc(48,R,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(49,"div",17),t.TgZ(50,"div",18),t.TgZ(51,"label",19),t._uU(52),t.ALo(53,"translate"),t.qZA(),t.TgZ(54,"select",24),t.YNc(55,w,3,2,"ng-container",25),t.ALo(56,"async"),t.qZA(),t.YNc(57,P,2,1,"div",21),t.qZA(),t.qZA(),t.qZA(),t.TgZ(58,"div",16),t.TgZ(59,"div",17),t.TgZ(60,"div",18),t.TgZ(61,"label",19),t._uU(62),t.ALo(63,"translate"),t.qZA(),t._UZ(64,"input",26),t.YNc(65,N,2,1,"div",21),t.qZA(),t.qZA(),t.TgZ(66,"div",17),t.TgZ(67,"div",18),t.TgZ(68,"label",19),t._uU(69),t.ALo(70,"translate"),t.qZA(),t._UZ(71,"input",27),t.YNc(72,J,2,1,"div",21),t.qZA(),t.qZA(),t.qZA(),t.TgZ(73,"div",16),t.TgZ(74,"div",17),t.TgZ(75,"div",28),t.TgZ(76,"label",19),t._uU(77),t.ALo(78,"translate"),t.qZA(),t.TgZ(79,"div",29),t._UZ(80,"input",30),t.TgZ(81,"button",31),t.NdJ("click",function(l){return n.clearApiToken(l)}),t.ALo(82,"translate"),t._UZ(83,"i",11),t.qZA(),t.TgZ(84,"button",31),t.NdJ("click",function(l){return n.generateApiToken(l)}),t.ALo(85,"translate"),t._UZ(86,"i",32),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(87,"div",17),t.TgZ(88,"div",28),t.TgZ(89,"div",33),t.TgZ(90,"div",34),t.TgZ(91,"div",35),t._UZ(92,"input",36),t.TgZ(93,"label",37),t._uU(94),t.ALo(95,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(96,"ngb-accordion",38),t.TgZ(97,"ngb-panel",39),t.ALo(98,"translate"),t.YNc(99,Q,29,13,"ng-template",40),t.qZA(),t.qZA(),t.YNc(100,K,3,1,"div",41),t.qZA(),t.TgZ(101,"div",42),t.YNc(102,j,5,5,"div",43),t.TgZ(103,"div",44),t.TgZ(104,"button",45),t.NdJ("click",function(l){return n.save(!0,l)}),t.TgZ(105,"span"),t._uU(106),t.ALo(107,"translate"),t.qZA(),t.qZA(),t.TgZ(108,"div",46),t._UZ(109,"button",47),t.TgZ(110,"div",48),t.TgZ(111,"button",49),t.NdJ("click",function(l){return n.save(!1,l)}),t._uU(112),t.ALo(113,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(114,"button",50),t.NdJ("click",function(l){return n.closeModal(l)}),t.TgZ(115,"span"),t._uU(116),t.ALo(117,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(6,46,"CLOSE")),t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(11,48,"MINIMIZE")),t.xp6(5),t.Q6J("title",t.lcZ(16,50,"EXPAND")),t.xp6(3),t.Q6J("title",t.lcZ(19,52,"CLOSE")),t.xp6(4),t.Oqu(n.modalTitle),t.xp6(1),t.Q6J("formGroup",n.form)("ngClass",t.VKq(84,V,n.submitted)),t.xp6(2),t.ekj("loading",n.loading),t.xp6(5),t.hij(" ",t.lcZ(31,54,"EMAIL")," "),t.xp6(2),t.Q6J("ngClass",t.VKq(86,C,n.form.controls.email.touched&&!n.form.controls.email.valid)),t.xp6(1),t.Q6J("ngIf",n.formErrors.email),t.xp6(4),t.hij(" ",t.lcZ(38,56,"FULL_NAME")," "),t.xp6(2),t.Q6J("ngClass",t.VKq(88,C,n.form.controls.fullName.touched&&!n.form.controls.fullName.valid)),t.xp6(1),t.Q6J("ngIf",n.formErrors.fullName),t.xp6(5),t.hij(" ",t.lcZ(46,58,"PHONE")," "),t.xp6(3),t.Q6J("ngIf",n.formErrors.phone),t.xp6(4),t.hij(" ",t.lcZ(53,60,"ROLE")," "),t.xp6(2),t.Q6J("ngClass",t.VKq(90,C,n.form.controls.role.touched&&!n.form.controls.role.valid)),t.xp6(1),t.Q6J("ngForOf",t.lcZ(56,62,n.userRoles$)),t.xp6(2),t.Q6J("ngIf",n.formErrors.password),t.xp6(5),t.hij(" ",t.lcZ(63,64,"PASSWORD")," "),t.xp6(2),t.Q6J("ngClass",t.VKq(92,C,n.form.controls.password.touched&&!n.form.controls.password.valid)),t.xp6(1),t.Q6J("ngIf",n.formErrors.password),t.xp6(4),t.hij(" ",t.lcZ(70,66,"CONFIRM_PASSWORD")," "),t.xp6(2),t.Q6J("ngClass",t.VKq(94,C,n.form.controls.confirmPassword.touched&&!n.form.controls.confirmPassword.valid)),t.xp6(1),t.Q6J("ngIf",n.formErrors.confirmPassword),t.xp6(5),t.hij(" ",t.lcZ(78,68,"API_TOKEN")," "),t.xp6(2),t.ekj("is-invalid",n.formErrors.name),t.xp6(2),t.s9C("ngbTooltip",t.lcZ(82,70,"CLEAR")),t.xp6(3),t.s9C("ngbTooltip",t.lcZ(85,72,"GENERATE")),t.xp6(8),t.MGl("id","fieldIsActive",n.model.id,""),t.xp6(1),t.MGl("for","fieldIsActive",n.model.id,""),t.xp6(1),t.hij(" ",t.lcZ(95,74,"ACTIVE")," "),t.xp6(2),t.Q6J("closeOthers",!0),t.xp6(1),t.Q6J("title",t.lcZ(98,76,"OPTIONS")),t.xp6(3),t.Q6J("ngIf",n.errorMessage),t.xp6(2),t.Q6J("ngIf",n.allowImpersonation),t.xp6(2),t.Q6J("disabled",n.submitted),t.xp6(2),t.Oqu(t.lcZ(107,78,"SAVE_AND_CLOSE")),t.xp6(3),t.Q6J("disabled",n.submitted),t.xp6(3),t.Oqu(t.lcZ(113,80,"SAVE")),t.xp6(4),t.Oqu(t.lcZ(117,82,"CLOSE")))},directives:[m._Y,m.JL,m.sg,_.mk,m.Fj,m.JJ,m.u,_.O5,m.EJ,_.sg,p._L,m.Wl,p.gY,p.Gk,p.gW,p.jt,p.iD,p.Vi,p.TH,m.YN,m.Kr,m.CE,m.x0],pipes:[T.X$,_.Ov],encapsulation:2}),i})();const $=[{path:"",redirectTo:"/users/",pathMatch:"full"},{path:":userEmail",component:(()=>{class i extends S.U{constructor(o,n,d,l,E,U){super(o,n,d,l),this.dataService=o,this.activeModal=n,this.modalService=d,this.translateService=l,this.route=E,this.router=U,this.queryOptions=new f.J("id","desc",1,10,0,0),this.tableFields=[{name:"id",sortName:"id",title:"ID",outputType:"text",outputProperties:{}},{name:"email",sortName:"email",title:"EMAIL",outputType:"text",outputProperties:{}},{name:"fullName",sortName:"fullName",title:"FULL_NAME",outputType:"text",outputProperties:{}},{name:"role",sortName:"roles",title:"ROLE",outputType:"userRole",outputProperties:{}},{name:"createdDate",sortName:"createdDate",title:"DATE_TIME",outputType:"date",outputProperties:{format:"dd/MM/y H:mm:s"}},{name:"isActive",sortName:"isActive",title:"STATUS",outputType:"boolean",outputProperties:{}}]}ngOnInit(){this.afterInit()}afterInit(){this.route.paramMap.subscribe(o=>{this.queryOptions.search_word=o.get("userEmail"),this.getList()})}onSearchClear(){this.route.snapshot.url&&this.route.snapshot.url[0].path?this.router.navigate(["/users",""]):this.getList()}setModalInputs(o,n=!1,d=""){const l=void 0!==o&&!n;this.modalRef.componentInstance.modalTitle=l?`${this.getLangString("USER")} #${o}`:this.getLangString("ADD_USER"),this.modalRef.componentInstance.modalId=d,this.modalRef.componentInstance.itemId=o||0,this.modalRef.componentInstance.isItemCopy=n||!1,this.modalRef.componentInstance.isEditMode=l}getModalElementId(o){return["modal","user",o||0].join("-")}getModalContent(){return W}changeRequest(o){}}return i.title="USERS",i.\u0275fac=function(o){return new(o||i)(t.Y36(a),t.Y36(p.Kz),t.Y36(p.FF),t.Y36(T.sK),t.Y36(Z.gz),t.Y36(Z.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-shk-users"]],features:[t._Bn([a]),t.qOj],decls:37,vars:29,consts:[[1,"card"],[1,"card-body"],[1,"icon-head"],[1,"mb-3"],[1,"float-md-start"],[1,"form-control-search","mb-2","mb-md-0",3,"ngClass"],["type","text",1,"form-control","min-width250",3,"placeholder","ngModel","ngModelChange"],[3,"click"],[1,"float-md-end"],["ngbDropdown","","placement","bottom-right",1,"d-block","d-md-inline-block","mb-2","mb-md-0"],["ngbDropdownToggle","",1,"btn","btn-info","d-block","d-md-inline-block","width-100","width-md-auto"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],["type","button",1,"btn","btn-success","btn-wide","d-block","d-md-inline-block","width-100","width-md-auto","ms-md-2","mb-2","mb-md-0",3,"click"],[1,"icon-plus"],[1,"float-start"],[1,"clearfix"],[1,"min-height400"],[3,"items","selectedIds","collectionSize","queryOptions","tableFields","loading","isCloneAllowed","selectedIdsChange","loadingChange","actionRequest","changeRequest"],["table",""]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3"),t._UZ(3,"i",2),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"hr"),t.TgZ(7,"div",3),t.TgZ(8,"div",4),t.TgZ(9,"div",5),t.TgZ(10,"input",6),t.NdJ("ngModelChange",function(l){return n.queryOptions.search_word=l})("ngModelChange",function(){return n.onSearchWordUpdate()}),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"span",7),t.NdJ("click",function(){return n.onSearchWordUpdate("")}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",8),t.TgZ(14,"div",9),t.TgZ(15,"button",10),t.TgZ(16,"span"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.qZA(),t.TgZ(19,"div",11),t.TgZ(20,"button",12),t.NdJ("click",function(){return n.blockSelected()}),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"button",12),t.NdJ("click",function(){return n.deleteSelected()}),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"button",13),t.NdJ("click",function(){return n.modalOpen()}),t._UZ(27,"i",14),t._uU(28," \xa0 "),t.TgZ(29,"span"),t._uU(30),t.ALo(31,"translate"),t.qZA(),t.qZA(),t.qZA(),t._UZ(32,"div",15),t._UZ(33,"div",16),t.qZA(),t.TgZ(34,"div",17),t.TgZ(35,"app-table",18,19),t.NdJ("selectedIdsChange",function(l){return n.selectedIds=l})("loadingChange",function(l){return n.loading=l})("actionRequest",function(l){return n.actionRequest(l)})("changeRequest",function(l){return n.changeRequest(l)}),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(4),t.hij(" ",t.lcZ(5,15,"USERS")," "),t.xp6(5),t.Q6J("ngClass",t.VKq(27,z,!!n.queryOptions.search_word)),t.xp6(1),t.MGl("placeholder","",t.lcZ(11,17,"SEARCH"),"..."),t.Q6J("ngModel",n.queryOptions.search_word),t.xp6(7),t.Oqu(t.lcZ(18,19,"BATCH_ACTIONS")),t.xp6(4),t.Oqu(t.lcZ(22,21,"DISABLE_ENABLE")),t.xp6(3),t.Oqu(t.lcZ(25,23,"DELETE")),t.xp6(6),t.Oqu(t.lcZ(31,25,"ADD")),t.xp6(5),t.Q6J("items",n.items)("selectedIds",n.selectedIds)("collectionSize",n.collectionSize)("queryOptions",n.queryOptions)("tableFields",n.tableFields)("loading",n.loading)("isCloneAllowed",!1))},directives:[_.mk,m.Fj,m.JJ,m.On,p.jt,p.iD,p.Vi,k.a],pipes:[T.X$],encapsulation:2}),i})()}];let G=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[Z.Bz.forChild($)],Z.Bz]}),i})(),H=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[a],imports:[[_.ez,q.m,G]]}),i})()}}]);